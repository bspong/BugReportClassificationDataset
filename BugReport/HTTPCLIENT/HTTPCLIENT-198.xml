<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:14:40 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-198/HTTPCLIENT-198.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-198] The PostMethod did not bring back response headers from proxy servers</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-198</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>Description:&lt;br/&gt;
&lt;br/&gt;
When doing tunnelling through proxy servers, in case of 407 response, the &lt;br/&gt;
wrapper class ConnectMethod failed to pass the response header back to the &lt;br/&gt;
wrapped method (PostMethod in our case).  As result, the response headers are &lt;br/&gt;
not passed back to the application.&lt;br/&gt;
&lt;br/&gt;
Proposed Fix:&lt;br/&gt;
Change the ConnectMethod to use the wrapped method instance to get response &lt;br/&gt;
headers.  It will be reinitialized again if &amp;quot;CONNECT&amp;quot; is successful.&lt;br/&gt;
&lt;br/&gt;
Also have to modify the addProxyAuthorizationRequestHeader code to use the &lt;br/&gt;
wrapped method for the authenticator to work.</description>
                <environment>Operating System: other&lt;br/&gt;
Platform: PC</environment>
            <key id="12333757">HTTPCLIENT-198</key>
            <summary>The PostMethod did not bring back response headers from proxy servers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="olegk">Oleg Kalnichevski</assignee>
                                <reporter username="bin.chen@sabre-holdings.com">Bin Chen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Apr 2003 23:02:12 +0100</created>
                <updated>Sun, 22 Apr 2007 08:10:20 +0100</updated>
                    <resolved>Sun, 22 Apr 2007 08:10:20 +0100</resolved>
                            <version>2.0 Beta 1</version>
                                <fixVersion>2.0 Beta 1</fixVersion>
                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12380309" author="bin.chen@sabre-holdings.com" created="Wed, 23 Apr 2003 23:02:54 +0100"  >Created an attachment (id=5969)&lt;br/&gt;
PATCH&lt;br/&gt;
</comment>
                    <comment id="12380310" author="olegk" created="Wed, 23 Apr 2003 23:54:44 +0100"  >Bin,&lt;br/&gt;
We are aware of the ConnectMethod being a terrible mess. It needs a complete&lt;br/&gt;
rewrite. Having to cast the HttpMethod interface to HttpMethodBase in order to&lt;br/&gt;
get things done is simply appalling.&lt;br/&gt;
&lt;br/&gt;
The problem is we can&amp;#39;t fix the problem cleanly while retaining API compatibility.&lt;br/&gt;
&lt;br/&gt;
There&amp;#39;s already a bug report in the Bugzilla for it, which has been targeted for&lt;br/&gt;
2.1 release. &lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://nagoya.apache.org/bugzilla/show_bug.cgi?id=15534&quot;&gt;http://nagoya.apache.org/bugzilla/show_bug.cgi?id=15534&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
How critical is this bug for you? Can it be targeted for 2.1 release?&lt;br/&gt;
&lt;br/&gt;
Oleg </comment>
                    <comment id="12380311" author="bin.chen@sabre-holdings.com" created="Thu, 24 Apr 2003 01:08:04 +0100"  >It is very critical for us to get all the bugs, includign thi sone, we reported &lt;br/&gt;
fixed in order for us to use httpClient as Open Source once 2.0 is released.  &lt;br/&gt;
Currently we have to maintain our own version of the httpClient code and we &lt;br/&gt;
will not be able to get any latest fixes merge in.&lt;br/&gt;
&lt;br/&gt;
For this particular problem, when we negotiate NTLM proxy, we need to get more &lt;br/&gt;
information from user (domain and host) than Basic or Digest proxies.  When we &lt;br/&gt;
get a 407 response code back, we have to look into the response header to find &lt;br/&gt;
out what type of proxy is in use.  I just don&amp;#39;t know any other way for the &lt;br/&gt;
application to get that information besides getting it from the method.  We can &lt;br/&gt;
not prompt all users for the additional information either, that will confuse &lt;br/&gt;
the user who don&amp;#39;t use NTLM.</comment>
                    <comment id="12380312" author="olegk" created="Thu, 24 Apr 2003 01:21:54 +0100"  >Ok, I see. I&amp;#39;ll be working on a fix. I want to see if I manage to come up with a&lt;br/&gt;
somewhat cleaner structure for the ConnectMethod.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12380313" author="bin.chen@sabre-holdings.com" created="Thu, 24 Apr 2003 01:25:08 +0100"  >A related issue, I also noticed that the response body was also not brought &lt;br/&gt;
back in the original method instance.  Currently we do not have any need for &lt;br/&gt;
this.  But if an application want to display the response in a html page &lt;br/&gt;
format, it would need teh body as well.  If you are going to fix it, you may &lt;br/&gt;
want to consider that as well.</comment>
                    <comment id="12380314" author="olegk" created="Fri, 25 Apr 2003 20:19:33 +0100"  >Created an attachment (id=6009)&lt;br/&gt;
Patch (take 2) by Oleg Kalnichevski&lt;br/&gt;
</comment>
                    <comment id="12380315" author="olegk" created="Fri, 25 Apr 2003 20:25:00 +0100"  >I have done my best to inject a bit of sanity into HttpClient&amp;#39;s SSL tunneling&lt;br/&gt;
code. Unfortunately without a better design (HttpMethod split into HttpRequest/&lt;br/&gt;
HttpResponse pair) this hacks appears the only feasible solution compatible with&lt;br/&gt;
the present API. I really hate having to introduce such an ugly work-around.&lt;br/&gt;
Anyone who sees a better approach is welcome to come forward with it&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12380316" author="becke@u.washington.edu" created="Fri, 25 Apr 2003 21:50:20 +0100"  >Wow that is ugly:)&lt;br/&gt;
&lt;br/&gt;
Unfortuantely though I agree this is the way to go for now.  There is no other&lt;br/&gt;
way to return the response, except to force it on the original method.  It seems&lt;br/&gt;
like we may also want to fake the response body on the method as well.&lt;br/&gt;
&lt;br/&gt;
It looks like a little extra code for HttpConnection was accidentally added as&lt;br/&gt;
well.  I&amp;#39;m guessing this is from the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-199&quot; title=&quot;httpClient incorrectly closing tunnelled connection right after tunnell established&quot;&gt;&lt;strike&gt;HTTPCLIENT-199&lt;/strike&gt;&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
We will also need to resolve this one with the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-195&quot; title=&quot;NTLM authentication failed due to closing of connection&quot;&gt;&lt;strike&gt;HTTPCLIENT-195&lt;/strike&gt;&lt;/a&gt;, as they both&lt;br/&gt;
patch HttpMethodBase.shouldCloseConnection().&lt;br/&gt;
&lt;br/&gt;
Mike&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12380317" author="olegk" created="Fri, 25 Apr 2003 21:59:20 +0100"  >Mike, I really feel bad about this hack. Really.&lt;br/&gt;
I am currently working on a cumulative patch that will include all your fixes &lt;br/&gt;
as all these problems appear to have been caused by the same flaky code. The &lt;br/&gt;
patch should address this bug, as well as &lt;br/&gt;
&lt;a href=&quot;http://nagoya.apache.org/bugzilla/show_bug.cgi?id=19286&quot;&gt;http://nagoya.apache.org/bugzilla/show_bug.cgi?id=19286&lt;/a&gt; and &lt;br/&gt;
&lt;a href=&quot;http://nagoya.apache.org/bugzilla/show_bug.cgi?id=19226&quot;&gt;http://nagoya.apache.org/bugzilla/show_bug.cgi?id=19226&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
You&amp;#39;ll hear from me within a few hours&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12380318" author="olegk" created="Fri, 25 Apr 2003 23:24:40 +0100"  >Created an attachment (id=6015)&lt;br/&gt;
Patch (take 3) - includes fixes for &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-199&quot; title=&quot;httpClient incorrectly closing tunnelled connection right after tunnell established&quot;&gt;&lt;strike&gt;HTTPCLIENT-199&lt;/strike&gt;&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-195&quot; title=&quot;NTLM authentication failed due to closing of connection&quot;&gt;&lt;strike&gt;HTTPCLIENT-195&lt;/strike&gt;&lt;/a&gt;&lt;br/&gt;
</comment>
                    <comment id="12380319" author="becke@u.washington.edu" created="Sat, 26 Apr 2003 01:19:36 +0100"  >This looks like a good merge to me.  &lt;br/&gt;
&lt;br/&gt;
I think we also want to have the ConnectMethod set the response stream on a&lt;br/&gt;
failed execute().  I think we just need to add a readResponseBody() after or in&lt;br/&gt;
the fakeResponse() call.&lt;br/&gt;
&lt;br/&gt;
Mike</comment>
                    <comment id="12380320" author="olegk" created="Sat, 26 Apr 2003 01:28:36 +0100"  >Mike,&lt;br/&gt;
I was concerned about messing aroud with the response stream too much as I&lt;br/&gt;
thought it might somehow interfere with connection pooling logic. &lt;br/&gt;
&lt;br/&gt;
I suggest I commit the patch as it, so all the folks out there could test the&lt;br/&gt;
latest fixes. If you find it safe to extend the HttpMethodBase#fakeResponse&lt;br/&gt;
method to include response stream, we can do it with an incremental patch.&lt;br/&gt;
&lt;br/&gt;
What do you think?&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12380321" author="becke@u.washington.edu" created="Sat, 26 Apr 2003 01:34:16 +0100"  >Works for me.&lt;br/&gt;
&lt;br/&gt;
Mike</comment>
                    <comment id="12380322" author="olegk" created="Sat, 26 Apr 2003 02:18:43 +0100"  >Patch (take 3) has been committed. I leave the bug open until Mike decides if it&lt;br/&gt;
is safe to add CONNECT method response to the &amp;#39;wrapped&amp;#39; method&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12380323" author="olegk" created="Mon, 28 Apr 2003 05:08:33 +0100"  >Mike, can pass your judgement on this one?&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12380324" author="becke@u.washington.edu" created="Mon, 28 Apr 2003 05:12:42 +0100"  >Yup, I&amp;#39;m working on it right now.  I should post something soon.&lt;br/&gt;
&lt;br/&gt;
Mike</comment>
                    <comment id="12380325" author="becke@u.washington.edu" created="Mon, 28 Apr 2003 05:33:07 +0100"  >Created an attachment (id=6040)&lt;br/&gt;
Fake ConnectMethod response patch&lt;br/&gt;
</comment>
                    <comment id="12380326" author="becke@u.washington.edu" created="Mon, 28 Apr 2003 05:35:02 +0100"  >The attached method adds support for setting the response body via the fakeResponse() method.  I &lt;br/&gt;
have also created a test case to make sure that connections can be released after a failed &lt;br/&gt;
CONNECT.&lt;br/&gt;
&lt;br/&gt;
Mike</comment>
                    <comment id="12380327" author="olegk" created="Mon, 28 Apr 2003 06:04:07 +0100"  >Patch looks fine. I ran a few tests againt my local squid, all seems ok. Go&lt;br/&gt;
ahead and commit it. I do not think we should spend anymore time on code that&lt;br/&gt;
should have never been there in the first place&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12380328" author="bin.chen@sabre-holdings.com" created="Tue, 29 Apr 2003 00:37:43 +0100"  >Created an attachment (id=6053)&lt;br/&gt;
Log file indicating that the cookie header added by app was not sent.&lt;br/&gt;
</comment>
                    <comment id="12380329" author="becke@u.washington.edu" created="Tue, 29 Apr 2003 07:22:15 +0100"  >Patch applied.</comment>
                </comments>
                    <attachments>
                    <attachment id="12326839" name="ASF.LICENSE.NOT.GRANTED--applet2.http" size="58672" author="bin.chen@sabre-holdings.com" created="Tue, 29 Apr 2003 00:37:43 +0100" />
                    <attachment id="12326835" name="ASF.LICENSE.NOT.GRANTED--ConnectMethod.patch" size="972" author="bin.chen@sabre-holdings.com" created="Wed, 23 Apr 2003 23:02:54 +0100" />
                    <attachment id="12326838" name="ASF.LICENSE.NOT.GRANTED--fakeResponse.patch" size="10224" author="becke@u.washington.edu" created="Mon, 28 Apr 2003 05:33:07 +0100" />
                    <attachment id="12326837" name="ASF.LICENSE.NOT.GRANTED--ssltunnel.patch" size="13005" author="olegk" created="Fri, 25 Apr 2003 23:24:40 +0100" />
                    <attachment id="12326836" name="ASF.LICENSE.NOT.GRANTED--ssltunnel.patch" size="11743" author="olegk" created="Fri, 25 Apr 2003 20:19:33 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>5.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                <customfieldname>Bugzilla Id</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>19250</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 23 Apr 2003 22:54:44 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>133252</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>188734</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
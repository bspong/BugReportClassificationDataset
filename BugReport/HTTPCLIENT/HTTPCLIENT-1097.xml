<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:12:50 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-1097/HTTPCLIENT-1097.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-1097] BrowserCompatHostnameVerifier and StrictHostnameVerifier should handle wildcards in SSL certificates better</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-1097</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>I ran into a problem with SSL wildcard certificates in the class BrowserCompatHostnameVerifier. It handles &amp;quot;*.example.org&amp;quot; fine but &amp;quot;server*.example.org&amp;quot; fails to work correctly. The javadoc claims that it should behave the same way as curl and FireFox. In Firefox an SSL certificate for &amp;quot;server*.example.org&amp;quot; works fine for the host &amp;quot;server.example.org&amp;quot;, using HttpClient it throws an exception.&lt;br/&gt;
&lt;br/&gt;
Here is an example test (JUnit4):&lt;br/&gt;
&lt;br/&gt;
package org.example.hb;&lt;br/&gt;
&lt;br/&gt;
import javax.net.ssl.SSLException;&lt;br/&gt;
&lt;br/&gt;
import org.apache.http.conn.ssl.BrowserCompatHostnameVerifier;&lt;br/&gt;
import org.junit.Test;&lt;br/&gt;
&lt;br/&gt;
public class BrowserCompatHostnameVerifierTest {&lt;br/&gt;
&lt;br/&gt;
	/**&lt;br/&gt;
	 * Should not throw an exeption in the verify method.&lt;br/&gt;
	 * @throws SSLException&lt;br/&gt;
	 */&lt;br/&gt;
	@Test&lt;br/&gt;
	public void testVerifyStringStringArrayStringArray() throws SSLException&lt;br/&gt;
	{&lt;br/&gt;
		BrowserCompatHostnameVerifier hv = new BrowserCompatHostnameVerifier();&lt;br/&gt;
		String host = &amp;quot;&lt;a href=&quot;http://www.example.org&quot;&gt;www.example.org&lt;/a&gt;&amp;quot;;&lt;br/&gt;
		String[] cns = {&amp;quot;www*.example.org&amp;quot;};&lt;br/&gt;
		&lt;br/&gt;
		hv.verify(host, cns, cns);&lt;br/&gt;
	}&lt;br/&gt;
&lt;br/&gt;
}</description>
                <environment></environment>
            <key id="12508585">HTTPCLIENT-1097</key>
            <summary>BrowserCompatHostnameVerifier and StrictHostnameVerifier should handle wildcards in SSL certificates better</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="hennus2011">Hennus Bergman</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 May 2011 21:02:35 +0100</created>
                <updated>Sat, 23 Jul 2011 10:58:10 +0100</updated>
                    <resolved>Thu, 2 Jun 2011 14:11:21 +0100</resolved>
                            <version>4.1.1</version>
                                <fixVersion>4.1.2</fixVersion>
                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13040574" author="sebb@apache.org" created="Sat, 28 May 2011 12:10:17 +0100"  >RFC2818 says this about wildcards:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Names may contain the wildcard&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;character * which is considered to match any single domain name&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;component or component fragment. E.g., *.a.com matches foo.a.com but&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;not bar.foo.a.com. f*.com matches foo.com but not bar.com.&lt;br/&gt;
&lt;br/&gt;
This implies that the StrictHostnameVerifier ought to allow wildcards for component fragments.&lt;br/&gt;
&lt;br/&gt;
The RFC does not say if *oo.com or f*o.com is allowed - are such certs ever created?&lt;br/&gt;
It does appear to disallow multiple wildcards - &amp;quot;... _the_ wildcard character ...&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
I assume that the example f*.com is bad, and is not actually allowed!&lt;br/&gt;
&lt;br/&gt;
In which case, wildcards are allowed if:&lt;br/&gt;
- there are at least 2 dots, i.e. 3 components&lt;br/&gt;
- there is only one *  and this must be at the end of the first component&lt;br/&gt;
- if there are 3 components and the last one has two characters then check against bad 2LDs&lt;br/&gt;
&lt;br/&gt;
What about server*.example.com - do curl and Firefox allow this to match server.abc.example.com?&lt;br/&gt;
&lt;br/&gt;
The matching could probably be simplified if this is not allowed.&lt;br/&gt;
</comment>
                    <comment id="13042763" author="sebb@apache.org" created="Thu, 2 Jun 2011 14:05:12 +0100"  >Affects AbstractVerifier which is the base for BrowserCompatHostnameVerifier</comment>
                    <comment id="13042764" author="sebb@apache.org" created="Thu, 2 Jun 2011 14:06:59 +0100"  >Better: also affects StrictHostnameVerifier</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 28 May 2011 11:10:17 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>67123</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>46981</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
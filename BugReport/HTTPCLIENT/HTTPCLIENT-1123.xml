<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:13:04 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-1123/HTTPCLIENT-1123.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-1123] Implement a way to override or resolve DNS entries defined in the OS</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-1123</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>When working with HttpClient in restrictive environments, where the user doesn&amp;#39;t have the permissisions to edit the local /etc/hosts file or the DNS configuration, can be eased with an DNS Overrider capability. &lt;br/&gt;
&lt;br/&gt;
This can be useful with JMeter which can follow redirects automatically and resolve some of the redirected hosts against its configuration. Another example is a custom forward proxy, written in Java and based on httpclient, which can be deployed is such a restricted environment that would ease the development of various web solutions for some developers. </description>
                <environment></environment>
            <key id="12521222">HTTPCLIENT-1123</key>
            <summary>Implement a way to override or resolve DNS entries defined in the OS</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="avasile">Alin Vasile</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Sep 2011 20:13:13 +0100</created>
                <updated>Mon, 10 Oct 2011 21:19:05 +0100</updated>
                    <resolved>Mon, 10 Oct 2011 21:19:05 +0100</resolved>
                                            <fixVersion>4.2 Alpha1</fixVersion>
                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13096256" author="avasile" created="Fri, 2 Sep 2011 21:03:30 +0100"  >Proof of concept work. If this is OK I can add a set of unit tests and put the ASF headers to the source files.</comment>
                    <comment id="13096602" author="avasile" created="Sat, 3 Sep 2011 08:14:13 +0100"  >Updated patch with examples for custom DNS resolving on auto-redirects. Please review ...</comment>
                    <comment id="13096673" author="olegk" created="Sat, 3 Sep 2011 16:31:30 +0100"  >Looks good to me. However, I think it would be slightly cleaner to provide an additional constructor to DefaultClientConnectionOperator and PoolingClientConnectionManager that takes DnsOverrider as an optional (nullable) parameter. I also think DnsResolver might be a better name for that interface that DnsOverrider. Otherwise, all is good. Please go ahead and add ASL headers and test cases. Please make sure to use spaces instead of tabs for indentation.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="13096913" author="avasile" created="Sun, 4 Sep 2011 18:57:10 +0100"  >Thanks for the review. In the initial proof-of-concept I didn&amp;#39;t wanted to touch the existing API, so I extended the classes where I plugged in the new functionality.&lt;br/&gt;
&lt;br/&gt;
I attached a new patch incorporating all your comments.</comment>
                    <comment id="13096928" author="olegk" created="Sun, 4 Sep 2011 20:41:36 +0100"  >The patch is too &amp;#39;noisy&amp;#39; (a lot of changes are due to different formatting, line wrapping, etc), which makes it difficult to review. Could you please create a new patch with the least amount of non-functional changes?&lt;br/&gt;
&lt;br/&gt;
Oleg </comment>
                    <comment id="13097049" author="avasile" created="Mon, 5 Sep 2011 09:14:43 +0100"  >Sorry about the noise. Attached a (hopefully) much cleaner version. Also I moved the DnsResolver interface from the package org.apache.http.impl.conn to org.apache.http.conn.</comment>
                    <comment id="13097254" author="olegk" created="Mon, 5 Sep 2011 20:01:05 +0100"  >Almost there. I think it would be better if the DnsResolver was always to resolve hostname to an address or throw an UnknownHostException if the address could not be resolved instead of returning null. Individual implementations may choose to fall back onto InetAddress#getAllByName when appropriate or signal failure to resolve the hostname by throwing UnknownHostException.&lt;br/&gt;
---&lt;br/&gt;
public interface DnsResolver {&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;InetAddress[] resolve(String host) throws UnknownHostException;&lt;br/&gt;
&lt;br/&gt;
}&lt;br/&gt;
---&lt;br/&gt;
What do you think?&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="13097283" author="avasile" created="Mon, 5 Sep 2011 20:41:47 +0100"  >This is a good idea; in this way we favour exceptions instead of custom&lt;br/&gt;
returns such as null.</comment>
                    <comment id="13097954" author="olegk" created="Tue, 6 Sep 2011 13:24:06 +0100"  >Patch checked in with some minor tweaks.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="13098296" author="avasile" created="Tue, 6 Sep 2011 20:37:50 +0100"  >Default DNS resolver that will translate the host names to IP addresses using the OS configuration.</comment>
                    <comment id="13098371" author="olegk" created="Tue, 6 Sep 2011 22:29:44 +0100"  >Patch checked in.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="13124440" author="avasile" created="Mon, 10 Oct 2011 21:04:59 +0100"  >&lt;br/&gt;
PoolingClientConnectionManager constructor doesn&amp;#39;t pick the provided dns resolver, but instead always goes with SystemDefaultDnsResolver:&lt;br/&gt;
&lt;br/&gt;
public PoolingClientConnectionManager(final SchemeRegistry schemeRegistry,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;final long timeToLive, final TimeUnit tunit,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;final DnsResolver dnsResolver) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;super();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (schemeRegistry == null) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;throw new IllegalArgumentException(&amp;quot;Scheme registry may not be null&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;this.schemeRegistry = schemeRegistry;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;this.dnsResolver  = new SystemDefaultDnsResolver();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;this.operator = createConnectionOperator(schemeRegistry);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;this.pool = new HttpConnPool(this.log, 2, 20, timeToLive, tunit);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}</comment>
                    <comment id="13124454" author="olegk" created="Mon, 10 Oct 2011 21:19:05 +0100"  >Fixed.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                </comments>
                    <attachments>
                    <attachment id="12492879" name="dns_overrider_poc.patch" size="13828" author="avasile" created="Sat, 3 Sep 2011 08:13:58 +0100" />
                    <attachment id="12492800" name="dns_overrider_poc.patch" size="9948" author="avasile" created="Fri, 2 Sep 2011 21:03:29 +0100" />
                    <attachment id="12493063" name="dns_resolver.patch" size="16962" author="avasile" created="Mon, 5 Sep 2011 21:09:39 +0100" />
                    <attachment id="12493007" name="dns_resolver.patch" size="16477" author="avasile" created="Mon, 5 Sep 2011 09:14:43 +0100" />
                    <attachment id="12492984" name="dns_resolver.patch" size="44606" author="avasile" created="Sun, 4 Sep 2011 18:57:35 +0100" />
                    <attachment id="12493201" name="dns_system_resolver.patch" size="6908" author="avasile" created="Tue, 6 Sep 2011 20:37:50 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>6.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 3 Sep 2011 15:31:30 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>56963</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>46927</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
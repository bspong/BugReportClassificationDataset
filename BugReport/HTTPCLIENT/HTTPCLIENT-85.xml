<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:21:34 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-85/HTTPCLIENT-85.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-85] Host request header does not contain port</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-85</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>The Host request header is always added with just the hostname used for the &lt;br/&gt;
connection.  If the port is different than 80 it needs to be included as well, &lt;br/&gt;
with a colon separating it from the hostname.  This problem is especially &lt;br/&gt;
apparent when you use the httpclient to connect to tomcat 4 and then use &lt;br/&gt;
HttpUtils to create a full URL representing the request.  HttpUtils pulls the &lt;br/&gt;
host and port from the Host header.  When commons-httpclient is used HttpUtils &lt;br/&gt;
never includes the port since it was never in the Host header.</description>
                <environment>Operating System: All&lt;br/&gt;
Platform: All</environment>
            <key id="12333644">HTTPCLIENT-85</key>
            <summary>Host request header does not contain port</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="jsdever@sympatico.ca">Jeff Dever</assignee>
                                <reporter username="batbdotcom@yahoo.com">Bruce Duncan</reporter>
                        <labels>
                    </labels>
                <created>Sat, 27 Jul 2002 04:54:06 +0100</created>
                <updated>Sun, 22 Apr 2007 08:10:04 +0100</updated>
                    <resolved>Sun, 22 Apr 2007 08:10:04 +0100</resolved>
                            <version>2.0 Alpha 1</version>
                                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12379550" author="jsdever@sympatico.ca" created="Sat, 27 Jul 2002 09:44:34 +0100"  >This behaviour has changed slightly since alpha1.  The current behaviour is as&lt;br/&gt;
follows: &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (!isIpAddress(host)) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (port == 80) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;setRequestHeader(&amp;quot;Host&amp;quot;, host);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} else {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;setRequestHeader(&amp;quot;Host&amp;quot;, host + &amp;quot;:&amp;quot; + port);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} else {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;setRequestHeader(&amp;quot;Host&amp;quot;, &amp;quot;&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
So if the host is an actual hostname, and is not port 80, then the port will be&lt;br/&gt;
concatenated to the hostname seperated with a colon.&lt;br/&gt;
&lt;br/&gt;
If the host is an ipaddress, then the host header is added but with a blank&lt;br/&gt;
value.&lt;br/&gt;
&lt;br/&gt;
&amp;lt;cite href=&amp;quot;&lt;a href=&quot;http://www.ietf.org/rfc/rfc2616.txt&quot;&gt;http://www.ietf.org/rfc/rfc2616.txt&lt;/a&gt;&amp;quot;&amp;gt;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;A client MUST include a Host header field in all HTTP/1.1 request&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;messages . If the requested URI does not include an Internet host&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;name for the service being requested, then the Host header field MUST&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;be given with an empty value. An HTTP/1.1 proxy MUST ensure that any&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;request message it forwards does contain an appropriate Host header&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;field that identifies the service being requested by the proxy. All&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Internet-based HTTP/1.1 servers MUST respond with a 400 (Bad Request)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;status code to any HTTP/1.1 request message which lacks a Host header&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;field.&lt;br/&gt;
&amp;lt;/cite&amp;gt;&lt;br/&gt;
</comment>
                    <comment id="12379551" author="jsdever@sympatico.ca" created="Sat, 27 Jul 2002 09:49:39 +0100"  >Marked as fixed by mistake.  Awaiting Bruce Duncan to acknowledge the previous&lt;br/&gt;
comment.</comment>
                    <comment id="12379552" author="xiaowei@stratify.com" created="Sat, 27 Jul 2002 09:52:06 +0100"  >The existing fix still have a problem: it doesn&amp;#39;t handle the default port &lt;br/&gt;
number correctly. The default port number is 80 for http and 443 for https.&lt;br/&gt;
&lt;br/&gt;
The following is a fix for this problem:&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;protected void addHostRequestHeader(HttpState state, HttpConnection conn) &lt;br/&gt;
throws IOException, HttpException {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Per 19.6.1.1 of RFC 2616, it is legal for HTTP/1.0 based&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// applications to send the Host request-header.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// TODO: Add the ability to disable the sending of this header for &lt;br/&gt;
HTTP/1.0 requests.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String host = conn.getHost();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;int port = conn.getPort();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (!requestHeaders.containsKey(&amp;quot;host&amp;quot;) &amp;amp;&amp;amp; !isIpAddress(host)) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if(conn.isSecure()) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if(443 != port) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;host += &amp;quot;:&amp;quot; + port;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;else {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if(80 != port) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;host += &amp;quot;:&amp;quot; + port;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;setRequestHeader(&amp;quot;Host&amp;quot;, host);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}</comment>
                    <comment id="12379553" author="jsdever@sympatico.ca" created="Fri, 2 Aug 2002 19:42:49 +0100"  >Created an attachment (id=2579)&lt;br/&gt;
Fix&lt;br/&gt;
</comment>
                    <comment id="12379554" author="jsdever@sympatico.ca" created="Fri, 2 Aug 2002 19:44:33 +0100"  >Patch applied.  Test cases added and passed to reflect the new logic.</comment>
                </comments>
                    <attachments>
                    <attachment id="12326671" name="ASF.LICENSE.NOT.GRANTED--hostheader.diff" size="1740" author="jsdever@sympatico.ca" created="Fri, 2 Aug 2002 19:42:49 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                <customfieldname>Bugzilla Id</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11220</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 27 Jul 2002 08:44:34 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>133140</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>189240</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
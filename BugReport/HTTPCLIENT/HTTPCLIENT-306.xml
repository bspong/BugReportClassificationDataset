<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:15:56 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-306/HTTPCLIENT-306.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-306] Redesign of HTTP authentication framework</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-306</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>The existing HTTP authentication framework has got a few glaring deficiencies:&lt;br/&gt;
- Authentication headers management evolved (or degraded) into a some sort of&lt;br/&gt;
black art and proved very error-prone.&lt;br/&gt;
- Existing logic intended to deal with authentication failures and&lt;br/&gt;
authentication failure recovery is flawed. The resolution of the &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-213&quot; title=&quot;Authentication fails with proxied SSL Connections&quot;&gt;&lt;strike&gt;HTTPCLIENT-213&lt;/strike&gt;&lt;/a&gt; did&lt;br/&gt;
appear possible without a better approach than the one based on AuthScheme#getID.&lt;br/&gt;
&lt;br/&gt;
On top of that authentication logic got quite messy with the series of attempts&lt;br/&gt;
to fix breakages in complex authentication schemes (the latest being NTLM proxy&lt;br/&gt;
+ basic host fix) &lt;br/&gt;
&lt;br/&gt;
The patch I am about to attach is an attempt to address all the shortcomings&lt;br/&gt;
mentioned above. It builds upon my previous patch that enabled authentication&lt;br/&gt;
schemes to maintain authentication state and presents a complete redesign of the&lt;br/&gt;
existing HTTP authentication framework.&lt;br/&gt;
&lt;br/&gt;
Basically there&amp;#39;s no authentication code left untouched, so please do take a&lt;br/&gt;
closer look. Critique, comments, suggestions welcome.&lt;br/&gt;
&lt;br/&gt;
Oleg</description>
                <environment>Operating System: All&lt;br/&gt;
Platform: All</environment>
            <key id="12333865">HTTPCLIENT-306</key>
            <summary>Redesign of HTTP authentication framework</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="olegk">Oleg Kalnichevski</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Dec 2003 19:39:43 +0000</created>
                <updated>Thu, 2 May 2013 03:28:36 +0100</updated>
                    <resolved>Sun, 22 Apr 2007 08:10:38 +0100</resolved>
                            <version>Snapshot</version>
                                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12381365" author="olegk" created="Mon, 15 Dec 2003 19:41:26 +0000"  >Created an attachment (id=9576)&lt;br/&gt;
Patch (take 1)&lt;br/&gt;
</comment>
                    <comment id="12381366" author="olegk" created="Thu, 18 Dec 2003 01:28:07 +0000"  >Any feedback so far? Is anyone looking at the patch?&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12381367" author="becke@u.washington.edu" created="Mon, 12 Jan 2004 10:24:56 +0000"  >Hi Oleg,&lt;br/&gt;
&lt;br/&gt;
This looks quite good.  I like the changes to the AuthScheme interface.  Authentication in &lt;br/&gt;
HttpMethodDirector is quite complicated now,  more javadocs here would be quite helpful.&lt;br/&gt;
&lt;br/&gt;
I also noticed, in the process of testing that HttpState.setAuthenticationPreemtive() no longer &lt;br/&gt;
seems to have any effect.  Granted, it is deprecated, but now it&amp;#39;s completely non-functional.  Any &lt;br/&gt;
thoughts about how we can fix this?&lt;br/&gt;
&lt;br/&gt;
Mike</comment>
                    <comment id="12381368" author="olegk" created="Mon, 12 Jan 2004 19:04:20 +0000"  >&amp;gt; HttpMethodDirector is quite complicated now,  more javadocs here would&lt;br/&gt;
&amp;gt; be quite helpful.&lt;br/&gt;
&lt;br/&gt;
That goes without saying. As soon as the code stabilizes somewhat Javadocs will &lt;br/&gt;
be provided. I would wait until the first alpha, though&lt;br/&gt;
&lt;br/&gt;
&amp;gt; Granted, it is deprecated, but now it&amp;#39;s completely non-functional.&lt;br/&gt;
&amp;gt; Any thoughts about how we can fix this?&lt;br/&gt;
&lt;br/&gt;
I can&amp;#39;t think of anything elegant, but a dirty workaround should not be too &lt;br/&gt;
difficult.&lt;br/&gt;
&lt;br/&gt;
Folks, are there any objections to committing the patch? Odi, have you had a &lt;br/&gt;
change to review the patch? Are you still planning on reviewing it?&lt;br/&gt;
&lt;br/&gt;
Oleg&lt;br/&gt;
</comment>
                    <comment id="12381369" author="oglueck" created="Mon, 12 Jan 2004 19:19:19 +0000"  >sorry Oleg, I can not apply the patch to the current HEAD. It seems outdated.</comment>
                    <comment id="12381370" author="olegk" created="Mon, 12 Jan 2004 20:39:10 +0000"  >Created an attachment (id=9909)&lt;br/&gt;
Patch (take 2)&lt;br/&gt;
</comment>
                    <comment id="12381371" author="oglueck" created="Mon, 12 Jan 2004 21:18:51 +0000"  >I think the patch is okay, but the architecture is not perfect yet. You can&lt;br/&gt;
still commit it I guess. I did not run any tests on it but rather scimmed the code.&lt;br/&gt;
&lt;br/&gt;
To do:&lt;br/&gt;
1. I would like to get rid of the challenge stuff in AuthScheme interface.&lt;br/&gt;
Challenge is really an implementation detail that should not be part of this&lt;br/&gt;
interface.&lt;br/&gt;
2. For real stateful authentication we will need a single AuthScheme instance&lt;br/&gt;
that  lives during a complete authentication cycle. The&lt;br/&gt;
AuthPolicy::getAuthScheme method does not currently fulfill this.&lt;br/&gt;
&lt;br/&gt;
Odi</comment>
                    <comment id="12381372" author="olegk" created="Mon, 12 Jan 2004 21:36:30 +0000"  >&lt;br/&gt;
&amp;gt; I think the patch is okay, but the architecture is not perfect yet. You can&lt;br/&gt;
&amp;gt; still commit it I guess. I did not run any tests on it but rather scimmed the &lt;br/&gt;
&amp;gt; code.&lt;br/&gt;
&lt;br/&gt;
Things can be always done better. The question is if the patch is step forward&lt;br/&gt;
or backward. If you need more time to review the patch, let me know.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; 2. For real stateful authentication we will need a single AuthScheme instance&lt;br/&gt;
&amp;gt; that  lives during a complete authentication cycle. &lt;br/&gt;
&lt;br/&gt;
Unless we are talking about different things, I believe that this is in fact the&lt;br/&gt;
case. There&amp;#39;s _always_ (preemptive auth scheme notwithstanding) only one&lt;br/&gt;
instance of authentication scheme within a complete authentication cycle. One&lt;br/&gt;
may take this one step further and persist (cache) authentication schemes&lt;br/&gt;
between method invocations to avoid re-authentication against the realms&lt;br/&gt;
HttpClient already has authenticated with. But this is something for 4.0&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12381373" author="oglueck" created="Mon, 12 Jan 2004 21:52:52 +0000"  >&amp;gt; The question is if the patch is step forward&lt;br/&gt;
&amp;gt; or backward. &lt;br/&gt;
&lt;br/&gt;
I think the code is moving towards the right places. It&amp;#39;s certainly an&lt;br/&gt;
improvement. Good work so far.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; Unless we are talking about different things, I believe that this is in fact the&lt;br/&gt;
&amp;gt; case. There&amp;#39;s _always_ (preemptive auth scheme notwithstanding) only one&lt;br/&gt;
&amp;gt; instance of authentication scheme within a complete authentication cycle.&lt;br/&gt;
&lt;br/&gt;
Oh. So I have to look at it again. Then this is fine with me and I can try and&lt;br/&gt;
make DigestAuth behave better ,-)</comment>
                    <comment id="12381374" author="becke@u.washington.edu" created="Mon, 12 Jan 2004 22:19:11 +0000"  >Commit it fine with me.&lt;br/&gt;
&lt;br/&gt;
Mike</comment>
                    <comment id="12381375" author="olegk" created="Tue, 13 Jan 2004 02:51:09 +0000"  >Patch committed. Oleg</comment>
                    <comment id="12381376" author="olegk" created="Wed, 24 Mar 2004 21:30:34 +0000"  >Prompted by the 2.0 incompatibility discovered by Vincent Massol&lt;br/&gt;
&amp;lt;vmassol at pivolis.com&amp;gt; (Specials thanks go to Gump and all the Gump&lt;br/&gt;
Meisters) I went over the authentication code one more time and made yet&lt;br/&gt;
another series of changes &lt;br/&gt;
&lt;br/&gt;
* I factored out the authentication challenge processing logic from the&lt;br/&gt;
HttpMethodDirector to a class of its own. Thanks to that authentication&lt;br/&gt;
challenge processing can now be tested separately. Test cases provided.&lt;br/&gt;
&lt;br/&gt;
* HttpMethodDirector no longer intervenes if Authorization &amp;amp;&lt;br/&gt;
Proxy-Authorization are set manually by the user. Custom authorization&lt;br/&gt;
headers are never overwritten&lt;br/&gt;
&lt;br/&gt;
* Introduced a new class called AuthState that represents the&lt;br/&gt;
authentication process state that contains all the authentication&lt;br/&gt;
details. Basically it is just a convenience wrapper around the&lt;br/&gt;
authentication scheme interface.&lt;br/&gt;
&lt;br/&gt;
* Proxy and host authentication state objects moved to the HTTP method&lt;br/&gt;
level, so that they can be queried by the user to find out the details&lt;br/&gt;
about authentication that has been performed by the HttpMethodDirector.&lt;br/&gt;
With the current implementation all the details of proxy and host&lt;br/&gt;
authentication are contained within the HttpMethodDirector instance,&lt;br/&gt;
which exists only within the lifetime of HttpClient#executeMethod()&lt;br/&gt;
execution. As soon as the method returns, the respective&lt;br/&gt;
HttpMethodDirector instance gets GCed along with the authentication&lt;br/&gt;
details&lt;br/&gt;
&lt;br/&gt;
* More test cases&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12381377" author="olegk" created="Wed, 24 Mar 2004 21:31:27 +0000"  >Created an attachment (id=10949)&lt;br/&gt;
Follow-up patch (take 1)&lt;br/&gt;
</comment>
                    <comment id="12381378" author="becke@u.washington.edu" created="Thu, 25 Mar 2004 11:15:35 +0000"  >Looks good to me.  I like it.&lt;br/&gt;
&lt;br/&gt;
Mike</comment>
                    <comment id="12381379" author="olegk" created="Fri, 26 Mar 2004 04:38:42 +0000"  >Patch committed.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10001">
                <name>dependent</name>
                                <outwardlinks description="depends upon">
                            <issuelink>
            <issuekey id="12333772">HTTPCLIENT-213</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12333607">HTTPCLIENT-48</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12327049" name="ASF.LICENSE.NOT.GRANTED--auth.patch" size="60382" author="olegk" created="Wed, 24 Mar 2004 21:31:27 +0000" />
                    <attachment id="12327048" name="ASF.LICENSE.NOT.GRANTED--auth.patch" size="66787" author="olegk" created="Mon, 12 Jan 2004 20:39:10 +0000" />
                    <attachment id="12327047" name="ASF.LICENSE.NOT.GRANTED--auth.patch" size="50969" author="olegk" created="Mon, 15 Dec 2003 19:41:26 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                <customfieldname>Bugzilla Id</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25529</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 12 Jan 2004 10:24:56 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>133355</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>189301</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
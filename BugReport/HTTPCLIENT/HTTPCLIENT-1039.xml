<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:12:24 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-1039/HTTPCLIENT-1039.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-1039] AbstractHttpClient.determineTarget does not recognize target host correctly</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-1039</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>I am trying to execute an HttpGet with the following URI:&lt;br/&gt;
&amp;quot;&lt;a href=&quot;http://www.foo.foo/doSomething.html?url=http://www.bar.bar/doSomethingElse.html&quot;&gt;http://www.foo.foo/doSomething.html?url=http://www.bar.bar/doSomethingElse.html&lt;/a&gt;&amp;quot;&lt;br/&gt;
&lt;br/&gt;
This leads to UnknownHostException&lt;br/&gt;
&lt;br/&gt;
Going through the internal code, the problem seems to be in the AbstractHttpClient.determineTarget method:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String ssp = requestURI.getSchemeSpecificPart();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ssp = ssp.substring(2, ssp.length()); //remove &amp;quot;//&amp;quot; prefix&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;int end = ssp.indexOf(&amp;#39;:&amp;#39;) &amp;gt; 0 ? ssp.indexOf(&amp;#39;:&amp;#39;) :&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ssp.indexOf(&amp;#39;/&amp;#39;) &amp;gt; 0 ? ssp.indexOf(&amp;#39;/&amp;#39;) :&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ssp.indexOf(&amp;#39;?&amp;#39;) &amp;gt; 0 ? ssp.indexOf(&amp;#39;?&amp;#39;) : ssp.length();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String host = ssp.substring(0, end);&lt;br/&gt;
&lt;br/&gt;
This code sets the target host to &amp;quot;&lt;a href=&quot;http://www.foo.foo/doSomething.html?url=http&quot;&gt;www.foo.foo/doSomething.html?url=http&lt;/a&gt;&amp;quot; instead of &amp;quot;&lt;a href=&quot;http://www.foo.foo&quot;&gt;www.foo.foo&lt;/a&gt;&amp;quot;. This obviously breaks the execution not far down the line... DefaultClientConnectionOperator.resolveHostname throws an UnknownHostException.&lt;br/&gt;
&lt;br/&gt;
FWIW the AbstractHttpClient.determineTarget method actually has access to the request URI object, which correctly states that the host is &amp;quot;&lt;a href=&quot;http://www.foo.foo&quot;&gt;www.foo.foo&lt;/a&gt;&amp;quot;.&lt;br/&gt;
&lt;br/&gt;
So why does it try to extract the host from the scheme specific part anyway?&lt;br/&gt;
&lt;br/&gt;
I hope this is useful... and if there is any workaround please let me know, as I&amp;#39;m stuck on this one.&lt;br/&gt;
&lt;br/&gt;
Marco</description>
                <environment></environment>
            <key id="12494708">HTTPCLIENT-1039</key>
            <summary>AbstractHttpClient.determineTarget does not recognize target host correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="mrocci">Marco Rocci</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Jan 2011 10:43:35 +0000</created>
                <updated>Tue, 25 Jan 2011 11:00:39 +0000</updated>
                    <resolved>Wed, 5 Jan 2011 10:58:29 +0000</resolved>
                            <version>4.1 Beta1</version>
                                <fixVersion>4.1 Final</fixVersion>
                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12977730" author="olegk" created="Wed, 5 Jan 2011 10:58:10 +0000"  >Duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-1038&quot; title=&quot;AbstractHttpClient.determineTarget(HttpUriRequest)&quot;&gt;&lt;strike&gt;HTTPCLIENT-1038&lt;/strike&gt;&lt;/a&gt;. Fixed in SVN trunk.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12977733" author="mrocci" created="Wed, 5 Jan 2011 11:10:06 +0000"  >I was thinking... if the determineTarget method really has to do this host extraction itself... shouldn&amp;#39;t it use:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;requestURI.getRawSchemeSpecificPart()&lt;br/&gt;
instead of:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;requestURI.getSchemeSpecificPart()&lt;br/&gt;
&lt;br/&gt;
At least that should solve this type of problem, right?&lt;br/&gt;
&lt;br/&gt;
Workarounds seem difficult. The called method is private in AbstractHttpClient... and the calling method is public final.&lt;br/&gt;
&lt;br/&gt;
Marco</comment>
                    <comment id="12977738" author="mrocci" created="Wed, 5 Jan 2011 11:15:58 +0000"  >Thanks Oleg. I&amp;#39;m sorry I opened a duplicate issue. I searched through the open ones, but I didn&amp;#39;t think of going through the solved issues.&lt;br/&gt;
&lt;br/&gt;
I&amp;#39;ll get the SVN trunk version then.&lt;br/&gt;
&lt;br/&gt;
Marco</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="12310000">
                <name>Duplicate</name>
                                <outwardlinks description="duplicates">
                            <issuelink>
            <issuekey id="12494288">HTTPCLIENT-1038</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 5 Jan 2011 10:58:10 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>134039</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>47292</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
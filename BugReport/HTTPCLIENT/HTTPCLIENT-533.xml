<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:18:26 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-533/HTTPCLIENT-533.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-533] CookiePolicy.registerCookieSpec(CookiePolicy.DEFAULT, &lt;Some CookieSpec&gt;); does not work as documented</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-533</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>I use HtmlUnit to access some quote information. Cookies shall be ignored,so I&lt;br/&gt;
set the default policy to CookiePolicy.IGNORE_COOKIES. Nevertheless I get error&lt;br/&gt;
messages after starting my program. &lt;br/&gt;
&lt;br/&gt;
The code reads:&lt;br/&gt;
---------------------------------------&lt;br/&gt;
CookiePolicy.registerCookieSpec(CookiePolicy.DEFAULT, IgnoreCookiesSpec.class);&lt;br/&gt;
final WebClient webClient = new WebClient();&lt;br/&gt;
final URL url = new URL(&amp;quot;&lt;a href=&quot;http://de.finance.yahoo.com/q?s=CB3569.SG&quot;&gt;http://de.finance.yahoo.com/q?s=CB3569.SG&lt;/a&gt;&amp;quot;);&lt;br/&gt;
final HtmlPage page = (HtmlPage) webClient.getPage(url);&lt;br/&gt;
----------------------------------------&lt;br/&gt;
&lt;br/&gt;
The error messages are:&lt;br/&gt;
----------------------------------------&lt;br/&gt;
WARNUNG: Cookie rejected: &amp;quot;$Version=0; PRF=&amp;amp;t=CB3569.SG; $Domain=finance.yahoo.c&lt;br/&gt;
om; $Path=/&amp;quot;. Domain attribute &amp;quot;finance.yahoo.com&amp;quot; violates RFC 2109: domain mus&lt;br/&gt;
t start with a dot&lt;br/&gt;
30.11.2005 10:28:20 org.apache.commons.httpclient.HttpMethodBase processResponse&lt;br/&gt;
Headers&lt;br/&gt;
WARNUNG: Cookie rejected: &amp;quot;$Version=0; B=7fkoh9l1oqs4h&amp;amp;b=3&amp;amp;s=hb; $Domain=.yahoo.&lt;br/&gt;
com; $Path=/&amp;quot;. Domain attribute &amp;quot;.yahoo.com&amp;quot; violates RFC 2109: host minus domai&lt;br/&gt;
n may not contain any dots&lt;br/&gt;
----------------------------------------</description>
                <environment>Operating System: Windows 2000&lt;br/&gt;
Platform: PC</environment>
            <key id="12334092">HTTPCLIENT-533</key>
            <summary>CookiePolicy.registerCookieSpec(CookiePolicy.DEFAULT, &lt;Some CookieSpec&gt;); does not work as documented</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="bernhardpetri@t-online.de">Bernhard Petri</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Nov 2005 19:58:37 +0000</created>
                <updated>Sun, 22 Apr 2007 08:11:12 +0100</updated>
                    <resolved>Wed, 31 May 2006 05:00:19 +0100</resolved>
                            <version>3.0 RC3</version>
                                <fixVersion>3.1 Alpha 1</fixVersion>
                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12382866" author="oglueck" created="Wed, 30 Nov 2005 20:04:04 +0000"  >This is not a bug, but your code is wrong. Please read&lt;br/&gt;
&lt;a href=&quot;http://jakarta.apache.org/commons/httpclient/cookies.html&quot;&gt;http://jakarta.apache.org/commons/httpclient/cookies.html&lt;/a&gt; on how to use a cookie&lt;br/&gt;
spec. You may subscribe to the users mailing list for help. This is a bug&lt;br/&gt;
reporting tool and not a support ticketing system.</comment>
                    <comment id="12382867" author="bernhardpetri@t-online.de" created="Wed, 30 Nov 2005 21:38:37 +0000"  >(In reply to comment #1)&lt;br/&gt;
&amp;gt; This is not a bug, but your code is wrong. Please read&lt;br/&gt;
&amp;gt; &lt;a href=&quot;http://jakarta.apache.org/commons/httpclient/cookies.html&quot;&gt;http://jakarta.apache.org/commons/httpclient/cookies.html&lt;/a&gt; on how to use a cookie&lt;br/&gt;
&amp;gt; spec. You may subscribe to the users mailing list for help. This is a bug&lt;br/&gt;
&amp;gt; reporting tool and not a support ticketing system.&lt;br/&gt;
I have read the above reference and also the API documentation carefully before&lt;br/&gt;
opening a bug report. I have read both documents again, but either the documents&lt;br/&gt;
are wrong or there is a bug. So please check ist again. &lt;br/&gt;
</comment>
                    <comment id="12382868" author="olegk" created="Wed, 30 Nov 2005 22:02:39 +0000"  >Per default HttpClient is configured to use the &amp;#39;rfc2109&amp;#39; cookie policy. Make&lt;br/&gt;
sure you change it to &amp;#39;default&amp;#39;&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12382869" author="oglueck" created="Wed, 30 Nov 2005 22:26:51 +0000"  >Created an attachment (id=17085)&lt;br/&gt;
possible patch&lt;br/&gt;
&lt;br/&gt;
Okay, our docs really state&lt;br/&gt;
CookiePolicy.registerCookieSpec(CookiePolicy.DEFAULT, &amp;lt;Some CookieSpec&amp;gt;);&lt;br/&gt;
but the preferred way is:&lt;br/&gt;
method.getParams().setCookiePolicy(CookiePolicy.RFC_2109);&lt;br/&gt;
&lt;br/&gt;
And there actually might be a problem, when using the first variant. I see that&lt;br/&gt;
DefaultHttpParamsFactory sets RFC_2109 hard coded instead of DEFAULT. Why it&lt;br/&gt;
does that is obscure to me. The attached patch should take care of it. What do&lt;br/&gt;
you think, Oleg?</comment>
                    <comment id="12382870" author="olegk" created="Wed, 30 Nov 2005 22:37:33 +0000"  >In my opinion HttpClient works as advertised. The default policy kicks in only&lt;br/&gt;
if no policy has been explicitly defined. Per default rfc2109 is set by the&lt;br/&gt;
DefaultHttpParamsFactory. If things are not clear I would very much rather&lt;br/&gt;
change the docs&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12382871" author="oglueck" created="Wed, 30 Nov 2005 22:43:38 +0000"  >I somehow agree. But the knowledge about the default spec is now in two places:&lt;br/&gt;
1. CookieSpec class&lt;br/&gt;
2. DefaultHttpParamsFactory class&lt;br/&gt;
&lt;br/&gt;
Why?</comment>
                    <comment id="12382872" author="olegk" created="Wed, 30 Nov 2005 22:51:13 +0000"  >(In reply to comment #6)&lt;br/&gt;
&amp;gt; I somehow agree. But the knowledge about the default spec is now in two places:&lt;br/&gt;
&amp;gt; 1. CookieSpec class&lt;br/&gt;
&amp;gt; 2. DefaultHttpParamsFactory class&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; Why?&lt;br/&gt;
&lt;br/&gt;
Well, because HttpClient 2.0 and 3.0 API is a bloody mess. This said, my general&lt;br/&gt;
recommendation to avoid problems with HttpClient configuration is very simple:&lt;br/&gt;
if one needs specific behaviour, she should _explicitly_ set the respective HTTP&lt;br/&gt;
parameter, otherwise HttpClient will pick a default at its discretion&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12382873" author="oglueck" created="Wed, 30 Nov 2005 23:00:58 +0000"  >So you vote for changing the docs?</comment>
                    <comment id="12382874" author="olegk" created="Wed, 30 Nov 2005 23:05:30 +0000"  >Certainly for the 3.0 release&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12382875" author="oglueck" created="Wed, 30 Nov 2005 23:08:54 +0000"  >Yeah I agree that for the attached patch it is too late.</comment>
                    <comment id="12382876" author="bernhardpetri@t-online.de" created="Fri, 2 Dec 2005 21:39:13 +0000"  >After reading your discussion I have tried the following to implement a&lt;br/&gt;
IGNORE_COOKIES policy:&lt;br/&gt;
-------------------------------------&lt;br/&gt;
HttpMethod method = new GetMethod();&lt;br/&gt;
method.getParams().setCookiePolicy(CookiePolicy.IGNORE_COOKIES);&lt;br/&gt;
final WebClient webClient = new WebClient();&lt;br/&gt;
final URL url = new URL(&amp;quot;&lt;a href=&quot;http://de.finance.yahoo.com/q?s=CB3569.SG&quot;&gt;http://de.finance.yahoo.com/q?s=CB3569.SG&lt;/a&gt;&amp;quot;);&lt;br/&gt;
final HtmlPage page = (HtmlPage) webClient.getPage(url);&lt;br/&gt;
-------------------------------------&lt;br/&gt;
But this also doesn&amp;#39;t work, i.e. I get the same error messages as before.</comment>
                    <comment id="12382877" author="olegk" created="Fri, 2 Dec 2005 21:54:02 +0000"  >Please produce a wire/context log of the session&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12382878" author="oglueck" created="Fri, 2 Dec 2005 22:13:59 +0000"  >That&amp;#39;s especially weird, because for this there exists a test case.</comment>
                    <comment id="12382879" author="bernhardpetri@t-online.de" created="Fri, 2 Dec 2005 22:25:29 +0000"  >Created an attachment (id=17121)&lt;br/&gt;
Context and wire log&lt;br/&gt;
&lt;br/&gt;
I have attached the context and wire log  you wanted.</comment>
                    <comment id="12382880" author="olegk" created="Fri, 2 Dec 2005 22:53:55 +0000"  >Works for me. See for yourself&lt;br/&gt;
&lt;br/&gt;
Test code run against local Tomcat 5.5.9:&lt;br/&gt;
==========&lt;br/&gt;
HttpClient httpclient = new HttpClient();&lt;br/&gt;
GetMethod httpget = new&lt;br/&gt;
GetMethod(&amp;quot;&lt;a href=&quot;http://localhost:8080/servlets-examples/servlet/CookieExample&quot;&gt;http://localhost:8080/servlets-examples/servlet/CookieExample&lt;/a&gt;&amp;quot;);&lt;br/&gt;
httpget.setQueryString(new NameValuePair[] {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;new NameValuePair(&amp;quot;cookiename&amp;quot;, &amp;quot;&amp;quot;), // invalid name&lt;br/&gt;
&amp;nbsp;&amp;nbsp;new NameValuePair(&amp;quot;cookievalue&amp;quot;, &amp;quot;value&amp;quot;)});&lt;br/&gt;
httpget.getParams().setCookiePolicy(CookiePolicy.IGNORE_COOKIES);&lt;br/&gt;
try {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;httpclient.executeMethod(httpget);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;System.out.println(httpget.getStatusLine());&lt;br/&gt;
} finally {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;httpget.releaseConnection();&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Default cookie policy / RFC2109&lt;br/&gt;
================================&lt;br/&gt;
[DEBUG] header - &amp;gt;&amp;gt; &amp;quot;GET&lt;br/&gt;
/servlets-examples/servlet/CookieExample?cookiename=&amp;amp;cookievalue=value&lt;br/&gt;
HTTP/1.1[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;gt;&amp;gt; &amp;quot;User-Agent: Jakarta Commons-HttpClient/3.0-rc4[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;gt;&amp;gt; &amp;quot;Host: localhost:8080[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;gt;&amp;gt; &amp;quot;[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;HTTP/1.1 200 OK[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;Server: Apache-Coyote/1.1[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;Set-Cookie: =value[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;Content-Type: text/html;charset=ISO-8859-1[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;Content-Length: 731[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;Date: Fri, 02 Dec 2005 13:51:40 GMT[\r][\n]&amp;quot;&lt;br/&gt;
[WARN] HttpMethodBase - Invalid cookie header: &amp;quot;=value&amp;quot;. Cookie name may not be&lt;br/&gt;
blank&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Ignore cookie policy&lt;br/&gt;
================================&lt;br/&gt;
[DEBUG] header - &amp;gt;&amp;gt; &amp;quot;GET&lt;br/&gt;
/servlets-examples/servlet/CookieExample?cookiename=&amp;amp;cookievalue=value&lt;br/&gt;
HTTP/1.1[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;gt;&amp;gt; &amp;quot;User-Agent: Jakarta Commons-HttpClient/3.0-rc4[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;gt;&amp;gt; &amp;quot;Host: localhost:8080[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;gt;&amp;gt; &amp;quot;[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;HTTP/1.1 200 OK[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;Server: Apache-Coyote/1.1[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;Set-Cookie: =value[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;Content-Type: text/html;charset=ISO-8859-1[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;Content-Length: 731[\r][\n]&amp;quot;&lt;br/&gt;
[DEBUG] header - &amp;lt;&amp;lt; &amp;quot;Date: Fri, 02 Dec 2005 13:51:05 GMT[\r][\n]&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Please debug WebClient class&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12382881" author="oglueck" created="Tue, 6 Dec 2005 21:53:06 +0000"  >Created an attachment (id=17156)&lt;br/&gt;
Patch for 3.0 docs&lt;br/&gt;
</comment>
                    <comment id="12382882" author="olegk" created="Tue, 6 Dec 2005 22:00:30 +0000"  >Patch away, Odi&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12382883" author="oglueck" created="Tue, 6 Dec 2005 22:19:57 +0000"  >Documentation patch committed.</comment>
                    <comment id="12413900" author="olegk" created="Wed, 31 May 2006 05:00:19 +0100"  >Patch checked in&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                </comments>
                    <attachments>
                    <attachment id="12327341" name="ASF.LICENSE.NOT.GRANTED--docs-patch.diff" size="864" author="oglueck" created="Tue, 6 Dec 2005 21:53:06 +0000" />
                    <attachment id="12327340" name="ASF.LICENSE.NOT.GRANTED--java0.log.0" size="59717" author="bernhardpetri@t-online.de" created="Fri, 2 Dec 2005 22:25:29 +0000" />
                    <attachment id="12327339" name="ASF.LICENSE.NOT.GRANTED--patch.txt" size="1094" author="oglueck" created="Wed, 30 Nov 2005 22:26:51 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                <customfieldname>Bugzilla Id</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>37712</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 30 Nov 2005 20:04:04 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>133578</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>47930</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
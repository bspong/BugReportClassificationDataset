<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:21:49 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-872/HTTPCLIENT-872.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-872] Add preemptive authentication</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-872</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>Wishlist request for preemptive authentication to be included in the API, like HttpClient 3.x had.  There is an example ClientPreemptiveBasicAuthentication.java that uses HttpRequestInterceptor which I had adapted to my application and it works fine.</description>
                <environment></environment>
            <key id="12434776">HTTPCLIENT-872</key>
            <summary>Add preemptive authentication</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="gturner">Gerald Turner</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Sep 2009 21:53:13 +0100</created>
                <updated>Tue, 25 Jan 2011 10:59:21 +0000</updated>
                    <resolved>Wed, 18 Nov 2009 21:15:50 +0000</resolved>
                            <version>4.0 Final</version>
                                <fixVersion>4.1 Alpha1</fixVersion>
                                <component>HttpAuth</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12751153" author="gturner" created="Thu, 3 Sep 2009 21:54:34 +0100"  >Patch which implements preemptive authentication</comment>
                    <comment id="12751160" author="gturner" created="Thu, 3 Sep 2009 22:07:06 +0100"  >Patch has a few caveats.&lt;br/&gt;
&lt;br/&gt;
I tried following the project style as best I could, but there were a few arbitrary decisions:&lt;br/&gt;
&lt;br/&gt;
&#8226; New parameter is AuthPNames.PREEMPTIVE_AUTHENTICATION with accessors in AuthParams and AuthParamBean.  I could have chosen ClientPNames since that&amp;#39;s where HANDLE_AUTHENTICATION lives.&lt;br/&gt;
&lt;br/&gt;
&#8226; New PreemptiveAuth HttpRequestInterceptor class is in org.apache.http.impl.auth package.  It only works with BasicAuthScheme.  I don&amp;#39;t believe there is any validity with trying to implement preemptive authentication for Digest and NTLM types since they include server generated &amp;#39;nonce&amp;#39; values as part of the challenge.&lt;br/&gt;
&lt;br/&gt;
&#8226; Since the request interceptors are initialized by DefaultHttpClient.createHttpProcessor patch changes the code like so:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;@Override&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;protected BasicHttpProcessor createHttpProcessor() {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;BasicHttpProcessor httpproc = new BasicHttpProcessor();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new RequestDefaultHeaders());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Required protocol interceptors&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new RequestContent());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new RequestTargetHost());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// Recommended protocol interceptors&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new RequestClientConnControl());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new RequestUserAgent());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new RequestExpectContinue());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// HTTP state management interceptors&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new RequestAddCookies());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new ResponseProcessCookies());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// HTTP authentication interceptors&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (AuthParams.getPreemptiveAuthentication(getParams()))&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new PreemptiveAuth());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new RequestTargetAuthentication());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpproc.addInterceptor(new RequestProxyAuthentication());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return httpproc;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
...there is only one other method createXXX method which peeks at getParams(), createClientConnectionManager, so it appears to follow the same style.&lt;br/&gt;
&lt;br/&gt;
&#8226; I added a testPreemptiveAuthentication case to TestClientAuthentication.</comment>
                    <comment id="12751169" author="gturner" created="Thu, 3 Sep 2009 22:20:35 +0100"  >Hey Oleg, before you commit this patch, please note that I put an incorrect &amp;quot;@since 4.0 + 1&amp;quot; in the javadoc for PreemptiveAuth, probably should be &amp;quot;@since 4.1.0&amp;quot;, eh?</comment>
                    <comment id="12751183" author="olegk" created="Thu, 3 Sep 2009 22:55:33 +0100"  >Gerald,&lt;br/&gt;
&lt;br/&gt;
This one is going to be a difficult one. I think we should approach the problem in several incremental steps. Can we start off by implementing interceptors for caching Basic and Digest auth states in order to avoid having to re-authenticate subsequent requests that share the same execution context? Something along the line of this example:&lt;br/&gt;
&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/repos/asf/httpcomponents/httpclient/trunk/httpclient/src/examples/org/apache/http/examples/client/ClientPreemptiveDigestAuthentication.java&quot;&gt;http://svn.apache.org/repos/asf/httpcomponents/httpclient/trunk/httpclient/src/examples/org/apache/http/examples/client/ClientPreemptiveDigestAuthentication.java&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Once we have that, we can think about adding a mechanism for preemtive initialization of the Basic scheme.&lt;br/&gt;
&lt;br/&gt;
Cheers&lt;br/&gt;
&lt;br/&gt;
Oleg </comment>
                    <comment id="12751252" author="gturner" created="Fri, 4 Sep 2009 01:46:58 +0100"  >I see what you mean &#8212; ran some tests and it&amp;#39;s apparent that reused connections keep repeating the authentication handshake, need to cache the Authorization header, worthy of a separate JIRA, yeah?  Digest is more complicated since it&amp;#39;ll need to increment the &amp;quot;nc&amp;quot; value and generate a new &amp;quot;cnonce&amp;quot; each subsequent request.  I have no idea about NTLM.&lt;br/&gt;
&lt;br/&gt;
With preemptive authentication, do you believe that the &amp;quot;nonce&amp;quot; can be pre-seeded?  Maybe some servers can be tricked, but that doesn&amp;#39;t seem like the way the protocol was intended.</comment>
                    <comment id="12751373" author="olegk" created="Fri, 4 Sep 2009 09:59:59 +0100"  >&amp;gt; need to cache the Authorization header, worthy of a separate JIRA, yeah?&lt;br/&gt;
&lt;br/&gt;
I think it might as easy as just caching AuthScheme instance. This looks like a related issue to me, but feel free to open a separate JIRA for it.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; With preemptive authentication, do you believe that the &amp;quot;nonce&amp;quot; can be pre-seeded? Maybe some servers can be tricked, but that doesn&amp;#39;t &lt;br/&gt;
&amp;gt; seem like the way the protocol was intended.&lt;br/&gt;
&lt;br/&gt;
It is certainly feasible, though a bad idea from the security standpoint. However, some people did express interest in having such a possibility. Anyways, reusing the &amp;quot;nonce&amp;quot; between requests within a session does seem reasonable.&lt;br/&gt;
&lt;br/&gt;
Oleg&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12779671" author="olegk" created="Wed, 18 Nov 2009 21:15:50 +0000"  >* HttpClient can now persist authentication data between request executions as long as they share the same execution context. &lt;br/&gt;
* It has also become much easier to make HttpClient authenticate preemptively by pre-populating authentication data cache&lt;br/&gt;
&lt;br/&gt;
Compare old code (4.0):&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/repos/asf/httpcomponents/httpclient/branches/4.0.x/httpclient/src/examples/org/apache/http/examples/client/ClientPreemptiveBasicAuthentication.java&quot;&gt;http://svn.apache.org/repos/asf/httpcomponents/httpclient/branches/4.0.x/httpclient/src/examples/org/apache/http/examples/client/ClientPreemptiveBasicAuthentication.java&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/repos/asf/httpcomponents/httpclient/branches/4.0.x/httpclient/src/examples/org/apache/http/examples/client/ClientPreemptiveDigestAuthentication.java&quot;&gt;http://svn.apache.org/repos/asf/httpcomponents/httpclient/branches/4.0.x/httpclient/src/examples/org/apache/http/examples/client/ClientPreemptiveDigestAuthentication.java&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
with new one (4.1):&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/repos/asf/httpcomponents/httpclient/trunk/httpclient/src/examples/org/apache/http/examples/client/ClientPreemptiveBasicAuthentication.java&quot;&gt;http://svn.apache.org/repos/asf/httpcomponents/httpclient/trunk/httpclient/src/examples/org/apache/http/examples/client/ClientPreemptiveBasicAuthentication.java&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/repos/asf/httpcomponents/httpclient/trunk/httpclient/src/examples/org/apache/http/examples/client/ClientPreemptiveDigestAuthentication.java&quot;&gt;http://svn.apache.org/repos/asf/httpcomponents/httpclient/trunk/httpclient/src/examples/org/apache/http/examples/client/ClientPreemptiveDigestAuthentication.java&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Please review / test / give feedback</comment>
                    <comment id="12779837" author="asankha" created="Thu, 19 Nov 2009 05:52:42 +0000"  >This is excellent.. the new example looks very elegant and is much easier to use</comment>
                </comments>
                    <attachments>
                    <attachment id="12418538" name="PreemptiveAuth.patch" size="10292" author="gturner" created="Thu, 3 Sep 2009 21:54:34 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 3 Sep 2009 21:55:33 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>133886</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>47384</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
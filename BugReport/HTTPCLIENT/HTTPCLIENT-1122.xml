<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:13:03 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-1122/HTTPCLIENT-1122.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-1122] NPE in RequestProxyAuthentication on Android</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-1122</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>Got a NPE backtrace in RequestProxyAuthentication.process(). &lt;br/&gt;
&lt;br/&gt;
HttpRoute route = conn.getRoute();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (route.isTunnelled()) {      &amp;lt;= line 88, NPE here&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
There&amp;#39;s no null check on the returned route although getRoute() can return null.&lt;br/&gt;
I guess it&amp;#39;s not supposed to happen.&lt;br/&gt;
&lt;br/&gt;
In the httpclient code, there&amp;#39;s a few more calls to getRoute() without a null check on the returned route.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
at com.bubblesoft.org.apache.http.client.protocol.RequestProxyAuthentication.process(SourceFile:88)&lt;br/&gt;
at com.bubblesoft.org.apache.http.protocol.ImmutableHttpProcessor.process(SourceFile:108)&lt;br/&gt;
at com.bubblesoft.org.apache.http.protocol.HttpRequestExecutor.preProcess(SourceFile:174)&lt;br/&gt;
at com.bubblesoft.org.apache.http.impl.client.DefaultRequestDirector.execute(SourceFile:457)&lt;br/&gt;
at com.bubblesoft.org.apache.http.impl.client.AbstractHttpClient.createHttpProcessor(SourceFile:821)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;execute&lt;br/&gt;
at com.bubblesoft.org.apache.http.impl.client.AbstractHttpClient.createHttpProcessor(SourceFile:755)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;execute&lt;br/&gt;
at com.bubblesoft.org.apache.http.impl.client.AbstractHttpClient.createHttpProcessor(SourceFile:733)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;execute&lt;br/&gt;
</description>
                <environment>Android 2.3.4. Using repackaged httpcore 4.1.1 in an app obfuscated with Proguard.&lt;br/&gt;
must be very rare as I only saw it once for &amp;gt; 10K users.</environment>
            <key id="12521193">HTTPCLIENT-1122</key>
            <summary>NPE in RequestProxyAuthentication on Android</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="bubbleguuum">Michael Pujos</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Sep 2011 15:46:14 +0100</created>
                <updated>Mon, 26 Sep 2011 23:43:29 +0100</updated>
                    <resolved>Fri, 23 Sep 2011 15:00:54 +0100</resolved>
                            <version>4.1.1</version>
                                <fixVersion>4.2 Alpha1</fixVersion>
                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13096054" author="olegk" created="Fri, 2 Sep 2011 16:40:43 +0100"  >Michael,&lt;br/&gt;
&lt;br/&gt;
It is the same situation as with &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-263&quot; title=&quot;IndexOutOfBoundsException thrown in AbstractSessionInputBuffer.readLine()&quot;&gt;&lt;strike&gt;HTTPCORE-263&lt;/strike&gt;&lt;/a&gt;. I really have no idea how to reproduce the issue and suspect the problem might be a side effect of obfuscation with Proguard. I will not be able to fix the problem without a reproducer.&lt;br/&gt;
&lt;br/&gt;
Oleg </comment>
                    <comment id="13096085" author="bubbleguuum" created="Fri, 2 Sep 2011 17:06:55 +0100"  >Noted, although this will be impossible to reproduce. Stack trace seems legit though. Proguard optimizations were disabled.&lt;br/&gt;
Recent versions of HttpComponents has been very little tested on Android as 99.999% of Android developers use the httpclient/httpcore of the platform from 2008&lt;br/&gt;
that has been hacked by Google.&lt;br/&gt;
There might be some specific bugs on Android, especially due to bad connectivity that can be lost at any time, more often that any other platform. I&amp;#39;ve had very few issues with 4.1.1 besides a few more &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-263&quot; title=&quot;IndexOutOfBoundsException thrown in AbstractSessionInputBuffer.readLine()&quot;&gt;&lt;strike&gt;HTTPCORE-263&lt;/strike&gt;&lt;/a&gt; crashes in automatic user crash reports  (with matching backtrace lines this time).&lt;br/&gt;
&lt;br/&gt;
For this specific issue, why not add null checks  for calls to conn.getRoute() ?&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="13096671" author="olegk" created="Sat, 3 Sep 2011 16:15:11 +0100"  >The HttpRoute should never be null (a connection is always open for a particular route) _unless_ the request has been aborted in the middle of execution process. I&amp;#39;ll try to mitigate the problem by adding a check for HttpRoute being non-null, but it would be helpful to know what exactly Httpclient was doing at the point when the exception occurred. &lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="13097828" author="bubbleguuum" created="Tue, 6 Sep 2011 10:17:57 +0100"  >Now that I think of it, the app code related to the stack trace above does indeed have plenty of HttpRequest.abort() going on while the request is executing. &lt;br/&gt;
I&amp;#39;d say it has more aborting than usual, since requests are made to download thumbnails images in a list, and requests are aborted during scrolling when previously visible list item are now invisible.</comment>
                    <comment id="13113449" author="olegk" created="Fri, 23 Sep 2011 15:00:54 +0100"  >With new ManagedClientConnection implementation the route for managed connections should never be null.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="13114994" author="bubbleguuum" created="Mon, 26 Sep 2011 23:43:29 +0100"  >Thanks for the fix.&lt;br/&gt;
&lt;br/&gt;
Here&amp;#39;s another stack trace that looks legit on an unchecked null route, that might confirm there was indeed a problem:&lt;br/&gt;
&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
at com.bubblesoft.org.apache.http.client.protocol.RequestClientConnControl.process(SourceFile:86)&lt;br/&gt;
at com.bubblesoft.org.apache.http.protocol.ImmutableHttpProcessor.process(SourceFile:108)&lt;br/&gt;
at com.bubblesoft.org.apache.http.protocol.HttpRequestExecutor.preProcess(SourceFile:174)&lt;br/&gt;
at com.bubblesoft.org.apache.http.impl.client.DefaultRequestDirector.execute(SourceFile:457)&lt;br/&gt;
at com.bubblesoft.org.apache.http.impl.client.AbstractHttpClient.createHttpProcessor(SourceFile:821)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;execute$1650775d&lt;br/&gt;
at com.bubblesoft.org.apache.http.impl.client.AbstractHttpClient.createHttpProcessor(SourceFile:733)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;execute&lt;br/&gt;
at com.bubblesoft.android.utils.AndroidHttpClient.execute(SourceFile:279)&lt;br/&gt;
at com.bubblesoft.android.utils.BitmapDownload.download(SourceFile:56)&lt;br/&gt;
at com.bubblesoft.android.utils.BitmapDownloadTask.doInBackground(SourceFile:33)&lt;br/&gt;
at com.bubblesoft.android.utils.BitmapDownloadTask.doInBackground(SourceFile:1)&lt;br/&gt;
at android.os.AsyncTask$2.call(AsyncTask.java:185)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Fri, 2 Sep 2011 15:40:43 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3935</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>46937</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
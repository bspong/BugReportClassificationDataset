<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:19:01 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-598/HTTPCLIENT-598.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-598] ContentLengthInputStream does not implement available() properly</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-598</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>ContentLengthInputStream should either extend FilterInputStream or should delegate available() to wrappedStream.&lt;br/&gt;
&lt;br/&gt;
Otherwise, available() on the response stream (an instance of AutoCloseInputStream, which is properly extending FilterInputStream, and, therefore, delegating to the ContentLengthInputStream) always returns 0.&lt;br/&gt;
&lt;br/&gt;
This issue is important for the clients that try to improve performance by processing all data that can be read in a non-blocking way before blocking on the network.</description>
                <environment></environment>
            <key id="12349769">HTTPCLIENT-598</key>
            <summary>ContentLengthInputStream does not implement available() properly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="igorlord">Igor Lubashev</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Sep 2006 23:31:01 +0100</created>
                <updated>Sun, 22 Apr 2007 08:11:21 +0100</updated>
                    <resolved>Sat, 16 Sep 2006 11:33:45 +0100</resolved>
                            <version>3.0.1</version>
                <version>3.1 Alpha 1</version>
                                <fixVersion>3.1 Beta 1</fixVersion>
                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12434411" author="olegk" created="Wed, 13 Sep 2006 12:17:14 +0100"  >Proposed fix. Please review and let me know what you think&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12434442" author="igorlord" created="Wed, 13 Sep 2006 14:34:52 +0100"  >Oleg, I think this fix does not work.  The contract of available() is that it guarantees many bytes read() will return successfully and without blocking.&lt;br/&gt;
&lt;br/&gt;
A better fix seems to be:&lt;br/&gt;
&lt;br/&gt;
public int available() throws IOException&lt;br/&gt;
{&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (closed)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return 0;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;int avail = this.wrappedStream.available();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if( pos + avail &amp;gt; contentLength )&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;avail = contentLength - pos;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return avail;&lt;br/&gt;
}</comment>
                    <comment id="12434455" author="olegk" created="Wed, 13 Sep 2006 15:31:35 +0100"  >Yes, indeed. This does seem like the right fix. &lt;br/&gt;
&lt;br/&gt;
Folks,&lt;br/&gt;
&lt;br/&gt;
if I hear no complaints, I&amp;#39;ll commit the patch in a few days&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12435206" author="olegk" created="Sat, 16 Sep 2006 11:33:45 +0100"  >Patch checked in.&lt;br/&gt;
&lt;br/&gt;
Many thanks, Igor.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                </comments>
                    <attachments>
                    <attachment id="12340736" name="20060913-clis.patch" size="880" author="olegk" created="Wed, 13 Sep 2006 15:31:35 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 13 Sep 2006 11:17:14 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>133638</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>47908</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
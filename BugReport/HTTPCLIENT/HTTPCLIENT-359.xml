<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:16:40 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-359/HTTPCLIENT-359.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-359] StringRequestEntity.getContentLength wrong for multibyte chars</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-359</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>When setting up a PostMethod containing a StringRequestEntity with umlauts and&lt;br/&gt;
charset UTF-8 the content-length header is wrong. It should be the number&lt;br/&gt;
of bytes, but is the number of chars by now.&lt;br/&gt;
&lt;br/&gt;
(e.g.&lt;br/&gt;
Content-Type: text/xml; charset=UTF-8&lt;br/&gt;
body=&amp;#39;&amp;#xC3;&amp;#xA4;&amp;#xC3;&amp;#xB6;&amp;#xC3;&amp;#xBC;&amp;#xC3;&amp;#x9F;&amp;#xC3;&amp;#x84;&amp;#xC3;&amp;#x96;&amp;#xC3;&amp;#x9C;&amp;#39;)&lt;br/&gt;
&lt;br/&gt;
Bug-location: org.apache.commons.httpclient.methods.StringRequestEntity</description>
                <environment>Operating System: All&lt;br/&gt;
Platform: All</environment>
            <key id="12333918">HTTPCLIENT-359</key>
            <summary>StringRequestEntity.getContentLength wrong for multibyte chars</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="susp51@verit.de">Heiner Westphal</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Jul 2004 21:52:17 +0100</created>
                <updated>Wed, 16 Feb 2011 20:43:43 +0000</updated>
                    <resolved>Sun, 22 Apr 2007 08:10:49 +0100</resolved>
                            <version>3.0 Alpha 1</version>
                                <fixVersion>3.0 Alpha 2</fixVersion>
                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12381808" author="susp51@verit.de" created="Fri, 2 Jul 2004 21:53:20 +0100"  >&lt;br/&gt;
Workaround:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// FIXME: This is a workaround for httpClient 3.0alpha1 bug&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//         concerning content-length and multi-byte chars&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (method instanceof EntityEnclosingMethod) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;EntityEnclosingMethod eeMethod = (EntityEnclosingMethod) method;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;final String charset = eeMethod.getRequestCharSet();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ByteArrayOutputStream baos = new ByteArrayOutputStream();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;eeMethod.getRequestEntity().writeRequest(baos);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ByteArrayInputStream bais = &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;new ByteArrayInputStream(baos.toByteArray());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// better use InputStreamRequestEntity, but you get the picture&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;eeMethod.setRequestBody(bais);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpClient.executeMethod(method);&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
P.S.: eclipse debugger gave me this stacktrace to see the bug at work:&lt;br/&gt;
&lt;br/&gt;
Thread [HttpClient-Client-Server-0] (Suspended)&lt;br/&gt;
	StringRequestEntity.getContentLength() line: 140&lt;br/&gt;
	PostMethod(EntityEnclosingMethod).getRequestContentLength() line: 322&lt;br/&gt;
	PostMethod(EntityEnclosingMethod).addContentLengthRequestHeader(HttpState,&lt;br/&gt;
HttpConnection) line: 392&lt;br/&gt;
	PostMethod(EntityEnclosingMethod).addRequestHeaders(HttpState, HttpConnection)&lt;br/&gt;
line: 360&lt;br/&gt;
	PostMethod(HttpMethodBase).writeRequestHeaders(HttpState, HttpConnection) line:&lt;br/&gt;
1977&lt;br/&gt;
	PostMethod(HttpMethodBase).writeRequest(HttpState, HttpConnection) line: 1865&lt;br/&gt;
	PostMethod(HttpMethodBase).execute(HttpState, HttpConnection) line: 975&lt;br/&gt;
	HttpMethodDirector.executeWithRetry(HttpMethod) line: 368&lt;br/&gt;
	HttpMethodDirector.executeMethod(HttpMethod) line: 164&lt;br/&gt;
	HttpClient.executeMethod(HostConfiguration, HttpMethod, HttpState) line: 437&lt;br/&gt;
	HttpClient.executeMethod(HttpMethod) line: 324&lt;br/&gt;
	HttpClientThread.run() line: 96&lt;br/&gt;
</comment>
                    <comment id="12381809" author="olegk" created="Sat, 3 Jul 2004 05:54:49 +0100"  >Created an attachment (id=12016)&lt;br/&gt;
Patch&lt;br/&gt;
</comment>
                    <comment id="12381810" author="olegk" created="Sat, 3 Jul 2004 05:55:18 +0100"  >This should take care of the problem&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12381811" author="becke@u.washington.edu" created="Sat, 3 Jul 2004 07:16:06 +0100"  >Hi Oleg,&lt;br/&gt;
&lt;br/&gt;
Looks pretty good to me.   My only suggestion would be to log the UnsupportedEncodingExceptions.  &lt;br/&gt;
Though they are probably not common, we definitely want to know when they occur.&lt;br/&gt;
&lt;br/&gt;
Mike</comment>
                    <comment id="12381812" author="olegk" created="Sat, 3 Jul 2004 22:31:23 +0100"  >UnsupportedEncodingException logs added. &lt;br/&gt;
&lt;br/&gt;
I have applied the patch without any further review, as the fix was pretty&lt;br/&gt;
straight-forward&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                </comments>
                    <attachments>
                    <attachment id="12327128" name="ASF.LICENSE.NOT.GRANTED--stringentity.patch" size="6682" author="olegk" created="Sat, 3 Jul 2004 05:54:49 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                <customfieldname>Bugzilla Id</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>29883</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 3 Jul 2004 04:54:49 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>133407</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>47245</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
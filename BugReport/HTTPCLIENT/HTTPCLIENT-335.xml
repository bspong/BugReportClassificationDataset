<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:16:22 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-335/HTTPCLIENT-335.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-335] Handling sub-domain cookies.</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-335</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>I noticed a difference in behaviour between httpclient and most common browsers &lt;br/&gt;
(IE/Mozilla). If a web site sets a cookie for &amp;quot;beta.gamma.com&amp;quot;, this cookie is &lt;br/&gt;
not sent in requests to &amp;quot;alpha.beta.gamma.com&amp;quot;. &lt;br/&gt;
&amp;nbsp;&amp;nbsp;I am not sure what the cookie specs say, but Mozilla, IE and even &lt;br/&gt;
HTTP::Cookies module in LWP seem to behave differently from HttpClient. &lt;br/&gt;
HttpClient seems to rely on the leading dot in the domain name &lt;br/&gt;
(like &amp;quot;.beta.gamma.com&amp;quot;).</description>
                <environment>Operating System: All&lt;br/&gt;
Platform: PC</environment>
            <key id="12333894">HTTPCLIENT-335</key>
            <summary>Handling sub-domain cookies.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="sabhishek@yahoo.com">Abhishek Sethi</reporter>
                        <labels>
                    </labels>
                <created>Sat, 24 Apr 2004 07:17:59 +0100</created>
                <updated>Wed, 16 Feb 2011 20:44:33 +0000</updated>
                    <resolved>Sun, 22 Apr 2007 08:10:43 +0100</resolved>
                            <version>2.0 Final</version>
                                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12381626" author="sabhishek@yahoo.com" created="Sat, 24 Apr 2004 07:25:40 +0100"  >This is with policy == CookiePolicy.COMPATIBILITY </comment>
                    <comment id="12381627" author="olegk" created="Sat, 24 Apr 2004 20:05:13 +0100"  >I cannot help mentioning that what those so called common browsers do is simply&lt;br/&gt;
silly, as the cookie spec requires the HTTP agents to differentiate between the&lt;br/&gt;
domain scope and the host scope. &amp;quot;beta.gamma.com&amp;quot; in my opinion implies a single&lt;br/&gt;
host, not a domain. This said, in browser compatibility HttpClient is supposed&lt;br/&gt;
to simulate whatever stupidity mainstream browsers are capable of. I&amp;#39;ll look&lt;br/&gt;
into the problem and provide a fix if required. It may happen, though, that the&lt;br/&gt;
problem has already been fixed in the post 2.0 release time frame, as we have&lt;br/&gt;
had a similar bug report not long ago (&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-301&quot; title=&quot;Cookie rejected&quot;&gt;&lt;strike&gt;HTTPCLIENT-301&lt;/strike&gt;&lt;/a&gt;).&lt;br/&gt;
&lt;br/&gt;
Oleg&lt;br/&gt;
&amp;nbsp;</comment>
                    <comment id="12381628" author="olegk" created="Sat, 24 Apr 2004 20:09:17 +0100"  >My apologies. The &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-301&quot; title=&quot;Cookie rejected&quot;&gt;&lt;strike&gt;HTTPCLIENT-301&lt;/strike&gt;&lt;/a&gt; made it into 2.0 final. I&amp;#39;ll look into the problem&lt;br/&gt;
anyhow.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12381629" author="olegk" created="Mon, 26 Apr 2004 04:47:34 +0100"  >Created an attachment (id=11326)&lt;br/&gt;
Patch&lt;br/&gt;
</comment>
                    <comment id="12381630" author="olegk" created="Mon, 26 Apr 2004 04:48:24 +0100"  >The patch takes care of the problem.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12381631" author="becke@u.washington.edu" created="Mon, 26 Apr 2004 06:02:24 +0100"  >Works for me.&lt;br/&gt;
&lt;br/&gt;
Mike</comment>
                    <comment id="12381632" author="sabhishek@yahoo.com" created="Tue, 27 Apr 2004 07:27:30 +0100"  >Works for me as well.&lt;br/&gt;
&lt;br/&gt;
However this wasnt enough to get my code to work. This time problem happens to &lt;br/&gt;
be with Cookie header formatting. HttpClient in non-strict mode sends out &lt;br/&gt;
multiple &amp;quot;Cookie:&amp;quot; headers (HttpMethodBase.addCookieRequestHeader(). Whereas &lt;br/&gt;
Mozilla/IE/LWP send out just one header with cookies delimited by semi-colon. &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Looks like HttpClient does not exactly mimic the behaviour of common user &lt;br/&gt;
agents, in this case. I am guessing strictMode would make it behave even more &lt;br/&gt;
differently. So should this be fixed in non-strict mode?&lt;br/&gt;
&amp;nbsp;&amp;nbsp;</comment>
                    <comment id="12381633" author="olegk" created="Tue, 27 Apr 2004 17:16:38 +0100"  >Abhishek,&lt;br/&gt;
This problem has already been addressed. I suppose you are using the latest CVS&lt;br/&gt;
snapshot, as the patch is against CVS HEAD. To make HttpClient send cookies as&lt;br/&gt;
one header set the parameter &amp;#39;http.protocol.single-cookie-header&amp;#39; to true&lt;br/&gt;
&lt;br/&gt;
GetMethod httpget = new GetMethod(&amp;quot;/whatever&amp;quot;);&lt;br/&gt;
httpget.getParams().&lt;br/&gt;
&amp;nbsp;&amp;nbsp;setBooleanParameter(&amp;quot;http.protocol.single-cookie-header&amp;quot;, true);&lt;br/&gt;
&lt;br/&gt;
This parameter can also be set at the HttpClient level, if you want all&lt;br/&gt;
subsequent requests issued by that HttpClient instance to send cookies as a&lt;br/&gt;
single header&lt;br/&gt;
&lt;br/&gt;
HTH&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12381634" author="sabhishek@yahoo.com" created="Wed, 28 Apr 2004 04:50:06 +0100"  >Hey Oleg,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Thanks for the quick response. You are FAST.&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;I am using the STABLE code since it will go into production pretty soon. &lt;br/&gt;
Probably before the next HttpClient release.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Would you recommend CVS HEAD for production purpose? &lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;For the time being I guess, I can work around by using a hack which ignores &lt;br/&gt;
the strict mode settings.&lt;br/&gt;
&lt;br/&gt;
--&lt;br/&gt;
cheers,&lt;br/&gt;
Abhishek.</comment>
                    <comment id="12381635" author="olegk" created="Wed, 28 Apr 2004 05:44:49 +0100"  >Abhishek,&lt;br/&gt;
We are nearing the 3.0 alpha1 release with the development branch. Even though I&lt;br/&gt;
am convinced that in many areas the code quality in our development branch is&lt;br/&gt;
much better than that in the stable one, it would be irresponsible for me to&lt;br/&gt;
recommend it for use in productive systems. For the time being, you might want&lt;br/&gt;
to get the latest snapshot of 2.0 (stable) branch and tweak the compatibility&lt;br/&gt;
cookie spec to your liking. The 3.0 release will provide many improvements in&lt;br/&gt;
the area of cookie management. It will also allow to plug in custom cookie spec&lt;br/&gt;
implementations. So, in the future you will not have to maintain the fork.&lt;br/&gt;
&lt;br/&gt;
If you do not mind, I&amp;#39;ll apply the patch to the CVS HEAD and close the bug&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12381636" author="sabhishek@yahoo.com" created="Wed, 28 Apr 2004 05:51:16 +0100"  >&amp;gt;&amp;gt; If you do not mind, I&amp;#39;ll apply the patch to the CVS HEAD and close the bug&lt;br/&gt;
&lt;br/&gt;
Please do. The fix works.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12381637" author="olegk" created="Wed, 28 Apr 2004 06:36:27 +0100"  >Patch committed&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                </comments>
                    <attachments>
                    <attachment id="12327093" name="ASF.LICENSE.NOT.GRANTED--cookiecompat.patch" size="9451" author="olegk" created="Mon, 26 Apr 2004 04:47:34 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                <customfieldname>Bugzilla Id</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>28566</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 24 Apr 2004 19:05:13 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>133384</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>47161</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
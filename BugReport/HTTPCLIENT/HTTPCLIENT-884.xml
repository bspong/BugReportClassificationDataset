<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:21:56 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-884/HTTPCLIENT-884.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-884] Charset omitted from UrlEncodedFormEntity Content-Type header</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-884</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>UrlEncodedFormEntity sets the Content-Type header to:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;application/x-www-form-urlencoded&amp;quot;&lt;br/&gt;
&lt;br/&gt;
It should set the header to:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;quot;application/x-www-form-urlencoded; charset=&amp;quot; + charset&lt;br/&gt;
&lt;br/&gt;
As a result, content can be misinterpreted by the recipient (e.g. if the entity content includes multibyte Unicode characters encoded with the &amp;quot;UTF-8&amp;quot; charset).&lt;br/&gt;
&lt;br/&gt;
For a correct example of specifying the charset in the Content-Type header, see StringEntity.java.&lt;br/&gt;
&lt;br/&gt;
Here&amp;#39;s the fix:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public UrlEncodedFormEntity (&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;final List &amp;lt;? extends NameValuePair&amp;gt; parameters, &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;final String encoding) throws UnsupportedEncodingException {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;super(URLEncodedUtils.format(parameters, encoding),  encoding);&lt;br/&gt;
-        setContentType(URLEncodedUtils.CONTENT_TYPE);&lt;br/&gt;
+        setContentType(URLEncodedUtils.CONTENT_TYPE + HTTP.CHARSET_PARAM +&lt;br/&gt;
+            (encoding != null ? encoding : HTTP.DEFAULT_CONTENT_CHARSET));&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public UrlEncodedFormEntity (&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;final List &amp;lt;? extends NameValuePair&amp;gt; parameters) throws UnsupportedEncodingException {&lt;br/&gt;
-        super(URLEncodedUtils.format(parameters, HTTP.DEFAULT_CONTENT_CHARSET), &lt;br/&gt;
-            HTTP.DEFAULT_CONTENT_CHARSET);&lt;br/&gt;
-        setContentType(URLEncodedUtils.CONTENT_TYPE);&lt;br/&gt;
+        this(parameters, HTTP.DEFAULT_CONTENT_CHARSET);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
</description>
                <environment>all</environment>
            <key id="12439704">HTTPCLIENT-884</key>
            <summary>Charset omitted from UrlEncodedFormEntity Content-Type header</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="jaredjacobs">Jared Jacobs</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Nov 2009 22:39:59 +0000</created>
                <updated>Tue, 31 Aug 2010 10:18:27 +0100</updated>
                    <resolved>Wed, 4 Nov 2009 19:59:21 +0000</resolved>
                            <version>4.0 Final</version>
                                <fixVersion>4.0.1</fixVersion>
                <fixVersion>4.1 Alpha1</fixVersion>
                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                          <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                    <timeestimate seconds="3600">1h</timeestimate>
                                  <comments>
                    <comment id="12773627" author="olegk" created="Wed, 4 Nov 2009 19:59:21 +0000"  >Patch checked in to SVN trunk and 4.0.x branch. Please review / re-test&lt;br/&gt;
&lt;br/&gt;
Many thanks for submitting the patch, Jared&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="12782932" author="jaredjacobs" created="Thu, 26 Nov 2009 16:38:44 +0000"  >Fix looks good. I noticed that this issue was omitted from the release notes. Only &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-885&quot; title=&quot;URLEncodedUtils fails to parse form-url-encoded entities that specify a charset&quot;&gt;&lt;strike&gt;HTTPCLIENT-885&lt;/strike&gt;&lt;/a&gt; was mentioned. I believe this issue is more serious than &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-885&quot; title=&quot;URLEncodedUtils fails to parse form-url-encoded entities that specify a charset&quot;&gt;&lt;strike&gt;HTTPCLIENT-885&lt;/strike&gt;&lt;/a&gt; because the library uses the faulty code to send all url-form-encoded entities, whereas the faulty code in &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCLIENT-885&quot; title=&quot;URLEncodedUtils fails to parse form-url-encoded entities that specify a charset&quot;&gt;&lt;strike&gt;HTTPCLIENT-885&lt;/strike&gt;&lt;/a&gt; is not used internally by the library at all.</comment>
                    <comment id="12903988" author="a2398723957" created="Sun, 29 Aug 2010 17:55:00 +0100"  >i&amp;#39;ve just switched from hc-client-4.0.0 to hc-client-4.0.1 and my code stopped working right!&lt;br/&gt;
the remote server i send post request to replies with &amp;quot;getcgivars(): Unsupported Content-Type.&amp;quot;&lt;br/&gt;
the problem is that after this fix the hc client sends:&lt;br/&gt;
&amp;quot;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&amp;quot;&lt;br/&gt;
instead of&lt;br/&gt;
&amp;quot;Content-Type: application/x-www-form-urlencoded&amp;quot;&lt;br/&gt;
&lt;br/&gt;
are you sure you&amp;#39;ve done the righ fix Jared Jacobs?&lt;br/&gt;
&lt;br/&gt;
thanks.&lt;br/&gt;
</comment>
                    <comment id="12904252" author="jaredjacobs" created="Mon, 30 Aug 2010 18:10:58 +0100"  >If you are sending simple ASCII content, then you can try specifying &amp;quot;US-ASCII&amp;quot; or &amp;quot;ISO-8859-1&amp;quot; as the second argument to the UrlEncodedFormEntity constructor.&lt;br/&gt;
&lt;br/&gt;
Oleg, you may want to provide a way in UrlEncodedFormEntity to exclude the &amp;quot;charset&amp;quot; parameter here. Apparently it&amp;#39;s still common for servers not to parse media type parameters correctly. For backwards compatibility, browser vendors decided not to specify the charset in the Content-Type header (even though it&amp;#39;s arguably most correct and a common practice -- just search the web), but instead to give authors the option of sending the character set as an extra &amp;quot;_charset_&amp;quot; parameter in the request&amp;#39;s body, and that practice made it into the HTML 5 spec:&lt;br/&gt;
&lt;a href=&quot;http://www.w3.org/TR/html5/association-of-controls-and-forms.html#url-encoded-form-data&quot;&gt;http://www.w3.org/TR/html5/association-of-controls-and-forms.html#url-encoded-form-data&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Unlike most media types, which are &amp;quot;owned&amp;quot; by IANA, the browser vendors and W3C own the non-standard &amp;quot;application/x-www-form-urlencoded&amp;quot;.</comment>
                    <comment id="12904568" author="olegk" created="Tue, 31 Aug 2010 10:18:27 +0100"  >I am somewhat reluctant to introduce workarounds for non-compliant servers in this particular case, as it is pretty trivial to put together a customised UrlEncodedFormEntity implementation or to override the default value with the #setContentType method. What could be done, tough, is changing UrlEncodedFormEntity to exclude &amp;#39;charset&amp;#39; parameter from the ContentType header if it is not explicitly set by the user (encoding constructor parameter is null). &lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 4 Nov 2009 19:59:21 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>133896</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>47540</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
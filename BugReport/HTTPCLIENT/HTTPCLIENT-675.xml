<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:19:54 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-675/HTTPCLIENT-675.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-675] thread starving in MultiThreadedHttpConnectionManager</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-675</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>Hi folks,&lt;br/&gt;
&lt;br/&gt;
I might have found a bug in MTHCM. It has to do with removing HostConnectionPool instances that have no more connections in them. That was a fix for a memory leak we previously had. There are two cases where the pools get deleted. One is in handleLostConnection: (excerpt)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;...&lt;br/&gt;
&amp;nbsp;&amp;nbsp;if (hostPool.numConnections == 0) mapHosts.remove(config);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;notifyWaitingThread(config);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;...&lt;br/&gt;
&lt;br/&gt;
Could this delete a pool in which there is still a thread waiting to get a connection? If so, the thread would remain in the global pool. But even if it is interrupted there, it would still use the old HostConnectionPool in which no connection will ever become available again.&lt;br/&gt;
&lt;br/&gt;
I suggest to change the removal check in both cases to:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;if ((hostPool.numConnections &amp;lt; 1) &amp;amp;&amp;amp; hostPool.waitingThreads.isEmpty)&lt;br/&gt;
&lt;br/&gt;
What do you think?</description>
                <environment></environment>
            <key id="12374703">HTTPCLIENT-675</key>
            <summary>thread starving in MultiThreadedHttpConnectionManager</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rolandw">Roland Weber</assignee>
                                <reporter username="rolandw">Roland Weber</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jul 2007 19:17:25 +0100</created>
                <updated>Sun, 11 Nov 2007 19:14:58 +0000</updated>
                    <resolved>Sat, 11 Aug 2007 13:27:45 +0100</resolved>
                            <version>3.1 RC1</version>
                                <fixVersion>3.1 (end of life)</fixVersion>
                                <component>HttpConn</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12516075" author="rolandw" created="Fri, 27 Jul 2007 19:55:30 +0100"  >please review</comment>
                    <comment id="12519090" author="rolandw" created="Fri, 10 Aug 2007 19:52:48 +0100"  >If I hear no complaints, I&amp;#39;ll commit this patch this week-end.&lt;br/&gt;
</comment>
                </comments>
                    <attachments>
                    <attachment id="12362691" name="2k7-07-27-MTHCM-675.txt" size="1448" author="rolandw" created="Fri, 27 Jul 2007 19:55:30 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>133713</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>47827</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
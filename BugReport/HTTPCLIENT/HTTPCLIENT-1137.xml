<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:13:14 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-1137/HTTPCLIENT-1137.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-1137] The values for the Via header are created by httpclient-cache for each cached and backend request</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-1137</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>The Via header that gets generated and inserted by the caching layer is done repeatedly in the HTTP conversation, even if the constructed string is constant for each protocol version that is involved.&lt;br/&gt;
&lt;br/&gt;
The proposed patch constructs a map of generated values held in memory with the associated ProtocolVersion as a key and uses read/write locks to access the data. This  solution minimizes the time to generate such a value from several milliseconds to 40-50 microseconds.</description>
                <environment></environment>
            <key id="12527021">HTTPCLIENT-1137</key>
            <summary>The values for the Via header are created by httpclient-cache for each cached and backend request</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="jonm">Jon Moore</assignee>
                                <reporter username="avasile">Alin Vasile</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Oct 2011 14:50:05 +0100</created>
                <updated>Fri, 4 Nov 2011 19:13:52 +0000</updated>
                    <resolved>Fri, 4 Nov 2011 19:13:52 +0000</resolved>
                            <version>4.1.2</version>
                                <fixVersion>4.2 Beta1</fixVersion>
                                <component>HttpCache</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13142358" author="jonm" created="Wed, 2 Nov 2011 17:57:08 +0000"  >Hi Vasile,&lt;br/&gt;
&lt;br/&gt;
Sorry to just be getting around to this now. Can you explain the reason for breaking out a ViaHeaderCache as a separate class? Why not just a HashMap? Since this is a true function (given a ProtocolVersion I always generate the same Via header), there&amp;#39;s no need to put locks around this, as once the cache is populated it won&amp;#39;t be modified, and even if there is a race condition between two threads trying to populate the cache, they&amp;#39;ll both arrive at the same answer.&lt;br/&gt;
&lt;br/&gt;
Would you like to revise your patch just to use a plain-old HashMap for this?&lt;br/&gt;
&lt;br/&gt;
Jon</comment>
                    <comment id="13142500" author="avasile" created="Wed, 2 Nov 2011 20:45:29 +0000"  >Hi Jon,&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Thanks for reviewing my patch.&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;I wanted to keep the request operations thread safe, but if you think race conditions are not a problem, I can use a simple map (my initial solution was a simple HashMap, as you suggest). Do you think a ConcurrentHashMap would be more appropriate, so we don&amp;#39;t have stale string values? (I&amp;#39;m thinking that a different thread might see an incomplete Via value in this map if we use a simple HashMap).&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Alin</comment>
                    <comment id="13143310" author="jonm" created="Thu, 3 Nov 2011 16:55:29 +0000"  >No, a regular HashMap is fine: Java Strings are immutable, and a put operation should just be a pointer swap.&lt;br/&gt;
</comment>
                    <comment id="13143508" author="avasile" created="Thu, 3 Nov 2011 20:26:59 +0000"  >Patch modified according to Jon&amp;#39;s comments to use a simple HashMap.</comment>
                    <comment id="13144255" author="jonm" created="Fri, 4 Nov 2011 19:13:03 +0000"  >Ok, patch checked in. Thanks much, Alin!&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
                    <attachments>
                    <attachment id="12498881" name="cached_via_header_vals.patch" size="8529" author="avasile" created="Thu, 13 Oct 2011 14:50:26 +0100" />
                    <attachment id="12502216" name="via_header_hashmap.patch" size="2829" author="avasile" created="Thu, 3 Nov 2011 20:26:59 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 2 Nov 2011 17:57:08 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>85384</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>46918</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Mon Jul 08 06:12:39 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HTTPCLIENT-1069/HTTPCLIENT-1069.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[HTTPCLIENT-1069] HttpClient 4.1 ignores request retry handler and stops retrying when a read timeout is followed by a connection refusal</title>
                <link>https://issues.apache.org/jira/browse/HTTPCLIENT-1069</link>
                <project id="12310360" key="HTTPCLIENT">HttpComponents HttpClient</project>
                        <description>I encountered an issue while writing unit tests for the RestBackup(tm) API Client Library, &lt;a href=&quot;https://github.com/mleonhard/restbackup-java&quot;&gt;https://github.com/mleonhard/restbackup-java&lt;/a&gt; .  HttpClient 4.1 is failing to retry when it encounters a read timeout followed by a connection refusal.  This problem occurs on Windows but not on Linux.  Below is a short program that reproduces the problem.  It performs the expected 5 request attempts on Linux but only 2 on Windows.&lt;br/&gt;
&lt;br/&gt;
My Windows environment is a laptop with Windows 7 Ultimate 64-bit and Oracle Java SE Development Kit Update 21 32-bit.  My Linux environment is Amazon EC2 with Ubuntu 10.04 LTS 32-bit and Oracle Java SE Development Kit Update 21 32-bit.&lt;br/&gt;
&lt;br/&gt;
This is my first bug report to an Apache project.  I&amp;#39;d like to add that I&amp;#39;m a big fan of the Commons libraries and Http Components.&lt;br/&gt;
&lt;br/&gt;
Sincerely,&lt;br/&gt;
-Michael&lt;br/&gt;
&lt;br/&gt;
=== RetryBug.java ===&lt;br/&gt;
&lt;br/&gt;
import java.io.IOException;&lt;br/&gt;
import java.net.ServerSocket;&lt;br/&gt;
import java.util.logging.Logger;&lt;br/&gt;
&lt;br/&gt;
import org.apache.http.client.HttpRequestRetryHandler;&lt;br/&gt;
import org.apache.http.client.methods.HttpGet;&lt;br/&gt;
import org.apache.http.impl.client.DefaultHttpClient;&lt;br/&gt;
import org.apache.http.params.CoreConnectionPNames;&lt;br/&gt;
import org.apache.http.protocol.HttpContext;&lt;br/&gt;
&lt;br/&gt;
public class RetryBug {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;private static final Logger _log = Logger.getLogger(RetryBug.class.getName());&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public static void main(String[] args) throws IOException {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ServerSocket serverSocket = new ServerSocket(0, 1);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;DefaultHttpClient httpClient = new DefaultHttpClient();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;HttpRequestRetryHandler retryHandler = new HttpRequestRetryHandler() {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public boolean retryRequest(IOException e, int count, HttpContext context) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;_log.info(&amp;quot;count=&amp;quot; + count + &amp;quot; &amp;quot; + e.toString());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;return count &amp;lt; 5;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;};&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpClient.setHttpRequestRetryHandler(retryHandler);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpClient.getParams().setIntParameter(CoreConnectionPNames.SO_TIMEOUT, 100);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String url = &amp;quot;&lt;a href=&quot;http://127.0.0.1:&quot;&gt;http://127.0.0.1:&lt;/a&gt;&amp;quot; + serverSocket.getLocalPort() + &amp;quot;/&amp;quot;;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;httpClient.execute(new HttpGet(url));&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} finally {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;serverSocket.close();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=== Windows 7 ===&lt;br/&gt;
&lt;br/&gt;
C:\RetryBug&amp;gt;md5sum httpcomponents-client-4.1-bin.zip&lt;br/&gt;
008ad15560249bcde42cfe34fdb4e858 *httpcomponents-client-4.1-bin.zip&lt;br/&gt;
&lt;br/&gt;
C:\RetryBug&amp;gt;&amp;quot;c:\Program Files (x86)\Java\jdk1.6.0_21\bin\java.exe&amp;quot; -version&lt;br/&gt;
java version &amp;quot;1.6.0_21&amp;quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_21-b06)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 17.0-b16, mixed mode)&lt;br/&gt;
&lt;br/&gt;
C:\RetryBug&amp;gt;&amp;quot;c:\Program Files (x86)\Java\jdk1.6.0_21\bin\javac.exe&amp;quot; -cp httpcomponents-client-4.1\lib\commons-codec-1.4.jar;httpcomponents-client-4.1\lib\commons-logging-1.1.1.jar;httpcomponents-client-4.1\lib\httpclient-4.1.jar;httpcomponents-client-4.1\lib\httpcore-4.1.jar RetryBug.java&lt;br/&gt;
&lt;br/&gt;
C:\RetryBug&amp;gt;&amp;quot;c:\Program Files (x86)\Java\jdk1.6.0_21\bin\java.exe&amp;quot; -cp httpcomponents-client-4.1\lib\commons-codec-1.4.jar;httpcomponents-client-4.1\lib\commons-logging-1.1.1.jar;httpcomponents-client-4.1\lib\httpclient-4.1.jar;httpcomponents-client-4.1\lib\httpcore-4.1.jar;. RetryBug&lt;br/&gt;
Mar 9, 2011 9:14:36 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=1 java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
Mar 9, 2011 9:14:36 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: I/O exception (java.net.SocketTimeoutException) caught when processing request: Read timed out&lt;br/&gt;
Mar 9, 2011 9:14:36 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: Retrying request&lt;br/&gt;
Exception in thread &amp;quot;main&amp;quot; org.apache.http.conn.HttpHostConnectException: Connection to &lt;a href=&quot;http://127.0.0.1:56361&quot;&gt;http://127.0.0.1:56361&lt;/a&gt; refused&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:158)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:149)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:121)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:650)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:454)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:754)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:732)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at RetryBug.main(RetryBug.java:27)&lt;br/&gt;
Caused by: java.net.ConnectException: Connection refused: connect&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.PlainSocketImpl.socketConnect(Native Method)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.Socket.connect(Socket.java:529)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:120)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:148)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 8 more&lt;br/&gt;
&lt;br/&gt;
C:\RetryBug&amp;gt;&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
=== Ubuntu 10 ===&lt;br/&gt;
&lt;br/&gt;
$ md5sum httpcomponents-client-4.1-bin.tar.gz&lt;br/&gt;
f043c1cc016cb3b720be9fb020bfa755  httpcomponents-client-4.1-bin.tar.gz&lt;br/&gt;
$ ~/jdk1.6.0_21/bin/java -version&lt;br/&gt;
java version &amp;quot;1.6.0_21&amp;quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_21-b06)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 17.0-b16, mixed mode, sharing)&lt;br/&gt;
$ ~/jdk1.6.0_21/bin/javac -cp httpcomponents-client-4.1/lib/httpclient-cache-4.1.jar:httpcomponents-client-4.1/lib/commons-logging-1.1.1.jar:httpcomponents-client-4.1/lib/httpcore-4.1.jar:httpcomponents-client-4.1/lib/httpclient-4.1.jar:httpcomponents-client-4.1/lib/httpmime-4.1.jar:httpcomponents-client-4.1/lib/commons-codec-1.4.jar RetryBug.java&lt;br/&gt;
$ ~/jdk1.6.0_21/bin/java -cp httpcomponents-client-4.1/lib/httpclient-cache-4.1.jar:httpcomponents-client-4.1/lib/commons-logging-1.1.1.jar:httpcomponents-client-4.1/lib/httpcore-4.1.jar:httpcomponents-client-4.1/lib/httpclient-4.1.jar:httpcomponents-client-4.1/lib/httpmime-4.1.jar:httpcomponents-client-4.1/lib/commons-codec-1.4.jar:. RetryBug&lt;br/&gt;
Mar 9, 2011 1:09:42 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=1 java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
Mar 9, 2011 1:09:42 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: I/O exception (java.net.SocketTimeoutException) caught when processing request: Read timed out&lt;br/&gt;
Mar 9, 2011 1:09:42 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: Retrying request&lt;br/&gt;
Mar 9, 2011 1:09:42 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=2 java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
Mar 9, 2011 1:09:42 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: I/O exception (java.net.SocketTimeoutException) caught when processing request: Read timed out&lt;br/&gt;
Mar 9, 2011 1:09:42 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: Retrying request&lt;br/&gt;
Mar 9, 2011 1:09:42 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=3 java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
Mar 9, 2011 1:09:42 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: I/O exception (java.net.SocketTimeoutException) caught when processing request: Read timed out&lt;br/&gt;
Mar 9, 2011 1:09:42 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: Retrying request&lt;br/&gt;
Mar 9, 2011 1:09:42 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=4 java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
Mar 9, 2011 1:09:42 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: I/O exception (java.net.SocketTimeoutException) caught when processing request: Read timed out&lt;br/&gt;
Mar 9, 2011 1:09:42 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: Retrying request&lt;br/&gt;
Mar 9, 2011 1:09:51 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=5 java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
Exception in thread &amp;quot;main&amp;quot; java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.SocketInputStream.socketRead0(Native Method)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.SocketInputStream.read(SocketInputStream.java:129)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.io.AbstractSessionInputBuffer.fillBuffer(AbstractSessionInputBuffer.java:149)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.io.SocketInputBuffer.fillBuffer(SocketInputBuffer.java:110)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.io.AbstractSessionInputBuffer.readLine(AbstractSessionInputBuffer.java:260)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.DefaultResponseParser.parseHead(DefaultResponseParser.java:98)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.io.AbstractMessageParser.parse(AbstractMessageParser.java:252)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.AbstractHttpClientConnection.receiveResponseHeader(AbstractHttpClientConnection.java:281)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.DefaultClientConnection.receiveResponseHeader(DefaultClientConnection.java:247)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.AbstractClientConnAdapter.receiveResponseHeader(AbstractClientConnAdapter.java:219)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.protocol.HttpRequestExecutor.doReceiveResponse(HttpRequestExecutor.java:298)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.protocol.HttpRequestExecutor.execute(HttpRequestExecutor.java:125)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:622)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:454)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:754)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:732)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at RetryBug.main(RetryBug.java:27)&lt;br/&gt;
$</description>
                <environment>Windows 7 Ultimate 64-bit, Java SE Development Kit Update 21 32-bit</environment>
            <key id="12500891">HTTPCLIENT-1069</key>
            <summary>HttpClient 4.1 ignores request retry handler and stops retrying when a read timeout is followed by a connection refusal</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="mleonhard">Michael Leonhard</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Mar 2011 13:39:08 +0000</created>
                <updated>Sat, 23 Jul 2011 10:58:10 +0100</updated>
                    <resolved>Thu, 10 Mar 2011 09:44:22 +0000</resolved>
                            <version>4.1 Final</version>
                                <fixVersion>4.1.1</fixVersion>
                                <component>HttpClient</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13005009" author="olegk" created="Thu, 10 Mar 2011 09:44:22 +0000"  >Fixed in trunk and 4.1.x branch. Please re-test.&lt;br/&gt;
&lt;br/&gt;
Oleg</comment>
                    <comment id="13005068" author="mleonhard" created="Thu, 10 Mar 2011 14:01:31 +0000"  >I can confirm that this is fixed in the 4.1.x branch.  Thank you!&lt;br/&gt;
-Michael&lt;br/&gt;
&lt;br/&gt;
C:\RetryBug&amp;gt;&amp;quot;c:\Program Files (x86)\Java\jdk1.6.0_21\bin\javac.exe&amp;quot; -cp httpclient-4.1.x\httpclient\target\httpclient-4.1.1-SNAPSHOT.jar;httpcomponents-client-4.1\lib\commons-codec-1.4.jar;httpcomponents-client-4.1\lib\commons-logging-1.1.1.jar;httpcomponents-client-4.1\lib\httpcore-4.1.jar RetryBug.java&lt;br/&gt;
&lt;br/&gt;
C:\RetryBug&amp;gt;&amp;quot;c:\Program Files (x86)\Java\jdk1.6.0_21\bin\java.exe&amp;quot; -cp httpclient-4.1.x\httpclient\target\httpclient-4.1.1-SNAPSHOT.jar;httpcomponents-client-4.1\lib\commons-codec-1.4.jar;httpcomponents-client-4.1\lib\commons-logging-1.1.1.jar;httpcomponents-client-4.1\lib\httpcore-4.1.jar;. RetryBug&lt;br/&gt;
Mar 10, 2011 9:58:02 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=1 java.net.SocketTimeoutException: Read timed out&lt;br/&gt;
Mar 10, 2011 9:58:02 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: I/O exception (java.net.SocketTimeoutException) caught when processing request: Read timed out&lt;br/&gt;
Mar 10, 2011 9:58:02 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: Retrying request&lt;br/&gt;
Mar 10, 2011 9:58:03 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=2 org.apache.http.conn.HttpHostConnectException: Connection to &lt;a href=&quot;http://127.0.0.1:56928&quot;&gt;http://127.0.0.1:56928&lt;/a&gt; refused&lt;br/&gt;
Mar 10, 2011 9:58:03 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: I/O exception (org.apache.http.conn.HttpHostConnectException) caught when processing request: Connection to &lt;a href=&quot;http://127.0.0.1:56928&quot;&gt;http://127.0.0.1:56928&lt;/a&gt; refused&lt;br/&gt;
Mar 10, 2011 9:58:03 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: Retrying request&lt;br/&gt;
Mar 10, 2011 9:58:04 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=3 org.apache.http.conn.HttpHostConnectException: Connection to &lt;a href=&quot;http://127.0.0.1:56928&quot;&gt;http://127.0.0.1:56928&lt;/a&gt; refused&lt;br/&gt;
Mar 10, 2011 9:58:04 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: I/O exception (org.apache.http.conn.HttpHostConnectException) caught when processing request: Connection to &lt;a href=&quot;http://127.0.0.1:56928&quot;&gt;http://127.0.0.1:56928&lt;/a&gt; refused&lt;br/&gt;
Mar 10, 2011 9:58:04 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: Retrying request&lt;br/&gt;
Mar 10, 2011 9:58:05 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=4 org.apache.http.conn.HttpHostConnectException: Connection to &lt;a href=&quot;http://127.0.0.1:56928&quot;&gt;http://127.0.0.1:56928&lt;/a&gt; refused&lt;br/&gt;
Mar 10, 2011 9:58:05 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: I/O exception (org.apache.http.conn.HttpHostConnectException) caught when processing request: Connection to &lt;a href=&quot;http://127.0.0.1:56928&quot;&gt;http://127.0.0.1:56928&lt;/a&gt; refused&lt;br/&gt;
Mar 10, 2011 9:58:05 PM org.apache.http.impl.client.DefaultRequestDirector tryExecute&lt;br/&gt;
INFO: Retrying request&lt;br/&gt;
Mar 10, 2011 9:58:06 PM RetryBug$1 retryRequest&lt;br/&gt;
INFO: count=5 org.apache.http.conn.HttpHostConnectException: Connection to &lt;a href=&quot;http://127.0.0.1:56928&quot;&gt;http://127.0.0.1:56928&lt;/a&gt; refused&lt;br/&gt;
Exception in thread &amp;quot;main&amp;quot; org.apache.http.conn.HttpHostConnectException: Connection to &lt;a href=&quot;http://127.0.0.1:56928&quot;&gt;http://127.0.0.1:56928&lt;/a&gt; refused&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:158)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:149)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:121)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.DefaultRequestDirector.tryExecute(DefaultRequestDirector.java:622)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:454)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:754)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:732)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at RetryBug.main(RetryBug.java:27)&lt;br/&gt;
Caused by: java.net.ConnectException: Connection refused: connect&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.PlainSocketImpl.socketConnect(Native Method)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at java.net.Socket.connect(Socket.java:529)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:123)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:148)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;... 8 more&lt;br/&gt;
&lt;br/&gt;
C:\RetryBug&amp;gt;</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 10 Mar 2011 09:44:22 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>67122</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>46983</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
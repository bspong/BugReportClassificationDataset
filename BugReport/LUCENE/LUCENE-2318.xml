<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:27:13 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2318/LUCENE-2318.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2318] Add System.getProperty(&quot;tempDir&quot;) as final static to LuceneTestCase(J4)</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2318</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Almost every test calls System.getProperty(&quot;tempDir&quot;) and some of them check the return value for null. In other cases the test simply fails from within eclipse.&lt;/p&gt;

&lt;p&gt;We should add this to LuceneTestCase(J4) as a static final constant. For enabling tests run in eclipse, we can add a fallback to &quot;.&quot;, if the Sysprop is not defined.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12459029">LUCENE-2318</key>
            <summary>Add System.getProperty(&quot;tempDir&quot;) as final static to LuceneTestCase(J4)</summary>
                <type id="6" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/requirement.png">Test</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Sat, 13 Mar 2010 16:55:14 +0000</created>
                <updated>Fri, 10 May 2013 11:43:49 +0100</updated>
                    <resolved>Sun, 14 Mar 2010 16:21:38 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12845038" author="shaie" created="Sun, 14 Mar 2010 07:17:52 +0000"  >&lt;p&gt;Uwe, can you default to &quot;java.io.tmpdir&quot; instead? &quot;.&quot; is not properly defined. It will create indexes in the current directory where the tests run from, which is different if I run &quot;ant test&quot; from &amp;lt;root&amp;gt;, &amp;lt;root&amp;gt;/contrib and &amp;lt;root&amp;gt;/benchmark ...&lt;/p&gt;

&lt;p&gt;Or, we can tweak common-build.xml to fallback to &amp;lt;root&amp;gt;/test. In fact, looking in common-build.xml, I already see tempDir defaults to &lt;/p&gt;
{build.dir}
&lt;p&gt;/test. Look at lines 448 (where it is set), 417 where it is used and 418 where java.io.tmpdir is set to that value.&lt;/p&gt;

&lt;p&gt;Maybe we need to change the definition of build.dir from location=&quot;build&quot; to location=&quot;&lt;/p&gt;
{common.dir}
&lt;p&gt;/build&quot; so that it always references &amp;lt;root&amp;gt;/build.&lt;/p&gt;

&lt;p&gt;And if run from eclipse, default TEMP_DIR constant to &quot;java.io.tmpdir&quot;?&lt;/p&gt;</comment>
                    <comment id="12845049" author="thetaphi" created="Sun, 14 Mar 2010 08:41:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;Uwe, can you default to &quot;java.io.tmpdir&quot; instead?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The problem are only test runs outside ANT. If you run the tests from ANT there is never a problem, they use $&lt;/p&gt;
{build.dir}
&lt;p&gt;/test, which is perfectly defined. But the tempDir system property is not set when running the tests from eclipse. So Your suggestion to fallback to java.io.tmpdir is a good idea, maybe with &quot;/lucene-test&quot; appended.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Maybe we need to change the definition of build.dir from location=&quot;build&quot; to location=&quot;{common.dir}/build&quot; so that it always references &amp;lt;root&amp;gt;/build.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This would break contrib. Its defined correctly at the moment, as ANT guarantees that &quot;.&quot; or the current dir defaults to the `dirname build.xml`.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Or, we can tweak common-build.xml to fallback to &amp;lt;root&amp;gt;/test.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;common-build never needs a fallback, as its always defined. and &amp;lt;root&amp;gt;/test is exactly what we do not want to have as it will not be cleaned up on &quot;ant clean&quot;&lt;/p&gt;</comment>
                    <comment id="12845068" author="thetaphi" created="Sun, 14 Mar 2010 11:30:00 +0000"  >&lt;p&gt;Here the patch.&lt;/p&gt;

&lt;p&gt;I removed almost all System.getProperty calls from tests. Only remaining are the special properties in benchmark (maybe that can be solved, too) and System.getProperty(&quot;line.separator&quot;) - but that&apos;s fine.&lt;/p&gt;

&lt;p&gt;LuceneTestCaseJ4 now has two fields of type java.io.File:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;TEMP_DIR that is retrieved from system property &quot;tempDir&quot;, set by ANT or, if not available from &quot;java.io.tmpdir&quot;. By this tests will also run correctly from eclipse. This is static.&lt;/li&gt;
	&lt;li&gt;DATA_DIR (deprecated) that is used by some contrib tests. This should not be used, instead the tests should use this.getClass().getResource/getResourceAsStream, which is also relative to the current tests. I did not change the tests to use this. DATA_DIR is detected from system property (set by ANT), else it is loaded from classpath of the &lt;b&gt;current&lt;/b&gt; test class, because of that it is not static (but final) and initialized in the class ctor.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12845074" author="thetaphi" created="Sun, 14 Mar 2010 13:09:46 +0000"  >&lt;p&gt;New patch, removed usage of DATA_DIR again.&lt;/p&gt;

&lt;p&gt;All tests that simply needed an InputStream were converted to getResourceAsStream(). Other tests that really need a File instance can use LuceneTestCase(J4).getDataFile(String), which was heavily borrowed from the PorterTestCase, I moved the code there. Its only few tests that use this function.&lt;/p&gt;

&lt;p&gt;This is now ready to commit.&lt;/p&gt;</comment>
                    <comment id="12845097" author="shaie" created="Sun, 14 Mar 2010 15:20:43 +0000"  >&lt;p&gt;Patch looks good.&lt;/p&gt;

&lt;p&gt;I see that you&apos;ve documented TEST_VERSION_CURRENT in LuceneTestCase(J4) as:  /** Use this constant when creating Analyzers. */. It&apos;s used already for creating IndexWriterConfig,and I assume it will be used for other components as we&apos;ll introduce it in them (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2305&quot; title=&quot;Introduce Version in more places long before 4.0&quot;&gt;&lt;del&gt;LUCENE-2305&lt;/del&gt;&lt;/a&gt;). So perhaps generalize the jdoc?&lt;/p&gt;

&lt;p&gt;It bothered me for a long time that I cannot run some tests from eclipse because of this &apos;tempDir&apos;. I&apos;m glad you fixed it !&lt;/p&gt;</comment>
                    <comment id="12845098" author="thetaphi" created="Sun, 14 Mar 2010 15:28:15 +0000"  >&lt;p&gt;OK, I fixed the javadocs here! Thanks.&lt;/p&gt;</comment>
                    <comment id="12845100" author="thetaphi" created="Sun, 14 Mar 2010 16:21:38 +0000"  >&lt;p&gt;Committed revision: 922886&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                                <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12460319">LUCENE-2349</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12438752" name="LUCENE-2318.patch" size="38632" author="thetaphi" created="Sun, 14 Mar 2010 13:09:46 +0000" />
                    <attachment id="12438749" name="LUCENE-2318.patch" size="34652" author="thetaphi" created="Sun, 14 Mar 2010 11:30:00 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sun, 14 Mar 2010 07:17:52 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11476</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25407</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
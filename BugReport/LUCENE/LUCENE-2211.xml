<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:16:31 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2211/LUCENE-2211.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2211] Improve BaseTokenStreamTestCase to uses a fake attribute to check if clearAttributes() was called correctly - found bugs in contrib/analyzers</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2211</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Robert had the idea to use a fake attribute inside BaseTokenStreamTestCase that records if its clear() method was called. If this is not the case after incrementToken(), asserTokenStreamContents fails. It also uses the attribute in TeeSinkTokenFilter, because there a lot of copying, captureState and restoreState() is used. By the attribute, you can track wonderful, if save/restore and clearAttributes is correctly implemented. It also verifies that &lt;b&gt;before&lt;/b&gt; a captureState() it was also cleared (as the state will also contain the clear call). Because if you consume tokens in a filter, capture the consumed tokens and insert them, the capturedStates must also be cleared before.&lt;/p&gt;

&lt;p&gt;In contrib analyzers are some test that fail to pass this additional assertion. They are not fixed in the attached patch.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12445569">LUCENE-2211</key>
            <summary>Improve BaseTokenStreamTestCase to uses a fake attribute to check if clearAttributes() was called correctly - found bugs in contrib/analyzers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Jan 2010 23:21:00 +0000</created>
                <updated>Mon, 16 May 2011 19:15:43 +0100</updated>
                    <resolved>Fri, 15 Jan 2010 16:15:01 +0000</resolved>
                            <version>2.9</version>
                <version>2.9.1</version>
                <version>3.0</version>
                                <fixVersion>2.9.2</fixVersion>
                <fixVersion>3.0.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>modules/analysis</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12800433" author="thetaphi" created="Thu, 14 Jan 2010 23:54:38 +0000"  >&lt;p&gt;The ngram things are serious, so also backport.&lt;/p&gt;

&lt;p&gt;We get the non-generic java 1.4 version for solr 1.5 for free.&lt;/p&gt;</comment>
                    <comment id="12800435" author="rcmuir" created="Thu, 14 Jan 2010 23:58:18 +0000"  >&lt;p&gt;uwe&apos;s patch, with the fixes for contrib.&lt;/p&gt;

&lt;p&gt;broken were compounds, n-gram filter, and edge n-gram filter&lt;/p&gt;</comment>
                    <comment id="12800464" author="rcmuir" created="Fri, 15 Jan 2010 00:32:13 +0000"  >&lt;p&gt;before committing any fix i want to review / add tests for any tokenstreams that do not yet use this BaseTokenStreamTestCase, just to be sure there are no others with this problem.&lt;/p&gt;

&lt;p&gt;it may seem trivial but if this clearing does not take place properly, then things like position increment with stopfilter can grow to very large values, overflow, and cause IndexWriter to throw an exception: &lt;a href=&quot;http://www.lucidimagination.com/search/document/f649a19901d33c75/illegalargumentexception_when_indexwriter_adddocument&quot; class=&quot;external-link&quot;&gt;http://www.lucidimagination.com/search/document/f649a19901d33c75/illegalargumentexception_when_indexwriter_adddocument&lt;/a&gt;&lt;/p&gt;
</comment>
                    <comment id="12800524" author="rcmuir" created="Fri, 15 Jan 2010 03:36:39 +0000"  >&lt;p&gt;Hello Uwe, i did not get time to review all tokenstreams but I converted a ShingleMatrix test to assertTokenStreamContents and found a clearAttributes() bug in it too, so it is also fixed in this one, more tokenstreams with problems might remain.&lt;/p&gt;</comment>
                    <comment id="12800533" author="rcmuir" created="Fri, 15 Jan 2010 04:15:41 +0000"  >&lt;p&gt;Hi Uwe, PrefixAwareTokenFilter did not clearAttributes() either. I tried all others i could find but I think the rest are ok.&lt;/p&gt;</comment>
                    <comment id="12800634" author="thetaphi" created="Fri, 15 Jan 2010 09:34:14 +0000"  >&lt;p&gt;Some updates to TeeSink test. Changes.txt.&lt;/p&gt;</comment>
                    <comment id="12800665" author="thetaphi" created="Fri, 15 Jan 2010 11:04:20 +0000"  >&lt;p&gt;More updates to TeeSink and also BaseTokenStreamTestCase to still call clearAttributes to force TS to not reuse attributes from previous calls to incrementToken(). This was one of the first traps, Robert investigated in 2.9.&lt;/p&gt;</comment>
                    <comment id="12800683" author="rcmuir" created="Fri, 15 Jan 2010 12:36:57 +0000"  >&lt;p&gt;i reviewed all code with incrementToken() and found 3 more problems, 2 in highlighter, 1 in memory.&lt;/p&gt;

&lt;p&gt;i also fixed all helper tokenstreams in core/contrib tests.&lt;/p&gt;</comment>
                    <comment id="12800697" author="thetaphi" created="Fri, 15 Jan 2010 13:42:07 +0000"  >&lt;p&gt;I&apos;ll commit attached patch woith some fixes for typos etc.&lt;/p&gt;</comment>
                    <comment id="12800698" author="thetaphi" created="Fri, 15 Jan 2010 13:42:36 +0000"  >&lt;p&gt;Fixed in trunk revision: 899627&lt;/p&gt;</comment>
                    <comment id="12800703" author="thetaphi" created="Fri, 15 Jan 2010 14:00:03 +0000"  >&lt;p&gt;Patch for 3.0 branch&lt;/p&gt;</comment>
                    <comment id="12800709" author="thetaphi" created="Fri, 15 Jan 2010 14:21:55 +0000"  >&lt;p&gt;Fixed in Lucene 3.0 revision: 899639&lt;/p&gt;</comment>
                    <comment id="12800712" author="thetaphi" created="Fri, 15 Jan 2010 14:33:19 +0000"  >&lt;p&gt;Patch for 2.9 branch. Tests are running...&lt;/p&gt;</comment>
                    <comment id="12800736" author="thetaphi" created="Fri, 15 Jan 2010 16:08:53 +0000"  >&lt;p&gt;There was a new bug in the 2.9 ShingleMatrixFilter because of incorrect Token reuse in a call to this.next(reusableToken). This patch now also contains the merged &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1939&quot; title=&quot;IndexOutOfBoundsException at ShingleMatrixFilter&amp;#39;s Iterator#hasNext method&quot;&gt;&lt;del&gt;LUCENE-1939&lt;/del&gt;&lt;/a&gt;, which was missing.&lt;/p&gt;

&lt;p&gt;I commit this now.&lt;/p&gt;</comment>
                    <comment id="12800739" author="thetaphi" created="Fri, 15 Jan 2010 16:15:01 +0000"  >&lt;p&gt;Committed into 2.9 branch revision: 899681&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12430408" name="LUCENE-2211-branch29.patch" size="41291" author="thetaphi" created="Fri, 15 Jan 2010 16:08:53 +0000" />
                    <attachment id="12430406" name="LUCENE-2211-branch29.patch" size="36864" author="thetaphi" created="Fri, 15 Jan 2010 14:33:19 +0000" />
                    <attachment id="12430401" name="LUCENE-2211-branch30.patch" size="35157" author="thetaphi" created="Fri, 15 Jan 2010 14:00:03 +0000" />
                    <attachment id="12430399" name="LUCENE-2211.patch" size="33161" author="thetaphi" created="Fri, 15 Jan 2010 13:42:07 +0000" />
                    <attachment id="12430391" name="LUCENE-2211.patch" size="33206" author="rcmuir" created="Fri, 15 Jan 2010 12:36:57 +0000" />
                    <attachment id="12430386" name="LUCENE-2211.patch" size="19961" author="thetaphi" created="Fri, 15 Jan 2010 11:04:20 +0000" />
                    <attachment id="12430381" name="LUCENE-2211.patch" size="19669" author="thetaphi" created="Fri, 15 Jan 2010 09:34:14 +0000" />
                    <attachment id="12430348" name="LUCENE-2211.patch" size="18604" author="rcmuir" created="Fri, 15 Jan 2010 04:15:41 +0000" />
                    <attachment id="12430346" name="LUCENE-2211.patch" size="12316" author="rcmuir" created="Fri, 15 Jan 2010 03:36:39 +0000" />
                    <attachment id="12430316" name="LUCENE-2211.patch" size="10157" author="rcmuir" created="Thu, 14 Jan 2010 23:58:18 +0000" />
                    <attachment id="12430311" name="LUCENE-2211.patch" size="7973" author="thetaphi" created="Thu, 14 Jan 2010 23:21:58 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 14 Jan 2010 23:58:18 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11576</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25514</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
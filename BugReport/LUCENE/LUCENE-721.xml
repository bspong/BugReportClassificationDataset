<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:21:47 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-721/LUCENE-721.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-721] Code coverage reports</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-721</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Hi all,&lt;/p&gt;

&lt;p&gt;We should be able to measure the code coverage of our unit testcases. I believe it would be very helpful for the committers, if they could verify before committing a patch if it does not reduce the coverage. &lt;/p&gt;

&lt;p&gt;Furthermore people could take a look in the code coverage reports to figure out where work needs to be done, i. e. where additional testcases are neccessary. It would be nice if we could add a page to the Lucene website showing the report, generated by the nightly build. Maybe you could add that to your preview page (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-707&quot; title=&quot;Lucene Java Site docs&quot;&gt;&lt;del&gt;LUCENE-707&lt;/del&gt;&lt;/a&gt;), Grant?&lt;/p&gt;

&lt;p&gt;I attach a patch here that uses the tool EMMA to generate the code coverage reports. EMMA is a very nice open-source tool released under the CPL (same license as junit). The patch adds three targets to common-build.xml: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;emma-check: verifys if both emma.jar and emma_ant.jar are in the ant classpath&lt;/li&gt;
	&lt;li&gt;emma-instrument: instruments the compiled code&lt;/li&gt;
	&lt;li&gt;generate-emma-report: generates an html code coverage report&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The following steps are neccessary in order to generate a code coverage report:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;add emma.jar and emma_ant.jar to your ant classpath (download emma from &lt;a href=&quot;http://emma.sourceforge.net/&quot; class=&quot;external-link&quot;&gt;http://emma.sourceforge.net/&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;execute ant target &apos;emma-instrument&apos; (depends on compile-test, so it will compile all core and test classes)&lt;/li&gt;
	&lt;li&gt;execute ant target &apos;test&apos; to run the unit tests&lt;/li&gt;
	&lt;li&gt;execute ant target &apos;generate-emma-report&apos;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;To view the emma report open build/test/emma/index.html&lt;/p&gt;</description>
                <environment></environment>
            <key id="12356239">LUCENE-721</key>
            <summary>Code coverage reports</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="gsingers">Grant Ingersoll</assignee>
                                <reporter username="michaelbusch">Michael Busch</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Nov 2006 06:59:05 +0000</created>
                <updated>Sat, 16 Dec 2006 20:27:15 +0000</updated>
                    <resolved>Sat, 16 Dec 2006 20:27:15 +0000</resolved>
                                                            <component>core/other</component>
                        <due></due>
                    <votes>1</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12451561" author="michaelbusch" created="Tue, 21 Nov 2006 07:00:02 +0000"  >&lt;p&gt;The patch described above.&lt;/p&gt;</comment>
                    <comment id="12451563" author="michaelbusch" created="Tue, 21 Nov 2006 07:10:44 +0000"  >&lt;p&gt;I attach a code coverage report of the current HEAD (revision: 477535), so people can check out how a report looks like. &lt;/p&gt;

&lt;p&gt;The current code coverage looks not bad: 77% of the code lines are being tested by our unit tests. However, the coverage is not perfect: e. g. the PorterStemmer or IndexWriter.addIndexes(IndexReader[]) are not tested at all.&lt;/p&gt;</comment>
                    <comment id="12451721" author="otis" created="Tue, 21 Nov 2006 17:46:40 +0000"  >&lt;p&gt;Nice.  I think we can&apos;t include EMMA jars int he repository, though, so you&apos;ll want to add the ability to download the Jar on the fly, just like Grant did it for the benchmark stuff.&lt;/p&gt;</comment>
                    <comment id="12451727" author="michaelbusch" created="Tue, 21 Nov 2006 18:10:47 +0000"  >&lt;p&gt;Good idea, I could do that. But currently we don&apos;t fetch the JUnit jars either, just give a hint where to download them in case they cannot be found in the ant classpath. I did the same with the EMMA jars. Should we do it for both (JUnit and EMMA), just for EMMA or leave it like it is for now?&lt;/p&gt;</comment>
                    <comment id="12451806" author="otis" created="Tue, 21 Nov 2006 22:59:34 +0000"  >&lt;p&gt;Sounds like my previous comment was off - if we don&apos;t distribute EMMA jars and just require the person to have them, what you have will do.  How about the nightly build, if we include this on the site?  I&apos;m not familiar with it enough to comment.  Yonik and Doug will know if/how things can be set up there with EMMA jars, should we include this on the site.&lt;/p&gt;</comment>
                    <comment id="12452544" author="gsingers" created="Sat, 25 Nov 2006 01:06:03 +0000"  >&lt;p&gt;Care to update this for Clover, Michael?  Then I can hook it into the site and the nightly builds.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Grant&lt;/p&gt;</comment>
                    <comment id="12452553" author="michaelbusch" created="Sat, 25 Nov 2006 03:34:01 +0000"  >&lt;p&gt;Sure Grant, I will update the patch soon to use clover instead of EMMA. Great that you will add it to the website!&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Michael&lt;/p&gt;</comment>
                    <comment id="12452621" author="michaelbusch" created="Sun, 26 Nov 2006 03:33:59 +0000"  >&lt;p&gt;Here it is, Grant. This new patch uses Clover to generate code coverage reports. Simply add clover.jar to the ant classpath, do a &quot;clean&quot; and run the target &quot;test&quot;. During compiling Clover will automatically instrument all classes under src/java. &lt;/p&gt;

&lt;p&gt;After the junit tests are done, execute the new target &quot;generate-clover-reports&quot;. Clover will generate the html report in build/test/clover/reports. &lt;/p&gt;

&lt;p&gt;Note: If clover.jar can not be found in the ant classpath then &quot;test&quot; will simply print an info message, saying that code coverage reports are disabled, and exeute the junit tests like it did before this patch.&lt;/p&gt;</comment>
                    <comment id="12457080" author="gsingers" created="Sat, 9 Dec 2006 15:15:37 +0000"  >&lt;p&gt;I&apos;m not familiar w/ clover, but here&apos;s what I did, when trying out your patch (which works):&lt;/p&gt;

&lt;p&gt;1. applied the patch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
2. Put clover.jar and clover.license (retrieved from the committers private repository into my ANT lib)&lt;br/&gt;
3. Ran &quot;ant clover&quot;  &amp;#8211; this passed and said clover is enabled&lt;br/&gt;
4.  Ran &quot;ant test&quot; &lt;br/&gt;
5. ant generate-clover-reports&lt;br/&gt;
6. View the reports!  They look good and I think will prove to be useful, especially for people who are looking for how they can help make Lucene better.&lt;/p&gt;

&lt;p&gt;Is there anyway to turn off clover other than removing the jar?  It seems like it takes quite a bit longer to run the tests and I was thinking I may just want to enable it when running nightly, but that most people wouldn&apos;t want it on by default even though they may have clover in there ANT lib.  &lt;br/&gt;
I wanted to do something like adding a property named run.clover (off by default) that could then be overridden by -Drun.clover=true on the command line, but I admit I don&apos;t see in ANT how to AND together the clover.present attribute with this new property.  The CONDITION and AVAILABLE tasks in ANT don&apos;t seem to allow for ANDing two existing properties, or perhaps I am missing something.  I admit, though, my ANT knowledge isn&apos;t what it used to be since I moved to Maven a long time ago, so if someone can chime in here it would be appreciated.&lt;/p&gt;

&lt;p&gt;Otherwise, the patch looks good and I will commit it once we figure out whether being able to turn it off is important to people and how to do it.&lt;/p&gt;</comment>
                    <comment id="12457084" author="gsingers" created="Sat, 9 Dec 2006 16:27:51 +0000"  >&lt;p&gt;OK, I committed this, with a minor change so that it is off by default (thanks Erik, for the ANT info).&lt;/p&gt;

&lt;p&gt;To  run, you need three things:&lt;br/&gt;
1. clover.jar in ANT lib&lt;br/&gt;
2. clover.license in ANT lib&lt;br/&gt;
3. On the command line or in the your ANT properties, if you want it on all the time, you must specify -Drun.clover=true&lt;/p&gt;

&lt;p&gt;Thanks, Micheal.&lt;/p&gt;

&lt;p&gt;I will incorporate this into the nightly build per &lt;a href=&quot;http://issues.apache.org/jira/browse/LUCENE-708&quot; class=&quot;external-link&quot;&gt;http://issues.apache.org/jira/browse/LUCENE-708&lt;/a&gt;&lt;/p&gt;</comment>
                    <comment id="12459076" author="gsingers" created="Sat, 16 Dec 2006 20:27:15 +0000"  >&lt;p&gt;Committed the change.  Linked to the reports from the Resources -&amp;gt; Developers page on the documentation.  Current report was generated on 12/16/06.  Once Lucene 708 is resolved, these reports will be updated nightly.&lt;/p&gt;

&lt;p&gt;Thanks Michael!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12345662" name="clover.patch" size="2385" author="michaelbusch" created="Sun, 26 Nov 2006 03:33:59 +0000" />
                    <attachment id="12345396" name="code_coverage.patch" size="3714" author="michaelbusch" created="Tue, 21 Nov 2006 07:00:02 +0000" />
                    <attachment id="12345397" name="emma_report.zip" size="866819" author="michaelbusch" created="Tue, 21 Nov 2006 07:10:44 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 21 Nov 2006 17:46:40 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>13031</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>27009</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
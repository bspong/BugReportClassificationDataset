<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 12:57:33 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3743/LUCENE-3743.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3743] LuceneTestCase&apos;s uncaught exceptions handler should check for AssumptionViolatedExceptions and then not trigger test failure</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3743</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;As in single-threaded tests, &lt;tt&gt;LuceneTestCase&lt;/tt&gt; should not trigger test failures for &lt;tt&gt;AssumptionViolatedException&lt;/tt&gt;&apos;s when they occur in multi-threaded tests.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12540656">LUCENE-3743</key>
            <summary>LuceneTestCase&apos;s uncaught exceptions handler should check for AssumptionViolatedExceptions and then not trigger test failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="steve_rowe">Steve Rowe</assignee>
                                <reporter username="steve_rowe">Steve Rowe</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Feb 2012 00:10:13 +0000</created>
                <updated>Fri, 10 May 2013 11:44:44 +0100</updated>
                    <resolved>Wed, 1 Feb 2012 00:54:31 +0000</resolved>
                            <version>3.5</version>
                <version>4.0-ALPHA</version>
                                <fixVersion>3.6</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>general/test</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13197409" author="steve_rowe" created="Wed, 1 Feb 2012 00:11:44 +0000"  >&lt;p&gt;Patch addressing the problem&lt;/p&gt;</comment>
                    <comment id="13197414" author="rcmuir" created="Wed, 1 Feb 2012 00:15:29 +0000"  >&lt;p&gt;definitely a bug... patch looks good to me.&lt;/p&gt;</comment>
                    <comment id="13197418" author="thetaphi" created="Wed, 1 Feb 2012 00:18:36 +0000"  >&lt;p&gt;I am not sure, if this is really a bug... Why would one do an assume in a thread, you would d this at the beginning of your test to check preconditions, but if its inside a thread its in my opinion somehow too late?&lt;/p&gt;</comment>
                    <comment id="13197421" author="rcmuir" created="Wed, 1 Feb 2012 00:22:02 +0000"  >&lt;p&gt;I think you can have a situation where you want to assume in another thread...&lt;/p&gt;

&lt;p&gt;it doesnt have to be a precondition... in fact the whole handling of assume doesnt&lt;br/&gt;
even work best as a precondition &lt;span class=&quot;error&quot;&gt;&amp;#91;in setUp&amp;#93;&lt;/span&gt; because you get no messages about it if you do that.&lt;br/&gt;
try it... its because the TestWatchMan does not intercept anything coming from setUp &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;anyway I think we should do the patch for consistency, and for those rare, crazy&lt;br/&gt;
situations where you want to make an assumption that isnt a precondition.&lt;/p&gt;</comment>
                    <comment id="13197426" author="thetaphi" created="Wed, 1 Feb 2012 00:29:30 +0000"  >&lt;p&gt;With &quot;precondition&quot; I meant a precodnition of a test method like the ones we have for slow codecs...&lt;/p&gt;</comment>
                    <comment id="13197427" author="steve_rowe" created="Wed, 1 Feb 2012 00:29:44 +0000"  >&lt;p&gt;Robert and I were looking at &lt;a href=&quot;https://builds.apache.org/job/Lucene-Solr-tests-only-3.x-java7/1685/testReport/junit/org.apache.lucene.analysis.charfilter/HTMLStripCharFilterTest/testRandom/&quot; class=&quot;external-link&quot;&gt;https://builds.apache.org/job/Lucene-Solr-tests-only-3.x-java7/1685/testReport/junit/org.apache.lucene.analysis.charfilter/HTMLStripCharFilterTest/testRandom/&lt;/a&gt; &amp;#8211; random data is generated that contains charcter U+FFFF, and tracking down all the locations where that character is generated in all the random generators looked hard; Robert suggested an Assume to ignore test data containing U+FFFF.&lt;/p&gt;

&lt;p&gt;From #lucene IRC:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  rmuir: maybe we should throw a junit assume or something
         so it doesnt fail
         but prevents you from wasting time 
sarowe1: makes sense
  rmuir: i think we can just &apos;throw new AssumptionViolatedException&apos;
sarowe1: I&apos;ll give it a try
         didn&apos;t work for me - it stops the run the same as assert
[...]
sarowe1: LuceneTestCase should ignore the failure???
  rmuir: yeah
         i think it should treat it as assume?
         im not sure
         hmm assume from another thread...
         i think thats an LTC bug maybe
         because from a single thread it works:
[...]
  rmuir: we should fix that
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                    <comment id="13197435" author="rcmuir" created="Wed, 1 Feb 2012 00:38:30 +0000"  >&lt;p&gt;I really think this is the best solution for this U+FFFF issue, the problems:&lt;br/&gt;
1. its only on 3.x becuase the indexer will replace it with U+FFFD (does not happen in trunk)&lt;br/&gt;
2. there is likely no bug in an random generator, instead its generating escaped &amp;#FFFF;, the assert happens at &apos;tokenizer&apos; level (after charfilters processing)&lt;br/&gt;
3. trying to stop generators from generating strings like that is hard, especially since we test this htmlstripfilter &apos;chained&apos; with MockCharFilter. for example MockCharFilter doubles characters &apos;randomly&apos;, and we test HtmlStrip &lt;b&gt;with&lt;/b&gt; MockCharFilter too (a charfilter chain), so a random generator could make &amp;#FF;, then MockCharFilter doubles the F&apos;s into &amp;#FFFF;, then HtmlStrip turns it into FFFF.&lt;/p&gt;

&lt;p&gt;for these reasons assume is the best, I added this as &apos;assert&apos; originally because otherwise&lt;br/&gt;
its hard to track down why some random searching test fails. if the generators were really generating&lt;br/&gt;
this character tests would be failing left and right.&lt;/p&gt;

&lt;p&gt;I dont think they are, I think its the situation described in 2 and 3 above. This is ridiculous to&lt;br/&gt;
spend a lot of time on, when we dont care to assert that this isn&apos;t happening, we just want to&lt;br/&gt;
not waste time on scary test failures.&lt;/p&gt;</comment>
                    <comment id="13197438" author="thetaphi" created="Wed, 1 Feb 2012 00:43:15 +0000"  >&lt;p&gt;I understand and the fix is fine, my problem was simply, that one should also add a short description of the issue that lead to the failure - thats all &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; If Steven would have put that into the issue description, I would not have complained &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="13197448" author="steve_rowe" created="Wed, 1 Feb 2012 00:53:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;If Steven would have put that into the issue description, I would not have complained&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You know, Uwe, I assumed that you would be asleep by now, rather than eagle-eye&apos;ing JIRA in the middle of the night...&lt;/p&gt;

&lt;p&gt;But seriously, I agree, I should have provided some rationale for this change.&lt;/p&gt;</comment>
                    <comment id="13197450" author="steve_rowe" created="Wed, 1 Feb 2012 00:54:31 +0000"  >&lt;p&gt;Committed to trunk and branch_3x.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12512698" name="LUCENE-3743.patch" size="2067" author="steve_rowe" created="Wed, 1 Feb 2012 00:11:44 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 1 Feb 2012 00:15:29 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>226052</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>23956</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
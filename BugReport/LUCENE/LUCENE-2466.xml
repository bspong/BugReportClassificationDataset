<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:16:46 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2466/LUCENE-2466.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2466] fix some more locale problems in lucene/solr</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2466</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;set ANT_ARGS=&quot;-Dargs=-Duser.language=tr -Duser.country=TR&quot;&lt;br/&gt;
ant clean test&lt;/p&gt;

&lt;p&gt;We should make sure this works across all of lucene/solr&lt;/p&gt;</description>
                <environment></environment>
            <key id="12464678">LUCENE-2466</key>
            <summary>fix some more locale problems in lucene/solr</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="rcmuir">Robert Muir</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 May 2010 15:25:09 +0100</created>
                <updated>Wed, 30 Mar 2011 16:50:03 +0100</updated>
                    <resolved>Mon, 17 May 2010 21:51:11 +0100</resolved>
                                            <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12868234" author="rcmuir" created="Mon, 17 May 2010 15:26:08 +0100"  >&lt;p&gt;attached is a patch, then lucene core/contrib is ok.&lt;/p&gt;

&lt;p&gt;But Solr has some failures that must be investigated.&lt;/p&gt;

&lt;p&gt;If no one objects I would like to commit this first and backport, then investigate those.&lt;/p&gt;</comment>
                    <comment id="12868257" author="rcmuir" created="Mon, 17 May 2010 16:48:36 +0100"  >&lt;p&gt;attached is a patch that fixes the tests for solr, too.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;I added StrUtils.ROOT_LOCALE, but we could probably use Locale.ENGLISH just fine too, this is just me being nitpicky.&lt;/li&gt;
	&lt;li&gt;commons-codec fixed this in their 1.4 release, so i upgraded to 1.4 (not in patch, obviously) so that DoubleMetaphoneFilter etc pass also.&lt;/li&gt;
	&lt;li&gt;besides lowercasing, Solr uses uppercasing in a lot of places... in my opinion we should review why it is doing this.&lt;/li&gt;
	&lt;li&gt;I didnt change SolrQueryParser, similar problems exist in Lucene&apos;s QueryParser (strange casing) and thats for another day.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Someone should review the Solr stuff, as I don&apos;t think i necessarily present the best solution but just indicate where the problems are.&lt;/p&gt;
</comment>
                    <comment id="12868264" author="yseeley@gmail.com" created="Mon, 17 May 2010 17:09:55 +0100"  >&lt;p&gt;Awesome!  If we can get the tests to pass with these different locales, commit it!  When in doubt, we should not be sensitive to locale.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I didnt change SolrQueryParser, similar problems exist in Lucene&apos;s QueryParser (strange casing)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The QP shouldn&apos;t currently be an issue for solr, we never set the flags to do lowercasing (I&apos;ve always been against it as the right solution is field specific, not parser specific).&lt;/p&gt;</comment>
                    <comment id="12868286" author="rcmuir" created="Mon, 17 May 2010 18:16:45 +0100"  >&lt;p&gt;here is a cleaned up patch, using Locale.ENGLISH, that fixes the casing problems.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Note the use of Locale.ENGLISH is not an affront to non-english users, it just forces consistent casing behavior and is already defined as a constant.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I plan to commit soon (trunk/stable), and then look at the unrelated separate failures for Thai:&lt;br/&gt;
set ANT_ARGS=&quot;-Dargs=-Duser.language=th -Duser.country=TH -Duser.variant=TH&quot;&lt;/p&gt;

&lt;p&gt;I suspect much of these failures are due to date handling.&lt;/p&gt;

&lt;p&gt;We might want to devise a plan to help test this stuff, either let Hudson pick a different locale each night, maybe just from the &quot;troublesome ones&quot;, and/or do something similar to the LocalizedTestCase in lucene (but this can cause tests to be very slow).&lt;/p&gt;</comment>
                    <comment id="12868308" author="rcmuir" created="Mon, 17 May 2010 18:45:36 +0100"  >&lt;p&gt;Committed 945245 (trunk) /945270 (3x) for the casing problems.&lt;/p&gt;</comment>
                    <comment id="12868319" author="rcmuir" created="Mon, 17 May 2010 18:57:57 +0100"  >&lt;p&gt;attached patch fixes trunk for the thai locale.&lt;/p&gt;

&lt;p&gt;doesnt need to be merged as the tests don&apos;t exist in 3x, i created this problem &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12868321" author="rcmuir" created="Mon, 17 May 2010 18:59:30 +0100"  >&lt;p&gt;Committed revision 945274 for the lucene wildcard/regex tests.&lt;/p&gt;

&lt;p&gt;I will look at the solr problems under this locale now, they probably need to be merged to 3x also.&lt;/p&gt;</comment>
                    <comment id="12868358" author="rcmuir" created="Mon, 17 May 2010 20:22:48 +0100"  >&lt;p&gt;I talked to Hoss Man about some of these date problems, and he was of the opinion that for Solr, the Locale should never be used for date parsing/formatting (only standard UTC/Locale.US). So these are easy to fix.&lt;/p&gt;

&lt;p&gt;But there is another problem, in this case the formats of floats themselves. Should they follow the same rule in Solr, or should localized numerics formats be supported? &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit] Caused by: java.lang.NumberFormatException: For input string: &quot;&amp;lt;some thai digits here&amp;gt;&quot;
   [junit]     at sun.misc.FloatingDecimal.readJavaFormatString(FloatingDecimal.java:1224)
   [junit]     at java.lang.Float.parseFloat(Float.java:422)
   [junit]     at org.apache.solr.util.NumberUtils.float2sortableStr(NumberUtils.java:79)
   [junit]     at org.apache.solr.schema.SortableFloatField.toInternal(SortableFloatField.java:49)
   [junit]     at org.apache.solr.schema.FieldType.createField(FieldType.java:236)
   [junit]     ... 38 more
   [junit] &amp;lt;/result&amp;gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Furthermore, what about DataImportHandlers use of some of the same DateMathParser stuff used in other places in Solr? It tends to use TimeZone.getDefault/Locale.getDefault... should this be changed?&lt;/p&gt;</comment>
                    <comment id="12868372" author="rcmuir" created="Mon, 17 May 2010 20:47:39 +0100"  >&lt;p&gt;attached is a patch with some modifications to Solr, adding missing Locale.US params etc, following Hoss Man&apos;s rule.&lt;/p&gt;

&lt;p&gt;I am still nervous about DIH (i didnt touch it) but this makes all the tests pass under th_TH_TH.&lt;/p&gt;</comment>
                    <comment id="12868380" author="yseeley@gmail.com" created="Mon, 17 May 2010 21:08:03 +0100"  >&lt;p&gt;IMO, there&apos;s nothing in Solr that should depend on the system locale unless explicitly referenced or configured to do so. The defaults should certainly never do so.&lt;/p&gt;

&lt;p&gt;Hoss pointed out this in DIH:&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/solr/DataImportHandler#NumberFormatTransformer&quot; class=&quot;external-link&quot;&gt;http://wiki.apache.org/solr/DataImportHandler#NumberFormatTransformer&lt;/a&gt;&lt;br/&gt;
At a minimum I think this should be changed in trunk to not default to the system locale.&lt;/p&gt;

&lt;p&gt;Anyway, my communication will be limited over the next week starting tomorrow (Apache Lucene EuroCon)...&lt;br/&gt;
so here&apos;s my standing +1 to commit all changes that remove system locale defaults.&lt;/p&gt;</comment>
                    <comment id="12868397" author="rcmuir" created="Mon, 17 May 2010 21:37:58 +0100"  >&lt;p&gt;Committed &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2466&quot; title=&quot;fix some more locale problems in lucene/solr&quot;&gt;&lt;del&gt;LUCENE-2466&lt;/del&gt;&lt;/a&gt;_thai_solr.patch 945343 (trunk) / 945353 (3x)&lt;/p&gt;</comment>
                    <comment id="12868402" author="rcmuir" created="Mon, 17 May 2010 21:51:11 +0100"  >&lt;p&gt;I ran a few more locales, no more failures... I think we found the worst problems.&lt;/p&gt;</comment>
                    <comment id="12874162" author="rcmuir" created="Tue, 1 Jun 2010 20:01:03 +0100"  >&lt;p&gt;setting fix versions correctly here.&lt;/p&gt;

&lt;p&gt;happy to backport this stuff to 1.4.1 if desired.&lt;/p&gt;</comment>
                    <comment id="13013348" author="gsingers" created="Wed, 30 Mar 2011 16:50:03 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="12310000">
                <name>Duplicate</name>
                                                <inwardlinks description="is duplicated by">
                            <issuelink>
            <issuekey id="12493004">SOLR-2281</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12444682" name="LUCENE-2466_coretests.patch" size="2276" author="rcmuir" created="Mon, 17 May 2010 15:26:08 +0100" />
                    <attachment id="12444717" name="LUCENE-2466_lucene_thai.patch" size="1846" author="rcmuir" created="Mon, 17 May 2010 18:57:57 +0100" />
                    <attachment id="12444707" name="LUCENE-2466.patch" size="35016" author="rcmuir" created="Mon, 17 May 2010 18:16:45 +0100" />
                    <attachment id="12444695" name="LUCENE-2466.patch" size="38798" author="rcmuir" created="Mon, 17 May 2010 16:48:36 +0100" />
                    <attachment id="12444732" name="LUCENE-2466_thai_solr.patch" size="6811" author="rcmuir" created="Mon, 17 May 2010 20:47:38 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>5.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 17 May 2010 16:09:55 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11353</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25226</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
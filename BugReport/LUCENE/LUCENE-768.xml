<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:03:06 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-768/LUCENE-768.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-768] Exception in deleteDocument, undeleteAll or setNorm in IndexReader can fail to release write lock on close</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-768</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;I hit this while working on &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-140&quot; title=&quot;docs out of order&quot;&gt;&lt;del&gt;LUCENE-140&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We have 3 cases in the IndexReader methods above where we have this pattern:&lt;/p&gt;

&lt;p&gt;  if (directoryOwner) acquireWriteLock();&lt;br/&gt;
  doSomething();&lt;br/&gt;
  hasChanges = true;&lt;/p&gt;

&lt;p&gt;The problem is if you hit an exception in doSomething(), and hasChanges was not already true, then hasChanges will not have been set to true yet the write lock is held.  If you then try to close the reader without making any other changes, then the write lock is not released because in IndexReader.close() (well, in commit()) we only release write lock if hasChanges is true.&lt;/p&gt;

&lt;p&gt;I think the simple fix is to swap the order of hasChanges = true and doSomething().  I already fixed one case of this under &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-140&quot; title=&quot;docs out of order&quot;&gt;&lt;del&gt;LUCENE-140&lt;/del&gt;&lt;/a&gt; commit yesterday; I will fix the other two under this issue.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12360100">LUCENE-768</key>
            <summary>Exception in deleteDocument, undeleteAll or setNorm in IndexReader can fail to release write lock on close</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Jan 2007 16:51:52 +0000</created>
                <updated>Tue, 27 Feb 2007 18:10:39 +0000</updated>
                    <resolved>Tue, 9 Jan 2007 17:38:50 +0000</resolved>
                            <version>1.9</version>
                <version>2.0.0</version>
                <version>2.1</version>
                                <fixVersion>2.1</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12476280" author="mikemccand" created="Tue, 27 Feb 2007 18:10:39 +0000"  >&lt;p&gt;Closing all issues that were resolved for 2.1.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12984</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26962</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
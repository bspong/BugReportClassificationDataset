<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:27:34 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2772/LUCENE-2772.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2772] Make SlowMultiReaderWrapper wrap always so close() is safe</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2772</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;The overhead when wrapping an atomic reader using SlowMultiReaderWrapper is very low, the work done in the static wrap method is much higher (instantiate ArrayList, recusively went through all subreaders), just to check the number of readers than simply always wrapping.&lt;/p&gt;

&lt;p&gt;MultiFields already is optimized when called by one-segment or atomic readers, so there is no overhead at all. So this patch removes the static wrap method and you simply wrap like a TokenFilter with ctor: new SlowMultiReaderWrapper(reader)&lt;/p&gt;

&lt;p&gt;When this is done, there is also no risk to close a SegmentReader (which you should not do), when wrap() returns a single SegmentReader. This help in parent issue with cleaning up the case in close().&lt;/p&gt;

&lt;p&gt;The patch a&#246;lso removes the now useless mainReader/reader variables and simply closes the wrapper.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12480452">LUCENE-2772</key>
            <summary>Make SlowMultiReaderWrapper wrap always so close() is safe</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                    <parent id="12480438">LUCENE-2771</parent>
                        <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Nov 2010 21:47:36 +0000</created>
                <updated>Fri, 10 May 2013 11:43:14 +0100</updated>
                    <resolved>Sat, 20 Nov 2010 18:48:02 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12934027" author="thetaphi" created="Fri, 19 Nov 2010 22:29:07 +0000"  >&lt;p&gt;Here the patch:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;When SlowMultiReaderWrapper will in future clean up the cache on close, the tests should not simply only close inner reader but instead close wrapper reader (which only delegates currently). This is also the only correct usage for Decoration pattern (see TokenFilter &amp;amp; co.)&lt;/li&gt;
	&lt;li&gt;TestFilterIndexReader had a bug when the &quot;source&quot; index has more than one segment, this is fixed now, because we always wrap and wrapped reader delegates close.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12934119" author="mikemccand" created="Sat, 20 Nov 2010 10:10:11 +0000"  >&lt;p&gt;Looks great Uwe!&lt;/p&gt;</comment>
                    <comment id="12934165" author="thetaphi" created="Sat, 20 Nov 2010 18:48:02 +0000"  >&lt;p&gt;Committed revision: 1037294&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12460064" name="LUCENE-2772.patch" size="22571" author="thetaphi" created="Fri, 19 Nov 2010 22:29:07 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 20 Nov 2010 10:10:11 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11081</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24920</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
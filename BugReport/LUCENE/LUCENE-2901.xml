<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:19:29 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2901/LUCENE-2901.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2901] KeywordMarkerFilter resets keyword attribute state to false for tokens not in protwords.txt</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2901</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;KeywordMarkerFilter sets true or false for the KeywordAttribute on all tokens. This erases previous state established further up the filter chain, for example in the case where a custom filter wants to prevent a token from being stemmed. &lt;/p&gt;

&lt;p&gt;If a token is already marked as a keyword (KeywordAttribute.isKeyword() == true), perhaps the KeywordMarkerFilterFactory should not re-set the state to false.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12497165">LUCENE-2901</key>
            <summary>KeywordMarkerFilter resets keyword attribute state to false for tokens not in protwords.txt</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="drew.farris">Drew Farris</reporter>
                        <labels>
                    </labels>
                <created>Sun, 30 Jan 2011 17:49:49 +0000</created>
                <updated>Wed, 30 Mar 2011 16:50:32 +0100</updated>
                    <resolved>Mon, 31 Jan 2011 14:46:07 +0000</resolved>
                            <version>3.1</version>
                                <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>modules/analysis</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12988618" author="rcmuir" created="Sun, 30 Jan 2011 18:00:25 +0000"  >&lt;p&gt;Hi Drew, I agree this is a bug.&lt;/p&gt;

&lt;p&gt;I think it should simply do what the javadoc says:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (keywordSet.contains(word))
  keywordAtt.setKeyword(true);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    <comment id="12988621" author="simonw" created="Sun, 30 Jan 2011 18:05:17 +0000"  >&lt;blockquote&gt;&lt;p&gt;If a token is already marked as a keyword (KeywordAttribute.isKeyword() == true), perhaps the KeywordMarkerFilterFactory should not re-set the state to false.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;hey Drew, I think I see you point here but I disagree that we should consider the previous state of the KeywordAttribute in this filter. IMO this filter is very clearly defined and extremely simple. If you want it to have different behavior eg. considering the attrs state you can simply write your own filter that. This one is more or less just a simple PoC how the KeywordAttribute works / should be used etc. &lt;/p&gt;

&lt;p&gt;I think if we change the behavior we will have JIRA issues that say &quot;KeywordMarkerFilter does not reset attribute state to false for tokens not in protwords.txt&quot;  - you know what I mean, this one is tricky and special use-cases should have their own kind of trivial impls.&lt;/p&gt;</comment>
                    <comment id="12988622" author="rcmuir" created="Sun, 30 Jan 2011 18:07:55 +0000"  >&lt;p&gt;Simon, i think the key point here is that the code does this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;keywordAtt.setKeyword(keywordSet.contains(word));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I am suggesting this be changed to:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (keywordSet.contains(word))
  keywordAtt.setKeyword(true);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is more consistent with what the javadoc says it does: it doesn&apos;t speak of unsetting any attributes.&lt;/p&gt;</comment>
                    <comment id="12988624" author="simonw" created="Sun, 30 Jan 2011 18:13:43 +0000"  >&lt;blockquote&gt;&lt;p&gt;Simon, i think the key point here is that the code does this:&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;so lets not rush on this - As far as I can recall this has not been released right? so we might rather figure out what makes most sense, fixing code or fixing javadoc. if you have 4 filters A  &amp;lt; &amp;#8211; A_kw &amp;lt; &amp;#8211; B &amp;lt;--  B_kw &amp;lt;-- Tokenizer and the term is in B_kw but not in A_kw the current code does the right thing while the change you suggest doesn&apos;t IMO. So I wonder if we should rather fix the javadoc than the code. I mean if somebody needs this behavior this is super simple to implement. Or maybe we have an option to reset keyword or not?&lt;/p&gt;</comment>
                    <comment id="12988625" author="rcmuir" created="Sun, 30 Jan 2011 18:17:39 +0000"  >&lt;p&gt;Honestly I didnt know the filter did what drew reported, or i would have raised this bug myself.&lt;/p&gt;

&lt;p&gt;The problem is this is inconsistent even with the other filters that use keyword attribute.&lt;br/&gt;
Its more obvious with the decorator pattern that if you have:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;KeywordFilter( { &quot;dogs&quot;, &quot;birds&quot;, &quot;trees&quot;, &quot;houses&quot; })
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That this is equivalent to:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;KeywordFilter( { &quot;dogs&quot;, &quot;birds&quot; } )
KeywordFilter( { &quot;trees&quot;, &quot;houses&quot; })
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is how all the other tokenstreams work, e.g. StopFilter etc.&lt;/p&gt;</comment>
                    <comment id="12988626" author="simonw" created="Sun, 30 Jan 2011 18:23:10 +0000"  >&lt;blockquote&gt;
&lt;p&gt;if (keywordSet.contains(word))&lt;br/&gt;
  keywordAtt.setKeyword(true);&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I just looked at the code and that change makes sense actually - it should really be consistent to StopFitler etc.&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12988631" author="drew.farris" created="Sun, 30 Jan 2011 18:44:15 +0000"  >&lt;p&gt;Revised patch that implements:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (keywordSet.contains(word))
  keywordAtt.setKeyword(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                    <comment id="12988777" author="rcmuir" created="Mon, 31 Jan 2011 14:46:08 +0000"  >&lt;p&gt;Committed revision 1065621, 1065626 (branch_3x)&lt;/p&gt;

&lt;p&gt;Thanks Drew... glad you caught this one!&lt;/p&gt;</comment>
                    <comment id="13013515" author="gsingers" created="Wed, 30 Mar 2011 16:50:32 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12469785" name="LUCENE-2901.patch" size="779" author="drew.farris" created="Sun, 30 Jan 2011 18:44:15 +0000" />
                    <attachment id="12469782" name="LUCENE-2901.patch" size="781" author="drew.farris" created="Sun, 30 Jan 2011 17:53:45 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sun, 30 Jan 2011 18:00:25 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>10967</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24791</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
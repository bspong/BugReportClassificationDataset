<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:16:49 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2155/LUCENE-2155.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2155] random localization test failures</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2155</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Some tests fail randomly (hard to reproduce). It appears to me that this is caused by uninitialized date fields. For example Uwe reported a failure today in this test of TestQueryParser:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 /** &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; testing legacy DateField support */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testLegacyDateRange() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; startDate = getLocalizedDate(2002, 1, 1, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; endDate = getLocalizedDate(2002, 1, 4, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;if you look at the helper getLocalizedDate, you can see if the 4th argument is false, it does not initialize all date field functions.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getLocalizedDate(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; year, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; month, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; day, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; extendLastDate) {
 Calendar calendar = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GregorianCalendar();
 calendar.set(year, month, day);
 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (extendLastDate) {
      calendar.set(Calendar.HOUR_OF_DAY, 23);
      calendar.set(Calendar.MINUTE, 59);
      calendar.set(Calendar.SECOND, 59);
 ...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think the solution to this is that in all tests, whereever we create new GregorianCalendar(), it should be followed by a call to Calendar.clear().&lt;br/&gt;
This will ensure that we always initialize unused calendar fields to zero, rather than being dependent on the local time.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12443268">LUCENE-2155</key>
            <summary>random localization test failures</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="rcmuir">Robert Muir</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Dec 2009 13:52:12 +0000</created>
                <updated>Fri, 10 May 2013 11:44:41 +0100</updated>
                    <resolved>Mon, 14 Dec 2009 17:33:29 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12790214" author="rcmuir" created="Mon, 14 Dec 2009 15:58:41 +0000"  >&lt;p&gt;attached is a patch that not only clears all Calendar attributes to erase anything dependent on local time, but also ensures the same hour/minute/second/millisecond is used for actual and expected.&lt;/p&gt;

&lt;p&gt;This is because the date in the test (2002/1/4) becomes two different Thai dates, depending upon the hour of day, timezone, etc.&lt;/p&gt;

&lt;p&gt;The expected end date was always 4/2/2545, because these were set. But the actual end date would sometimes be 3/2/2545, depending upon when and where you ran the tests.&lt;/p&gt;</comment>
                    <comment id="12790251" author="rcmuir" created="Mon, 14 Dec 2009 17:33:18 +0000"  >&lt;p&gt;Committed revision 890407.&lt;/p&gt;

&lt;p&gt;This may not be the complete solution, but its at least an improvement. I still do not trust these tests are doing exactly what we think...&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12427937" name="LUCENE-2155.patch" size="11038" author="rcmuir" created="Mon, 14 Dec 2009 15:58:41 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11628</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25570</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:33:32 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3572/LUCENE-3572.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3572] MultiIndexDocValues pretends it can merge sorted sources</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3572</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Nightly build hit this failure:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ant test-core -Dtestcase=TestSort -Dtestmethod=testReverseSort -Dtests.seed=791b126576b0cfab:-48895c7243ecc5d0:743c683d1c9f7768 -Dtests.multiplier=3 -Dargs=&quot;-Dfile.encoding=ISO8859-1&quot;

    [junit] Testcase: testReverseSort(org.apache.lucene.search.TestSort):	Caused an ERROR
    [junit] expected:&amp;lt;[CEGIA]&amp;gt; but was:&amp;lt;[ACEGI]&amp;gt;
    [junit] 	at org.apache.lucene.search.TestSort.assertMatches(TestSort.java:1248)
    [junit] 	at org.apache.lucene.search.TestSort.assertMatches(TestSort.java:1216)
    [junit] 	at org.apache.lucene.search.TestSort.testReverseSort(TestSort.java:759)
    [junit] 	at org.apache.lucene.util.LuceneTestCase$3$1.evaluate(LuceneTestCase.java:523)
    [junit] 	at org.apache.lucene.util.LuceneTestCaseRunner.runChild(LuceneTestCaseRunner.java:149)
    [junit] 	at org.apache.lucene.util.LuceneTestCaseRunner.runChild(LuceneTestCaseRunner.java:51)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It&apos;s happening in the test for reverse-sort of a string field with DocValues, when the test had gotten SlowMultiReaderWrapper.&lt;/p&gt;

&lt;p&gt;I committed a fix to the test to avoid testing this case, but we need a better fix to the underlying bug.&lt;/p&gt;

&lt;p&gt;MultiIndexDocValues cannot merge sorted sources (I think?), yet somehow it&apos;s pretending it can (in the above test, the three subs had BYTES_FIXED_SORTED type, and the TypePromoter happily claims to merge these to BYTES_FIXED_SORTED; I think MultiIndexDocValues should return null for the sorted source in this case?&lt;/p&gt;</description>
                <environment></environment>
            <key id="12531320">LUCENE-3572</key>
            <summary>MultiIndexDocValues pretends it can merge sorted sources</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Nov 2011 13:49:51 +0000</created>
                <updated>Fri, 10 May 2013 11:43:09 +0100</updated>
                    <resolved>Tue, 15 Nov 2011 19:17:27 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13150391" author="simonw" created="Tue, 15 Nov 2011 11:33:28 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think MultiIndexDocValues should return null for the sorted source in this case?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;afaik, this is what it does so I think this test should fail with a NPE no?&lt;/p&gt;</comment>
                    <comment id="13150685" author="mikemccand" created="Tue, 15 Nov 2011 19:11:35 +0000"  >&lt;p&gt;OK I mis-diagnosed this!&lt;/p&gt;

&lt;p&gt;Indeed the MultiIndexDV.getSource().asSortedSource is returning null,&lt;br/&gt;
but then the FieldComparator was swapping in the default source (all&lt;br/&gt;
docs have empty byte[]) in this case, which I think is wrong.  Ie, I&lt;br/&gt;
think user should see a hard exception if they try to use this&lt;br/&gt;
FieldComp on a field whose doc values cannot provide a sorted source.&lt;/p&gt;

&lt;p&gt;So I made a small patch w/ that change (attached)... tests pass.  I&apos;ll&lt;br/&gt;
commit shortly.&lt;/p&gt;</comment>
                    <comment id="13150792" author="simonw" created="Tue, 15 Nov 2011 21:35:01 +0000"  >&lt;p&gt;+1 patch looks good to me&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12503779" name="LUCENE-3572.patch" size="1263" author="mikemccand" created="Tue, 15 Nov 2011 19:11:35 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 15 Nov 2011 11:33:28 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>217057</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24125</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
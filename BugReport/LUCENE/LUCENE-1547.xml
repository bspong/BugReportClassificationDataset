<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:01:59 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1547/LUCENE-1547.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1547] Rare thread hazard in IndexWriter.commit()</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1547</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;The nightly build 2 nights ago hit this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; NOTE: random seed of testcase &apos;testAtomicUpdates&apos; was: -5065675995121791051
    [junit] ------------- ---------------- ---------------
    [junit] Testcase: testAtomicUpdates(org.apache.lucene.index.TestAtomicUpdate):	FAILED
    [junit] expected:&amp;lt;100&amp;gt; but was:&amp;lt;91&amp;gt;
    [junit] junit.framework.AssertionFailedError: expected:&amp;lt;100&amp;gt; but was:&amp;lt;91&amp;gt;
    [junit] 	at org.apache.lucene.index.TestAtomicUpdate.runTest(TestAtomicUpdate.java:142)
    [junit] 	at org.apache.lucene.index.TestAtomicUpdate.testAtomicUpdates(TestAtomicUpdate.java:194)
    [junit] 	at org.apache.lucene.util.LuceneTestCase.runTest(LuceneTestCase.java:88)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It&apos;s an intermittant failure that only happens when multiple threads&lt;br/&gt;
are calling commit() at once.  With autoComit=true and&lt;br/&gt;
ConcurrentMergeScheduler, this can happen more often because each&lt;br/&gt;
merge thread calls commit after it&apos;s done.&lt;/p&gt;

&lt;p&gt;The problem happens when one thread has already begun the commit&lt;br/&gt;
process, but another two or more threads then come along wanting to&lt;br/&gt;
also commit after further changes have happened.  Those two or more&lt;br/&gt;
threads would wait until the currently committing thread finished, and&lt;br/&gt;
then they&apos;d wake up and do their commit.  The problem was, after&lt;br/&gt;
waking up they would fail to check whether they had been superseded,&lt;br/&gt;
ie whether another thread had already committed more up-to-date&lt;br/&gt;
changes.&lt;/p&gt;

&lt;p&gt;The fix is simple &amp;#8211; after waking up, check again if your commit has&lt;br/&gt;
been superseded, and skip your commit if so.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12415301">LUCENE-1547</key>
            <summary>Rare thread hazard in IndexWriter.commit()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Sun, 22 Feb 2009 12:17:08 +0000</created>
                <updated>Fri, 25 Sep 2009 17:23:18 +0100</updated>
                    <resolved>Tue, 24 Feb 2009 10:41:23 +0000</resolved>
                            <version>2.4</version>
                                <fixVersion>2.4.1</fixVersion>
                <fixVersion>2.9</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12675644" author="mikemccand" created="Sun, 22 Feb 2009 12:18:03 +0000"  >&lt;p&gt;Attached patch.  I plan to commit in a day or so.&lt;/p&gt;</comment>
                    <comment id="12676235" author="mikemccand" created="Tue, 24 Feb 2009 10:41:23 +0000"  >&lt;p&gt;Fixed on 2.9 &amp;amp; 2.4.1.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12400693" name="LUCENE-1547.patch" size="5542" author="mikemccand" created="Sun, 22 Feb 2009 12:18:03 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12207</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26182</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:21:11 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2006/LUCENE-2006.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2006] Optimization for FieldDocSortedHitQueue</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2006</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;When updating core for generics,  I found the following as a optimization of FieldDocSortedHitQueue:&lt;/p&gt;

&lt;p&gt;All FieldDoc values are Compareables (also the score or docid, if they&lt;br/&gt;
appear as SortField in a MultiSearcher or ParallelMultiSearcher). The code&lt;br/&gt;
of lessThan seems very ineffective, as it has a big switch statement on the&lt;br/&gt;
SortField type, then casts the value to the underlying numeric type Object,&lt;br/&gt;
calls Number.xxxValue() &amp;amp; co for it and then compares manually. As&lt;br/&gt;
j.l.Number is itself Comparable, I see no reason to do this. Just call&lt;br/&gt;
compareTo on the Comparable interface and we are happy. The big deal is that&lt;br/&gt;
it prevents casting and the two method calls xxxValue(), as Number.compareTo&lt;br/&gt;
works more efficient internally.&lt;/p&gt;

&lt;p&gt;The only special cases are String sort, where the Locale may be used and the&lt;br/&gt;
score sorting which is backwards. But these are two if statements instead of&lt;br/&gt;
the whole switch.&lt;/p&gt;

&lt;p&gt;I had not tested it now for performance, but in my opinion it should be&lt;br/&gt;
faster for MultiSearchers. All tests still pass (because they should).&lt;/p&gt;</description>
                <environment></environment>
            <key id="12438956">LUCENE-2006</key>
            <summary>Optimization for FieldDocSortedHitQueue</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Oct 2009 20:52:06 +0100</created>
                <updated>Sun, 10 Oct 2010 23:17:25 +0100</updated>
                    <resolved>Sat, 24 Oct 2009 00:10:31 +0100</resolved>
                            <version>3.0</version>
                                <fixVersion>3.0</fixVersion>
                                <component>core/search</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12769386" author="thetaphi" created="Fri, 23 Oct 2009 20:52:42 +0100"  >&lt;p&gt;Patch.&lt;/p&gt;</comment>
                    <comment id="12769389" author="thetaphi" created="Fri, 23 Oct 2009 20:53:27 +0100"  >&lt;p&gt;Mark Miller on java-dev:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Nice! I like it. Even if its not much faster (havn&apos;t checked either), I&lt;br/&gt;
can&apos;t see it being much slower and its cleaner code.&lt;/p&gt;

&lt;p&gt;I&apos;d be happy to do some quick perf tests when I get a chance, but I&apos;m +1&lt;br/&gt;
on it.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                    <comment id="12769398" author="thetaphi" created="Fri, 23 Oct 2009 21:02:40 +0100"  >&lt;p&gt;Is there any MultiSearcher related task/alg in contrib/benchmark or somewhere in JIRA?&lt;/p&gt;</comment>
                    <comment id="12769404" author="thetaphi" created="Fri, 23 Oct 2009 21:15:41 +0100"  >&lt;p&gt;The reason why this code looked like this is simple (from SVN log): at the beginning the FieldDoc values were just &quot;Object[] fields&quot;. So the casts were needed. After adding custom comparators they get &quot;Comparable&quot;. So there was no real perf idea behind doing it so complicated and ineffective.&lt;/p&gt;</comment>
                    <comment id="12769509" author="markrmiller@gmail.com" created="Fri, 23 Oct 2009 23:46:14 +0100"  >&lt;p&gt;Okay Uwe -&lt;/p&gt;

&lt;p&gt;I took a 2 GB zipped Wiki dump and used a SkipDocTask to create four unique indices of 64,000 docs each.&lt;/p&gt;

&lt;p&gt;Then I ran a search matching all docs and sorting on title, taking the average of 1000 runs and recording that overage over a few times for each method.&lt;/p&gt;

&lt;p&gt;I tried topn&apos;s of 10, 100, and 1000.&lt;/p&gt;

&lt;p&gt;I couldn&apos;t measure a meaningful difference one way or the other. Lets do it.&lt;/p&gt;</comment>
                    <comment id="12769515" author="thetaphi" created="Fri, 23 Oct 2009 23:52:31 +0100"  >&lt;p&gt;I think it is because you only merge the top 1000 docs into the HitQueue. The merging of the HQs at the end of search is simple, because it only merges the top n docs of each queue. You would only see a difference if you sort all hits.&lt;/p&gt;

&lt;p&gt;I think we can commit this, too.&lt;/p&gt;</comment>
                    <comment id="12769521" author="markrmiller@gmail.com" created="Sat, 24 Oct 2009 00:03:28 +0100"  >&lt;p&gt;Right - I don&apos;t think we have to worry about things much over top 1000.&lt;/p&gt;

&lt;p&gt;And while I don&apos;t want to take the time to do top 4*64,000, for kicks I tried top 64,000 over a couple runs.&lt;/p&gt;

&lt;p&gt;It actually does show a 2-3% win with the new method once you get up that high &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Its somethin&apos; anyway &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12769522" author="thetaphi" created="Sat, 24 Oct 2009 00:06:37 +0100"  >&lt;p&gt;OK, I commit soon!&lt;/p&gt;</comment>
                    <comment id="12769524" author="thetaphi" created="Sat, 24 Oct 2009 00:10:31 +0100"  >&lt;p&gt;Committed revision: 829274&lt;/p&gt;

&lt;p&gt;Thanks Mark for perf testing!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12423053" name="LUCENE-2006.patch" size="4107" author="thetaphi" created="Fri, 23 Oct 2009 20:52:42 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Fri, 23 Oct 2009 22:46:14 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11767</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25719</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
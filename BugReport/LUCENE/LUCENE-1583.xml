<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:27:37 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1583/LUCENE-1583.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1583] SpanOrQuery skipTo() doesn&apos;t always move forwards</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1583</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;In SpanOrQuery the skipTo() method is improperly implemented if the target doc is less than or equal to the current doc, since skipTo() may not be called for any of the clauses&apos; spans:&lt;/p&gt;

&lt;p&gt;    public boolean skipTo(int target) throws IOException {&lt;br/&gt;
          if (queue == null) &lt;/p&gt;
{
            return initSpanQueue(target);
          }&lt;br/&gt;
&lt;br/&gt;
          while (queue.size() != 0 &amp;amp;&amp;amp; top().doc() &amp;lt; target) {&lt;br/&gt;
            if (top().skipTo(target)) {
              queue.adjustTop();
            } else {
              queue.pop();
            }&lt;br/&gt;
          }&lt;br/&gt;
          &lt;br/&gt;
        	return queue.size() != 0;&lt;br/&gt;
        }&lt;br/&gt;
&lt;br/&gt;
This violates the correct behavior (as described in the Spans interface documentation), that skipTo() should always move forwards, in other words the correct implementation would be:&lt;br/&gt;
&lt;br/&gt;
    public boolean skipTo(int target) throws IOException {&lt;br/&gt;
          if (queue == null) {
            return initSpanQueue(target);
          }

&lt;p&gt;          boolean skipCalled = false;&lt;br/&gt;
          while (queue.size() != 0 &amp;amp;&amp;amp; top().doc() &amp;lt; target) {&lt;br/&gt;
            if (top().skipTo(target)) &lt;/p&gt;
{
              queue.adjustTop();
            }
&lt;p&gt; else &lt;/p&gt;
{
              queue.pop();
            }
&lt;p&gt;            skipCalled = true;&lt;br/&gt;
          }&lt;/p&gt;

&lt;p&gt;          if (skipCalled) &lt;/p&gt;
{
        	return queue.size() != 0;
          }
&lt;p&gt;          return next();&lt;br/&gt;
        }&lt;/p&gt;</description>
                <environment></environment>
            <key id="12421865">LUCENE-1583</key>
            <summary>SpanOrQuery skipTo() doesn&apos;t always move forwards</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                <reporter username="motinis">Moti Nisenson</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Apr 2009 14:07:09 +0100</created>
                <updated>Fri, 25 Sep 2009 17:23:21 +0100</updated>
                    <resolved>Tue, 14 Jul 2009 22:03:21 +0100</resolved>
                            <version>1.9</version>
                <version>2.0.0</version>
                <version>2.1</version>
                <version>2.2</version>
                <version>2.3</version>
                <version>2.3.1</version>
                <version>2.3.2</version>
                <version>2.4</version>
                <version>2.4.1</version>
                                <fixVersion>2.9</fixVersion>
                                <component>core/search</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12695008" author="mikemccand" created="Thu, 2 Apr 2009 15:00:45 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1327&quot; title=&quot;TermSpans skipTo() doesn&amp;#39;t always move forwards&quot;&gt;&lt;del&gt;LUCENE-1327&lt;/del&gt;&lt;/a&gt; was a similar issue.&lt;/p&gt;</comment>
                    <comment id="12718290" author="markrmiller@gmail.com" created="Thu, 11 Jun 2009 04:30:30 +0100"  >&lt;p&gt;I havn&apos;t looked closely at it yet, but tests appear to pass (unknown if tests actually hit skipto on SpanOrQuery though)&lt;/p&gt;</comment>
                    <comment id="12719628" author="markrmiller@gmail.com" created="Mon, 15 Jun 2009 17:27:52 +0100"  >&lt;p&gt;I guess I&apos;ll do this one.&lt;/p&gt;

&lt;p&gt;You out there reading Paul Elschot? This look right to you? Any issues it might cause?&lt;/p&gt;

&lt;p&gt;Else I guess I&apos;ll have to put on my thinking cap and figure it myself.&lt;/p&gt;</comment>
                    <comment id="12719811" author="paul.elschot@xs4all.nl" created="Mon, 15 Jun 2009 23:08:51 +0100"  >&lt;p&gt;Midnight here, still reading &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;The patch looks good. However, it might be easier to understand by starting like this after the queue initialisation:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!next()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and leave the rest of the code as it is.&lt;/p&gt;

&lt;p&gt;I did not run any tests on this, so a thinking cap might well save time.&lt;/p&gt;</comment>
                    <comment id="12721858" author="markrmiller@gmail.com" created="Fri, 19 Jun 2009 17:19:29 +0100"  >&lt;p&gt;That change would always call next once before skipping though right? And the way the patch is, you would only call next if no skipping occurred? I know its semantically the same, and I guess the clarity is probably worth any (probably extremely minor) slowdown?&lt;/p&gt;</comment>
                    <comment id="12723587" author="markrmiller@gmail.com" created="Wed, 24 Jun 2009 15:54:48 +0100"  >&lt;p&gt;I&apos;m going to commit this soon.&lt;/p&gt;</comment>
                    <comment id="12731078" author="markrmiller@gmail.com" created="Tue, 14 Jul 2009 20:47:47 +0100"  >&lt;p&gt;Adds a Unit test and Changes entry&lt;/p&gt;</comment>
                    <comment id="12731129" author="markrmiller@gmail.com" created="Tue, 14 Jul 2009 22:03:21 +0100"  >&lt;p&gt;Thanks Moti!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12413473" name="LUCENE-1583.patch" size="2254" author="markrmiller@gmail.com" created="Tue, 14 Jul 2009 20:47:47 +0100" />
                    <attachment id="12410357" name="LUCENE-1583.patch" size="904" author="markrmiller@gmail.com" created="Thu, 11 Jun 2009 04:30:30 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 2 Apr 2009 14:00:45 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12172</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26146</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
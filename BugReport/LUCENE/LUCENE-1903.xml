<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 12:57:43 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1903/LUCENE-1903.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1903] Incorrect ShingleFilter behavior when outputUnigrams == false</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1903</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;ShingleFilter isn&apos;t working as expected when outputUnigrams == false. In particular, it is outputting unigrams at least some of the time when outputUnigrams==false.&lt;/p&gt;

&lt;p&gt;I&apos;ll attach a patch to ShingleFilterTest.java that adds some test cases that demonstrate the problem.&lt;/p&gt;

&lt;p&gt;I haven&apos;t checked this, but I hypothesize that the behavior for outputUnigrams == false got changed when the class was upgraded to the new TokenStream API?&lt;/p&gt;</description>
                <environment></environment>
            <key id="12435152">LUCENE-1903</key>
            <summary>Incorrect ShingleFilter behavior when outputUnigrams == false</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="ryguasu">Chris Harris</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Sep 2009 21:55:40 +0100</created>
                <updated>Mon, 16 May 2011 19:15:35 +0100</updated>
                    <resolved>Wed, 9 Sep 2009 07:07:20 +0100</resolved>
                            <version>2.9</version>
                                <fixVersion>2.9</fixVersion>
                                <component>modules/analysis</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12752743" author="ryguasu" created="Tue, 8 Sep 2009 22:05:05 +0100"  >&lt;p&gt;Attaching a patch that adds three new ShingleFilter tests. Two of the new tests do not pass; these are testBiGramFilterWithoutUnigrams and testBiGramFilterWithSingleTokenWithoutUnigrams.&lt;/p&gt;

&lt;p&gt;Also attaching the XML output from my junit run.&lt;/p&gt;</comment>
                    <comment id="12752750" author="thetaphi" created="Tue, 8 Sep 2009 22:17:06 +0100"  >&lt;p&gt;Did the test pass with 2.4.1?&lt;/p&gt;

&lt;p&gt;If yes, it&apos;s caused by the rewrite and could you please assign 2.9 as the affected version? I think Michael Busch did this TokenFilter, maybe he understands the shingle code.&lt;/p&gt;</comment>
                    <comment id="12752771" author="ryguasu" created="Tue, 8 Sep 2009 22:54:26 +0100"  >&lt;p&gt;Here is the equivalent patch for lucene 2.4.1. The six tests all pass.&lt;/p&gt;</comment>
                    <comment id="12752774" author="ryguasu" created="Tue, 8 Sep 2009 22:55:01 +0100"  >&lt;p&gt;Oops. Wrong license option first time.&lt;/p&gt;</comment>
                    <comment id="12752776" author="ryguasu" created="Tue, 8 Sep 2009 22:56:37 +0100"  >&lt;p&gt;Mark 2.9 as the affected version, according to Uwe&apos;s instructions.&lt;/p&gt;</comment>
                    <comment id="12752789" author="hossman" created="Tue, 8 Sep 2009 23:17:05 +0100"  >&lt;p&gt;since this is code that worked in 2.4.1, it should probably block 2.9 (at least untill the scope is understood &amp;#8211; a concious choice could be made to release with it as a known bug)&lt;/p&gt;</comment>
                    <comment id="12752791" author="markrmiller@gmail.com" created="Tue, 8 Sep 2009 23:22:52 +0100"  >&lt;p&gt;Hmm - I think Busch might be on Vacation.&lt;/p&gt;

&lt;p&gt;I&apos;d hate to release with a known bug ...&lt;/p&gt;

&lt;p&gt;I already owe Uwe beer, so not sure what else I can offer ... &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12752792" author="thetaphi" created="Tue, 8 Sep 2009 23:25:25 +0100"  >&lt;p&gt;This patch seems to fix this issue. All tests pass.&lt;/p&gt;

&lt;p&gt;This patch also removes an unnecessary isEmpty() check (because fillShingleBuffer already returned false, if empty). I also replace remove(0) by removeFirst(), which is faster for linked lists.&lt;/p&gt;</comment>
                    <comment id="12752795" author="thetaphi" created="Tue, 8 Sep 2009 23:34:31 +0100"  >&lt;p&gt;...hm, a beer is ok until now. A beer and a meal is needed if I also understand the whole filter (I am still in the dark) - this filter is complicated so late in the evening.&lt;br/&gt;
As far as I understand, this should be the correct fix. The problem was in the change from the output buffer to the on-the-fly iterator.&lt;/p&gt;</comment>
                    <comment id="12752813" author="thetaphi" created="Wed, 9 Sep 2009 00:01:19 +0100"  >&lt;p&gt;Chris: Could you test this patch, if it works as exspected also for you. Maybe I found a fix only valid for your testcase but not other cases. In my opinion, the code works now identical to the 2.4.1 one (without the output buffer). Unigrams are simply detected by shingleBufferPosition==0. The position increments are also tested by your code and the implementation also looks right. In principle, there was only missing the increment of the shingleBufferPosition if no unigrams are provided.&lt;/p&gt;

&lt;p&gt;Mark: If you want to build RC3 soon, just assign yourself and commit this fix. I will go to bed now. I will commit this tomorrow, if you hadn&apos;t. A CHANGES.txt entry is not needed in my opinion, as this is not a new feature or a bug from 2.4.1.&lt;/p&gt;</comment>
                    <comment id="12752818" author="markrmiller@gmail.com" created="Wed, 9 Sep 2009 00:08:48 +0100"  >&lt;p&gt;Okay - I&apos;m not sure if I&apos;ll short for tonight or the morning yet (not so late here).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;A CHANGES.txt entry is not needed in my opinion, as this is not a new feature or a bug from 2.4.1.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This could prob be debated from a lot of angles - in the end, it appears pretty much up to each committer what they do -&lt;/p&gt;

&lt;p&gt;My rule of thumb has been - when it comes to me, be modest, skip where it makes sense. But when it comes to someone else having reported&lt;br/&gt;
the issue - I always add a credit somehow. Outside contributions (in whatever form) deserves credit for reporting things and suppling things (especially tests), and I think it encourages that behavior to a small&lt;br/&gt;
degree. Proper credit to outside contributers is very important I think - thats why we put someones name right next to ours, even when the user&lt;br/&gt;
may have just reported the issue and we did all the work - or even if two people did 98% of the work and some guy drops a patch that changes&lt;br/&gt;
2%. Just my two cents on the subject though - take it for what its worth.&lt;/p&gt;</comment>
                    <comment id="12752821" author="rcmuir" created="Wed, 9 Sep 2009 00:21:16 +0100"  >&lt;p&gt;here is what i think:&lt;br/&gt;
this is what Michael Busch said in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1775&quot; title=&quot;Change remaining contrib streams/filters to use new TokenStream API&quot;&gt;&lt;del&gt;LUCENE-1775&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;ShingleFilter and ShingleFilterTest are converted to the new API.&lt;/p&gt;

&lt;p&gt;ShingleFilter is much more efficient now, it clones much less often and computes the tokens mostly on the fly now. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;the fact it went to the new API appears to have made it to CHANGES, but not the fact it is more efficient.&lt;br/&gt;
so maybe it could be mentioned in CHANGES not only that it went to the new API,&lt;br/&gt;
but that it is more efficient and that Chris &amp;amp; Uwe added additional tests and fixed bugs/ensured correctness?&lt;/p&gt;

&lt;p&gt;by the way, you can take my name off existing CHANGE if you want, I did nothing &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12752822" author="thetaphi" created="Wed, 9 Sep 2009 00:23:29 +0100"  >&lt;p&gt;You are right about the external contributor. I think, we should also add a changes entry for &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1901&quot; title=&quot;TermAttributeImpl.equals() does not check termLength&quot;&gt;&lt;del&gt;LUCENE-1901&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    <comment id="12752837" author="ryguasu" created="Wed, 9 Sep 2009 01:12:39 +0100"  >&lt;p&gt;This is the same as Uwe&apos;s patch, but with three additional tests:&lt;/p&gt;

&lt;p&gt;testBiGramFilterWithHolesWithoutUnigrams&lt;br/&gt;
testBiGramFilterWithEmptyTokenStream&lt;br/&gt;
testBiGramFilterWithEmptyTokenStreamWithoutUnigrams&lt;/p&gt;

&lt;p&gt;Not sure if it&apos;s worth adding them, but they do pass.&lt;/p&gt;
</comment>
                    <comment id="12752838" author="ryguasu" created="Wed, 9 Sep 2009 01:22:31 +0100"  >&lt;blockquote&gt;&lt;p&gt;Chris: Could you test this patch&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Looks ok so far, but unfortunately I doubt I&apos;ll be able to test it in a real-world setting before you guys want to freeze the code and/or release. (I usually use not just ShingleFilter but ShingleFilter combined with the &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1370&quot; title=&quot;Add ShingleFilter option to output unigrams if no shingles can be generated&quot;&gt;&lt;del&gt;LUCENE-1370&lt;/del&gt;&lt;/a&gt; patch. It was in looking into to upgrading &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1370&quot; title=&quot;Add ShingleFilter option to output unigrams if no shingles can be generated&quot;&gt;&lt;del&gt;LUCENE-1370&lt;/del&gt;&lt;/a&gt; to work with the trunk that I discovered this bug.)&lt;/p&gt;</comment>
                    <comment id="12752927" author="thetaphi" created="Wed, 9 Sep 2009 07:07:20 +0100"  >&lt;p&gt;Committed revision: 812779 &amp;amp; 812782&lt;br/&gt;
I also added Chris&apos; advanced tests. More tests, more better. The tests verify that my changes also work with empty or very short token streams.&lt;/p&gt;

&lt;p&gt;Thanks Chris Harris!&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12431974">LUCENE-1775</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12419000" name="LUCENE-1903.patch" size="8456" author="ryguasu" created="Wed, 9 Sep 2009 01:12:39 +0100" />
                    <attachment id="12418980" name="LUCENE-1903.patch" size="7233" author="thetaphi" created="Tue, 8 Sep 2009 23:25:25 +0100" />
                    <attachment id="12418978" name="LUCENE-1903_testcases_lucene2_4_1_version.patch" size="5018" author="ryguasu" created="Tue, 8 Sep 2009 22:54:26 +0100" />
                    <attachment id="12418979" name="LUCENE-1903_testcases.patch" size="5425" author="ryguasu" created="Tue, 8 Sep 2009 22:55:01 +0100" />
                    <attachment id="12418970" name="TEST-org.apache.lucene.analysis.shingle.ShingleFilterTest.xml" size="15304" author="ryguasu" created="Tue, 8 Sep 2009 22:05:05 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>5.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 8 Sep 2009 21:17:06 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11864</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25822</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
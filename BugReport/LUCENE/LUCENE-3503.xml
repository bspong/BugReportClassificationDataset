<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:31:01 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3503/LUCENE-3503.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3503] DisjunctionSumScorer gives slightly (float iotas) different scores when you .nextDoc vs .advance</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3503</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Spinoff from &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1536&quot; title=&quot;if a filter can support random access API, we should use it&quot;&gt;&lt;del&gt;LUCENE-1536&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I dug into why we hit a score diff when using luceneutil to benchmark&lt;br/&gt;
the patch.&lt;/p&gt;

&lt;p&gt;At first I thought it was BS1/BS2 difference, but because of a bug in&lt;br/&gt;
the patch it was still using BS2 (but should be BS1) &amp;#8211; Robert&apos;s last&lt;br/&gt;
patch fixes that.&lt;/p&gt;

&lt;p&gt;But it&apos;s actually a diff in BS2 itself, whether you next or advance&lt;br/&gt;
through the docs.&lt;/p&gt;

&lt;p&gt;It&apos;s because DisjunctionSumScorer, when summing the float scores for a&lt;br/&gt;
given doc that matches multiple sub-scorers, might sum in a different&lt;br/&gt;
order, when you had .nextDoc&apos;d to that doc than when you had .advance&apos;d&lt;br/&gt;
to it.&lt;/p&gt;

&lt;p&gt;This in turn is because the PQ used by that scorer (ScorerDocQueue)&lt;br/&gt;
makes no effort to break ties.  So, when the top N scorers are on the&lt;br/&gt;
same doc, the PQ doesn&apos;t care what order they are in.&lt;/p&gt;

&lt;p&gt;Fixing ScorerDocQueue to break ties will likely be a non-trivial perf&lt;br/&gt;
hit, though, so I&apos;m not sure whether we should do anything here...&lt;/p&gt;</description>
                <environment></environment>
            <key id="12526471">LUCENE-3503</key>
            <summary>DisjunctionSumScorer gives slightly (float iotas) different scores when you .nextDoc vs .advance</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Mon, 10 Oct 2011 18:19:21 +0100</created>
                <updated>Sun, 27 Nov 2011 12:29:35 +0000</updated>
                    <resolved>Tue, 11 Oct 2011 12:58:10 +0100</resolved>
                                            <fixVersion>3.5</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13124312" author="mikemccand" created="Mon, 10 Oct 2011 18:20:18 +0100"  >&lt;p&gt;Failing test case showing the bug.&lt;/p&gt;</comment>
                    <comment id="13124315" author="rcmuir" created="Mon, 10 Oct 2011 18:22:56 +0100"  >&lt;p&gt;I think we have to fix it, get the correctness and then worry about performance later.&lt;/p&gt;

&lt;p&gt;giving a document a different score (no matter how little, it will affect ranking) just because you next&apos;ed versus advance&apos;d it is bad news.&lt;/p&gt;</comment>
                    <comment id="13124353" author="rcmuir" created="Mon, 10 Oct 2011 19:12:56 +0100"  >&lt;p&gt;not a real &apos;fix&apos; but maybe this solves it for practical purposes?&lt;/p&gt;</comment>
                    <comment id="13124412" author="rcmuir" created="Mon, 10 Oct 2011 20:32:27 +0100"  >&lt;p&gt;patch with a bugfix to the test (in case it gets slowmultireaderwrapper)&lt;/p&gt;</comment>
                    <comment id="13157810" author="thetaphi" created="Sun, 27 Nov 2011 12:29:35 +0000"  >&lt;p&gt;Bulk close after release of 3.5&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10032">
                <name>Blocker</name>
                                <outwardlinks description="blocks">
                            <issuelink>
            <issuekey id="12414034">LUCENE-1536</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12498453" name="LUCENE-3503.patch" size="5411" author="rcmuir" created="Mon, 10 Oct 2011 20:32:27 +0100" />
                    <attachment id="12498447" name="LUCENE-3503.patch" size="5449" author="rcmuir" created="Mon, 10 Oct 2011 19:12:56 +0100" />
                    <attachment id="12498442" name="LUCENE-3503.patch" size="4522" author="mikemccand" created="Mon, 10 Oct 2011 18:20:18 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 10 Oct 2011 17:22:56 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>56860</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24194</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:20:11 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1045/LUCENE-1045.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1045] SortField.AUTO doesn&apos;t work with long</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1045</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;This is actually the same as &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-463&quot; title=&quot;Sorting does not work correcly on &amp;quot;String Date&amp;quot;&quot;&gt;&lt;del&gt;LUCENE-463&lt;/del&gt;&lt;/a&gt; but I cannot find a way to re-open that issue. I&apos;m attaching a test case by dragon-fly999 at hotmail com that shows the problem and a patch that seems to fix it.&lt;/p&gt;

&lt;p&gt;The problem is that a long (as used for dates) cannot be parsed as an integer, and the next step is then to parse it as a float, which works but which is not correct. With the patch the following parsers are used in this order: int, long, float.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12381799">LUCENE-1045</key>
            <summary>SortField.AUTO doesn&apos;t work with long</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="gsingers">Grant Ingersoll</assignee>
                                <reporter username="lucenebugs@danielnaber.de">Daniel Naber</reporter>
                        <labels>
                    </labels>
                <created>Sat, 3 Nov 2007 21:46:39 +0000</created>
                <updated>Thu, 2 May 2013 03:29:10 +0100</updated>
                    <resolved>Sat, 2 Feb 2008 03:09:39 +0000</resolved>
                            <version>2.2</version>
                                <fixVersion>2.4</fixVersion>
                                <component>core/search</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12540011" author="lucenebugs@danielnaber.de" created="Sat, 3 Nov 2007 21:48:58 +0000"  >&lt;p&gt;Makes auto sorting work with long.&lt;/p&gt;</comment>
                    <comment id="12545549" author="lucenebugs@danielnaber.de" created="Mon, 26 Nov 2007 18:54:40 +0000"  >&lt;p&gt;patch applied&lt;/p&gt;</comment>
                    <comment id="12545567" author="gsingers" created="Mon, 26 Nov 2007 19:44:32 +0000"  >&lt;p&gt;This patch seems a bit strange to me (sorry for getting to it so late).  I think the better way might be to have the FieldSortedHitQueue#comparatorAuto method use the ExtendedFieldCache, instead of creating the dependency in FieldCacheImpl on ExtendedFieldCache to have long support.  &lt;/p&gt;

&lt;p&gt;Then, you could just override getAuto in ExtendedFieldCache.   &lt;/p&gt;

&lt;p&gt;This way, those who have longs and want them treated as such get them from the ExtendedFC, otherwise, those just using FieldCacheImpl, get the behavior they are used to, namely no long support.&lt;/p&gt;</comment>
                    <comment id="12545575" author="yseeley@gmail.com" created="Mon, 26 Nov 2007 19:54:46 +0000"  >&lt;p&gt;Hmmm, I didn&apos;t realize that ExtendedFieldCache was added until you just pointed it out.&lt;br/&gt;
Why can&apos;t we just add long and double support directly to FieldCache?&lt;/p&gt;</comment>
                    <comment id="12545578" author="gsingers" created="Mon, 26 Nov 2007 20:02:03 +0000"  >&lt;p&gt;Because it is an interface and that could break implementations.  See &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1015&quot; class=&quot;external-link&quot;&gt;https://issues.apache.org/jira/browse/LUCENE-1015&lt;/a&gt;&lt;/p&gt;</comment>
                    <comment id="12545580" author="yseeley@gmail.com" created="Mon, 26 Nov 2007 20:08:10 +0000"  >&lt;p&gt;Normally right, but a user can&apos;t provide their own implementation for lucene to use (because of the way lucene looks up the implementation).&lt;/p&gt;</comment>
                    <comment id="12545583" author="gsingers" created="Mon, 26 Nov 2007 20:12:48 +0000"  >&lt;p&gt;There is a cleaner way of doing this w/o copying code from ExtendedFieldCacheImpl&lt;/p&gt;

&lt;p&gt;Patch to follow&lt;/p&gt;</comment>
                    <comment id="12545584" author="gsingers" created="Mon, 26 Nov 2007 20:15:27 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Normally right, but a user can&apos;t provide their own implementation for lucene to use (because of the way lucene looks up the implementation).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;True, it isn&apos;t all that useful of an interface.  We probably should open another issue to deal with it.  Either that, or we should take another look at fixing it in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-831&quot; class=&quot;external-link&quot;&gt;https://issues.apache.org/jira/browse/LUCENE-831&lt;/a&gt;&lt;/p&gt;
</comment>
                    <comment id="12545590" author="gsingers" created="Mon, 26 Nov 2007 20:25:50 +0000"  >&lt;p&gt;Refactoring to remove duplicated code and use the ExtendedFieldCache impl.&lt;/p&gt;</comment>
                    <comment id="12545592" author="yseeley@gmail.com" created="Mon, 26 Nov 2007 20:42:27 +0000"  >&lt;p&gt;My only concern is that ExtendedFieldCache(Impl) adds more public classes that we then need to keep back compatibility with in future releases.  If we decide that adding long/double directly to FieldCache is OK, then that should ideally be done before the next release so we can simply remove ExtendedFieldCache.&lt;/p&gt;</comment>
                    <comment id="12545601" author="cutting" created="Mon, 26 Nov 2007 20:57:13 +0000"  >&lt;p&gt;&amp;gt; True, it isn&apos;t all that useful of an interface.&lt;/p&gt;

&lt;p&gt;Perhaps it should be an abstract base class instead of an interface, so that the API can more easily evolve without breaking user code?  If external implementations are not currently supported, this might even be a back-compatible change.&lt;/p&gt;</comment>
                    <comment id="12545612" author="gsingers" created="Mon, 26 Nov 2007 21:27:49 +0000"  >&lt;p&gt;That&apos;s fine by me, I think we just need to document it clearly in CHANGES.txt that we are making a potentially non-back compatible change (which isn&apos;t likely) in order to support future back compatibility &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.  &lt;/p&gt;

&lt;p&gt;I guess the question is whether there are people that have extended TopDocCollector and created a variation of the PriorityQueue that is similar to FieldSortedHitQueue that uses their own FieldCache implementation.  I can&apos;t imagine the need for this, but it does seem possible, or did I miss something?&lt;/p&gt;</comment>
                    <comment id="12547714" author="gsingers" created="Mon, 3 Dec 2007 02:06:21 +0000"  >&lt;p&gt;Any more thoughts on this?  Otherwise, I am going to apply this patch before I forget about it.  It does seem to me there is at least a remote possibility of using the interface.  &lt;/p&gt;

&lt;p&gt;I will commit tomorrow evening or Tuesday unless I hear otherwise.&lt;/p&gt;</comment>
                    <comment id="12547715" author="yseeley@gmail.com" created="Mon, 3 Dec 2007 02:15:59 +0000"  >&lt;p&gt;I think we should just fold Long &amp;amp; Double support into the FieldCache and change it to be an abstract class.&lt;br/&gt;
It is &lt;b&gt;very&lt;/b&gt; unlikely that anyone has implemented their own FieldCache since it wouldn&apos;t be directly usable with Lucene.&lt;br/&gt;
In the worst-case scenario that someone did, there will be an immediate and understandable error, and the fix is easy.&lt;/p&gt;</comment>
                    <comment id="12547754" author="otis" created="Mon, 3 Dec 2007 07:59:20 +0000"  >&lt;p&gt;Grant, any chance of you throwing in short support in there?&lt;/p&gt;</comment>
                    <comment id="12547803" author="gsingers" created="Mon, 3 Dec 2007 11:44:29 +0000"  >&lt;blockquote&gt;
&lt;p&gt;short support&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;FieldCache already has shorts support, so no reason not to add it and bytes to SortField.&lt;/p&gt;

&lt;p&gt;I will work up a patch for all of this.&lt;/p&gt;</comment>
                    <comment id="12547911" author="gsingers" created="Mon, 3 Dec 2007 17:30:04 +0000"  >&lt;p&gt;Drops ExtendedFieldCache, puts everything into FieldCache, adds support to SortField and FieldSortedHitQueue for sorting on bytes and longs.  Drops FieldCacheImpl as it doesn&apos;t really serve any purpose once you make FieldCache a class.&lt;/p&gt;

&lt;p&gt;Note this breaks the back-compat. contract on FieldCache interface.&lt;/p&gt;</comment>
                    <comment id="12548053" author="yseeley@gmail.com" created="Mon, 3 Dec 2007 23:44:32 +0000"  >&lt;p&gt;Actually, I&apos;m not sure we should change it to an abstract class now... that&apos;s not a backward compatible change for normal users, right?&lt;/p&gt;

&lt;p&gt;People very likely access the current FieldCache via FieldCache.DEFAULT.get...() or&lt;br/&gt;
FieldCache f = FieldCache.DEFAULT&lt;/p&gt;

&lt;p&gt;So as long as no one has any custom implementations, we can at least add new methods to the FieldCache interface and implement them in FieldCacheImpl&lt;/p&gt;</comment>
                    <comment id="12548078" author="gsingers" created="Tue, 4 Dec 2007 00:58:21 +0000"  >&lt;p&gt;With this latest patch, they will still be able to do that.  I made FC a full-blown public class and deleted FieldCacheImpl.&lt;/p&gt;

&lt;p&gt;So far, there has been one user who responded to my request for people who have implemented FieldCache: &lt;a href=&quot;http://www.gossamer-threads.com/lists/lucene/java-user/55402&quot; class=&quot;external-link&quot;&gt;http://www.gossamer-threads.com/lists/lucene/java-user/55402&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;However, the user already says it isn&apos;t a big deal for us to change it.&lt;/p&gt;</comment>
                    <comment id="12548079" author="yseeley@gmail.com" created="Tue, 4 Dec 2007 01:19:35 +0000"  >&lt;p&gt;&amp;gt; With this latest patch, they will still be able to do that.&lt;/p&gt;

&lt;p&gt;Only if they recompile.  Simply dropping in a new lucene jar would break their existing FieldCache usage.&lt;/p&gt;</comment>
                    <comment id="12548088" author="gsingers" created="Tue, 4 Dec 2007 02:01:14 +0000"  >&lt;p&gt;Yes.  True.  Here you and Doug finally had me convinced and now... &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12552783" author="gsingers" created="Tue, 18 Dec 2007 15:13:54 +0000"  >&lt;p&gt;I committed my original patch which keeps the ExtendedFieldCache.&lt;/p&gt;

&lt;p&gt;If anything, I think we should mark FieldCache for 3.X that it is going to be converted to a class.&lt;/p&gt;</comment>
                    <comment id="12564272" author="gsingers" created="Thu, 31 Jan 2008 02:21:14 +0000"  >&lt;p&gt;Sigh, I had it in the patch, but didn&apos;t get the BYTE and SHORT values on the SortField.  Ugh.&lt;/p&gt;</comment>
                    <comment id="12564391" author="gsingers" created="Thu, 31 Jan 2008 16:27:23 +0000"  >&lt;p&gt;Here&apos;s the patch that adds the missing short and byte sorting.&lt;/p&gt;

&lt;p&gt;Will commit in the next day or two.&lt;/p&gt;</comment>
                    <comment id="12565023" author="gsingers" created="Sat, 2 Feb 2008 03:09:39 +0000"  >&lt;p&gt;I committed the short-byte patch.&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                                <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12379485">LUCENE-1015</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                        <issuelinktype id="10001">
                <name>dependent</name>
                                                <inwardlinks description="is depended upon by">
                            <issuelink>
            <issuekey id="12375243">SOLR-324</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12368935" name="auto-long-sorting.diff" size="3967" author="lucenebugs@danielnaber.de" created="Sat, 3 Nov 2007 21:48:58 +0000" />
                    <attachment id="12370855" name="LUCENE-1045.patch" size="68902" author="gsingers" created="Mon, 3 Dec 2007 17:30:03 +0000" />
                    <attachment id="12370236" name="LUCENE-1045.patch" size="6765" author="gsingers" created="Mon, 26 Nov 2007 20:25:50 +0000" />
                    <attachment id="12374470" name="LUCENE-1045-shortbyte.patch" size="11451" author="gsingers" created="Thu, 31 Jan 2008 16:27:23 +0000" />
                    <attachment id="12368934" name="TestDateSort.java" size="3919" author="lucenebugs@danielnaber.de" created="Sat, 3 Nov 2007 21:47:45 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>5.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 26 Nov 2007 19:44:32 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12700</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26684</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
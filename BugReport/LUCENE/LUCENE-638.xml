<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:21:46 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-638/LUCENE-638.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-638] Can&apos;t put non-index files (e.g. CVS, SVN directories) in a Lucene index directory</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-638</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Lucene won&apos;t tolerate foreign files in its index directories.  This makes it impossible to keep an index in a CVS or Subversion repository.&lt;/p&gt;

&lt;p&gt;For instance, this exception appears when creating a RAMDirectory from a java.io.File that contains a subdirectory called &quot;.svn&quot;.&lt;/p&gt;

&lt;p&gt;java.io.FileNotFoundException: /home/local/ejj/ic/.caches/.search/.index/.svn&lt;br/&gt;
(Is a directory)&lt;br/&gt;
        at java.io.RandomAccessFile.open(Native Method)&lt;br/&gt;
        at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(RandomAccessFile.java:212)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.lucene.store.FSIndexInput$Descriptor.&amp;lt;init&amp;gt;(FSDirectory.java:425)&lt;br/&gt;
        at org.apache.lucene.store.FSIndexInput.&amp;lt;init&amp;gt;(FSDirectory.java:434)&lt;br/&gt;
        at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:324)&lt;br/&gt;
        at org.apache.lucene.store.RAMDirectory.&amp;lt;init&amp;gt;(RAMDirectory.java:61)&lt;br/&gt;
        at org.apache.lucene.store.RAMDirectory.&amp;lt;init&amp;gt;(RAMDirectory.java:86)&lt;/p&gt;</description>
                <environment></environment>
            <key id="12346784">LUCENE-638</key>
            <summary>Can&apos;t put non-index files (e.g. CVS, SVN directories) in a Lucene index directory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="eleanor">Eleanor Joslin</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Jul 2006 18:19:19 +0100</created>
                <updated>Sat, 29 Jul 2006 10:54:11 +0100</updated>
                    <resolved>Sat, 29 Jul 2006 10:54:11 +0100</resolved>
                                                                    <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12423893" author="lucenebugs@danielnaber.de" created="Thu, 27 Jul 2006 19:56:42 +0100"  >&lt;p&gt;What exactly does your code look like? Something else must be wrong because I use an index that&apos;s committed to CVS without problems (using Lucene 2.0).&lt;/p&gt;</comment>
                    <comment id="12424048" author="eleanor" created="Fri, 28 Jul 2006 10:50:16 +0100"  >&lt;p&gt;Here&apos;s an example.  Compile and run this with lucene-core-2.0.0.jar in the classpath.&lt;/p&gt;</comment>
                    <comment id="12424084" author="simonwillnauer" created="Fri, 28 Jul 2006 13:39:44 +0100"  >&lt;p&gt;The RAMDirectory class uses the Directory.list() method to create the index input in the constructor. The implementation of FSDirectory returns all containing files of the directory including non lucene files and also all containing directories. &lt;br/&gt;
In my opinion this method should not return non lucene files and directories for consistency. &lt;br/&gt;
The problem does only appear if you create a RamDirectory from a existing index.&lt;/p&gt;

&lt;p&gt;here is the patch for the trunk: &lt;br/&gt;
(I also added a try / finally block in the rename() method to close all streams in the case of an exception on the input stream the output stream would remain open.)&lt;br/&gt;
All test passed, almost no tests in the store package &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;


&lt;p&gt;Index: FSDirectory.java&lt;br/&gt;
===================================================================&lt;br/&gt;
&amp;#8212; FSDirectory.java    (revision 426479) &lt;br/&gt;
+++ FSDirectory.java    (working copy) &lt;br/&gt;
@@ -211,9 +211,9 @@&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;/** Returns an array of strings, one for each file in the directory. */&lt;br/&gt;
+  /** Returns an array of strings, one for each lucnene index file in the directory. */ &lt;br/&gt;
   public String[] list() 
{
-    return directory.list(); 
+    return directory.list(new IndexFileNameFilter()); 
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   /** Returns true iff a file with the given name exists. */&lt;br/&gt;
@@ -296,20 +296,23 @@&lt;br/&gt;
         throw newExc;&lt;br/&gt;
       }&lt;br/&gt;
       finally {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (in != null) {&lt;/li&gt;
	&lt;li&gt;try 
{ 
-            in.close(); 
-          }
&lt;p&gt; catch (IOException e) {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;throw new RuntimeException(&quot;Cannot close input stream: &quot; + e.toString(), e);&lt;br/&gt;
+    try{       &lt;br/&gt;
+          if (in != null) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: { +            try { 
+              in.close(); 
+            } catch (IOException e) { 
+              throw new RuntimeException(&quot;Cannot close input stream: &quot; + e.toString(), e); 
+            }            }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;}&lt;/li&gt;
	&lt;li&gt;if (out != null) {&lt;/li&gt;
	&lt;li&gt;try 
{ 
-            out.close(); 
-          }
&lt;p&gt; catch (IOException e) &lt;/p&gt;
{ 
-            throw new RuntimeException(&quot;Cannot close output stream: &quot; + e.toString(), e); 
+    }
&lt;p&gt;finally{&lt;br/&gt;
+          if (out != null) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: { +            try { 
+              out.close(); 
+            } catch (IOException e) { 
+              throw new RuntimeException(&quot;Cannot close output stream: &quot; + e.toString(), e); 
+            }            }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
+    } &lt;br/&gt;
       }&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12424280" author="lucenebugs@danielnaber.de" created="Sat, 29 Jul 2006 10:54:11 +0100"  >&lt;p&gt;Thanks, this has now been fixed in trunk.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12337694" name="LuceneTest.java" size="3267" author="eleanor" created="Fri, 28 Jul 2006 10:50:16 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 27 Jul 2006 18:56:42 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>13115</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>27092</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:25:26 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2941/LUCENE-2941.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2941] custom sort broken if IS uses executorservice</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2941</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description></description>
                <environment></environment>
            <key id="12499879">LUCENE-2941</key>
            <summary>custom sort broken if IS uses executorservice</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="rcmuir">Robert Muir</reporter>
                        <labels>
                    </labels>
                <created>Sun, 27 Feb 2011 23:39:45 +0000</created>
                <updated>Wed, 30 Mar 2011 16:50:23 +0100</updated>
                    <resolved>Tue, 1 Mar 2011 22:24:43 +0000</resolved>
                                            <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13000061" author="rcmuir" created="Sun, 27 Feb 2011 23:43:15 +0000"  >&lt;p&gt;attached is a testcase (fails on both trunk and 3.x):&lt;/p&gt;

&lt;p&gt;this works:   &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;public void testSort() throws Exception {
    SortField sf = new SortField(&quot;field&quot;, locale);
    TopFieldDocs docs = searcher.search(new MatchAllDocsQuery(), null, numDocs, new Sort(sf));
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;this doesn&apos;t, if IS uses executorservice:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  public void testSort2() throws Exception {
    SortField sf = new SortField(&quot;field&quot;, new FieldComparatorSource() {
      @Override
      public FieldComparator newComparator(String fieldname, int numHits, int sortPos, boolean reversed) throws IOException {
        return new FieldComparator.StringComparatorLocale(numHits, fieldname, locale);
      }
    });
    TopFieldDocs docs = searcher.search(new MatchAllDocsQuery(), null, numDocs, new Sort(sf));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem is inside the FieldDocSortedHitQueue... the only reason Locale sort works today is because it cheats and looks inside the SortField to see if it has a locale, and does things with its collator.&lt;/p&gt;

&lt;p&gt;But if you code the same approach as a custom sort, it won&apos;t work.&lt;/p&gt;</comment>
                    <comment id="13000367" author="mikemccand" created="Mon, 28 Feb 2011 16:13:15 +0000"  >&lt;p&gt;How about something like this?  I just make a new TopFieldCollector to collect per-segment each of the subs.  If we do this we should remove the FieldDocSortedHitQueue.&lt;/p&gt;

&lt;p&gt;(I haven&apos;t checked whether Robert&apos;s test passes w/ this yet!)&lt;/p&gt;</comment>
                    <comment id="13000383" author="rcmuir" created="Mon, 28 Feb 2011 16:41:42 +0000"  >&lt;p&gt;Patch seems to fix my issue! (in trunk, the test attached to the issue is actually committed as contrib/queries/...TestSlowCollationMethods, you just gotta enable newSearcher to trigger the bug)&lt;/p&gt;

&lt;p&gt;but the test attached to the issue works for branch_3x, so we probably want something like that there along with any fix.&lt;/p&gt;</comment>
                    <comment id="13000385" author="mikemccand" created="Mon, 28 Feb 2011 16:42:52 +0000"  >&lt;p&gt;New patch, cuts over the new TestSlowCollationMethods to newSearcher (which failed before but passes now), and removes dead code.&lt;/p&gt;</comment>
                    <comment id="13013459" author="gsingers" created="Wed, 30 Mar 2011 16:50:23 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12472198" name="LUCENE-2941.patch" size="10165" author="mikemccand" created="Mon, 28 Feb 2011 16:42:52 +0000" />
                    <attachment id="12472197" name="LUCENE-2941.patch" size="5704" author="mikemccand" created="Mon, 28 Feb 2011 16:13:15 +0000" />
                    <attachment id="12472128" name="LUCENE-2941_test.patch" size="5960" author="rcmuir" created="Sun, 27 Feb 2011 23:43:15 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 28 Feb 2011 16:13:15 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>10931</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24751</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
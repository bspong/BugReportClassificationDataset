<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:21:32 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2531/LUCENE-2531.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2531] FieldComparator.TermOrdValComparator compares by value unnecessarily</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2531</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Digging on &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2504&quot; title=&quot;sorting performance regression&quot;&gt;&lt;del&gt;LUCENE-2504&lt;/del&gt;&lt;/a&gt;, I noticed that TermOrdValComparator&apos;s compareBottom method falls back on compare-by-value when it needn&apos;t.&lt;/p&gt;

&lt;p&gt;Specifically, if we know the current bottom ord &quot;matches&quot; the current segment, we can skip the value comparison when the ords are the same (ie, return 0) because the ords are exactly comparable.&lt;/p&gt;

&lt;p&gt;This is hurting string sort perf especially for optimized indices (and also unoptimized indices), and especially for highly redundant (not many unique values) fields.  This affects all releases &amp;gt;= 2.9.x, but trunk is likely more severely affected since looking up a value is more costly.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12468986">LUCENE-2531</key>
            <summary>FieldComparator.TermOrdValComparator compares by value unnecessarily</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Sat, 10 Jul 2010 21:44:44 +0100</created>
                <updated>Wed, 30 Mar 2011 16:50:30 +0100</updated>
                    <resolved>Tue, 13 Jul 2010 11:29:57 +0100</resolved>
                                            <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>core/search</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12887090" author="mikemccand" created="Sat, 10 Jul 2010 21:48:43 +0100"  >&lt;p&gt;Attached patches, for 3.1 and 4.0.&lt;/p&gt;

&lt;p&gt;This also cleans up the String/TermOrdValComparator, absorbing the convert method directly into setBottom, and doing away with some dead code.  With this fix we no longer compare by value at all if index is a single segment (I think!).&lt;/p&gt;</comment>
                    <comment id="12887106" author="mikemccand" created="Sat, 10 Jul 2010 23:47:04 +0100"  >&lt;p&gt;Another iteration on the patches with some small further optimizing.&lt;/p&gt;</comment>
                    <comment id="12887122" author="yseeley@gmail.com" created="Sun, 11 Jul 2010 01:08:59 +0100"  >&lt;p&gt;The thing that jumps out at me is the removal of &quot;reversed&quot;... I&apos;d need to apply the patch to study enough to figure that out, but any clues you could give would be helpful (yes, I&apos;m being lazy &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12887126" author="mikemccand" created="Sun, 11 Jul 2010 01:20:22 +0100"  >&lt;p&gt;I hear you; this stuff is kinda hairy &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;The usage of reverse (and, sortPos) was only in dead code, inside the convert method.&lt;/p&gt;

&lt;p&gt;The convert method used to be used more often (to do on-demand convert of the ord when its readerGen != current one), but we stopped doing that and only convert the bottom slot now, which mean this if:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;      if (sortPos == 0 &amp;amp;&amp;amp; bottomSlot != -1 &amp;amp;&amp;amp; bottomSlot != slot) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can never be true (bottomSlot is &lt;b&gt;always&lt;/b&gt; == slot), so that true clause was all dead code anyway.&lt;/p&gt;</comment>
                    <comment id="13013504" author="gsingers" created="Wed, 30 Mar 2011 16:50:30 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12449169" name="LUCENE-2504-3x.patch" size="3101" author="mikemccand" created="Sat, 10 Jul 2010 21:48:43 +0100" />
                    <attachment id="12449168" name="LUCENE-2504.patch" size="3240" author="mikemccand" created="Sat, 10 Jul 2010 21:48:43 +0100" />
                    <attachment id="12449175" name="LUCENE-2531-3x.patch" size="3854" author="mikemccand" created="Sat, 10 Jul 2010 23:47:04 +0100" />
                    <attachment id="12449174" name="LUCENE-2531.patch" size="4944" author="mikemccand" created="Sat, 10 Jul 2010 23:47:04 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>4.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sun, 11 Jul 2010 00:08:59 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11296</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25161</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:00:04 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1744/LUCENE-1744.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1744] BooleanScorer2 fails to update this.doc when its the top scorer</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1744</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;When BooleanScorer2 runs the top collection loop (one of its&lt;br/&gt;
score(Collector)) methods, it uses a local &quot;doc&quot; var, ie:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void score(Collector collector) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    collector.setScorer(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; doc;
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; ((doc = countingSumScorer.nextDoc()) != NO_MORE_DOCS) {
      collector.collect(doc);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem is, if the child collector calls scorer.doc() it will&lt;br/&gt;
always get -1.  Most Collectors don&apos;t actually call scorer.doc(), but&lt;br/&gt;
one important one that does is ScoreCachingWrapperScorer, as it uses&lt;br/&gt;
the doc to know when to invalidate its cache.  Since this always&lt;br/&gt;
returns -1, the ScoreCachingWrapperScorer keeps returning score=0.0 to&lt;br/&gt;
its caller, thus messing up a SortField.SCORE comparator instance if&lt;br/&gt;
it&apos;s included in the sort fields.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12430487">LUCENE-1744</key>
            <summary>BooleanScorer2 fails to update this.doc when its the top scorer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Jul 2009 12:07:21 +0100</created>
                <updated>Fri, 25 Sep 2009 17:23:29 +0100</updated>
                    <resolved>Wed, 15 Jul 2009 12:19:01 +0100</resolved>
                            <version>2.9</version>
                                <fixVersion>2.9</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12731386" author="mikemccand" created="Wed, 15 Jul 2009 12:11:04 +0100"  >&lt;p&gt;Attached patch, including Shalin&apos;s test case (thanks!) which fails on trunk, plus the fix that resolves it.&lt;/p&gt;

&lt;p&gt;I plan to commit shortly.&lt;/p&gt;</comment>
                    <comment id="12731393" author="mikemccand" created="Wed, 15 Jul 2009 12:19:01 +0100"  >&lt;p&gt;Thanks Shalin!&lt;/p&gt;</comment>
                    <comment id="12731399" author="shaie" created="Wed, 15 Jul 2009 12:36:23 +0100"  >&lt;p&gt;good catch. I think this was before one of the issues (forgot which) where I added doc as a member to BS2.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12413540" name="LUCENE-1744.patch" size="9047" author="mikemccand" created="Wed, 15 Jul 2009 12:11:04 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 15 Jul 2009 11:36:23 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12016</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25982</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
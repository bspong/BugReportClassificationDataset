<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:18:17 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1384/LUCENE-1384.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1384] addIndexesNoOptimize intermittantly throws incorrect &quot;segment exists in external directory...&quot; exception</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1384</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Spinoff from here:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/lucene-java-user/200809.mbox/%3Cba72f77f0809111418l29cf215dnd45bf679832d7d42%40mail.gmail.com%3E&quot; class=&quot;external-link&quot;&gt;http://mail-archives.apache.org/mod_mbox/lucene-java-user/200809.mbox/%3Cba72f77f0809111418l29cf215dnd45bf679832d7d42%40mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here&apos;s my response on that thread:&lt;/p&gt;

&lt;p&gt;The bug only happens when you call addIndexesNoOptimize, and one&lt;br/&gt;
simple workaround would be to use SerialMergeScheduler.&lt;/p&gt;

&lt;p&gt;I think this is already fixed in trunk (soonish to be 2.4) as a side&lt;br/&gt;
effect of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1335&quot; class=&quot;external-link&quot;&gt;https://issues.apache.org/jira/browse/LUCENE-1335&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In 2.3, merges that involve external segments (which are segments&lt;br/&gt;
folded in by addIndexesNoOptimize) are not supposed to run in a BG&lt;br/&gt;
thread.  This is to prevent addIndexesNoOptimize from returning until&lt;br/&gt;
after all external segments have been carried over (merged or copied)&lt;br/&gt;
into the index, so that if there is an exception (eg disk full),&lt;br/&gt;
addIndexesNoOptimize is able to rollback to the index to the starting&lt;br/&gt;
point.&lt;/p&gt;

&lt;p&gt;The primary merge() method of CMS indeed does not BG any external&lt;br/&gt;
merges, but the bug is that when a BG merge finishes it then selects a&lt;br/&gt;
new merge to kick off and that selection is happy to pick an external&lt;br/&gt;
segment.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12404234">LUCENE-1384</key>
            <summary>addIndexesNoOptimize intermittantly throws incorrect &quot;segment exists in external directory...&quot; exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Sep 2008 11:01:01 +0100</created>
                <updated>Fri, 13 May 2011 19:20:36 +0100</updated>
                    <resolved>Mon, 15 Sep 2008 15:26:38 +0100</resolved>
                            <version>2.3</version>
                <version>2.3.1</version>
                <version>2.3.2</version>
                                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12630545" author="mikemccand" created="Fri, 12 Sep 2008 11:39:35 +0100"  >&lt;p&gt;Attached patch.  I plan to commit in a day or to to 2.3.x branch.&lt;/p&gt;</comment>
                    <comment id="12631035" author="mikemccand" created="Mon, 15 Sep 2008 15:26:38 +0100"  >&lt;p&gt;Committed revision 695483.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12389999" name="LUCENE-1384.patch" size="3463" author="mikemccand" created="Fri, 12 Sep 2008 11:39:35 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12367</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26347</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
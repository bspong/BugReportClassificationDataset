<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:18:01 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1208/LUCENE-1208.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1208] Deadlock case in IndexWriter on exception just before flush</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1208</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;If a document hits a non-aborting exception, eg something goes wrong&lt;br/&gt;
in tokenStream.next(), and, that document had triggered a flush&lt;br/&gt;
(due to RAM or doc count) then DocumentsWriter will deadlock because&lt;br/&gt;
that thread marks the flush as pending but fails to clear it on&lt;br/&gt;
exception.&lt;/p&gt;

&lt;p&gt;I have a simple test case showing this, and a fix fixing it.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12390481">LUCENE-1208</key>
            <summary>Deadlock case in IndexWriter on exception just before flush</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Mar 2008 19:08:06 +0000</created>
                <updated>Thu, 8 May 2008 20:47:58 +0100</updated>
                    <resolved>Fri, 7 Mar 2008 21:46:32 +0000</resolved>
                            <version>2.3</version>
                <version>2.3.1</version>
                                <fixVersion>2.3.2</fixVersion>
                <fixVersion>2.4</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12576337" author="mikemccand" created="Fri, 7 Mar 2008 19:11:22 +0000"  >&lt;p&gt;Attached patch.  The fix is trivial.  I will commit later today.&lt;/p&gt;</comment>
                    <comment id="12576933" author="michele" created="Mon, 10 Mar 2008 10:22:14 +0000"  >&lt;p&gt;As with &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1210&quot; title=&quot;IndexWriter &amp;amp; ConcurrentMergeScheduler deadlock case if starting a merge hits an exception&quot;&gt;&lt;del&gt;LUCENE-1210&lt;/del&gt;&lt;/a&gt;, shouldn&apos;t the patch be committed in the 2.3 branch, too, as it affects 2.3.1? Other issues, such as the speedups in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1211&quot; title=&quot;Small speedups to DocumentsWriter&amp;#39;s quickSort&quot;&gt;&lt;del&gt;LUCENE-1211&lt;/del&gt;&lt;/a&gt;, although useful, can be left out as they are not bugs. But fix for deadlocks seem worthwhile for 2.3.x, too.&lt;/p&gt;</comment>
                    <comment id="12576941" author="mikemccand" created="Mon, 10 Mar 2008 10:51:52 +0000"  >&lt;p&gt;Agreed.  I&apos;m thinking these issues should be ported to 2.3.2:&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1191&quot; title=&quot;If IndexWriter hits OutOfMemoryError it should not commit&quot;&gt;&lt;del&gt;LUCENE-1191&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1197&quot; title=&quot;IndexWriter can flush too early when flushing by RAM usage&quot;&gt;&lt;del&gt;LUCENE-1197&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1198&quot; title=&quot;Exception in DocumentsWriter.ThreadState.init leads to corruption&quot;&gt;&lt;del&gt;LUCENE-1198&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1199&quot; title=&quot;NullPointerException in IndexModifier.close()&quot;&gt;&lt;del&gt;LUCENE-1199&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1200&quot; title=&quot;IndexWriter.addIndexes* can deadlock in rare cases&quot;&gt;&lt;del&gt;LUCENE-1200&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1208&quot; title=&quot;Deadlock case in IndexWriter on exception just before flush&quot;&gt;&lt;del&gt;LUCENE-1208&lt;/del&gt;&lt;/a&gt; (this issue)&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1210&quot; title=&quot;IndexWriter &amp;amp; ConcurrentMergeScheduler deadlock case if starting a merge hits an exception&quot;&gt;&lt;del&gt;LUCENE-1210&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;
</comment>
                    <comment id="12577073" author="michaelbusch" created="Mon, 10 Mar 2008 17:12:42 +0000"  >&lt;p&gt;We had seen this deadlock problem in our tests. I reran all tests with Lucene 2.3.1 + &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1208&quot; title=&quot;Deadlock case in IndexWriter on exception just before flush&quot;&gt;&lt;del&gt;LUCENE-1208&lt;/del&gt;&lt;/a&gt; and didn&apos;t see the problem again so far!&lt;/p&gt;</comment>
                    <comment id="12577576" author="hossman" created="Tue, 11 Mar 2008 19:29:40 +0000"  >&lt;p&gt;targeted for 2.3.2 bug fix release&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12377382" name="LUCENE-1208.patch" size="2279" author="mikemccand" created="Fri, 7 Mar 2008 19:11:22 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 10 Mar 2008 10:22:14 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12538</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26521</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
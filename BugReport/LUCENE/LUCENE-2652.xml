<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:21:48 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2652/LUCENE-2652.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2652] Rethink LocalizedTestCaseRunner with JUnit 4 - Clover OOM</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2652</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;As a spinn off from this &lt;a href=&quot;http://www.lucidimagination.com/search/document/ae20885bf5baedc5/build_failed_in_hudson_lucene_3_x_116#7ed351341152ee2d&quot; class=&quot;external-link&quot;&gt;conversation&lt;/a&gt; we should rethink the way how we execute testcases with different locals since glover reports appears to throw OOM errors b/c Junit treats each local as a single test case run.&lt;/p&gt;

&lt;p&gt;Here are some options:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;select the local at random only run the test with a single local&lt;/li&gt;
	&lt;li&gt;set the local via system property -Dtest.locale=en.EN&lt;/li&gt;
	&lt;li&gt;run with the default locale only -Dtest.skiplocale=true&lt;/li&gt;
	&lt;li&gt;one from the above but only if instrumented with clover (let common tests run all the locale)&lt;/li&gt;
&lt;/ul&gt;

</description>
                <environment></environment>
            <key id="12474469">LUCENE-2652</key>
            <summary>Rethink LocalizedTestCaseRunner with JUnit 4 - Clover OOM</summary>
                <type id="6" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/requirement.png">Test</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="simonw">Simon Willnauer</reporter>
                        <labels>
                    </labels>
                <created>Sat, 18 Sep 2010 11:49:29 +0100</created>
                <updated>Wed, 30 Mar 2011 16:50:28 +0100</updated>
                    <resolved>Tue, 19 Oct 2010 14:00:38 +0100</resolved>
                                            <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>general/test</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12911034" author="rcmuir" created="Sat, 18 Sep 2010 16:35:48 +0100"  >&lt;p&gt;here&apos;s a patch to disable use of the runners.&lt;/p&gt;

&lt;p&gt;really i think the two runners (LocalizedTestCase/MultiCodecTestCase) are obselete anyway,&lt;br/&gt;
you can run any junit test under any locale/codec, and we select locale, timezone, and codec&lt;br/&gt;
randomly by default.&lt;/p&gt;</comment>
                    <comment id="12911038" author="simonw" created="Sat, 18 Sep 2010 16:58:22 +0100"  >&lt;blockquote&gt;
&lt;p&gt;really i think the two runners (LocalizedTestCase/MultiCodecTestCase) are obselete anyway,&lt;br/&gt;
you can run any junit test under any locale/codec, and we select locale, timezone, and codec&lt;br/&gt;
randomly by default.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yeah I agree that we should fix that and get rid of them. I also think we should apply a quick fix to make builds on hudson pass again. Yet, you patch changes lots of files - the patch I attached is less intrusive and has the same effect.&lt;/p&gt;

&lt;p&gt;Lets commit that and do a real fix within the next days. Thoughts?&lt;/p&gt;</comment>
                    <comment id="12911039" author="rcmuir" created="Sat, 18 Sep 2010 17:03:00 +0100"  >&lt;blockquote&gt;&lt;p&gt;Yet, you patch changes lots of files&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right, but long term we should remove these runners anyway.&lt;br/&gt;
So maybe we should delete the RunWiths &lt;b&gt;and&lt;/b&gt; delete the runner code.&lt;/p&gt;

&lt;p&gt;These runners are obselete and weaker than our general test support itself:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the MultiCodecRunner cannot set parameters for the codecs, but LuceneTestCase can do this&lt;/li&gt;
	&lt;li&gt;The LocalizedRunner cannot set timezone (this runner is used by lots of tests), but LuceneTestCase can do this&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12911040" author="simonw" created="Sat, 18 Sep 2010 17:07:15 +0100"  >&lt;blockquote&gt;
&lt;p&gt;Right, but long term we should remove these runners anyway.&lt;br/&gt;
So maybe we should delete the RunWiths and delete the runner code.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I agree robert but I want to let other folk have a chance to comment on how to proceed (its weekend and some may have other things to do) but at the same time I don&apos;t want to let hudson fail again due to clover / Junit 4.&lt;/p&gt;

&lt;p&gt;I&apos;d commit the fix to trunk and 3.x and decide once others have commented, thoughts?&lt;/p&gt;
</comment>
                    <comment id="12911052" author="rcmuir" created="Sat, 18 Sep 2010 18:36:44 +0100"  >&lt;blockquote&gt;&lt;p&gt;I&apos;d commit the fix to trunk and 3.x and decide once others have commented, thoughts?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1, commit it so our clover works&lt;/p&gt;</comment>
                    <comment id="12911058" author="simonw" created="Sat, 18 Sep 2010 19:09:49 +0100"  >&lt;p&gt;I committed the quick fix for now&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;3.x &amp;#8211; Committed revision 998503.&lt;/li&gt;
	&lt;li&gt;trunk &amp;#8211; Committed revision 998507.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I will work on a new patch tomorrow.&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12912211" author="simonw" created="Sun, 19 Sep 2010 12:43:32 +0100"  >&lt;p&gt;I added support for tests.locale=all &amp;amp;&amp;amp; tests.codec=all while still utilizing the TestRunners we used before. With this patch we preserve all functionality we had before  - being able to run with all locale / codec types for those tests which have been marked with the corresponding runners. Should we commit that until we change to a single runner?&lt;/p&gt;

&lt;p&gt;Yet, i think what we should ultimately do is remove the runners and add support to run all permutations like a test with all codecs, locale , timezone etc. I don&apos;t think that it makes lot of sense to do that for every test but maybe we want to offer the test to tell if it wants to run with all locale and / or all codec .... &lt;/p&gt;

&lt;p&gt;maybe something like &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; TestProperty {
  Locale, Codec, Timezone

}

...

setTestProperties(TestProperty ... properties) {
  ...
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    <comment id="12912237" author="rcmuir" created="Sun, 19 Sep 2010 16:14:17 +0100"  >&lt;blockquote&gt;
&lt;p&gt;I added support for tests.locale=all &amp;amp;&amp;amp; tests.codec=all while still utilizing the TestRunners we used before. With this patch we preserve all functionality we had before - being able to run with all locale / codec types for those tests which have been marked with the corresponding runners. Should we commit that until we change to a single runner?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Not sure, i think its a little confusing, because this &apos;all&apos; only affects tests that use the runner.&lt;/p&gt;

&lt;p&gt;I still think we should remove these runners completely. there is other ways to test all locales/codecs: for example by doing ant test -Dtestcase=foo -Dtests.iter=1000, as it should randomly hit them all anyway, same with codecs.&lt;/p&gt;

&lt;p&gt;and this works for all test cases, not just those annotated with the runners.&lt;/p&gt;</comment>
                    <comment id="12922361" author="rcmuir" created="Tue, 19 Oct 2010 00:48:31 +0100"  >&lt;p&gt;Rethinking: Now that all tests are Junit4 tests, this issue is obselete.&lt;/p&gt;

&lt;p&gt;these runners don&apos;t properly setup the locale correctly: only in setUp+test method itself.&lt;/p&gt;

&lt;p&gt;But our build system now with -Dtests.locale does it correctly, @beforeClass is consistent too.&lt;/p&gt;

&lt;p&gt;I&apos;ll remove these runners from LuceneTestCase shortly.&lt;/p&gt;</comment>
                    <comment id="12922455" author="simonw" created="Tue, 19 Oct 2010 07:26:20 +0100"  >&lt;blockquote&gt;&lt;p&gt;I&apos;ll remove these runners from LuceneTestCase shortly.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt; +1 thanks for taking this issue!&lt;/p&gt;</comment>
                    <comment id="12922546" author="rcmuir" created="Tue, 19 Oct 2010 14:00:38 +0100"  >&lt;p&gt;Committed revision 1024219, 1024223 (3x)&lt;/p&gt;</comment>
                    <comment id="13013491" author="gsingers" created="Wed, 30 Mar 2011 16:50:28 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12457507" name="LUCENE-2652.patch" size="13410" author="rcmuir" created="Tue, 19 Oct 2010 01:21:18 +0100" />
                    <attachment id="12454973" name="LUCENE-2652.patch" size="3422" author="simonw" created="Sun, 19 Sep 2010 12:43:32 +0100" />
                    <attachment id="12454943" name="LUCENE-2652.patch" size="1313" author="simonw" created="Sat, 18 Sep 2010 16:58:22 +0100" />
                    <attachment id="12454942" name="LUCENE-2652.patch" size="7308" author="rcmuir" created="Sat, 18 Sep 2010 16:35:48 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>4.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 18 Sep 2010 15:35:48 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11187</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25040</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
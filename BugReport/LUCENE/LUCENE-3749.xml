<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:27:52 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3749/LUCENE-3749.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3749] Similarity.java javadocs and simplifications for 4.0</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3749</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;As part of adding additional scoring systems to lucene, we made a lower-level Similarity&lt;br/&gt;
and the existing stuff became e.g. TFIDFSimilarity which extends it.&lt;/p&gt;

&lt;p&gt;However, I always feel bad about the complexity introduced here (though I do feel there&lt;br/&gt;
are some &quot;excuses&quot;, that its a difficult challenge).&lt;/p&gt;

&lt;p&gt;In order to try to mitigate this, we also exposed an easier API (SimilarityBase) on top of &lt;br/&gt;
it that makes some assumptions (and trades off some performance) to try to provide something &lt;br/&gt;
consumable for e.g. experiments.&lt;/p&gt;

&lt;p&gt;Still, we can cleanup a few things with the low-level api: fix outdated documentation and&lt;br/&gt;
shoot for better/clearer naming etc.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12540994">LUCENE-3749</key>
            <summary>Similarity.java javadocs and simplifications for 4.0</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="rcmuir">Robert Muir</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Feb 2012 20:37:18 +0000</created>
                <updated>Fri, 10 May 2013 11:42:48 +0100</updated>
                    <resolved>Mon, 6 Feb 2012 12:48:50 +0000</resolved>
                            <version>4.0-ALPHA</version>
                                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="13199193" author="rcmuir" created="Thu, 2 Feb 2012 20:37:55 +0000"  >&lt;p&gt;patch&lt;/p&gt;</comment>
                    <comment id="13199219" author="mikemccand" created="Thu, 2 Feb 2012 21:02:39 +0000"  >&lt;p&gt;+1 looks great!&lt;/p&gt;</comment>
                    <comment id="13199382" author="rcmuir" created="Thu, 2 Feb 2012 23:58:58 +0000"  >&lt;p&gt;Thanks Mike: i will prematurely commit, just to make try to make some incremental improvements.&lt;/p&gt;

&lt;p&gt;I think its especially confusing/horrible in trunk after &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3555&quot; title=&quot;Add support for distributed stats&quot;&gt;&lt;del&gt;LUCENE-3555&lt;/del&gt;&lt;/a&gt; and as the javadocs are &lt;br/&gt;
out of date since norms are no longer required to be single-bytes, etc, etc.&lt;/p&gt;

&lt;p&gt;if anyone objects, or has better ideas (ESPECIALLY NAMING: its the worst!), don&apos;t hesitate...&lt;br/&gt;
this stuff is really important.&lt;/p&gt;</comment>
                    <comment id="13200603" author="rcmuir" created="Sun, 5 Feb 2012 00:25:42 +0000"  >&lt;p&gt;Here&apos;s part2: nuking SimilarityProvider (instead use PerFieldSimilarityWrapper if you want special per-field stuff).&lt;/p&gt;

&lt;p&gt;This really simplifies the APIs, especially for say a casual user who just wants to try out a new ranking model.&lt;/p&gt;</comment>
                    <comment id="13200771" author="mikemccand" created="Sun, 5 Feb 2012 14:03:53 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                    <comment id="13222055" author="nhooey" created="Sun, 4 Mar 2012 23:16:41 +0000"  >&lt;p&gt;This change breaks per-field similarity configuration in Solr. Specifically with this commit:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
commit 5d371928263d8d78d0e52781340ae95506bd9bf6
Author: Robert Muir &amp;lt;rmuir@apache.org&amp;gt;
Date:   Mon Feb 6 12:48:01 2012 +0000

    LUCENE-3749: replace SimilarityProvider with PerFieldSimilarityWrapper
    
    git-svn-id: https:&lt;span class=&quot;code-comment&quot;&gt;//svn.apache.org/repos/asf/lucene/dev/trunk@1241001 13f79535-47bb-0310-9956-ffa450edef68&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I have the following configuration in my schema.xml:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;fieldtype name=&lt;span class=&quot;code-quote&quot;&gt;&quot;payloads&quot;&lt;/span&gt; stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.TextField&quot;&lt;/span&gt; &amp;gt;
  &amp;lt;analyzer&amp;gt;
    &amp;lt;tokenizer class=&lt;span class=&quot;code-quote&quot;&gt;&quot;com.foo.lucene.analysis.core.PayloadTermTokenizerFactory&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.DelimitedPayloadTokenFilterFactory&quot;&lt;/span&gt; encoder=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
  &amp;lt;/analyzer&amp;gt;
  &amp;lt;analyzer type=&lt;span class=&quot;code-quote&quot;&gt;&quot;query&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;tokenizer class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.WhitespaceTokenizerFactory&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.LowerCaseFilterFactory&quot;&lt;/span&gt;/&amp;gt;
  &amp;lt;/analyzer&amp;gt;
  &amp;lt;similarity class=&lt;span class=&quot;code-quote&quot;&gt;&quot;com.foo.lucene.search.PayloadSimilarity&quot;&lt;/span&gt; /&amp;gt;
&amp;lt;/fieldtype&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But when I build against and use a version of a Solr with the commit mentioned above, my similarity class is no longer executed. I&apos;ve confirmed this by putting prints in the scorePayload(), tf() and idf() functions and noticing they print before and don&apos;t print after including that commit.&lt;/p&gt;

&lt;p&gt;It seems this is intentional, based on Robert Muir&apos;s comments, but how can you get per-field similarity to work in Solr with this new code?&lt;/p&gt;</comment>
                    <comment id="13222059" author="rcmuir" created="Sun, 4 Mar 2012 23:37:28 +0000"  >&lt;p&gt;This patch does not break anything, it changes the configuration mechanism for an unreleased feature.&lt;/p&gt;

&lt;p&gt;if you want a per-field similarity, then configure a &amp;lt;similarity&amp;gt; in your schema.xml that&lt;br/&gt;
extends PerFieldSimilarityWrapper. If you want it to defer to the fieldType in the schema,&lt;br/&gt;
then make it SchemaAware so that its initialized with an IndexSchema object.&lt;/p&gt;

&lt;p&gt;An example one (SchemaSimilarityFactory) is provided that just this, and here is its test: &lt;a href=&quot;http://svn.apache.org/repos/asf/lucene/dev/trunk/solr/core/src/test-files/solr/conf/schema-sim.xml&quot; class=&quot;external-link&quot;&gt;http://svn.apache.org/repos/asf/lucene/dev/trunk/solr/core/src/test-files/solr/conf/schema-sim.xml&lt;/a&gt;&lt;/p&gt;</comment>
                    <comment id="13222521" author="nhooey" created="Mon, 5 Mar 2012 19:13:31 +0000"  >&lt;p&gt;Thanks Robert, I&apos;ve got it working now. I just set my default similarity to &lt;tt&gt;SchemaSimilarityFactory&lt;/tt&gt; and it works just as it did before.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12513273" name="LUCENE-3749_part2.patch" size="175877" author="rcmuir" created="Sun, 5 Feb 2012 00:25:42 +0000" />
                    <attachment id="12513030" name="LUCENE-3749.patch" size="61554" author="rcmuir" created="Thu, 2 Feb 2012 20:37:55 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 2 Feb 2012 21:02:39 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>226348</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>23950</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
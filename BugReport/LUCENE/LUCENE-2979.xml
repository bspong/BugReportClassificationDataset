<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:32:40 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2979/LUCENE-2979.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2979] Simplify configuration API of contrib Query Parser</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2979</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;The current configuration API is very complicated and inherit the concept used by Attribute API to store token information in token streams. However, the requirements for both (QP config and token stream) are not the same, so they shouldn&apos;t be using the same thing.&lt;/p&gt;

&lt;p&gt;I propose to simplify QP config and make it less scary for people intending to use contrib QP. The task is not difficult, it will just require a lot of code change and figure out the best way to do it. That&apos;s why it&apos;s a good candidate for a GSoC project.&lt;/p&gt;

&lt;p&gt;I would like to hear good proposals about how to make the API more friendly and less scaring &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment></environment>
            <key id="12501921">LUCENE-2979</key>
            <summary>Simplify configuration API of contrib Query Parser</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="adriano_crestani">Adriano Crestani</assignee>
                                <reporter username="adriano_crestani">Adriano Crestani</reporter>
                        <labels>
                        <label>api-change</label>
                        <label>gsoc</label>
                        <label>gsoc2011</label>
                        <label>lucene-gsoc-11</label>
                        <label>mentor</label>
                    </labels>
                <created>Mon, 21 Mar 2011 06:02:57 +0000</created>
                <updated>Sun, 27 Nov 2011 12:31:40 +0000</updated>
                    <resolved>Thu, 8 Sep 2011 16:27:59 +0100</resolved>
                            <version>2.9</version>
                <version>3.0</version>
                                <fixVersion>3.4</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>modules/other</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13009166" author="yseeley@gmail.com" created="Mon, 21 Mar 2011 15:19:41 +0000"  >&lt;p&gt;moving out of 3.1 - this is not a release blocker&lt;/p&gt;</comment>
                    <comment id="13009972" author="phillipe.ramalho" created="Wed, 23 Mar 2011 02:22:02 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I am considering doing a gsoc proposal about this, any specific points I should be covering on the proposal?&lt;/p&gt;

&lt;p&gt;I saw Adriano&apos;s comment on another &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1823&quot; title=&quot;QueryParser with new features for Lucene 3&quot;&gt;LUCENE-1823&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The map idea is really good and fits well as configuration for the QP, but I would like to restrict the key type, so the user doesn&apos;t use a String object as key. String keys may lead to runtime errors, mainly when they are inserted inline. I would prefer to use enums as keys, it would enforce the user to always pass the same object as key when referencing the same configuration. It also avoids duplicated configuration keys, once each enum type has only one instance per JVM.&lt;/p&gt;

&lt;p&gt;If nobody complains about using a Map&amp;lt;Enum&amp;lt;?&amp;gt;, Object&amp;gt; as configuration for QP framework, I will start working on a new patch including these changes soon.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I will try to initially cover how we can use Map to replace the current config API. Also I would like to cover how/whether we can make the new API compatible with the old one, so users can migrate from old to new slowly, deprecating the old one of course. I will also investigate the best way to enforce the user to always pass the same key object. Also try to suggest an API that will allow the users to retrieve the config values without casting them from Object, maybe Java generic capability will enable it, but I am not sure it will work with Enum.&lt;/p&gt;

&lt;p&gt;Anything else I should be covering on the proposal?&lt;/p&gt;</comment>
                    <comment id="13011003" author="adriano_crestani" created="Thu, 24 Mar 2011 23:29:23 +0000"  >&lt;p&gt;Assigning to myself as I am willing to mentor&lt;/p&gt;</comment>
                    <comment id="13011049" author="adriano_crestani" created="Fri, 25 Mar 2011 00:41:06 +0000"  >&lt;p&gt;Hi Phillipe,&lt;/p&gt;

&lt;p&gt;It&apos;s good to see your interest on this project. I think what you plan to cover on the proposal is good enough. Don&apos;t forget to add a timeline and describe how much time you are willing to spend on this project this summer, also include any vacation period.&lt;/p&gt;</comment>
                    <comment id="13011539" author="phillipe.ramalho" created="Sat, 26 Mar 2011 02:23:56 +0000"  >&lt;p&gt;Here are my initial thoughts:&lt;/p&gt;

&lt;p&gt;There will be two types of config classes, as there is today, one for global configuration and other for field configuration. The global config class will hold reference to the field configurations. The field configuration will have the field name. They both will extend a common class, which is some kind of map.&lt;/p&gt;

&lt;p&gt;The key will be an special type (ConfigKey). This ConfigKey class will be final and will receive a generic argument when constructed. The user will need to define it and always use the same constants. To make sure the user uses it correctly, we can enforce ConfigKey.equals to only return true when the same instance is passed to equals method, so the map will only return the object for that key when the defined key is used. Example:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;// developer code&lt;br/&gt;
final public static ConfigKey&amp;lt;String&amp;gt; MY_CONFIG_KEY = new ConfigKey&amp;lt;String&amp;gt;();&lt;br/&gt;
...&lt;br/&gt;
String myConfig = getConfig().get(MY_CONFIG_KEY);&lt;br/&gt;
/////////////////&lt;br/&gt;
// user code&lt;br/&gt;
getConfig().set(MY_CONFIG_KEY, &quot;value1&quot;); // works&lt;br/&gt;
getConfig().set(new ConfigKey&amp;lt;String&amp;gt;(), &quot;value1&quot;); // does not work, as the developer&apos;s code will look up for the key the developer has previously defined, any other instance passed as key won&apos;t be found when the developer&apos;s code is executed&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I couldn&apos;t find a way to do the generic capability above with Enum. Actually, I don&apos;t see any reason to use Enum in this case.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                    <comment id="13011721" author="adriano_crestani" created="Sun, 27 Mar 2011 05:09:20 +0100"  >&lt;p&gt;Hi Phillip,&lt;/p&gt;

&lt;p&gt;I like your idea, similiar to the one I have, but I was planning to use enum, however, after spent some time thinking, I can&apos;t see how I can use generic the way you described only using enum. So go ahead with your idea and create a proposal &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Don&apos;t forget to describe how you plan make the old and new API work together.&lt;/p&gt;</comment>
                    <comment id="13012331" author="phillipe.ramalho" created="Tue, 29 Mar 2011 05:26:11 +0100"  >&lt;blockquote&gt;
&lt;p&gt;Don&apos;t forget to describe how you plan make the old and new API work together.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I will do, thanks for reminding me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="13014953" author="phillipe.ramalho" created="Sat, 2 Apr 2011 07:13:52 +0100"  >&lt;p&gt;Hi Adriano,&lt;/p&gt;

&lt;p&gt;I finally submitted my proposal. Comments are welcome!&lt;/p&gt;

&lt;p&gt;Note that I used the title &quot;Lucene-2979: Simplify configuration API of contrib Query Parser&quot; in the proposal. I hope you can find it, not sure how I can reference it.&lt;/p&gt;</comment>
                    <comment id="13015099" author="adriano_crestani" created="Sun, 3 Apr 2011 05:32:14 +0100"  >&lt;p&gt;Hi Phillipe,&lt;/p&gt;

&lt;p&gt;Good proposal, very detailed.&lt;/p&gt;

&lt;p&gt;Looking at the schedule table you created, it sounds like now the project is small for a two and half month project. However, I am probably underestimating the difficulty of the project, mainly because I am already used to the code. So you probably shouldn&apos;t worry about it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="13043551" author="rcmuir" created="Fri, 3 Jun 2011 17:40:44 +0100"  >&lt;p&gt;bulk move 3.2 -&amp;gt; 3.3&lt;/p&gt;</comment>
                    <comment id="13048918" author="phillipe.ramalho" created="Tue, 14 Jun 2011 01:48:10 +0100"  >&lt;p&gt;This is finally my first patch. Sorry for taking so long, but I started changing the API and it broke a lot of code, which took forever to fix. Now it&apos;s working and all junits are passing.&lt;/p&gt;

&lt;p&gt;So far, I changed the entire configuration API. Next step is to write more junits and update/write javadocs.&lt;/p&gt;</comment>
                    <comment id="13059327" author="phillipe.ramalho" created="Mon, 4 Jul 2011 07:00:51 +0100"  >&lt;p&gt;As Adriano asked me, here is the first patch ready to be committed. It includes javadoc and package.html and overview.html updated based on the changes I made to the code.&lt;/p&gt;

&lt;p&gt;I am still working on integrating the new API with the old API.&lt;/p&gt;</comment>
                    <comment id="13059329" author="adriano_crestani" created="Mon, 4 Jul 2011 07:20:03 +0100"  >&lt;p&gt;Hi Phillipe, thanks for the patch. However, as you did many changes to javadocs, I decided to run &quot;ant javadocs&quot; and it fails. It seems your patch references many times the constants in StandardQueryConfigHandler.ConfigurationKeys using @see tag, unfortunately you forgot to create a javadoc for those constants and it&apos;s causing the ant script to fail. Please, add these missing javadocs, run ant javadocs on contrib/queryparser to check if it finishes successfully and then submit a new patch.&lt;/p&gt;

&lt;p&gt;Besides that, great job, tests are running fine even after your big change &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                    <comment id="13059647" author="phillipe.ramalho" created="Tue, 5 Jul 2011 01:20:50 +0100"  >&lt;p&gt;Hi Adriano,&lt;/p&gt;

&lt;p&gt;Sorry for that, I forgot to add javadoc to those comments, they are pretty important.&lt;/p&gt;

&lt;p&gt;Anyway, the problem was not really the missing javadoc, but javadoc was not understanding the link to inner classes (Class.InnerClass#Constant), I had to reference the inner class directly (InnerClass#Constant).&lt;/p&gt;

&lt;p&gt;However, there is a still a javadoc warning, I just sent an email to the mailing list, I hope you saw it already, where I report the problem.&lt;/p&gt;

&lt;p&gt;Here is the third patch with javadoc fixes.&lt;/p&gt;</comment>
                    <comment id="13059648" author="phillipe.ramalho" created="Tue, 5 Jul 2011 01:21:40 +0100"  >&lt;p&gt;oops, I had forgotten to check the ASF license.&lt;/p&gt;</comment>
                    <comment id="13059651" author="adriano_crestani" created="Tue, 5 Jul 2011 01:59:02 +0100"  >&lt;p&gt;Hi Phillipe, thanks for the quick fix!&lt;/p&gt;

&lt;p&gt;Just committed your last patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2979&quot; title=&quot;Simplify configuration API of contrib Query Parser&quot;&gt;&lt;del&gt;LUCENE-2979&lt;/del&gt;&lt;/a&gt;_phillipe_ramalho_3.patch) on revision 1142862&lt;/p&gt;</comment>
                    <comment id="13073475" author="thetaphi" created="Mon, 1 Aug 2011 10:39:17 +0100"  >&lt;p&gt;There was an issue opened today: &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3352&quot; title=&quot;ParametricRangeQueryNodeProcessor support for time zones&quot;&gt;LUCENE-3352&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Maybe that is related to the config changes here, perhaps already fixed?&lt;/p&gt;</comment>
                    <comment id="13075973" author="phillipe.ramalho" created="Tue, 2 Aug 2011 01:09:31 +0100"  >&lt;p&gt;Here is a patch that backports the new configuration API to 3.x. I did exactly as I described in my proposal and it seems to be working as expected. I changed the documentation as well (I hope I everything, can you double check that Adriano?).&lt;/p&gt;

&lt;p&gt;I also created a simple example of how to use the new API in package.html and added to both 3.x and trunk.&lt;/p&gt;

&lt;p&gt;Please, let me know if everything looks good and if I didn&apos;t break any API.&lt;/p&gt;</comment>
                    <comment id="13075974" author="phillipe.ramalho" created="Tue, 2 Aug 2011 01:12:35 +0100"  >&lt;p&gt;Hi Uwe,&lt;/p&gt;

&lt;p&gt;Is there anything to be fixed in 3352? I see it&apos;s a &quot;new feature&quot; JIRA. Am I missing something?&lt;/p&gt;

&lt;p&gt;Currently, I am only working on migrating the old to new API and doing no changes on how the configuration is used. So nothing here changes (at least should not) how ParametricQueryNodeProcessor works.&lt;/p&gt;</comment>
                    <comment id="13078549" author="adriano_crestani" created="Wed, 3 Aug 2011 02:14:16 +0100"  >&lt;p&gt;Hi Phillipe,&lt;/p&gt;

&lt;p&gt;Thanks for the patch. I just applied your patch for 3x. It looks good.&lt;/p&gt;

&lt;p&gt;As you removed TestAttributes, can you create another junit to test whether configuration is updated when an attribute (like CharTermAttribute) is updated, which is basically the new functionality of the newly deprecated query parser attributes.&lt;/p&gt;</comment>
                    <comment id="13091610" author="phillipe.ramalho" created="Fri, 26 Aug 2011 06:57:05 +0100"  >&lt;p&gt;Creating a junit for attributes was a good idea, I was able to find many problems. I spent the last three weeks working on them and reviewing the code. I think this is the last patch for this jira, it should be done now.&lt;/p&gt;</comment>
                    <comment id="13100388" author="adriano_crestani" created="Thu, 8 Sep 2011 16:27:42 +0100"  >&lt;p&gt;Hi Phillipe,&lt;/p&gt;

&lt;p&gt;Just committed your latest patch. Thanks for the great job.&lt;/p&gt;

&lt;p&gt;I will set this item as completed now.&lt;/p&gt;</comment>
                    <comment id="13100416" author="mikemccand" created="Thu, 8 Sep 2011 17:07:32 +0100"  >&lt;p&gt;I think TestAttributes was accidentally committed to the wrong place?  It&apos;s in core now, but should be under contrib/queryparser instead?&lt;/p&gt;</comment>
                    <comment id="13100424" author="mikemccand" created="Thu, 8 Sep 2011 17:20:34 +0100"  >&lt;p&gt;OK, I just moved it.&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                                <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12515889">LUCENE-3352</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12485118" name="LUCENE-2979_phillipe_ramalho_2.patch" size="165781" author="phillipe.ramalho" created="Mon, 4 Jul 2011 07:00:51 +0100" />
                    <attachment id="12485188" name="LUCENE-2979_phillipe_ramalho_3.patch" size="171263" author="phillipe.ramalho" created="Tue, 5 Jul 2011 01:21:40 +0100" />
                    <attachment id="12485187" name="LUCENE-2979_phillipe_ramalho_3.patch" size="171263" author="phillipe.ramalho" created="Tue, 5 Jul 2011 01:20:50 +0100" />
                    <attachment id="12488839" name="LUCENE-2979_phillipe_ramalho_4_3x.patch" size="162944" author="phillipe.ramalho" created="Tue, 2 Aug 2011 01:09:31 +0100" />
                    <attachment id="12488840" name="LUCENE-2979_phillipe_ramalho_4_trunk.patch" size="2829" author="phillipe.ramalho" created="Tue, 2 Aug 2011 01:09:31 +0100" />
                    <attachment id="12491740" name="LUCENE-2979_phillipe_ramalho_5_3x.patch" size="41048" author="phillipe.ramalho" created="Fri, 26 Aug 2011 06:57:05 +0100" />
                    <attachment id="12482500" name="LUCENE-2979_phillipe_reamalho.patch" size="151242" author="phillipe.ramalho" created="Tue, 14 Jun 2011 01:48:09 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>7.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 21 Mar 2011 15:19:41 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3938</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24713</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
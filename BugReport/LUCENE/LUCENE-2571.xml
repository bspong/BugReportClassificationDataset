<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 12:58:28 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2571/LUCENE-2571.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2571] Indexing performance tests with realtime branch</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2571</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;We should run indexing performance tests with the DWPT changes and compare to trunk.&lt;/p&gt;

&lt;p&gt;We need to test both single-threaded and multi-threaded performance.&lt;/p&gt;

&lt;p&gt;NOTE:  flush by RAM isn&apos;t implemented just yet, so either we wait with the tests or flush by doc count.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12470294">LUCENE-2571</key>
            <summary>Indexing performance tests with realtime branch</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="simonw">Simon Willnauer</assignee>
                                <reporter username="michaelbusch">Michael Busch</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Jul 2010 21:54:11 +0100</created>
                <updated>Mon, 14 Nov 2011 10:08:50 +0000</updated>
                    <resolved>Mon, 14 Nov 2011 10:08:50 +0000</resolved>
                                            <fixVersion>Realtime Branch</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>3</watches>
                                                    <comments>
                    <comment id="13019853" author="simonw" created="Thu, 14 Apr 2011 15:49:14 +0100"  >&lt;p&gt;benchmarks charts attached&lt;/p&gt;</comment>
                    <comment id="13019890" author="simonw" created="Thu, 14 Apr 2011 17:21:35 +0100"  >&lt;p&gt;I run batch indexing benchmarks trunk vs. realtime branch with addDocument and with updateDocument. &lt;/p&gt;

&lt;p&gt;For add document I indexed 10M wikipedia docs into a spinning disk reading from a separate SSD&lt;/p&gt;

&lt;p&gt;Here is the realtime graph:&lt;br/&gt;
&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12476341/12476341_wikimedium.realtime.Standard.nd10M_dps_addDocuments.png&quot; align=&quot;absmiddle&quot; border=&quot;0&quot; /&gt;&lt;/p&gt;

&lt;p&gt;vs. trunk:&lt;br/&gt;
&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12476344/12476344_wikimedium.trunk.Standard.nd10M_dps_addDocuments.png&quot; align=&quot;absmiddle&quot; border=&quot;0&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This graph shows how DWPT is flushing to disk over time:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12476342/12476342_wikimedium.realtime.Standard.nd10M_dps_addDocuments_flush.png&quot; align=&quot;absmiddle&quot; border=&quot;0&quot; /&gt;&lt;/p&gt;

&lt;p&gt;for updateDocument I build a 10M docs wiki index and indexed the exact same documents with updateDocument here are the results:&lt;br/&gt;
Realtime Branch:&lt;br/&gt;
&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12476351/12476351_wikimedium.realtime.Standard.nd10M_dps.png&quot; align=&quot;absmiddle&quot; border=&quot;0&quot; /&gt;&lt;/p&gt;

&lt;p&gt;trunk:&lt;br/&gt;
&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12476352/12476352_wikimedium.trunk.Standard.nd10M_dps.png&quot; align=&quot;absmiddle&quot; border=&quot;0&quot; /&gt;&lt;/p&gt;
</comment>
                    <comment id="13019892" author="simonw" created="Thu, 14 Apr 2011 17:22:47 +0100"  >&lt;p&gt;updated attachements&lt;/p&gt;</comment>
                    <comment id="13020147" author="lancenorskog" created="Fri, 15 Apr 2011 02:09:49 +0100"  >&lt;p&gt;Would you consider trying other MergePolicy objects on trunk? The BalancedSegment MP tries to avoid these long stoppages.  &lt;/p&gt;</comment>
                    <comment id="13020206" author="simonw" created="Fri, 15 Apr 2011 07:28:17 +0100"  >&lt;blockquote&gt;&lt;p&gt;Would you consider trying other MergePolicy objects on trunk? The BalancedSegment MP tries to avoid these long stoppages.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think there is a misunderstanding on your side. The long stoppages on trunk are not due to merges at all. They are due to flushing the DocumentsWriter which essentially means stop the world. This is why we can not make any progress. Merges are NOT blocking indexing on trunk no matter which MP you use. The Balanced MP is rather suited for RT environments to make reopening the reader quicker. &lt;/p&gt;

&lt;p&gt;you should maybe look at this blog entry for a more complete explanation: &lt;a href=&quot;http://blog.jteam.nl/2011/04/01/gimme-all-resources-you-have-i-can-use-them/&quot; class=&quot;external-link&quot;&gt;http://blog.jteam.nl/2011/04/01/gimme-all-resources-you-have-i-can-use-them/&lt;/a&gt;&lt;/p&gt;</comment>
                    <comment id="13020217" author="earwin" created="Fri, 15 Apr 2011 08:15:13 +0100"  >&lt;blockquote&gt;&lt;p&gt;Merges are NOT blocking indexing on trunk no matter which MP you use.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Well.. merges tie up IO (especially if not on fancy SSDs/RAIDs), which in turn lags flushes -&amp;gt; bigger delays for stop the world flushes / lower bandwith cap (after which they are forced to stop the world) for parallel flushes.&lt;/p&gt;

&lt;p&gt;So Lance&apos;s point is partially valid.&lt;/p&gt;</comment>
                    <comment id="13020230" author="simonw" created="Fri, 15 Apr 2011 09:03:43 +0100"  >&lt;blockquote&gt;&lt;p&gt;Well.. merges tie up IO (especially if not on fancy SSDs/RAIDs), which in turn lags flushes -&amp;gt; bigger delays for stop the world flushes / lower bandwith cap (after which they are forced to stop the world) for parallel flushes.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;True it will make a difference in certain situations but not for this benchmark RT does way more merges here since we are flushing way more segments. the time windows I used here is where we almost don&apos;t merge at all in the trunk run so it should not make a difference.&lt;/p&gt;

&lt;p&gt;I ran those benchmarks again with BalancedSegmentMergePolicy and it doesn&apos;t make any difference really. see below&lt;br/&gt;
&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12476435/12476435_wikimedium.trunk.Standard.nd10M_dps_BalancedSegmentMergePolicy.png&quot; align=&quot;absmiddle&quot; border=&quot;0&quot; /&gt;&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10032">
                <name>Blocker</name>
                                                <inwardlinks description="is blocked by">
                            <issuelink>
            <issuekey id="12470358">LUCENE-2573</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12476342" name="wikimedium.realtime.Standard.nd10M_dps_addDocuments_flush.png" size="7049" author="simonw" created="Thu, 14 Apr 2011 15:49:14 +0100" />
                    <attachment id="12476341" name="wikimedium.realtime.Standard.nd10M_dps_addDocuments.png" size="9960" author="simonw" created="Thu, 14 Apr 2011 15:49:14 +0100" />
                    <attachment id="12476351" name="wikimedium.realtime.Standard.nd10M_dps.png" size="9877" author="simonw" created="Thu, 14 Apr 2011 17:22:47 +0100" />
                    <attachment id="12476344" name="wikimedium.trunk.Standard.nd10M_dps_addDocuments.png" size="7959" author="simonw" created="Thu, 14 Apr 2011 15:49:14 +0100" />
                    <attachment id="12476435" name="wikimedium.trunk.Standard.nd10M_dps_BalancedSegmentMergePolicy.png" size="8244" author="simonw" created="Fri, 15 Apr 2011 09:00:58 +0100" />
                    <attachment id="12476352" name="wikimedium.trunk.Standard.nd10M_dps.png" size="8396" author="simonw" created="Thu, 14 Apr 2011 17:22:47 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>6.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 14 Apr 2011 14:49:14 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11262</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25121</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
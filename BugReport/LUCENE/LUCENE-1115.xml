<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:05:07 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1115/LUCENE-1115.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1115] Some small fixes to contrib/benchmark</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1115</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;I&apos;ve fixed a few small issues I&apos;ve hit in contrib/benchmark.&lt;/p&gt;

&lt;p&gt;First, this alg was only doing work on the first round.  All&lt;br/&gt;
subsequent rounds immediately finished:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;analyzer=org.apache.lucene.analysis.standard.StandardAnalyzer
doc.maker=org.apache.lucene.benchmark.byTask.feeds.LineDocMaker
work.dir = /lucene/work
docs.file=work/reuters.lines.txt
doc.maker.forever=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
directory=FSDirectory
doc.add.log.step=3000

{ &lt;span class=&quot;code-quote&quot;&gt;&quot;Rounds&quot;&lt;/span&gt;
  ResetSystemErase
  CreateIndex
  { &lt;span class=&quot;code-quote&quot;&gt;&quot;AddDocs&quot;&lt;/span&gt; AddDoc &amp;gt; : *
  CloseIndex
  NewRound
} : 3
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think this is because we are failing to reset &quot;exhausted&quot; to false&lt;br/&gt;
in PerfTask.doLogic(), so I added that.  Plus I had to re-open the&lt;br/&gt;
file in LineDocMaker.&lt;/p&gt;

&lt;p&gt;Second, I made a small optimization to not call updateExhausted unless&lt;br/&gt;
any of the child tasks are TaskSequence or ResetInputsTask (which I&lt;br/&gt;
compute up-front).&lt;/p&gt;

&lt;p&gt;Finally, we were not allowing flushing by RAM and doc count, so I&lt;br/&gt;
fixed the logic in Create/OpenIndexTask to set both RAMBufferSizeMB&lt;br/&gt;
and MaxBufferedDocs.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12385446">LUCENE-1115</key>
            <summary>Some small fixes to contrib/benchmark</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Jan 2008 17:30:00 +0000</created>
                <updated>Fri, 25 Jan 2008 03:24:16 +0000</updated>
                    <resolved>Thu, 3 Jan 2008 01:52:03 +0000</resolved>
                            <version>2.3</version>
                                <fixVersion>2.3</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12555346" author="mikemccand" created="Wed, 2 Jan 2008 17:32:39 +0000"  >&lt;p&gt;Attached patch.  All tests pass.  I plan to commit in a day or so.&lt;/p&gt;</comment>
                    <comment id="12555441" author="doronc" created="Wed, 2 Jan 2008 23:25:02 +0000"  >&lt;p&gt;Definitely a bug.&lt;br/&gt;
Patch looks good, and I like the optimization, thanks for fixing this Mike.&lt;/p&gt;

&lt;p&gt;Perhaps rename in TaskSequence from &lt;b&gt;anyExhaustedTasks&lt;/b&gt; to &lt;b&gt;anyExhaustableTasks&lt;/b&gt;?&lt;/p&gt;

&lt;p&gt;Also, this new test (belongs in TestPerfTaskLogic) passes with the fix but fails without it:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  /**
   * Test that exhaust in loop works as expected (LUCENE-1115).
   */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testExhaustedLooped() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-comment&quot;&gt;// 1. alg definition (required in every &lt;span class=&quot;code-quote&quot;&gt;&quot;logic&quot;&lt;/span&gt; test)
&lt;/span&gt;    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; algLines[] = {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;# ----- properties &quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;doc.maker=&quot;&lt;/span&gt;+Reuters20DocMaker.class.getName(),
        &lt;span class=&quot;code-quote&quot;&gt;&quot;doc.add.log.step=3&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;doc.term.vector=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;doc.maker.forever=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;directory=RAMDirectory&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;doc.stored=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;doc.tokenized=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;debug.level=1&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;# ----- alg &quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;{ \&quot;&lt;/span&gt;Rounds\&quot;&quot;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;  ResetSystemErase&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;  CreateIndex&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;  { \&quot;&lt;/span&gt;AddDocs\&lt;span class=&quot;code-quote&quot;&gt;&quot;  AddDoc &amp;gt; : * &quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;  CloseIndex&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;} : 2&quot;&lt;/span&gt;,
    };
    
    &lt;span class=&quot;code-comment&quot;&gt;// 2. execute the algorithm  (required in every &lt;span class=&quot;code-quote&quot;&gt;&quot;logic&quot;&lt;/span&gt; test)
&lt;/span&gt;    Benchmark benchmark = execBenchmark(algLines);

    &lt;span class=&quot;code-comment&quot;&gt;// 3. test number of docs in the index
&lt;/span&gt;    IndexReader ir = IndexReader.open(benchmark.getRunData().getDirectory());
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; ndocsExpected = 20; &lt;span class=&quot;code-comment&quot;&gt;// Reuters20DocMaker exhausts after 20 docs.
&lt;/span&gt;    assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;wrong number of docs in the index!&quot;&lt;/span&gt;, ndocsExpected, ir.numDocs());
    ir.close();
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Doron&lt;/p&gt;</comment>
                    <comment id="12555453" author="mikemccand" created="Thu, 3 Jan 2008 00:34:26 +0000"  >&lt;p&gt;Awesome, I will add that test case.  Thanks Doron!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12372407" name="LUCENE-1115.patch" size="7327" author="mikemccand" created="Wed, 2 Jan 2008 17:32:38 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 2 Jan 2008 23:25:02 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12630</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26614</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
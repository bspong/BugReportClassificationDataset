<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:23:36 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2015/LUCENE-2015.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2015] ASCIIFoldingFilter: expose folding logic + small improvements to ISOLatin1AccentFilter</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2015</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;This patch adds a couple of non-ascii chars to ISOLatin1AccentFilter (namely: left &amp;amp; right single quotation marks, en dash, em dash) which we very frequently encounter in our projects. I know that this class is now deprecated; this improvement is for legacy code that hasn&apos;t migrated yet.&lt;/p&gt;

&lt;p&gt;It also enables easy access to the ascii folding technique use in ASCIIFoldingFilter for potential re-use in non-Lucene-related code.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12439428">LUCENE-2015</key>
            <summary>ASCIIFoldingFilter: expose folding logic + small improvements to ISOLatin1AccentFilter</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="cedrik_lime">C&#233;drik LIME</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Oct 2009 17:01:54 +0000</created>
                <updated>Fri, 10 May 2013 11:43:18 +0100</updated>
                    <resolved>Fri, 12 Mar 2010 14:35:09 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                <component>modules/analysis</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12771479" author="cedrik_lime" created="Thu, 29 Oct 2009 17:03:05 +0000"  >&lt;p&gt;(UTF-8 encoding)&lt;/p&gt;</comment>
                    <comment id="12771481" author="rcmuir" created="Thu, 29 Oct 2009 17:07:01 +0000"  >&lt;p&gt;C&#233;drik, is it possible to provide a patch without the formatting changes?&lt;/p&gt;

&lt;p&gt;I am having trouble seeing the changes you made to ASCIIFoldingFilter.&lt;/p&gt;

&lt;p&gt;btw, I think ISOLatin1AccentFilter only stays around for back compat to support old indexes, in my opinion we should not modify it for this reason.&lt;/p&gt;</comment>
                    <comment id="12771496" author="cedrik_lime" created="Thu, 29 Oct 2009 17:36:17 +0000"  >&lt;p&gt;Robert,&lt;/p&gt;

&lt;p&gt;All I did is refactor the big switch(c) into its own method:&lt;br/&gt;
  public static final int foldToASCII(char c, char[] output, int outputPos)&lt;br/&gt;
and change the caller (public void foldToASCII(char[] input, int length)) accordingly.&lt;/p&gt;

&lt;p&gt;I can submit a patch without formatting changes, but that means the source won&apos;t be nicely indented...&lt;br/&gt;
Please advise.&lt;/p&gt;

&lt;p&gt;As for the ISOLatin1AccentFilter patch, it really is to enable us to remove a workaround for an issue we had with some special (yet frequent) chars. Feel free to ignore it should you think this part is not relevant.&lt;/p&gt;</comment>
                    <comment id="12771524" author="rcmuir" created="Thu, 29 Oct 2009 18:02:35 +0000"  >&lt;p&gt;C&#233;drik, in my opinion, it would be easier to see the patch without the formatting changes if possible.&lt;/p&gt;

&lt;p&gt;Even if there is bad indentation currently, I think this should be corrected in a separate patch.&lt;/p&gt;</comment>
                    <comment id="12771538" author="cedrik_lime" created="Thu, 29 Oct 2009 18:34:06 +0000"  >&lt;p&gt;Here are the patches (UTF-8 encoding), 1 per filter.&lt;br/&gt;
I have removed the formatting on the switch(c) in ASCIIFoldingFilter for easier review.&lt;/p&gt;</comment>
                    <comment id="12771546" author="rcmuir" created="Thu, 29 Oct 2009 18:43:17 +0000"  >&lt;p&gt;C&#233;drik,&lt;/p&gt;

&lt;p&gt;I think adding the idea of adding a public static method for folding is OK. but I think it should essentially do what foldToAscii does, not operate on a single &apos;char&apos;.&lt;/p&gt;

&lt;p&gt;we should avoid single &apos;char&apos; as parameter arguments, instead it should work on the entire char[] I think ?&lt;/p&gt;</comment>
                    <comment id="12771557" author="cedrik_lime" created="Thu, 29 Oct 2009 18:55:16 +0000"  >&lt;p&gt;Indeed, and that was my primary (internal) patch.&lt;br/&gt;
But then you loose the shared &quot;output&quot; buffer between incrementToken() calls, and you end up creating char[]&apos;s like there is no tomorrow, which may be a performance regression.&lt;/p&gt;

&lt;p&gt;What I can do is /add/ a static method that operates on a char[], for convenient external use.&lt;br/&gt;
What do you think?&lt;/p&gt;</comment>
                    <comment id="12771564" author="rcmuir" created="Thu, 29 Oct 2009 19:07:10 +0000"  >&lt;p&gt;C&#233;drik, why would you create char[]&apos;s like there is no tomorrow if you add a static method that operates on char[], for external use, but also use this within the incrementToken(), passing the tokenBuffer as an argument?&lt;/p&gt;</comment>
                    <comment id="12771568" author="thetaphi" created="Thu, 29 Oct 2009 19:13:02 +0000"  >&lt;p&gt;We cannot apply the patch to ISOLatin1Filter, as it would break indexes already using it. Because of that we migrated to ASCIIFoldingFilter and kept ISOLatin1Filter alive. So we should leave it as it is.&lt;/p&gt;

&lt;p&gt;To the buffer problem: For easy external use we could also provide a expert API that works like the current public foldToASCII method, which is memory efficient. But may also provide String/StringBuilder converters for external use. Internal it cannot be better as it currently is &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12771576" author="cedrik_lime" created="Thu, 29 Oct 2009 19:40:25 +0000"  >&lt;p&gt;Uwe,&lt;/p&gt;

&lt;p&gt;ISOLatin1AccentFilter was already modified in Lucene 2.4: see &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1351&quot; title=&quot;Add some ligatures (ff, fi, fl, ft, st) to ISOLatin1AccentFilter&quot;&gt;&lt;del&gt;LUCENE-1351&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As for ASCIIFoldingFilter, I will take a second shot at an expert API next week. Stay tuned!&lt;/p&gt;</comment>
                    <comment id="12771578" author="rcmuir" created="Thu, 29 Oct 2009 19:49:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;ISOLatin1AccentFilter was already modified in Lucene 2.4: see &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1351&quot; title=&quot;Add some ligatures (ff, fi, fl, ft, st) to ISOLatin1AccentFilter&quot;&gt;&lt;del&gt;LUCENE-1351&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;that&apos;s interesting, so if someone has a &amp;lt; Lucene 2.4 index built with this filter, its currently not compatible... &lt;br/&gt;
I guess no one has complained but there could be some conditional logic based on Version to support those indexes...&lt;/p&gt;</comment>
                    <comment id="12771592" author="thetaphi" created="Thu, 29 Oct 2009 20:24:05 +0000"  >&lt;p&gt;I would leave ISOLatin1AccentFilter as it is. No version logic for already deprecated classes, they are deprecated, so no support any more. Normally we would have removed it in 3.0, it is really only be there to support old indexes, so no new features. If until now, nobody complained, we do not need to care. Maybe the modifications were so special, that only some of the term in such indexes were affected and nobody realized that difference.&lt;/p&gt;</comment>
                    <comment id="12771593" author="mikemccand" created="Thu, 29 Oct 2009 20:27:43 +0000"  >&lt;p&gt;I think those changes to ISOLatin1AccentFilter predated our Version logic... I agree that had Version been around we probably should have used it.&lt;/p&gt;</comment>
                    <comment id="12772985" author="cedrik_lime" created="Tue, 3 Nov 2009 09:53:36 +0000"  >&lt;p&gt;As suggested by Robert, here is a new version of the ASCIIFoldingFilter patch which exposes the folding logic.&lt;br/&gt;
I have added 2 convenience methods that can operate on a char[] and on a CharSequence.&lt;/p&gt;</comment>
                    <comment id="12773014" author="rcmuir" created="Tue, 3 Nov 2009 11:03:23 +0000"  >&lt;p&gt;C&#233;drik, thanks!&lt;/p&gt;

&lt;p&gt;at a glance this looks good to me... can look at it more thoroughly later, i am heading out of town.&lt;/p&gt;</comment>
                    <comment id="12786710" author="markrmiller@gmail.com" created="Sun, 6 Dec 2009 21:36:02 +0000"  >&lt;p&gt;For this type of stuff &quot;no one has complained&quot; doesn&apos;t mean much - thats why these changes are so insidious - they are easy not to notice - docs just disappear, and users likely don&apos;t know they ever existed. For some apps this is absolutely disastrous.&lt;/p&gt;

&lt;p&gt;We prob should have been more careful with 1351 and more careful in the future.&lt;/p&gt;</comment>
                    <comment id="12843539" author="cedrik_lime" created="Wed, 10 Mar 2010 11:53:07 +0000"  >&lt;p&gt;Robert, any news on this patch? Can we get it applied for Lucene 3.1?&lt;/p&gt;</comment>
                    <comment id="12843552" author="rcmuir" created="Wed, 10 Mar 2010 12:55:14 +0000"  >&lt;p&gt;C&#233;drik: i brought the patch up to date, but modified it slightly.&lt;/p&gt;

&lt;p&gt;The reasoning is, I would prefer if we just expose one method in this case.&lt;/p&gt;</comment>
                    <comment id="12843589" author="cedrik_lime" created="Wed, 10 Mar 2010 15:19:26 +0000"  >&lt;p&gt;Robert: I liked the dual approach (fold 1 &lt;tt&gt;char&lt;/tt&gt; / a &lt;tt&gt;char[]&lt;/tt&gt;) as it offered maximum flexibility (folding a String didn&apos;t incur a systematic copy of the input as &lt;tt&gt;toCharArray()&lt;/tt&gt; does, I could use &lt;tt&gt;charAt()&lt;/tt&gt; in a loop).&lt;br/&gt;
Nevertheless, I will be happy with a single method if this is your preferred approach.&lt;/p&gt;

&lt;p&gt;I have updated your patch slightly to model the API after &lt;tt&gt;System.arraycopy()&lt;/tt&gt;, which makes it a bit more flexible and easier to use:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;added offset for output&lt;/li&gt;
	&lt;li&gt;shuffled the arguments order to mimic &lt;tt&gt;System.arraycopy()&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;updated JavaDoc&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12843593" author="rcmuir" created="Wed, 10 Mar 2010 15:29:43 +0000"  >&lt;p&gt;Thanks C&#233;drik, I like your latest change.&lt;/p&gt;

&lt;p&gt;My primary reasoning for minimizing the API is because each exposed &lt;br/&gt;
method has some cost to us (backwards compatibility).&lt;/p&gt;

&lt;p&gt;I think if someone wants to fold a String they can still work with this API,&lt;br/&gt;
e.g. use a char&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; container, and not even bother if charAt() &amp;lt; 0x7F, etc.&lt;/p&gt;

&lt;p&gt;In general I guess i am less concerned about this as the Lucene API &lt;br/&gt;
doesn&apos;t use String.&lt;/p&gt;

&lt;p&gt;I will commit in a day or two if no one objects.&lt;/p&gt;</comment>
                    <comment id="12844519" author="rcmuir" created="Fri, 12 Mar 2010 14:35:09 +0000"  >&lt;p&gt;Committed revision 922277.&lt;/p&gt;

&lt;p&gt;Thanks C&#233;drik!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12423907" name="ASCIIFoldingFilter-no_formatting.patch" size="3855" author="cedrik_lime" created="Tue, 3 Nov 2009 09:53:36 +0000" />
                    <attachment id="12423602" name="ASCIIFoldingFilter-no_formatting.patch" size="2224" author="cedrik_lime" created="Thu, 29 Oct 2009 18:34:06 +0000" />
                    <attachment id="12423592" name="Filters.patch" size="225777" author="cedrik_lime" created="Thu, 29 Oct 2009 17:03:05 +0000" />
                    <attachment id="12423601" name="ISOLatin1AccentFilter.patch" size="5882" author="cedrik_lime" created="Thu, 29 Oct 2009 18:34:06 +0000" />
                    <attachment id="12438409" name="LUCENE-2015.patch" size="1468" author="cedrik_lime" created="Wed, 10 Mar 2010 15:19:26 +0000" />
                    <attachment id="12438407" name="LUCENE-2015.patch" size="1380" author="rcmuir" created="Wed, 10 Mar 2010 12:55:14 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>6.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 29 Oct 2009 17:07:01 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11758</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25710</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:17:54 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2488/LUCENE-2488.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2488] Fix 2.9 contrib builds to succeed when JDK 1.4 is used (leaving out contribs that require 1.5)</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2488</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;When you build and test Lucene 2.9 with Java 1.4, building and testing of contrib fails. This patch fixes this to repect the current compiler version and disables all contribs that need Java 1.5 by checking their javac.source property.&lt;/p&gt;

&lt;p&gt;This patch can be ported to 3.x or trunk, when 1.6 contribs will appear.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12466226">LUCENE-2488</key>
            <summary>Fix 2.9 contrib builds to succeed when JDK 1.4 is used (leaving out contribs that require 1.5)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Jun 2010 23:42:01 +0100</created>
                <updated>Fri, 18 Jun 2010 09:04:10 +0100</updated>
                    <resolved>Sat, 5 Jun 2010 22:02:40 +0100</resolved>
                            <version>2.9</version>
                <version>2.9.1</version>
                <version>2.9.2</version>
                                <fixVersion>2.9.3</fixVersion>
                                <component>general/build</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12875793" author="thetaphi" created="Sat, 5 Jun 2010 00:35:05 +0100"  >&lt;p&gt;Patch for build.xmls. This also marks benchmark as 1.5, as it depends on fast-vector-highlighter that is 1.5.&lt;/p&gt;

&lt;p&gt;I will commit this soon and build the final artifacts of 2.9.3 and 3.0.2!&lt;/p&gt;</comment>
                    <comment id="12875796" author="rcmuir" created="Sat, 5 Jun 2010 00:44:57 +0100"  >&lt;blockquote&gt;&lt;p&gt;This patch fixes this to repect the current compiler version and disables all contribs that need Java 1.5 by checking their javac.source property.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This patch can be ported to 3.x or trunk, when 1.6 contribs will appear.&lt;/p&gt;


&lt;p&gt;I don&apos;t think we should do this. Please don&apos;t commit this it should be discussed more.&lt;/p&gt;

&lt;p&gt;I know you hate java 1.6, etc. but i don&apos;t want to write code that silently fails depending upon environment. a hard error is best.&lt;/p&gt;
</comment>
                    <comment id="12875862" author="thetaphi" created="Sat, 5 Jun 2010 06:16:35 +0100"  >&lt;p&gt;Hi Robert,&lt;/p&gt;

&lt;p&gt;in Lucene 2.9, it was intended to work like this, as this code is already there, but the recent added contribs did not use the property at all! Lucene 2.9 is Java 1.4, so it &lt;b&gt;must&lt;/b&gt; compile, if you run it with this JDK version.&lt;/p&gt;

&lt;p&gt;Without this, it&apos;s impossible to check the dependency correctly, and because of this I &lt;b&gt;fixed&lt;/b&gt; this. I dont want to commit this in 3.x or trunk! So please just tell, if you are fine with &lt;b&gt;fixing&lt;/b&gt; it in Lucebe 2.9, so it works as expected!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;This patch can be ported to 3.x or trunk, when 1.6 contribs will appear.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This patch is for Lucene 2.9 branch only!&lt;/p&gt;</comment>
                    <comment id="12875883" author="thetaphi" created="Sat, 5 Jun 2010 08:52:25 +0100"  >&lt;p&gt;More ant magic.&lt;/p&gt;

&lt;p&gt;This patch does not automatically exclude 1.5 only contribs, it fails per default with an error message:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Buildfile: build.xml
     [echo] Building fast-vector-highlighter...

javacc-uptodate-check:

javacc-notice:

jflex-uptodate-check:

jflex-notice:

common.init:

fail-jdk14-version:

BUILD FAILED
contrib-build.xml:98: Contrib &apos;fast-vector-highlighter&apos; needs at least JDK 1.5 to build. If you only want to compile Java 1.4 compatible contribs, add &apos;-Dforce.jdk14.build=true&apos; to command line.

Total time: 0 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For testing a whole &quot;ant test&quot; with JDK 1.4 you can pass the mentioned property, so it excludes als Java 1.5 contribs. With this its possible for me as release manager of 2.9, to test compatibility with Java 1.4.&lt;/p&gt;

&lt;p&gt;Robert, are you fine with that for 2.9.3? If we need something similar in trunk, we &lt;b&gt;may&lt;/b&gt; think about adding a similar ant magic to the trunk/3x build scripts. But this is not part of this issue, this is fix for 2.9.3 only.&lt;/p&gt;</comment>
                    <comment id="12875887" author="mikemccand" created="Sat, 5 Jun 2010 11:09:52 +0100"  >&lt;p&gt;This looks like a great step forward &amp;#8211; we can now &lt;span class=&quot;error&quot;&gt;&amp;#91;optionally; off by default&amp;#93;&lt;/span&gt; assert those modules (core, contribs) that &quot;claim&quot; to be &amp;lt;= JDK X in fact compile &amp;amp; pass tests with JDK X.&lt;/p&gt;

&lt;p&gt;So we now default to a hard error.... but if you want (eg you are the RM), you can pass -Dforce.jdk14.build=true, and skip those contribs requiring &amp;gt; X.  I agree the default should be brittle (hard error).&lt;/p&gt;

&lt;p&gt;Can we use this for Solr/Lucene on trunk/3x?  Ie Solr requires JDK &amp;gt;= 1.6, but Lucene is &amp;gt;= 1.5; we don&apos;t want 1.6 features to accidentally sneak into Lucene...&lt;/p&gt;</comment>
                    <comment id="12875899" author="rcmuir" created="Sat, 5 Jun 2010 13:00:54 +0100"  >&lt;p&gt;The new option is great, thanks Uwe.&lt;/p&gt;

&lt;p&gt;i understood all along the patch is for 2.9.x only. I didnt want us to set a precedent where the build allows things to be skipped depending on environment.&lt;br/&gt;
Then the tests are passing for one developer and not for another, releasers could accidentally not build all artifacts, ...&lt;/p&gt;
</comment>
                    <comment id="12875900" author="thetaphi" created="Sat, 5 Jun 2010 13:06:53 +0100"  >&lt;blockquote&gt;&lt;p&gt;I didnt want us to set a precedent where the build allows things to be skipped depending on environment. Then the tests are passing for one developer and not for another, releasers could accidentally not build all artifacts, ...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks, I think the new option is fine now and works in all combinations. I already verified that the whole build and test suite (with the ignore 1.5 contribs option) succeed with JDK 1.4.2_19. This is good to know as the release manager.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can we use this for Solr/Lucene on trunk/3x? Ie Solr requires JDK &amp;gt;= 1.6, but Lucene is &amp;gt;= 1.5; we don&apos;t want 1.6 features to accidentally sneak into Lucene...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Of course, but we should do this in another issue. I will commit this evening and create the release artifacts!&lt;/p&gt;</comment>
                    <comment id="12875938" author="thetaphi" created="Sat, 5 Jun 2010 22:02:40 +0100"  >&lt;p&gt;Committed revision: 951767&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12446406" name="LUCENE-2488.patch" size="13730" author="thetaphi" created="Sat, 5 Jun 2010 08:54:42 +0100" />
                    <attachment id="12446383" name="LUCENE-2488.patch" size="13022" author="thetaphi" created="Sat, 5 Jun 2010 00:35:04 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Fri, 4 Jun 2010 23:44:57 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11334</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25204</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:03:00 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1084/LUCENE-1084.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1084] increase default maxFieldLength?</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1084</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;To my understanding, Lucene 2.3 will easily index large documents. So shouldn&apos;t we get rid of the 10,000 default limit for the field length? 10,000 isn&apos;t that much and as Lucene doesn&apos;t have any error logging by default, this is a common problem for users that is difficult to debug if you don&apos;t know where to look.&lt;/p&gt;

&lt;p&gt;A better new default might be Integer.MAX_VALUE.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12384212">LUCENE-1084</key>
            <summary>increase default maxFieldLength?</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="steve_rowe">Steve Rowe</assignee>
                                <reporter username="lucenebugs@danielnaber.de">Daniel Naber</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Dec 2007 22:36:03 +0000</created>
                <updated>Sat, 11 Oct 2008 13:49:34 +0100</updated>
                    <resolved>Thu, 7 Feb 2008 18:22:47 +0000</resolved>
                            <version>2.2</version>
                                <fixVersion>2.4</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12559440" author="mikemccand" created="Wed, 16 Jan 2008 10:52:10 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Users frequently trip up on this one, and the fact that we silently truncate at 10,000 tokens is &quot;unexpected&quot;.  I think the default should be Integer.MAX_VALUE.&lt;/p&gt;

&lt;p&gt;How about doing this for 2.4?&lt;/p&gt;</comment>
                    <comment id="12559490" author="gsingers" created="Wed, 16 Jan 2008 13:30:39 +0000"  >&lt;p&gt;Does this break back-compatibility if we change this in a minor version? &lt;/p&gt;</comment>
                    <comment id="12559549" author="mikemccand" created="Wed, 16 Jan 2008 15:55:05 +0000"  >
&lt;blockquote&gt;
&lt;p&gt;Does this break back-compatibility if we change this in a minor version?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Technically it does, but I think (guesssing?) most of the time when&lt;br/&gt;
this limit kicks in, the application (if they knew about it) would&lt;br/&gt;
consider it a bug?  Ie, fixing this would almost always improve&lt;br/&gt;
applications?&lt;/p&gt;

&lt;p&gt;I think most Lucene users are not aware that this truncation is&lt;br/&gt;
occurring (it&apos;s not something you&apos;d expect).&lt;/p&gt;

&lt;p&gt;Or, are we thinking that there are quite a few applications where&lt;br/&gt;
truly enormous documents are indexed and this change is going to cause&lt;br/&gt;
massive slowdown for such applications?&lt;/p&gt;</comment>
                    <comment id="12559583" author="gsingers" created="Wed, 16 Jan 2008 16:59:37 +0000"  >&lt;p&gt;I don&apos;t know the answer to those questions, I just know we faced similar issues with changing the StandardTokenizer.  It was clearly doing something wrong (incorrectly marking acronyms), yet we had to do the deprecation dance to handle it b/c there may be applications that rely on that functionality.  This one seems a little  less problematic, I agree.  There may, however, be applications out there that occasionally hit a really large document and don&apos;t want it to throw off their indexing, so they truncate it.&lt;/p&gt;

&lt;p&gt;I think we ought to have a separate discussion on our back compatibility standards on java-dev, as I, personally, think we have some room for improvement when it comes to these kinds of things.   I will kick it off, as it has been something I have been mulling for a while.&lt;/p&gt;</comment>
                    <comment id="12559730" author="cutting" created="Wed, 16 Jan 2008 23:12:44 +0000"  >&lt;p&gt;This kind of limit is common on web search engines.  It prevents really big pages that crawlers find causing indexing and search from blowing up (think a 100MB PDF that claims it is a text file).  So changing it might indeed hurt folks who&apos;re indexing uncontrolled web content.&lt;/p&gt;</comment>
                    <comment id="12559748" author="steve_rowe" created="Thu, 17 Jan 2008 00:02:41 +0000"  >&lt;p&gt;An alternative to changing the default setting would be to not have a default - make it a required parameter to the IndexWriter constructor.  That way, there is no silent loss (or gain) of content - the user must specify.  &lt;/p&gt;

&lt;p&gt;Maybe the type of this extra parameter could be an enumeration, along the lines of BooleanClause.Occur, e.g. IndexWriter.FieldLength.LIMITED and IndexWriter.FieldLength.UNLIMITED.  LIMITED would set the max to the current default, setMaxFieldLimit() would operate as it does currently, and UNLIMITED would set the max to Integer.MAX_VALUE.&lt;/p&gt;

&lt;p&gt;This solution would definitely be a backward-incompatible change, and would have to wait for the 3.0 release.&lt;/p&gt;</comment>
                    <comment id="12559887" author="mikemccand" created="Thu, 17 Jan 2008 10:14:37 +0000"  >&lt;blockquote&gt;
&lt;p&gt;This kind of limit is common on web search engines. It prevents really big pages that crawlers find causing indexing and search from blowing up (think a 100MB PDF that claims it is a text file). So changing it might indeed hurt folks who&apos;re indexing uncontrolled web content.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;OK, it seems like it&apos;s an important safeguard, and risky to change, so&lt;br/&gt;
let&apos;s wait for 3.0.&lt;/p&gt;

&lt;p&gt;Maybe we could increase it from 10K --&amp;gt; 100K to reduce the times when&lt;br/&gt;
a legit document is truncated?&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;An alternative to changing the default setting would be to not have a default - make it a required parameter to the IndexWriter constructor. That way, there is no silent loss (or gain) of content - the user must specify.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think this is a good idea; it basically forces the user to confront&lt;br/&gt;
the truncation issue up front.&lt;/p&gt;</comment>
                    <comment id="12560022" author="steve_rowe" created="Thu, 17 Jan 2008 18:35:36 +0000"  >&lt;p&gt;Attaching a patch implementing my suggestion to add an explicit maximum field length parameter to IndexWriter constructors.  I named the inner class MaxFieldLength instead of FieldLength.&lt;/p&gt;

&lt;p&gt;The patch deprecates the pre-existing constructors, and adds a new constructor with the added parameter for each of the pre-existing constructors.  As a result, the patch could be applied to the trunk as soon as 2.3 has been released; the deprecated pre-existing constructors would then be removed as part of the 3.0 release.&lt;/p&gt;

&lt;p&gt;The patch also replaces all IndexWriter constructor calls in the tree with their equivalents taking the explicit max field length parameter.  (I excluded IndexModifier, because it is already scheduled for removal as part of the 3.0 release.)&lt;/p&gt;

&lt;p&gt;I see that in o.a.l.demo.IndexHTML.java, the max field length is set significantly above the current default limit:&lt;/p&gt;

&lt;p&gt;71:   writer = new IndexWriter(index, new StandardAnalyzer(), create);&lt;br/&gt;
72:   writer.setMaxFieldLength(1000000);&lt;/p&gt;

&lt;p&gt;Should the above two lines be replaced with the following? (I did &lt;b&gt;not&lt;/b&gt; do this in the attached patch):&lt;/p&gt;

&lt;p&gt;   writer = new IndexWriter(index, new StandardAnalyzer(), create, &lt;br/&gt;
       IndexWriter.MaxFieldLength.UNLIMITED);&lt;/p&gt;

&lt;p&gt;That is, should the demo use Integer.MAX_VALUE instead of 1,000,000 for the maximum field length?&lt;/p&gt;</comment>
                    <comment id="12560792" author="mikemccand" created="Sun, 20 Jan 2008 11:00:29 +0000"  >
&lt;p&gt;This patch looks great; thanks Steven!&lt;/p&gt;

&lt;p&gt;This forces users to confront, up front, when creating IndexWriter,&lt;br/&gt;
whether they want to truncate the fields.&lt;/p&gt;

&lt;p&gt;It deprecates all existing IndexWriter ctors, noting that in 3.0 they&lt;br/&gt;
will be removed, in favor of the version that adds the MaxFieldLength&lt;br/&gt;
argument.&lt;/p&gt;

&lt;p&gt;We can commit this now, and then removed the deprecated APIs in 3.0.&lt;br/&gt;
I think with this change it&apos;s OK to leave the default truncation limit&lt;br/&gt;
at 10,000?&lt;/p&gt;

&lt;p&gt;I think we can leave the IndexHTML.java with that current large limit?&lt;/p&gt;

&lt;p&gt;I plan to commit in a day or two!&lt;/p&gt;</comment>
                    <comment id="12562425" author="mikemccand" created="Fri, 25 Jan 2008 10:21:59 +0000"  >&lt;p&gt;I just committed this.  Thanks Daniel for opening it, and thanks Steven for the patch!&lt;/p&gt;</comment>
                    <comment id="12566600" author="gsingers" created="Thu, 7 Feb 2008 14:00:00 +0000"  >&lt;p&gt;Sorry for the lateness on this, was just looking at another patch that had the deprecated constructor and was going to replace it...&lt;/p&gt;

&lt;p&gt;How, exactly, is one supposed to specify an alternate value for the MaxFieldLength in the constructor when using the IndexWriter.MaxFieldLength constructor when it is private and not extendable?  Or is it that I pass in a LIMITED or UNLIMITED and then immediately go call indexWriter.setMaxFieldLength()?  That doesn&apos;t make sense to me from a user&apos;s point of view of trying to understand how to set the maxFieldLength, so I feel like I must be missing something.&lt;/p&gt;</comment>
                    <comment id="12566624" author="mikemccand" created="Thu, 7 Feb 2008 15:08:33 +0000"  >&lt;p&gt;Yeah, the intention here was that you specify LIMITED or UNLIMITED enum parameter on creating the IW, and then change the actual limit using setMaxFieldLength.&lt;/p&gt;

&lt;p&gt;But I agree it&apos;d be cleaner if you could actually just set the limit (once) on construction.&lt;/p&gt;

&lt;p&gt;I think if we stopped subclassing from Parameter (we don&apos;t really need Serializable here?), and made the ctor public, then you could pass in &quot;new MaxFieldLength(100000)&quot; to make your own limit?&lt;/p&gt;</comment>
                    <comment id="12566662" author="steve_rowe" created="Thu, 7 Feb 2008 16:12:50 +0000"  >&lt;p&gt;Reopening to attach a patch to allow for (variable) user specification of maximum field length in IndexWriter constructors.&lt;/p&gt;</comment>
                    <comment id="12566664" author="steve_rowe" created="Thu, 7 Feb 2008 16:14:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think if we stopped subclassing from Parameter (we don&apos;t really need Serializable here?), and made the ctor public, then you could pass in &quot;new MaxFieldLength(100000)&quot; to make your own limit?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Attaching a patch implementing this idea.&lt;/p&gt;</comment>
                    <comment id="12566685" author="steve_rowe" created="Thu, 7 Feb 2008 16:52:02 +0000"  >&lt;p&gt;The javadoc description of the MaxFieldLength parameter (mfl) in the IndexWriter constructors is now &quot;whether or not to limit field lengths&quot;.  &lt;/p&gt;

&lt;p&gt;This should probably be rewritten in light of the change allowing user specification of values other than LIMITED or UNLIMITED.  How&apos;s this?:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/** ...
 * @param mfl Maximum field length: LIMITED, UNLIMITED, or user-specified
 *   via the MaxFieldLength constructor.
 * ...
 */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Attaching part2.take2 patch including this javadoc change and the MaxFieldLength extension and constructor changes.&lt;/p&gt;</comment>
                    <comment id="12566717" author="mikemccand" created="Thu, 7 Feb 2008 18:00:18 +0000"  >&lt;p&gt;This looks good!  Thanks Steven.  I&apos;ll commit.&lt;/p&gt;</comment>
                    <comment id="12566728" author="steve_rowe" created="Thu, 7 Feb 2008 18:39:08 +0000"  >&lt;p&gt;Mike, I see you added a test for the user-specified max field length - cool.&lt;/p&gt;

&lt;p&gt;It made me think of the IndexHTML.java usage, which should probably be changed to conform to the new style:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      writer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IndexWriter(index, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StandardAnalyzer(), create, 
                               IndexWriter.MaxFieldLength.LIMITED);
      writer.setMaxFieldLength(1000000);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;should be:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      writer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IndexWriter(index, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StandardAnalyzer(), create, 
                               &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IndexWriter.MaxFieldLength(1000000));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hmm, now that I look, I can see several other new IndexWriter() / setMaxFieldLength() sequences that should be changed ... I&apos;ll submit a patch shortly.&lt;/p&gt;</comment>
                    <comment id="12566739" author="steve_rowe" created="Thu, 7 Feb 2008 18:49:32 +0000"  >&lt;p&gt;Patch replacing &lt;span class=&quot;error&quot;&gt;&amp;#91;IW constructor, MFL setter&amp;#93;&lt;/span&gt; sequences with IW constructor taking new&apos;d MFL.&lt;/p&gt;</comment>
                    <comment id="12566791" author="mikemccand" created="Thu, 7 Feb 2008 20:53:35 +0000"  >&lt;p&gt;Good &amp;#8211; I&apos;ll commit.  Thanks!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12374990" name="LUCENE-1084.part2.patch" size="1594" author="steve_rowe" created="Thu, 7 Feb 2008 16:14:36 +0000" />
                    <attachment id="12374995" name="LUCENE-1084.part2.take2.patch" size="6672" author="steve_rowe" created="Thu, 7 Feb 2008 16:52:01 +0000" />
                    <attachment id="12375009" name="LUCENE-1084.part3.patch" size="4128" author="steve_rowe" created="Thu, 7 Feb 2008 18:49:31 +0000" />
                    <attachment id="12373415" name="LUCENE-1084.patch" size="66045" author="steve_rowe" created="Thu, 17 Jan 2008 18:35:35 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>4.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 16 Jan 2008 10:52:10 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12661</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26645</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:02:48 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2532/LUCENE-2532.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2532] improve test coverage of multi-segment indices</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2532</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Simple patch that adds a test-only helper class, RandomIndexWriter, that lets you add docs, but it will randomly do things like use a different merge policy/scheduler, flush by doc count instead of RAM, flush randomly (so we get multi-segment indices) but also randomly optimize in the end (so we also sometimes test single segment indices).&lt;/p&gt;</description>
                <environment></environment>
            <key id="12469058">LUCENE-2532</key>
            <summary>improve test coverage of multi-segment indices</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Jul 2010 13:35:03 +0100</created>
                <updated>Wed, 30 Mar 2011 16:50:09 +0100</updated>
                    <resolved>Tue, 13 Jul 2010 17:13:36 +0100</resolved>
                                            <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12887360" author="mikemccand" created="Mon, 12 Jul 2010 13:35:50 +0100"  >&lt;p&gt;Attached patch.  I only cutover TestRegexpRandom2 for starters...&lt;/p&gt;</comment>
                    <comment id="12887362" author="rcmuir" created="Mon, 12 Jul 2010 13:37:23 +0100"  >&lt;p&gt;thanks, I&apos;ll apply this logic to a few other multitermquery tests i am familiar with, and upload a new patch.&lt;/p&gt;</comment>
                    <comment id="12887393" author="rcmuir" created="Mon, 12 Jul 2010 16:05:03 +0100"  >&lt;p&gt;ok, hopefully this is just my screwup, but just in case: i want to get uwe or someone to confirm &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I started converting some test cases to use this, and got some failures in TestNumericRangeQuery64:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    [junit] Testsuite: org.apache.lucene.search.TestNumericRangeQuery64
    [junit] Testcase: testRange_8bit(org.apache.lucene.search.TestNumericRangeQuery64): FAILED
    [junit] Distinct term number is equal for all query types expected:&amp;lt;494&amp;gt; but was:&amp;lt;493&amp;gt;
    [junit] junit.framework.AssertionFailedError: Distinct term number is equal for all query types expected:&amp;lt;494&amp;gt; but was:&amp;lt;493&amp;gt;
    [junit]     at org.apache.lucene.search.TestNumericRangeQuery64.testRange(TestNumericRangeQuery64.java:159)
    [junit]     at org.apache.lucene.search.TestNumericRangeQuery64.testRange_8bit(TestNumericRangeQuery64.java:167)
...
[junit] ------------- Standard Output ---------------
[junit] NOTE: random static seed of testclass &apos;testRange_8bit&apos; was: 7879034790334081579
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to reproduce, just plug in the seed to the beforeClass method:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Random random = newStaticRandom(TestNumericRangeQuery64.class, 7879034790334081579L);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    <comment id="12887400" author="rcmuir" created="Mon, 12 Jul 2010 16:31:46 +0100"  >&lt;p&gt;OK, this was just my stupidity... the assertion here (MTQ&apos;s getTermCount) isnt valid for a multi-segment + constant score rewrite case, so i conditionalized the assert.&lt;/p&gt;</comment>
                    <comment id="12887452" author="rcmuir" created="Mon, 12 Jul 2010 19:22:17 +0100"  >&lt;p&gt;here is the current progress, i only converted a few more tests over, but added more randomness to randomIW (random codec, compound file, tii, etc)&lt;/p&gt;

&lt;p&gt;this caused a test fail in numericrange64... unfortunately it was an exception in another thread and we arent printing the random seed in this case... i need to fix this.&lt;/p&gt;

&lt;p&gt;ill upload the stacktrace separately&lt;/p&gt;</comment>
                    <comment id="12887453" author="rcmuir" created="Mon, 12 Jul 2010 19:22:58 +0100"  >&lt;p&gt;stacktrace file&lt;/p&gt;</comment>
                    <comment id="12887531" author="rcmuir" created="Mon, 12 Jul 2010 22:10:48 +0100"  >&lt;p&gt;here is an updated patch, with a lot more tests converted over.&lt;br/&gt;
the previous problem was just a bad assertion (thanks Mike)&lt;/p&gt;

&lt;p&gt;But this one has a new problem, i angered spans.TestBasics somehow (use seed 7669636241779895237L)&lt;br/&gt;
will try to debug it later, feel free if you have ideas.&lt;/p&gt;</comment>
                    <comment id="12887766" author="rcmuir" created="Tue, 13 Jul 2010 15:08:09 +0100"  >&lt;p&gt;here&apos;s the final patch... I got a good chunk of o.a.l.search tests converted over.&lt;/p&gt;

&lt;p&gt;I think I am sick of this now, we can convert more later.&lt;/p&gt;

&lt;p&gt;I plan to commit soon... and try to merge to 3x&lt;/p&gt;</comment>
                    <comment id="12887768" author="mikemccand" created="Tue, 13 Jul 2010 15:13:05 +0100"  >&lt;p&gt;Looks great Robert!  +1 to commit&lt;/p&gt;</comment>
                    <comment id="12887772" author="rcmuir" created="Tue, 13 Jul 2010 15:22:54 +0100"  >&lt;p&gt;Committed revision 963720 to trunk. I&apos;ll work on the merge to 3x, sure it will be completely smooth &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12887821" author="rcmuir" created="Tue, 13 Jul 2010 17:13:36 +0100"  >&lt;p&gt;Committed revision 963780 to 3x&lt;/p&gt;</comment>
                    <comment id="13013381" author="gsingers" created="Wed, 30 Mar 2011 16:50:09 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12449347" name="LUCENE-2532.patch" size="346496" author="rcmuir" created="Tue, 13 Jul 2010 15:08:08 +0100" />
                    <attachment id="12449285" name="LUCENE-2532.patch" size="168924" author="rcmuir" created="Mon, 12 Jul 2010 22:10:48 +0100" />
                    <attachment id="12449269" name="LUCENE-2532.patch" size="39203" author="rcmuir" created="Mon, 12 Jul 2010 19:22:17 +0100" />
                    <attachment id="12449253" name="LUCENE-2532.patch" size="21427" author="rcmuir" created="Mon, 12 Jul 2010 16:05:03 +0100" />
                    <attachment id="12449242" name="LUCENE-2532.patch" size="5196" author="mikemccand" created="Mon, 12 Jul 2010 13:35:50 +0100" />
                    <attachment id="12449270" name="stacktrace.txt" size="21325" author="rcmuir" created="Mon, 12 Jul 2010 19:22:58 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>6.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 12 Jul 2010 12:37:23 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11295</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25160</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
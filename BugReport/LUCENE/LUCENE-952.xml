<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:02:19 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-952/LUCENE-952.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-952] GData&apos;s TestGdataIndexer.testDestroy() intermittently hits spin loop &amp; causes build timeout</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-952</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Several nightly builds (at least #136, #143 and #144) have failed due&lt;br/&gt;
to timeout at 45 minutes while running the TestGdataIndexer.testDestroy()&lt;br/&gt;
test case.&lt;/p&gt;

&lt;p&gt;I tracked it down to this line:&lt;/p&gt;

&lt;p&gt;      // wait active for the commit&lt;br/&gt;
      while(this.indexer.writer != null){}&lt;/p&gt;

&lt;p&gt;Intermittently, that while loop will spin forever.  I can only get the&lt;br/&gt;
failure to happen on Linux: it doesn&apos;t happen on Mac OS X (haven&apos;t&lt;br/&gt;
tried windows).  The nightly build runs on Solaris 10, so it also&lt;br/&gt;
happens there.&lt;/p&gt;

&lt;p&gt;It turns out, this is due to the fact that &quot;writer&quot; is not declared as&lt;br/&gt;
&quot;volatile&quot;.  This is because one thread is closing the indexer, which&lt;br/&gt;
sets writer to null, but another thread is running the while loop.&lt;br/&gt;
If this.indexer.writer was set to null before that while loop starts,&lt;br/&gt;
the test will run through fine; else, it won&apos;t.&lt;/p&gt;

&lt;p&gt;I plan to fix this by adding this method to GDataIndexer class:&lt;/p&gt;

&lt;p&gt;    // Used only for testing&lt;br/&gt;
    protected synchronized IndexWriter getWriter() &lt;/p&gt;
{
      return this.writer;
    }

&lt;p&gt;and changing unit test to call that method.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12373226">LUCENE-952</key>
            <summary>GData&apos;s TestGdataIndexer.testDestroy() intermittently hits spin loop &amp; causes build timeout</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Sat, 7 Jul 2007 13:18:33 +0100</created>
                <updated>Fri, 25 Jan 2008 03:23:59 +0000</updated>
                    <resolved>Sat, 7 Jul 2007 13:28:27 +0100</resolved>
                            <version>2.3</version>
                                <fixVersion>2.3</fixVersion>
                                <component>core/other</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                            <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12790</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26777</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:20:22 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-664/LUCENE-664.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-664] [PATCH] small fixes to the new scoring.html doc</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-664</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;This is an awesome initiative.  We need more docs that cleanly explain the inner workings of Lucene in general... thanks Grant &amp;amp; Steve &amp;amp; others!&lt;/p&gt;

&lt;p&gt;I have a few small initial proposed fixes, largely just adding some more description around the components of the formula.  But also a couple typos, another link out to Wikipedia, a missing closing ), etc.  I&apos;ve only made it through the &quot;Understanding the Scoring Formula&quot; section so far.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12348477">LUCENE-664</key>
            <summary>[PATCH] small fixes to the new scoring.html doc</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Aug 2006 15:56:56 +0100</created>
                <updated>Fri, 17 Nov 2006 18:41:50 +0000</updated>
                    <resolved>Mon, 6 Nov 2006 03:30:09 +0000</resolved>
                            <version>2.1</version>
                                                <component>general/website</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12430051" author="gsingers" created="Wed, 23 Aug 2006 18:26:43 +0100"  >&lt;p&gt;Thanks, Michael.  I have applied the patch in scoring-small-fixes.patch and will update the docs.&lt;/p&gt;

&lt;p&gt;I will leave this Issue open so that you and others can add patches w/o opening a new Issue for every patch, at least until this document becomes &quot;official&quot;.&lt;/p&gt;</comment>
                    <comment id="12430115" author="karl.wettin" created="Wed, 23 Aug 2006 23:13:34 +0100"  >&lt;p&gt;This is the class diagram (in UMLet format) linked to in the document. It does not explain scoring that much - more of an abstract overview of Lucene than anything else. I might find some time to sequence up the comments.&lt;/p&gt;</comment>
                    <comment id="12430293" author="mikemccand" created="Thu, 24 Aug 2006 18:43:27 +0100"  >&lt;p&gt;OK I did some more small fixes to the sections &quot;Query Classes&quot; and &quot;Changing Similarity&quot;.  Just added some missing links, fixed a broken link, tightened up wording, etc.  I&apos;ll attach a patch.&lt;/p&gt;

&lt;p&gt;Also a couple random questions:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Should this go into the Wiki or into the Web site?  Is there a general criteria / guideline that we&apos;ve converged on for Wiki vs Web site?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Is there a reason why we are linking to the &quot;ViewVC&quot; page in the Big Picture section?  Can&apos;t we just link to the javadoc?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Should we change the title / purpose to be an overview of the Query classes and also details of scoring?  I think the Query Classes section is a great intro to the different Query classes.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12430812" author="gsingers" created="Sun, 27 Aug 2006 03:05:40 +0100"  >&lt;p&gt;Hi Michael,&lt;/p&gt;

&lt;p&gt;Correct me if I am wrong, but does the second patch include the first patch, too?  I have already committed the first, so if you could update and add a new version of the patch with your latest edits, that would be great.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Grant&lt;/p&gt;</comment>
                    <comment id="12430837" author="mikemccand" created="Sun, 27 Aug 2006 11:26:20 +0100"  >&lt;p&gt;Doh!  You are correct.  OK I re-based the diffs off the current version.  Sorry about that.&lt;/p&gt;</comment>
                    <comment id="12431302" author="gsingers" created="Tue, 29 Aug 2006 18:41:28 +0100"  >&lt;p&gt;Committed patch 3.  Thanks Michael!&lt;/p&gt;</comment>
                    <comment id="12431631" author="cutting" created="Wed, 30 Aug 2006 18:31:15 +0100"  >&lt;p&gt;This is good stuff.  Might it be better to include this in the javadoc? That way, as the code evolves, the documentation is more naturally maintained, since search-and-replace operations etc. will find it.  I worry that as soon as this documentation is complete, we&apos;ll change the implementation and invalidate it.&lt;/p&gt;</comment>
                    <comment id="12431645" author="gsingers" created="Wed, 30 Aug 2006 19:22:06 +0100"  >&lt;p&gt;Yeah, I thought about putting it in Javadoc and I share your concern about invalidation, but I think that is always the case with all documentation, including javadocs, and is just something we have to live with and work on.  I also think it is bigger picture than javadocs and spans multiple packages, so it doesn&apos;t really fit as nicely into the Javadoc model of package level documentation.   My hope is that by making it a part of the main site and something people can easily find it will be better maintained. &lt;/p&gt;</comment>
                    <comment id="12431669" author="steven_parkes" created="Wed, 30 Aug 2006 20:43:08 +0100"  >&lt;p&gt;I went through basically the same reasoning that Grant describes, particularly with loading the javadocs w/too much stuff. But I do like the wiki ability to give you linking akin to that in javadocs.&lt;/p&gt;

&lt;p&gt;As to renaming the wiki url (mentioned on dev though not in jira), I&apos;m happy to approach infrastructure. My concern would be external links into the wiki that reference the old jakarata url. I guess we could find out if they can handle a redirect from jakarata-lucene/* to lucene/*?&lt;/p&gt;</comment>
                    <comment id="12431954" author="cutting" created="Thu, 31 Aug 2006 20:49:29 +0100"  >&lt;p&gt;Javadoc is easiest to keep in sync with changes to the code, since it is in the same files.  The wiki is the hardest to keep in sync with the code, since it is not versioned with the code.  We website is somewhere between: it is in subversion, but in separate files in a separate tree.&lt;/p&gt;

&lt;p&gt;The javadoc is thus the preferred location for documentation that is specific to the code.  The website and wiki are better for stuff that&apos;s specific to the project: policys, procedures, etc.  The wiki is great for user-generated stuff like benchmarks, porting tricks, use cases, etc.&lt;/p&gt;

&lt;p&gt;This stuff seems pretty closely tied to the code, so I&apos;d put it in the javadoc.  It&apos;s nearly all stuff that&apos;s in the search package, so much of this could go in search/package.html with pointers to the javadoc for Query, Weight, Scorer, etc.&lt;/p&gt;</comment>
                    <comment id="12434029" author="gsingers" created="Tue, 12 Sep 2006 02:03:59 +0100"  >&lt;p&gt;OK, I have split this up into the javadocs and the scoring page.  All the Query stuff and Similarity stuff is moved to o.a.l.s package documentation.&lt;/p&gt;</comment>
                    <comment id="12438636" author="doronc" created="Fri, 29 Sep 2006 05:54:56 +0100"  >&lt;p&gt;(1) added a section in Scoring.xml for &quot;Search Results Boosts&quot;, on ways to boost in Lucene, at search time and at indexing time. &lt;/p&gt;

&lt;p&gt;(2) updated the presentation of the scoring formula in Similarity.java, to:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;closely reflect the scoring code/process.&lt;/li&gt;
	&lt;li&gt;distinguish between indexing time factors and search time factors, and&lt;/li&gt;
	&lt;li&gt;point to differences between a scoring notion (e.g.tf, idf) to the way it is computed.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;As result the scoring formula is presented differently in Similarity.java and in Scoring.html. I can update this if there are no objections to the updated formula presentation.&lt;/p&gt;</comment>
                    <comment id="12438837" author="gsingers" created="Sat, 30 Sep 2006 04:13:48 +0100"  >&lt;p&gt;Hi Doron,&lt;/p&gt;

&lt;p&gt;Thanks for the updates.  I like the content in scoring.xml, although I am inclined to place it after boosts have been introduced in the Scoring Formula section (what do you think?  No need to send a new patch if you agree, I can take care of it)&lt;/p&gt;

&lt;p&gt;On the Similarity changes, I think I like them, but would like to hear from other people. One of the problems I had with the old writing of the formula is it is a bit hard to  tell whether the coord factor is inside the sum or not at first glance and I always have to think about the theory a bit before being sure.  With your formula, it is much clearer.  You also have some nice explanations, but I also feel it takes a bit longer to get an understanding of the formula b/c you introduce some new factors (normalizer, searchBoost, indexBoost) that require an extra layer of indirection (but maybe it is just b/c I am late and I&apos;m tired and need to take a fresh look this weekend).&lt;/p&gt;

&lt;p&gt;I think the scoring.xml and Similarity.java formulas should be kept in sync.  Ideally we could do some type of include and only have one file with the formula, but I am not sure how to do this given the current documentation frameworks.&lt;/p&gt;

&lt;p&gt;Also, I think you need a link on the indexBoost factor to the indexBoost anchor (but again, I can take care of that if others are in favor of this part of the patch).&lt;/p&gt;

&lt;p&gt;So, in summary, I am +1 on part 1 of this patch and am all for applying that, but after the Scoring Formula section.  Part 1 can be applied separately from part 2 and I will do so this weekend unless I hear objections otherwise.&lt;/p&gt;

&lt;p&gt;The 2nd part, I am +0.5, if there is such a thing.  I really like the added explanation and the organization of the formula, but am not sure on the searchBoost, indexBoost and normalizer factors and would like to hear from others what they favor.&lt;/p&gt;

&lt;p&gt;-Grant&lt;/p&gt;</comment>
                    <comment id="12438854" author="doronc" created="Sat, 30 Sep 2006 05:51:52 +0100"  >&lt;p&gt;Hi Grant, &lt;/p&gt;

&lt;p&gt;For part 1, I am ok with having it after the scoring formula.&lt;/p&gt;

&lt;p&gt;For part 2, my motivation was to make it more clear in:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;- what&apos;s inside the sum and what&apos;s outside (as you said).&lt;/li&gt;
	&lt;li&gt;- what&apos;s decided at indexing time and what&apos;s still controllable at search time.&lt;/li&gt;
	&lt;li&gt;- how boosts and encoding/decoding play in.&lt;/li&gt;
	&lt;li&gt;- what&apos;s fixed and what can be modified, by subclassing, say, DefaultSimilarity.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So &lt;/p&gt;
{indexBoost, searchBoost, normalizer}
&lt;p&gt; were the tools to clear this up, and also to make the formula shorter and easier to read in a glance.&lt;/p&gt;

&lt;p&gt;Naturally, after delving so deep into it is now clear to me, but you are right, it would be good to hear from others how they like this part.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Doron&lt;/p&gt;</comment>
                    <comment id="12439344" author="cutting" created="Tue, 3 Oct 2006 00:24:32 +0100"  >&lt;p&gt;I like the idea of refactoring this formula, but think we should be cautious about introducing new terms that look like java methods but are not.&lt;/p&gt;

&lt;p&gt;I don&apos;t see the distinction between queryNorm and normalizer.  I am not convinced we need a new term here.&lt;/p&gt;

&lt;p&gt;I think &apos;norm&apos; is a good term for the product of lengthNorm(d) and field boost.  That&apos;s what it is called consistently in the code and API.  This quantity is represented in two places, but seems like a logical candidate for the sort of factoring done here.  This could be placed to the left of the sigma, since it does not depend on t.&lt;/p&gt;

&lt;p&gt;Finally, I think it might be clearer to call &quot;searchBoost&quot; instead t.getBoost().&lt;/p&gt;</comment>
                    <comment id="12439370" author="doronc" created="Tue, 3 Oct 2006 02:52:24 +0100"  >&lt;p&gt;Two quick questions:&lt;/p&gt;

&lt;p&gt;&amp;gt; I think &apos;norm&apos; is a good term for the product of lengthNorm(d) and &lt;br/&gt;
&amp;gt; field boost. That&apos;s what it is called consistently in the code and API. &lt;br/&gt;
&amp;gt; This quantity is represented in two places, but seems like a logical &lt;br/&gt;
&amp;gt; candidate for the sort of factoring done here. &lt;/p&gt;

&lt;p&gt;Norm would also Include the doc boost, right?&lt;br/&gt;
So this means replacing &lt;b&gt;indexBoost&lt;/b&gt; with &lt;b&gt;norm&lt;/b&gt; ?&lt;/p&gt;

&lt;p&gt;&amp;gt; This could be placed to the left of the sigma, since it does not depend on t. &lt;/p&gt;

&lt;p&gt;I think that norm depends on the field name and there may be terms of more than one field in the query.?&lt;/p&gt;</comment>
                    <comment id="12439675" author="cutting" created="Tue, 3 Oct 2006 23:14:19 +0100"  >&lt;p&gt;&amp;gt; So this means replacing &lt;b&gt;indexBoost&lt;/b&gt; with &lt;b&gt;norm&lt;/b&gt; ?&lt;/p&gt;

&lt;p&gt;Yes, that was my suggestion.&lt;/p&gt;

&lt;p&gt;&amp;gt; I think that norm depends on the field name [ ...]&lt;/p&gt;

&lt;p&gt;You&apos;re right.  Both components are indeed field-specific (lengthNorm and field.getBoost()).  So maybe it can&apos;t move to the left of the sigma.&lt;/p&gt;</comment>
                    <comment id="12440442" author="gsingers" created="Fri, 6 Oct 2006 14:10:15 +0100"  >&lt;p&gt;Doron, if you can submit a new patch, that would be great, otherwise I can try to do it sometime soon.&lt;/p&gt;

&lt;p&gt;I also think I want to drop the formula (and explanation) in scoring.html and just put a link to similarity in, so that we don&apos;t have to maintain two copies.  Ideally, there would be a way to do a server side include so that we could have one file that contains the formula and then have it included in both the javadocs and this page.  Does anyone know if this possible using our current setup?&lt;/p&gt;</comment>
                    <comment id="12440592" author="doronc" created="Fri, 6 Oct 2006 20:55:56 +0100"  >&lt;p&gt;Going to work on this now, according to comments by Doug and Grant.&lt;/p&gt;

&lt;p&gt;Will give a try to the include idea - client side iframe as Chris suggested, see how it works. Iframe don&apos;t rely on Javascript (might be turned off for some users).  There are downsides to iframe too - possible scrollbars etc. - so need to see how it looks, and need to check if it is possible to somehow also include it in Scoring.html, otherwise guess we just link to it from there.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.boutell.com/newfaq/creating/include.html&quot; class=&quot;external-link&quot;&gt;http://www.boutell.com/newfaq/creating/include.html&lt;/a&gt;&lt;/p&gt;
</comment>
                    <comment id="12440648" author="doronc" created="Sat, 7 Oct 2006 07:45:39 +0100"  >&lt;p&gt;I played with including the formula from a separate file, Client Side Include. &lt;/p&gt;

&lt;p&gt;=== Summary === &lt;br/&gt;
 I think the &quot;include&quot; is not going to work well enough and hence not worth to invest in it.&lt;br/&gt;
So, bottom line, I give up for now on &quot;include&quot;, and so I will make the changes in Similarity.java.&lt;/p&gt;

&lt;p&gt;=== Details  === &lt;br/&gt;
I know of 3 ways to do this: Javascript, Iframe, Object-Embed. &lt;/p&gt;

&lt;p&gt;Iframe can work for both the javadocs and the xdocs - I think that Embed also would work though I did not try it.&lt;/p&gt;

&lt;p&gt;Both Iframe and Embed have a problem of appearance: you have to decide on the size of the frame showm, in pixels. If you set too large an area, blank space will remain. If you set a too small area, scroll bars would show up. If the user changes the text side, the required area size is changing, but not the allocated area, so scrollbars or blank space are showing up and disapearing. Very ugly. &lt;/p&gt;

&lt;p&gt;Iframe also has an issue with inner links navigation: once you navigate to an anchor text in the iframe part (this works), the back action from some reason does not work (both Firefox and IE).&lt;/p&gt;

&lt;p&gt;The javascript approach should not have these issues, because the imported text becomes part of the embedding page (the imported text is &quot;dynamically generated&quot;). I saw that Javadocs themselves use javascript (at least in 1.5) so I feel better with using this. However to use Javascript you have to put some javascript code in the HTML Header, as well as an onload event in the BODY tag. I didn&apos;t find a way to do this with Javadocs. &lt;/p&gt;

&lt;p&gt;(Another tricky issue with Javascript is that outgoing links from the imported text have the base address of the embedding page. So references going out from the embedded text should be different in Similarity.html and Scoring.html (which are in separate directories). But I think this can be resolved with passing a &apos;base&apos; param to the include() function.)&lt;/p&gt;

&lt;p&gt;Bottom line, I give up for now on &quot;include&quot;, and so I will make the changes in Similarity.java.&lt;/p&gt;</comment>
                    <comment id="12440654" author="gsingers" created="Sat, 7 Oct 2006 12:17:59 +0100"  >&lt;p&gt;That sounds good to me.  I will remove the formula from scoring and just make it link for now until we can figure something else out.&lt;/p&gt;</comment>
                    <comment id="12440702" author="doronc" created="Sat, 7 Oct 2006 19:41:46 +0100"  >&lt;p&gt;I am attaching scoring_formula_2.patch - modifed scoring formula as suggested. &lt;/p&gt;

&lt;p&gt;Additional changes here:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;order of the explanation parts: detailed norm part moved to end;  tf and idf moved to start, so most of the stuff is visble at first glance.&lt;/li&gt;
	&lt;li&gt;links in the formula go to the appropriate explanation bullet.&lt;/li&gt;
	&lt;li&gt;formula itself is &quot;framed&quot; (border=1)  for easier orientation within all the other text.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12440759" author="gsingers" created="Sun, 8 Oct 2006 17:24:20 +0100"  >&lt;p&gt;Doron,&lt;/p&gt;

&lt;p&gt;I really like this.  It is so much cleaner and easier to read, IMO.  I will commit this tomorrow or Tuesday unless I hear any objections.&lt;/p&gt;

&lt;p&gt;-Grant&lt;/p&gt;</comment>
                    <comment id="12441164" author="gsingers" created="Tue, 10 Oct 2006 16:21:33 +0100"  >&lt;p&gt;OK, I have committed the changes and updated the site javadocs and scoring.  Changes always take 15-30 mins. to propagate.&lt;/p&gt;</comment>
                    <comment id="12441194" author="doronc" created="Tue, 10 Oct 2006 17:44:16 +0100"  >&lt;p&gt;One comment for Scoring.html:&lt;/p&gt;

&lt;p&gt;Tthe last sentence in the &quot;Score Boosting&quot; paragraph says:&lt;/p&gt;

&lt;p&gt;      &quot;At scoring (search) time, this norm is brought into the score &lt;br/&gt;
      of document as indexBoost, as shown by the formula in Similarity.&quot;&lt;/p&gt;

&lt;p&gt;To fix this, we should replace  &quot;indexBoost&quot;  by   &quot;norm(t,d)&quot;&lt;/p&gt;</comment>
                    <comment id="12441280" author="doronc" created="Tue, 10 Oct 2006 21:43:17 +0100"  >&lt;p&gt;I just noticed that the link to &quot;TermScorer&quot; in &quot;Understanding the Scoring Formula&quot; is broken b/c TermScorer has package visibility. &lt;/p&gt;

&lt;p&gt;Can be fixed by saying instead &quot;..., especially the scorer for TermQuery&quot; and linking to TermQuery.&lt;/p&gt;</comment>
                    <comment id="12447349" author="gsingers" created="Mon, 6 Nov 2006 03:30:09 +0000"  >&lt;p&gt;Going to close this one out for now, as I think we have gotten past the initial flurry of changes for the new docs.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12339417" name="ASF.LICENSE.NOT.GRANTED--scoring-small-fixes.patch" size="8082" author="mikemccand" created="Wed, 23 Aug 2006 15:56:56 +0100" />
                    <attachment id="12341949" name="boosts_plus_scoring_formula.patch" size="63367" author="doronc" created="Fri, 29 Sep 2006 05:54:56 +0100" />
                    <attachment id="12339446" name="lucene.uxf" size="11607" author="karl.wettin" created="Wed, 23 Aug 2006 23:13:34 +0100" />
                    <attachment id="12342504" name="scoring_formula_2.patch" size="13450" author="doronc" created="Sat, 7 Oct 2006 19:41:46 +0100" />
                    <attachment id="12339507" name="scoring-small-fixes2.patch" size="32114" author="mikemccand" created="Thu, 24 Aug 2006 18:43:55 +0100" />
                    <attachment id="12339652" name="scoring-small-fixes3.patch" size="24684" author="mikemccand" created="Sun, 27 Aug 2006 11:26:20 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>6.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 23 Aug 2006 17:26:43 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>13088</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>27066</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
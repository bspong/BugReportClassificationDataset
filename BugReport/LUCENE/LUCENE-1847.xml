<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:10:05 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1847/LUCENE-1847.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1847] PhraseQuery/TermQuery/SpanQuery use IndexReader specific stats in their explains</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1847</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;PhraseQuery uses IndexReader in explainfor top level stats - as mentioned by Mike McCandless in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1837&quot; title=&quot;Remove Searcher from Weight#explain&quot;&gt;&lt;del&gt;LUCENE-1837&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
TermQuery uses IndexReader in explain for top level stats&lt;/p&gt;

&lt;p&gt;Always been a bug with MultiSearcher, but per segment search makes it worse.&lt;/p&gt;
</description>
                <environment></environment>
            <key id="12433806">LUCENE-1847</key>
            <summary>PhraseQuery/TermQuery/SpanQuery use IndexReader specific stats in their explains</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                <reporter username="markrmiller@gmail.com">Mark Miller</reporter>
                        <labels>
                    </labels>
                <created>Sun, 23 Aug 2009 21:10:01 +0100</created>
                <updated>Fri, 25 Sep 2009 17:23:36 +0100</updated>
                    <resolved>Tue, 25 Aug 2009 13:50:34 +0100</resolved>
                                            <fixVersion>2.9</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12746670" author="markrmiller@gmail.com" created="Sun, 23 Aug 2009 21:21:46 +0100"  >&lt;p&gt;Okay - I&apos;m going to use the other issue just to revert the Searcher - more of a task.&lt;/p&gt;

&lt;p&gt;This issue can then be used to track the new work for this bug here.&lt;/p&gt;</comment>
                    <comment id="12746853" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 13:59:53 +0100"  >&lt;p&gt;rough draft - works as the fix, but could use some polish.&lt;/p&gt;

&lt;p&gt;And what to do about back compat - because its just explain output, I don&apos;t think its a huge deal,&lt;br/&gt;
but if you overrode idf(Collection terms, Searcher searcher) or idf(Term term, Searcher searcher) on&lt;br/&gt;
Sim, right now they wouldn&apos;t be called for TermQuery and PhraseQuery. An override of float idf(int docFreq, int numDocs)&lt;br/&gt;
would still be taken into account though.&lt;/p&gt;</comment>
                    <comment id="12746859" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 14:16:15 +0100"  >&lt;p&gt;TestSimilarity fails due to the back compat issue by the way - it overrides a sim to return hard coded values for the two above ref&apos;d methods&lt;/p&gt;</comment>
                    <comment id="12746914" author="mikemccand" created="Mon, 24 Aug 2009 16:23:06 +0100"  >&lt;p&gt;Patch looks good.  Can we name it IDFExplain instead of IdfExplain?  Nit-picky I know, but I try to do all caps when the thing is already an acronym.&lt;/p&gt;

&lt;p&gt;Shouldn&apos;t we deprecate Similarity&apos;s idf methods that return float?&lt;/p&gt;

&lt;p&gt;You may want to defer calling IdfExplain.explain() until the Weight&apos;s explain is invoked?  And, then, store the IdfExplain instance in the Weight, and then IdfExplain must implement Serializable, and maybe add a Javadoc stating that Weight instances may hold onto your IdfExplain so be careful about holding references to big/unserializable things if you need to serialize.&lt;/p&gt;

&lt;p&gt;On back-compat... we could check (using reflection) if the subclass has overridden it, and in that case forward to the subclass&apos;s method, with some canned explanation eg &quot;inexplicable&quot; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12746919" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 16:28:14 +0100"  >&lt;blockquote&gt;&lt;p&gt;Can we name it IDFExplain instead of IdfExplain? Nit-picky I know, but I try to do all caps when the thing is already an acronym.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yup, sounds good.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Shouldn&apos;t we deprecate Similarity&apos;s idf methods that return float?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes - I&apos;ve done that locally - just didn&apos;t concentrate it on this patch because I hadn&apos;t solved the back compat problems yet.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;You may want to defer calling IdfExplain.explain() until the Weight&apos;s explain is invoked? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;On back-compat... we could check (using reflection) if the subclass has overridden it, and in that case forward to the subclass&apos;s method, with some canned explanation eg &quot;inexplicable&quot; &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ugg ... at least this code isn&apos;t performance sensitive &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I&apos;ll work with that.&lt;/p&gt;</comment>
                    <comment id="12746924" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 16:35:57 +0100"  >&lt;p&gt;Its a problem with SpanQuery as well&lt;/p&gt;</comment>
                    <comment id="12746941" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 17:33:16 +0100"  >&lt;p&gt;Okay, almost there. This one fixes SpanWeight as well and checks for back compat. Plus other little polish stuff.&lt;/p&gt;</comment>
                    <comment id="12746968" author="mikemccand" created="Mon, 24 Aug 2009 18:38:18 +0100"  >&lt;p&gt;Looks good!&lt;/p&gt;

&lt;p&gt;Your isMethodOverridden is incorrectly checking against&lt;br/&gt;
TokenStream.class (should be Similarity.class instead).  Maybe add a&lt;br/&gt;
test case that asserts &quot;maxDocs=XXX&quot; is present in TermQuery&apos;s explain?&lt;/p&gt;

&lt;p&gt;Small typo: explaination -&amp;gt; explanation&lt;/p&gt;</comment>
                    <comment id="12746982" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 19:04:45 +0100"  >&lt;p&gt;add test case for TermQuery explain over multisearcher.&lt;/p&gt;

&lt;p&gt;fixed spelling - my ubber eclipse spellcheck file likes that version ...&lt;/p&gt;

&lt;p&gt;nice eyes on the TokenStream - classic cut and paste folly.&lt;/p&gt;</comment>
                    <comment id="12747036" author="mikemccand" created="Mon, 24 Aug 2009 20:40:52 +0100"  >&lt;p&gt;New patch has explaination in the javadoc &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Otherwise patch looks great!  I like the new unit test &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12747061" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 21:51:22 +0100"  >&lt;p&gt;Okay, one final version I hope:&lt;/p&gt;

&lt;p&gt;fixed javadoc spelling of explanations&lt;br/&gt;
removed unused imports&lt;br/&gt;
minor javadoc tweaks&lt;/p&gt;</comment>
                    <comment id="12747063" author="mikemccand" created="Mon, 24 Aug 2009 21:56:29 +0100"  >&lt;p&gt;Looks good!&lt;/p&gt;</comment>
                    <comment id="12747074" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 22:03:44 +0100"  >&lt;p&gt;I&apos;m wondering if we should cache the isMethodOverridden now. clazz.getMethod is painfully slow.&lt;/p&gt;

&lt;p&gt;If I keep teeing up a ton of new TermQuery/PhraseQuery/SpanQuery Weights for searching, its going to be much, much slower in a throughput benchmark.&lt;/p&gt;</comment>
                    <comment id="12747079" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 22:10:26 +0100"  >&lt;p&gt;Hmm - it would have to be a static cache - thats not great. But perhaps the lesser of two evils.&lt;/p&gt;</comment>
                    <comment id="12747080" author="mikemccand" created="Mon, 24 Aug 2009 22:12:17 +0100"  >&lt;p&gt;You could cache it on the Similarity instance?&lt;/p&gt;</comment>
                    <comment id="12747083" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 22:21:02 +0100"  >&lt;p&gt;of course. right where it belongs &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Darn brain is lazier than my aim.&lt;/p&gt;</comment>
                    <comment id="12747184" author="markrmiller@gmail.com" created="Tue, 25 Aug 2009 03:06:51 +0100"  >&lt;p&gt;Okay, adds a cache and puts it on Similarity -&lt;/p&gt;

&lt;p&gt;This will let user queries that use the new explain stuff use Sims that overload those methods too - not a likely scerioro, but nice to know its covered now.&lt;/p&gt;

&lt;p&gt;I changed to inexplicable - thats a great word.&lt;/p&gt;

&lt;p&gt;Just finished, so merits another look over before commit ready.&lt;/p&gt;</comment>
                    <comment id="12747196" author="markrmiller@gmail.com" created="Tue, 25 Aug 2009 03:49:33 +0100"  >&lt;p&gt;Okay, I&apos;m still awake, so one more:&lt;/p&gt;

&lt;p&gt;Removed some white space to clean up diff&lt;br/&gt;
Changed IDFExplain to IDFExplanation&lt;br/&gt;
Added Phrase and SpanQuery to the new test.&lt;/p&gt;</comment>
                    <comment id="12747327" author="mikemccand" created="Tue, 25 Aug 2009 10:32:09 +0100"  >&lt;blockquote&gt;&lt;p&gt;I changed to inexplicable - thats a great word.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yay &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Small typo: explantion.  This sure is one hard word to get right!&lt;/p&gt;

&lt;p&gt;Otherwise looks good to go!&lt;/p&gt;</comment>
                    <comment id="12747378" author="markrmiller@gmail.com" created="Tue, 25 Aug 2009 13:35:57 +0100"  >&lt;p&gt;One more -&lt;/p&gt;

&lt;p&gt;I killed my spellchecker trying to get explaination out of it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Fixed the new misspelling though, and removed the java 1.5 code &apos;contains&apos; - thanks to whoever committed that to the qp test as well - I wouldn&apos;t have noticed it was a problem here otherwise &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12747385" author="markrmiller@gmail.com" created="Tue, 25 Aug 2009 13:50:34 +0100"  >&lt;p&gt;Thanks a lot Mike !&lt;/p&gt;

&lt;p&gt;r807595.&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="12310010">
                <name>Incorporates</name>
                                <outwardlinks description="incorporates">
                            <issuelink>
            <issuekey id="12384338">LUCENE-1087</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12433681">LUCENE-1837</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12417609" name="LUCENE-1847.patch" size="17281" author="markrmiller@gmail.com" created="Tue, 25 Aug 2009 13:35:57 +0100" />
                    <attachment id="12417561" name="LUCENE-1847.patch" size="17256" author="markrmiller@gmail.com" created="Tue, 25 Aug 2009 03:49:33 +0100" />
                    <attachment id="12417554" name="LUCENE-1847.patch" size="16678" author="markrmiller@gmail.com" created="Tue, 25 Aug 2009 03:06:51 +0100" />
                    <attachment id="12417523" name="LUCENE-1847.patch" size="18223" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 21:51:22 +0100" />
                    <attachment id="12417499" name="LUCENE-1847.patch" size="18595" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 19:04:45 +0100" />
                    <attachment id="12417491" name="LUCENE-1847.patch" size="15999" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 17:33:16 +0100" />
                    <attachment id="12417474" name="LUCENE-1847.patch" size="8371" author="markrmiller@gmail.com" created="Mon, 24 Aug 2009 13:59:53 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>7.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 24 Aug 2009 15:23:06 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11916</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25880</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
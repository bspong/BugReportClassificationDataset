<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 12:57:46 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-771/LUCENE-771.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-771] Change default write lock file location to index directory (not java.io.tmpdir)</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-771</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Now that readers are read-only, we no longer need to store lock files&lt;br/&gt;
in a different global lock directory than the index directory.  This&lt;br/&gt;
has been a source of confusion and caused problems to users in the&lt;br/&gt;
past.&lt;/p&gt;

&lt;p&gt;Furthermore, once the write lock is stored in the index directory, it&lt;br/&gt;
no longer needs the big digest prefix that was previously required&lt;br/&gt;
to make sure lock files in the global lock directory, from different&lt;br/&gt;
indexes, did not conflict.&lt;/p&gt;

&lt;p&gt;This way, all files related to an index will appear in a single&lt;br/&gt;
directory.  And you can easily list that directory to see if a&lt;br/&gt;
&quot;write.lock&quot; is present to check whether a writer is open on the&lt;br/&gt;
index.&lt;/p&gt;

&lt;p&gt;Note that this change just affects how FSDirectory creates its default&lt;br/&gt;
lockFactory if no lockFactory was specified.  It is still possible&lt;br/&gt;
(just no longer the default) to pick a different directory to store&lt;br/&gt;
your lock files by pre-instantiating your own LockFactory.&lt;/p&gt;

&lt;p&gt;As part of this I would like to remove LOCK_DIR and the no-argument&lt;br/&gt;
constructor, in SimpleFSLockFactory and NativeFSLockFactory.  I don&apos;t&lt;br/&gt;
think we should have the notion of a global default lock directory&lt;br/&gt;
anymore.  This is actually an API change.  However, neither&lt;br/&gt;
SimpleFSLockFactory nor NativeFSLockFactory haver been released yet,&lt;br/&gt;
so I think this API removal is allowed?&lt;/p&gt;

&lt;p&gt;Finally I want to deprecate (but not yet remove, because this has been&lt;br/&gt;
in the API for many releases) the static LOCK_DIR that&apos;s in&lt;br/&gt;
FSDirectory.  But it&apos;s now entirely unused.&lt;/p&gt;

&lt;p&gt;See here for discussion leading to this:&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;http://www.gossamer-threads.com/lists/lucene/java-dev/43940&quot; class=&quot;external-link&quot;&gt;http://www.gossamer-threads.com/lists/lucene/java-dev/43940&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
            <key id="12360405">LUCENE-771</key>
            <summary>Change default write lock file location to index directory (not java.io.tmpdir)</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Jan 2007 19:54:49 +0000</created>
                <updated>Tue, 27 Feb 2007 18:10:39 +0000</updated>
                    <resolved>Wed, 17 Jan 2007 10:54:31 +0000</resolved>
                            <version>2.1</version>
                                <fixVersion>2.1</fixVersion>
                                <component>core/store</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12464350" author="yseeley@gmail.com" created="Fri, 12 Jan 2007 20:48:59 +0000"  >&lt;p&gt;Sounds good, I agree with all the changes you outlined.&lt;/p&gt;</comment>
                    <comment id="12464371" author="mikemccand" created="Fri, 12 Jan 2007 22:15:47 +0000"  >&lt;p&gt;Thanks for the review Yonik!&lt;/p&gt;

&lt;p&gt;And thanks for pointing this out Marvin!&lt;/p&gt;

&lt;p&gt;I&apos;ve committed this.&lt;/p&gt;</comment>
                    <comment id="12464385" author="doronc" created="Sat, 13 Jan 2007 00:43:48 +0000"  >&lt;p&gt;I have a question on this change - though I didn&apos;t look at the code yet - we don&apos;t support backwards compatability with regard to existing lock files, right?  Specifically, if there exist an older version index with locks in tmp dir, and the Lucene lib is replaced for one client at a time, while other clients are running, there would be a problem, possible corruption. So who ever is migrating from an index before this change to an index with this change should make sure that all clients are upgraded at the time. At least all clients that may attempt to write.&lt;/p&gt;</comment>
                    <comment id="12464393" author="mikemccand" created="Sat, 13 Jan 2007 02:01:20 +0000"  >&lt;p&gt;Yes, that is true.&lt;/p&gt;

&lt;p&gt;But there are also quite a few other changes in 2.1 (eg the file format changes) that would also generally necessitate that all places that will share the given index, upgrade to 2.1 at once.&lt;/p&gt;</comment>
                    <comment id="12464395" author="doronc" created="Sat, 13 Jan 2007 02:07:31 +0000"  >&lt;p&gt;Is that true? I thought that for previous format changes, the combination of - &lt;/p&gt;
{ (1) point-in-time index reading by readers (2) backwards compatibility (3) locks }
&lt;p&gt; - allowed not to require this. &lt;/p&gt;</comment>
                    <comment id="12464409" author="mikemccand" created="Sat, 13 Jan 2007 03:34:52 +0000"  >&lt;p&gt;You&apos;re right, backwards compatibility will allow a 2.1 client to&lt;br/&gt;
read/write to an older index, but as soon as a 2.1 client writes to&lt;br/&gt;
the index then all pre-2.1 readers won&apos;t be able to read it.  You&apos;re&lt;br/&gt;
right that if these readers are not reopened then &quot;point in time&quot;&lt;br/&gt;
would allow them to keep running pre-2.1.&lt;/p&gt;

&lt;p&gt;So I think you could individually update each reader to 2.1, but then&lt;br/&gt;
(after readers are updated), all writers would need to go to 2.1 at&lt;br/&gt;
once, to make sure they all &quot;agree&quot; that the write lock is now in the&lt;br/&gt;
index.&lt;/p&gt;</comment>
                    <comment id="12464466" author="mikemccand" created="Sat, 13 Jan 2007 14:29:50 +0000"  >&lt;p&gt;Woops, I committed a silly violation of the LockFactory abstraction&lt;br/&gt;
(I&apos;m removing files in FSDirectory when that should only occur inside&lt;br/&gt;
the LockFactory implementation.)  I&apos;m re-opening and I&apos;ll get the&lt;br/&gt;
corrected fix in soon.&lt;/p&gt;
</comment>
                    <comment id="12476281" author="mikemccand" created="Tue, 27 Feb 2007 18:10:39 +0000"  >&lt;p&gt;Closing all issues that were resolved for 2.1.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Fri, 12 Jan 2007 20:48:59 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12981</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26959</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:16:33 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2792/LUCENE-2792.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2792] Add a simple FST impl to Lucene</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2792</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>
&lt;p&gt;I implemented the algo described at&lt;br/&gt;
&lt;a href=&quot;http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.24.3698&quot; class=&quot;external-link&quot;&gt;http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.24.3698&lt;/a&gt; for&lt;br/&gt;
incrementally building a finite state transducer (FST) from sorted&lt;br/&gt;
inputs.&lt;/p&gt;

&lt;p&gt;This is not a fully general FST impl &amp;#8211; it&apos;s only able to build up an&lt;br/&gt;
FST incrementally from input/output pairs that are pre-sorted.&lt;/p&gt;

&lt;p&gt;Currently the inputs are BytesRefs, and the outputs are pluggable &amp;#8211;&lt;br/&gt;
NoOutputs gets you a simple FSA, PositiveIntOutputs maps to a long,&lt;br/&gt;
ByteSequenceOutput maps to a BytesRef.&lt;/p&gt;

&lt;p&gt;The implementation has a low memory overhead, so that it can handle a&lt;br/&gt;
fairly large set of terms.  For example, it can build the FSA for the&lt;br/&gt;
9.8M terms from a 10M document wikipedia index in ~8 seconds (on&lt;br/&gt;
beast), using ~256 MB peak RAM, resulting in an FSA that&apos;s ~60 MB.&lt;/p&gt;

&lt;p&gt;It packs the FST as-it-builds into a compact byte[], and then exposes&lt;br/&gt;
the API to read nodes/arcs directly from the byte[].  The FST can be&lt;br/&gt;
quickly saved/loaded to/from a Directory since it&apos;s just a big byte[].&lt;/p&gt;

&lt;p&gt;The format is similar to what Morfologik uses&lt;br/&gt;
(&lt;a href=&quot;http://sourceforge.net/projects/morfologik/&quot; class=&quot;external-link&quot;&gt;http://sourceforge.net/projects/morfologik/&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;I think there are a number of possible places we can use this in&lt;br/&gt;
Lucene.  For example, I think many apps could hold the entire terms&lt;br/&gt;
dict in RAM, either at the multi-reader level or maybe per-segment&lt;br/&gt;
(mapping to file offset or to something else custom to the app), which&lt;br/&gt;
may possibly be a good speedup for certain MTQs (though, because the&lt;br/&gt;
format is packed into a byte[], there is a decode cost when visiting&lt;br/&gt;
arcs).&lt;/p&gt;

&lt;p&gt;The builder can also prune as it goes, so you get a prefix trie pruned&lt;br/&gt;
according to how many terms run through the nodes, which makes it&lt;br/&gt;
faster and even less memory consuming.  This may be useful as a&lt;br/&gt;
replacement for our current binary search terms index since it can&lt;br/&gt;
achieve higher term density for the same RAM consumption of our&lt;br/&gt;
current index.&lt;/p&gt;

&lt;p&gt;As an initial usage to make sure this is exercised, I cutover the&lt;br/&gt;
SimpleText codec, which currently fully loads all terms into a&lt;br/&gt;
TreeMap (and has caused intermittent OOME in some tests), to use an FST&lt;br/&gt;
instead.  SimpleText uses a PairOutputs which is able to &quot;pair up&quot; any&lt;br/&gt;
two other outputs, since it needs to map each input term to an int&lt;br/&gt;
docFreq and long filePosition.&lt;/p&gt;

&lt;p&gt;All tests pass w/ SimpleText forced codec, and I think this is&lt;br/&gt;
committable except I&apos;d love to get some help w/ the generics&lt;br/&gt;
(confession to the policeman: I had to add&lt;br/&gt;
@SuppressWarnings(&lt;/p&gt;
{&quot;unchecked&quot;}
&lt;p&gt;)) all over!!  Ideally an FST is&lt;br/&gt;
parameterized by its output type (Integer, BytesRef, etc.).&lt;/p&gt;

&lt;p&gt;I even added a new @nightly test that makes a largeish set of random&lt;br/&gt;
terms and tests the resulting FST on different outputs &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I think it would also be easy to make a variant that uses char[]&lt;br/&gt;
instead of byte[] as its inputs, so we could eg use this during analysis&lt;br/&gt;
(Robert&apos;s idea).  It&apos;s already be easy to have a CharSequence&lt;br/&gt;
output type since the outputs are pluggable.&lt;/p&gt;

&lt;p&gt;Dawid Weiss (author of HPPC &amp;#8211; &lt;a href=&quot;http://labs.carrotsearch.com/hppc.html&quot; class=&quot;external-link&quot;&gt;http://labs.carrotsearch.com/hppc.html&lt;/a&gt; &amp;#8211; and&lt;br/&gt;
Morfologik &amp;#8211; &lt;a href=&quot;http://sourceforge.net/projects/morfologik/&quot; class=&quot;external-link&quot;&gt;http://sourceforge.net/projects/morfologik/&lt;/a&gt;)&lt;br/&gt;
was very helpful iterating with me on this (thank you!).&lt;/p&gt;</description>
                <environment></environment>
            <key id="12491976">LUCENE-2792</key>
            <summary>Add a simple FST impl to Lucene</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Dec 2010 10:30:58 +0000</created>
                <updated>Fri, 10 May 2013 11:44:58 +0100</updated>
                    <resolved>Mon, 13 Dec 2010 19:18:08 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>1</votes>
                        <watches>2</watches>
                                                    <comments>
                    <comment id="12966478" author="mikemccand" created="Fri, 3 Dec 2010 10:34:56 +0000"  >&lt;p&gt;Patch.&lt;/p&gt;</comment>
                    <comment id="12966479" author="mikemccand" created="Fri, 3 Dec 2010 10:39:02 +0000"  >&lt;p&gt;I&apos;m attaching an example FST (PNG image) so we can visualize what an FST does.&lt;/p&gt;

&lt;p&gt;Really an FST is like a SortedMap&amp;lt;BytesRef,X&amp;gt;, where X (the &quot;outputs&quot;) is pluggable.&lt;/p&gt;

&lt;p&gt;This particular FST maps a canned set of words to the int ord (0, 1, 2, ...) of the word.&lt;/p&gt;

&lt;p&gt;Arcs that are &quot;final&quot; end in a T instead of an arrow, which means if you stop at that arc the input you&apos;ve traversed is &quot;accepted&quot;.  (The blue arcs just indicate arcs that were compressed with a NEXT flag when stored in the byte[].)&lt;/p&gt;

&lt;p&gt;To get the total output you sum the outputs you encounter.  For example, the input &quot;stop&quot; hits output 4 on the &apos;s&apos; and output 1 on the o so its ord is 5.&lt;/p&gt;</comment>
                    <comment id="12966510" author="rcmuir" created="Fri, 3 Dec 2010 12:30:50 +0000"  >&lt;p&gt;This sounds awesome!&lt;/p&gt;

&lt;p&gt;It would be neat to write intersect(FST, Automaton), and somehow optionally use it if available.&lt;br/&gt;
Such a thing might be cleaner now that MTQ.getTermsEnum takes a Terms structure&lt;/p&gt;</comment>
                    <comment id="12966597" author="jasonrutherglen" created="Fri, 3 Dec 2010 17:37:12 +0000"  >&lt;p&gt;Can the FST be made concurrent for use in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2312&quot; title=&quot;Search on IndexWriter&amp;#39;s RAM Buffer&quot;&gt;LUCENE-2312&lt;/a&gt; as the terms dict implementation?&lt;/p&gt;</comment>
                    <comment id="12966600" author="mikemccand" created="Fri, 3 Dec 2010 17:54:11 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can the FST be made concurrent for use in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2312&quot; title=&quot;Search on IndexWriter&amp;#39;s RAM Buffer&quot;&gt;LUCENE-2312&lt;/a&gt; as the terms dict implementation?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Maybe?  Ie the write ops are things like &quot;append a new arc to this node&quot;, so eg if we use a concurrent linked list per node?&lt;/p&gt;

&lt;p&gt;Also, the impl here isn&apos;t helpful for the RT case, since it requires you add the terms in sorted order.  But, there is a non-sorted-order version too, however, they will be substantially more RAM consuming since they&apos;d use a objects for node/arcs (this impl doesn&apos;t).&lt;/p&gt;</comment>
                    <comment id="12966604" author="rcmuir" created="Fri, 3 Dec 2010 18:03:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can the FST be made concurrent for use in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2312&quot; title=&quot;Search on IndexWriter&amp;#39;s RAM Buffer&quot;&gt;LUCENE-2312&lt;/a&gt; as the terms dict implementation?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Just an idea, maybe you could use something like ConcurrentSkipListMap for this&lt;br/&gt;
until mike makes &quot;fst 2.0&quot; or something?&lt;/p&gt;

&lt;p&gt;its only in java 6 but you can poach from apache harmony...&lt;/p&gt;</comment>
                    <comment id="12966691" author="michaelbusch" created="Fri, 3 Dec 2010 22:01:09 +0000"  >&lt;p&gt;Cool stuff, Mike!&lt;/p&gt;

&lt;p&gt;Could we use this for more efficient wildcard search?  E.g. could we add posting lists for inner nodes to the index?&lt;/p&gt;</comment>
                    <comment id="12966817" author="mikemccand" created="Sat, 4 Dec 2010 10:01:25 +0000"  >&lt;blockquote&gt;&lt;p&gt;Could we use this for more efficient wildcard search? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Possibly &amp;#8211; we need to explore this.  It remains to be seen if the CPU cost of traversing the FST is offset by the fact that the FST can keep more (possibly, all) terms in memory.&lt;/p&gt;

&lt;p&gt;Also we&apos;d need to figure out whether this&apos;d work at the top-level reader (eg as an initial filter to enumerate all terms matching the MTQ), or, per-segment as the terms index (which&apos;d be much more RAM costly).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;E.g. could we add posting lists for inner nodes to the index?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hmm... what are the &quot;inner nodes&quot;?&lt;/p&gt;

&lt;p&gt;I guess we could do something like Pulsing codec, where postings for low doc-freq terms are simply stored in an FST, and then only the higher freq terms remain on disk (optionally of course since whether this is feasible depends on the app).  Then eg lookups against a primary key field would be entirely in RAM.&lt;/p&gt;</comment>
                    <comment id="12970251" author="jasonrutherglen" created="Fri, 10 Dec 2010 18:16:02 +0000"  >&lt;blockquote&gt;&lt;p&gt;Just an idea, maybe you could use something like ConcurrentSkipListMap for this&lt;br/&gt;
its only in java 6 but you can poach from apache harmony...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right, I&apos;m planning on using CSLM and sorted int[]s.  Aren&apos;t we on Java 6 for trunk?  However, yes, it&apos;d be nice to support JDK 1.5, I&apos;ll look into if Harmony&apos;s CSLM can be pulled out.&lt;/p&gt;</comment>
                    <comment id="12970445" author="mikemccand" created="Sat, 11 Dec 2010 10:50:50 +0000"  >&lt;p&gt;New patch!  I think it&apos;s ready to commit.&lt;/p&gt;

&lt;p&gt;I switched the core FST input from byte to int so that the FST can now map any IntsRef to any output.  I also added sugar for adding eg CharSequence, char[] as utf32 to the FST, and also running (looking up the output for a given input).  I made separate BytesRefFSTEnum and IntsRefFSTEnum.  I changed the &quot;nocommit switch to generics&quot; to TODOs &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, but it&apos;d be nice to somehow cutover to generics for the FST&apos;s output type.&lt;/p&gt;

&lt;p&gt;I also added a test case that indexes docs from the new test line docs file, builds an FST, then verifies the resulting TermsEnum vs BytesRefFSTEnum behave the same.&lt;/p&gt;</comment>
                    <comment id="12970447" author="thetaphi" created="Sat, 11 Dec 2010 11:14:11 +0000"  >&lt;p&gt;Hi Mike,&lt;br/&gt;
my problem is that I have no time to closely look into it and I don&apos;t understand the whole thing &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; (you cannot always understand everything &lt;b&gt;g&lt;/b&gt;). So I have no idea how the generics &lt;b&gt;should&lt;/b&gt; look like. I don&apos;t even understand all the SuppressWarnings currently in the code, because in my opinion, generics warnings cannot occur at all those places. From a first look it seems that a few places using untyped Output, but for that the methods need to be generified (a generic &amp;lt;T&amp;gt; before the return type like in AttributeSource). The &quot;copy&quot; in one of the TODOs cannot be avoided by generics, because the generics are type erasure, so it would not help in that method (only that you may not need to add so many casts, which on the other hand the compiler will add).&lt;/p&gt;</comment>
                    <comment id="12970452" author="rcmuir" created="Sat, 11 Dec 2010 12:49:42 +0000"  >&lt;p&gt;As a start, i generified the PairOutputs.. will try to help with the other classes later today.&lt;/p&gt;</comment>
                    <comment id="12970459" author="thetaphi" created="Sat, 11 Dec 2010 14:00:43 +0000"  >&lt;p&gt;Here a first generifid patch. There are several problems:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;FST&amp;lt;T&amp;gt; as parameter to Outputs.write() and Outputs.read() breaks generics in PairOutput (I added nocommit, this is really why we have the generics, without that this bug would never be visible). Mike said, that there should be really used IndexInput and IndexOutput&lt;/li&gt;
	&lt;li&gt;The testcase is broken, as it dynamically casts types depending on int constants. The test should be rewritten to use typed inner classes (and some code duplication)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I may have missed more generics violations, but it now compiles correctly. Javac does not detect all missing parameters, so I have to review again, but for now I want to post the patch.&lt;/p&gt;</comment>
                    <comment id="12970460" author="thetaphi" created="Sat, 11 Dec 2010 14:08:58 +0000"  >&lt;p&gt;Last patch missed some generics in NoOutputs and PositiveInts&lt;/p&gt;</comment>
                    <comment id="12970461" author="mikemccand" created="Sat, 11 Dec 2010 14:16:27 +0000"  >&lt;p&gt;This looks great Uwe, thanks!&lt;/p&gt;</comment>
                    <comment id="12970603" author="mikemccand" created="Sun, 12 Dec 2010 14:28:03 +0000"  >&lt;p&gt;New patch, after substantial iterations w/ the Generics Policeman (thanks!) using Mercurial.&lt;/p&gt;

&lt;p&gt;It&apos;s much cleaner now &amp;#8211; the classes are parameterized by the output type of the FST.&lt;/p&gt;

&lt;p&gt;I will commit soon...&lt;/p&gt;</comment>
                    <comment id="12970604" author="thetaphi" created="Sun, 12 Dec 2010 14:43:55 +0000"  >&lt;p&gt;I will merge the ArrayUtils imporvements to 3.x after the commit (its minor, but very useful).&lt;/p&gt;</comment>
                    <comment id="12970608" author="thetaphi" created="Sun, 12 Dec 2010 15:26:50 +0000"  >&lt;p&gt;Mike: Here some further, small cleanups in the grow() parts.&lt;/p&gt;</comment>
                    <comment id="12970609" author="mikemccand" created="Sun, 12 Dec 2010 15:43:39 +0000"  >&lt;p&gt;Thanks Uwe!&lt;/p&gt;</comment>
                    <comment id="12970694" author="rcmuir" created="Mon, 13 Dec 2010 03:22:22 +0000"  >&lt;p&gt;Reopening: the generic ArrayUtil.grow here (with getComponentType etc) is more than 10x slower than the old code on -client.&lt;br/&gt;
Yes, its the same performance on -server, but not everyone runs with that.&lt;/p&gt;</comment>
                    <comment id="12970697" author="rcmuir" created="Mon, 13 Dec 2010 03:33:30 +0000"  >&lt;p&gt;In revision 1045012, i reverted the generic grow() for the classes that are unrelated to this issue.&lt;/p&gt;

&lt;p&gt;Its still being used in 3 places by the FST stuff in this patch, and this should be reviewed separately if these areas are performance sensitive.&lt;/p&gt;</comment>
                    <comment id="12970700" author="rcmuir" created="Mon, 13 Dec 2010 03:46:53 +0000"  >&lt;p&gt;Here&apos;s the link for reference: &lt;a href=&quot;http://bugs.sun.com/view_bug.do?bug_id=6525802&quot; class=&quot;external-link&quot;&gt;http://bugs.sun.com/view_bug.do?bug_id=6525802&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This getComponentType is intrinsic only on -server, on -client it is native (slow).&lt;/p&gt;

&lt;p&gt;Personally I think we should remove this generic grow() completely to avoid performance issues (I kept it, but its only used by FST)&lt;/p&gt;</comment>
                    <comment id="12970738" author="thetaphi" created="Mon, 13 Dec 2010 08:03:08 +0000"  >&lt;p&gt;Thanks Robert for the test with -client. We all use -server and did not see a difference (I made tests yesterday with Java 6). &lt;/p&gt;

&lt;p&gt;This may also be a reason for the slow performance of Collections.sort() without our improvements, because AbstractCollection.toArray(T[]) exactly uses this code to create the array instance (in fact, I copied the resize code from Harmony).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Here&apos;s the link for reference: &lt;a href=&quot;http://bugs.sun.com/view_bug.do?bug_id=6525802&quot; class=&quot;external-link&quot;&gt;http://bugs.sun.com/view_bug.do?bug_id=6525802&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;As far as I see is the slow part a.getClass().getComponentType(). What do you think about the following method signature, that would make it also 100% type safe and does not have the negative performance impact?:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; T[] grow(T[] array, &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;T&amp;gt; componentType, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; size)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In code you would use:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] sa=...
ArrayUtils.grow(sa, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.class, 20);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I can supply a patch for testing. Array.newInstance is one of the most used methods in lots of code, and the actual growing is done seldom (because of oversize()).&lt;/p&gt;</comment>
                    <comment id="12970740" author="thetaphi" created="Mon, 13 Dec 2010 08:26:11 +0000"  >&lt;p&gt;Here the patch, just to test performance. Robert?&lt;/p&gt;

&lt;p&gt;Silly: It again creates stupid unchecked warnings in FST classes (this was the main treason for the grow method). If this patch helps I will try to improve, maybe by relaxing generics in ArrayUtil.&lt;/p&gt;</comment>
                    <comment id="12970753" author="rcmuir" created="Mon, 13 Dec 2010 09:05:47 +0000"  >&lt;p&gt;Uwe, unfortunately even without the getComponentType its still much worse.&lt;br/&gt;
I&apos;m attaching my benchmark (times in milliseconds):&lt;br/&gt;
method1: new+arraycopy&lt;br/&gt;
method2: original Array.grow&lt;br/&gt;
method3: Array.grow without getComponentType&lt;/p&gt;

&lt;p&gt;-client &lt;br/&gt;
method1: 221&lt;br/&gt;
method2: 2672&lt;br/&gt;
method3: 1731&lt;br/&gt;
method1: 225&lt;br/&gt;
method2: 2674&lt;br/&gt;
method3: 1727&lt;br/&gt;
method1: 212&lt;br/&gt;
method2: 2697&lt;br/&gt;
method3: 1698&lt;/p&gt;

&lt;p&gt;-server&lt;br/&gt;
method1: 160&lt;br/&gt;
method2: 166&lt;br/&gt;
method3: 167&lt;br/&gt;
method1: 159&lt;br/&gt;
method2: 168&lt;br/&gt;
method3: 170&lt;br/&gt;
method1: 162&lt;br/&gt;
method2: 172&lt;br/&gt;
method3: 171&lt;/p&gt;</comment>
                    <comment id="12970932" author="mikemccand" created="Mon, 13 Dec 2010 18:16:40 +0000"  >&lt;p&gt;I think we should remove this generic ArrayUtil.grow?  It&apos;s too dangerous that we&apos;ll accidentally use it in a hotspot some time going forward...?&lt;/p&gt;</comment>
                    <comment id="12970941" author="thetaphi" created="Mon, 13 Dec 2010 18:31:30 +0000"  >&lt;p&gt;Give me few days to think about it. We still use it in FST, but mostly because the generics are ugly otherwise. Maybe I have a good idea. But we can revert in 3.x? I will do that, if you also thinks so.&lt;/p&gt;</comment>
                    <comment id="12970950" author="mikemccand" created="Mon, 13 Dec 2010 18:46:35 +0000"  >&lt;p&gt;It would be best if we could keep the API but w/ no trap for -client java users.&lt;/p&gt;

&lt;p&gt;But, I think we should at least revert from FST&apos;s Builder.UnCompiledNode arc reallocation; that&apos;s a hot spot...&lt;/p&gt;</comment>
                    <comment id="12970977" author="thetaphi" created="Mon, 13 Dec 2010 19:18:07 +0000"  >&lt;p&gt;Reverted generic ArrayUtil.grow(T[]) in trunk and 3.x (rev. 1045319).&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12465223" name="FSTExample.png" size="71105" author="mikemccand" created="Fri, 3 Dec 2010 10:39:02 +0000" />
                    <attachment id="12466123" name="LUCENE-2792-ArrayUtil-grow.patch" size="11609" author="thetaphi" created="Mon, 13 Dec 2010 08:26:11 +0000" />
                    <attachment id="12466098" name="LUCENE-2792.patch" size="160612" author="thetaphi" created="Sun, 12 Dec 2010 15:26:50 +0000" />
                    <attachment id="12466096" name="LUCENE-2792.patch" size="160308" author="mikemccand" created="Sun, 12 Dec 2010 14:28:03 +0000" />
                    <attachment id="12466059" name="LUCENE-2792.patch" size="148982" author="thetaphi" created="Sat, 11 Dec 2010 14:08:58 +0000" />
                    <attachment id="12466047" name="LUCENE-2792.patch" size="148109" author="rcmuir" created="Sat, 11 Dec 2010 12:49:41 +0000" />
                    <attachment id="12466045" name="LUCENE-2792.patch" size="143992" author="mikemccand" created="Sat, 11 Dec 2010 10:50:49 +0000" />
                    <attachment id="12465221" name="LUCENE-2792.patch" size="101586" author="mikemccand" created="Fri, 3 Dec 2010 10:34:56 +0000" />
                    <attachment id="12466125" name="SimpleBench.java" size="1641" author="rcmuir" created="Mon, 13 Dec 2010 09:05:47 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>9.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Fri, 3 Dec 2010 12:30:50 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11062</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24900</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
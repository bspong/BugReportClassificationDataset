<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:32:18 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1217/LUCENE-1217.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1217] use isBinary cached variable instead of instanceof in Field</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1217</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Field class can hold three types of values, &lt;br/&gt;
See: AbstractField.java  protected Object fieldsData = null; &lt;/p&gt;

&lt;p&gt;currently, mainly RTTI (instanceof) is used to determine the type of the value stored in particular instance of the Field, but for binary value we have mixed RTTI and cached variable &quot;boolean isBinary&quot; &lt;/p&gt;

&lt;p&gt;This patch makes consistent use of cached variable isBinary.&lt;/p&gt;

&lt;p&gt;Benefit: consistent usage of method to determine run-time type for binary case  (reduces chance to get out of sync on cached variable). It should be slightly faster as well.&lt;/p&gt;

&lt;p&gt;Thinking aloud: &lt;br/&gt;
Would it not make sense to maintain type with some integer/byte&quot;poor man&apos;s enum&quot; (Interface with a couple of constants)&lt;br/&gt;
code:java{&lt;br/&gt;
public static final interface Type{&lt;br/&gt;
public static final byte BOOLEAN = 0;&lt;br/&gt;
public static final byte STRING = 1;&lt;br/&gt;
public static final byte READER = 2;&lt;br/&gt;
....&lt;br/&gt;
}&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;and use that instead of isBinary + instanceof? &lt;/p&gt;</description>
                <environment></environment>
            <key id="12390735">LUCENE-1217</key>
            <summary>use isBinary cached variable instead of instanceof in Field</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="eksdev">Eks Dev</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Mar 2008 09:23:19 +0000</created>
                <updated>Wed, 12 Mar 2008 16:57:16 +0000</updated>
                    <resolved>Wed, 12 Mar 2008 10:10:20 +0000</resolved>
                                                            <component>core/other</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12577547" author="mikemccand" created="Tue, 11 Mar 2008 18:26:37 +0000"  >&lt;p&gt;Patch looks good.  I will commit shortly.  Thanks Eks Dev.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Would it not make sense to maintain type with some integer/byte&quot;poor man&apos;s enum&quot; (Interface with a couple of constants)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Or we could wait until Java 5 (3.0) and use real enums?&lt;/p&gt;

&lt;p&gt;Or ... maybe we should have subclasses of Field (TextField, BinaryField,&lt;br/&gt;
ReaderField, TokenStreamField) which override the corresponding method&lt;br/&gt;
(and the base Field.java would still implement these methods but&lt;br/&gt;
return null)?  Though this would be a rather large change...&lt;/p&gt;</comment>
                    <comment id="12577591" author="eksdev" created="Tue, 11 Mar 2008 20:35:13 +0000"  >&lt;p&gt;thanks fof looking into it!&lt;br/&gt;
Subclassing now with backwards compatibility would be clumsy, I was thinking about it but could not find clean way to make it.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt;Or we could wait until Java 5 (3.0) and use real enums?&lt;br/&gt;
yes, that is ultimate solution, but my line of thoughts was that &quot;poor man&apos;s enum&quot;-&amp;gt;java 5 enum migration would be trivial later... but do not change working code kicks-in here &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  &lt;/p&gt;</comment>
                    <comment id="12577598" author="mikemccand" created="Tue, 11 Mar 2008 20:48:33 +0000"  >&lt;p&gt;Actually seeing a test failure with this:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Testcase: testLazyFields(org.apache.lucene.index.TestFieldsReader): FAILED&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; bytes is null and it shouldn&apos;t be&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; junit.framework.AssertionFailedError: bytes is null and it shouldn&apos;t be&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.lucene.index.TestFieldsReader.testLazyFields(TestFieldsReader.java:132)&lt;/p&gt;
</comment>
                    <comment id="12577601" author="eksdev" created="Tue, 11 Mar 2008 21:08:35 +0000"  >&lt;p&gt;hah, this bug just  justified this patch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;br/&gt;
sorry,  I should have run tests before... nothing is trivial enough.   &lt;br/&gt;
 The problem was indeed isBinary that went out of sync in LazyField, new patch follows &lt;/p&gt;</comment>
                    <comment id="12577602" author="eksdev" created="Tue, 11 Mar 2008 21:09:40 +0000"  >&lt;p&gt;new patch, fixes isBinary status in LazyField&lt;/p&gt;</comment>
                    <comment id="12577637" author="mikemccand" created="Tue, 11 Mar 2008 22:49:00 +0000"  >&lt;p&gt;OK the new patch passes all tests &amp;#8211; thanks!&lt;/p&gt;

&lt;p&gt;One unrelated thing I noticed: it looks like you can get a binary LazyField and then ask for its stringValue(), and vice-versa.  Ie we are failing to check in binaryValue() that the field is in fact binary even though when we create the LazyField we know whether it is.  I&apos;ll open a separate issue for this.&lt;/p&gt;</comment>
                    <comment id="12577919" author="cutting" created="Wed, 12 Mar 2008 16:57:16 +0000"  >&lt;p&gt;fix typo that&apos;s been bugging me&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10032">
                <name>Blocker</name>
                                <outwardlinks description="blocks">
                            <issuelink>
            <issuekey id="12390744">LUCENE-1219</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12377589" name="LUCENE-1217.patch" size="1423" author="eksdev" created="Tue, 11 Mar 2008 09:25:36 +0000" />
                    <attachment id="12377639" name="Lucene-1217-take1.patch" size="1555" author="eksdev" created="Tue, 11 Mar 2008 21:09:40 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 11 Mar 2008 18:26:37 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12529</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26512</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
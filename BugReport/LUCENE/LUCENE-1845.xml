<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:06:00 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1845/LUCENE-1845.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1845] if the build fails to download JARs for contrib/db, just skip its tests</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1845</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Every so often our nightly build fails because contrib/db is unable to download the necessary BDB JARs from &lt;a href=&quot;http://downloads.osafoundation.org&quot; class=&quot;external-link&quot;&gt;http://downloads.osafoundation.org&lt;/a&gt;.  I think in such cases we should simply skip contrib/db&apos;s tests, if it&apos;s the nightly build that&apos;s running, since it&apos;s a false positive failure.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12433795">LUCENE-1845</key>
            <summary>if the build fails to download JARs for contrib/db, just skip its tests</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Sun, 23 Aug 2009 10:40:56 +0100</created>
                <updated>Fri, 10 May 2013 11:43:56 +0100</updated>
                    <resolved>Sun, 17 Jan 2010 14:52:23 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12746590" author="simonw" created="Sun, 23 Aug 2009 12:34:23 +0100"  >&lt;p&gt;I set the property &quot;ignoreerrors&quot; to true on the get task. This should print out if there is a problem with the download and continue. The sanity check will fail if the jar is not present and unit-test will be skipped.&lt;br/&gt;
i guess that should do the job though.&lt;/p&gt;</comment>
                    <comment id="12746618" author="mikemccand" created="Sun, 23 Aug 2009 16:29:34 +0100"  >&lt;p&gt;Hmm &amp;#8211; I tried applying the patch, then changing the download URL to something bogus that fails, and then &quot;ant test&quot; hits errors during the &quot;compile-core&quot; target.  It seems like we have to somehow skip compile-core if the sanity check fails?&lt;/p&gt;</comment>
                    <comment id="12746640" author="simonw" created="Sun, 23 Aug 2009 18:23:40 +0100"  >&lt;p&gt;Weird! - I changed the URL to &lt;a href=&quot;http://foo.bar&quot; class=&quot;external-link&quot;&gt;http://foo.bar&lt;/a&gt; and ant.test succeeds with the expected message. I guess you changed the get url in bdb-je/build.xml but this file (the je.jar) is not the cause of this issue unless I got something wrong. I thought this issues is caused by the fact that &lt;a href=&quot;http://downloads.osafoundation.org/db/db-$&quot; class=&quot;external-link&quot;&gt;http://downloads.osafoundation.org/db/db-$&lt;/a&gt;&lt;/p&gt;
{db.version}
&lt;p&gt;.jar is not available on a regular basis. Thats why I did not patch this sub-module.&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12746642" author="mikemccand" created="Sun, 23 Aug 2009 18:33:16 +0100"  >&lt;p&gt;Aha, you&apos;re right!  Sorry about the confusion.&lt;/p&gt;

&lt;p&gt;OK so this is good to go.  Can you commit?&lt;/p&gt;</comment>
                    <comment id="12746646" author="simonw" created="Sun, 23 Aug 2009 18:50:49 +0100"  >&lt;blockquote&gt;&lt;p&gt;OK so this is good to go. Can you commit?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;will do!&lt;/p&gt;</comment>
                    <comment id="12746664" author="simonw" created="Sun, 23 Aug 2009 20:35:13 +0100"  >&lt;p&gt;Mike, I attached a new patch. The old one had some problems with the sanity check as the check needs the jar though. &lt;br/&gt;
This one will work for unit-tests but it will fail if ant tries to run compile-core during a build,jar, release etc. &lt;/p&gt;

&lt;p&gt;how should we handle if the jar can not be obtained? I would rather say the build must fail asif we du a release build the jar will not be included. &lt;br/&gt;
Would it be an option to put the jar to some other location maybe on a commiter page on people.apache.org?! &lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12746665" author="simonw" created="Sun, 23 Aug 2009 20:36:13 +0100"  >&lt;p&gt;this time with ASF licence grant&lt;/p&gt;</comment>
                    <comment id="12746793" author="mikemccand" created="Mon, 24 Aug 2009 10:49:06 +0100"  >&lt;blockquote&gt;&lt;p&gt;The old one had some problems with the sanity check as the check needs the jar though. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ahh OK.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;how should we handle if the jar can not be obtained? I would rather say the build must fail asif we du a release build the jar will not be included. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think, ideally, If it&apos;s the nightly build that&apos;s running, the disposition should be robust (ignored), else it should be brittle (like it is today).&lt;/p&gt;

&lt;p&gt;I&apos;m not sure about hosting the JARs.  The license for bdb-je is at &lt;a href=&quot;http://www.oracle.com/technology/software/products/berkeley-db/htdocs/jeoslicense.html&quot; class=&quot;external-link&quot;&gt;http://www.oracle.com/technology/software/products/berkeley-db/htdocs/jeoslicense.html&lt;/a&gt; and for bdb &lt;a href=&quot;http://www.oracle.com/technology/software/products/berkeley-db/htdocs/oslicense.html&quot; class=&quot;external-link&quot;&gt;http://www.oracle.com/technology/software/products/berkeley-db/htdocs/oslicense.html&lt;/a&gt;.  I think these libs were LGPL&apos;d before Oracle acquired Sleepycat, which was why we could not host them, but I have no idea if Oracle&apos;s licensing would permit us to host/redistribute them.  Maybe an inquiry on legal@ is the next step?  If the licensing allows it, I think the simplest solution would be to check them in to our svn repository....&lt;/p&gt;</comment>
                    <comment id="12746851" author="simonw" created="Mon, 24 Aug 2009 13:54:50 +0100"  >&lt;p&gt;Checking it into svn would be an option as far as I know just having something in SVN would not violate licenses as we do not distribute it but I will check with legal.&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12747328" author="mikemccand" created="Tue, 25 Aug 2009 10:36:23 +0100"  >&lt;p&gt;Last 3 builds were broken because of this... can we &quot;improve&quot; the sanity checking to check for lack of existence of the JAR, and then skip everything?&lt;/p&gt;</comment>
                    <comment id="12747515" author="simonw" created="Tue, 25 Aug 2009 18:47:10 +0100"  >&lt;p&gt;The current patch disables every build (jar, compile-core, compile-test) if the jar can not be downloaded. It will print a message in the following cases:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if the file can not be downloaded&lt;/li&gt;
	&lt;li&gt;if the sanity check does not succeed&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@mike could you have a look at it and try to run it with the &amp;lt;get&amp;gt; commented out as the jar is now available again :/&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12747523" author="mikemccand" created="Tue, 25 Aug 2009 18:59:02 +0100"  >&lt;p&gt;Looks great Simon!  I removed the JAR, changed the &amp;lt;get&amp;gt; to a bogus host, and confirmed that it did not fail.&lt;/p&gt;

&lt;p&gt;Now the only question is how to not fail only if it&apos;s the nightly build.  Note that the nightly build runs &quot;ant nightly&quot;, so can we somehow set something under the &quot;nightly&quot; target, that contrib/db/bdb&apos;s build.xml could access, to know it&apos;s the nightly build?&lt;/p&gt;</comment>
                    <comment id="12747537" author="simonw" created="Tue, 25 Aug 2009 19:23:54 +0100"  >&lt;p&gt;I was not aware of the &quot;nightly&quot; target. Thanks for pointing it out.&lt;/p&gt;

&lt;p&gt;I added a &quot;nightly&quot; property to trunk/build.xml and let the jar-check always succeed if the nightly property is NOT set. I also changed the name of the property from &quot;db-jar-check-success&quot; to &quot;execute-build&quot;.&lt;/p&gt;

&lt;p&gt;I can not commit /trunk/build.xml can you do once I have the bdb/build.xml in?&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12747578" author="mikemccand" created="Tue, 25 Aug 2009 20:05:06 +0100"  >&lt;p&gt;For some reason I get hunk #3 failing when I try to apply the patch:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Hunk #3 FAILED at 66.
1 out of 3 hunks FAILED -- saving rejects to file contrib/db/bdb/build.xml.rej
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But the approach sounds good.  So if &quot;ant nightly&quot; is the target, and it fails to download the JAR, it&apos;ll just warn and continue.  But if it&apos;s any other target, it&apos;ll fail.&lt;/p&gt;

&lt;p&gt;OK, I&apos;ll commit the toplevel build.xml changes shortly.  They are fully independent (just sets the &quot;nightly&quot; property).&lt;/p&gt;</comment>
                    <comment id="12747582" author="mikemccand" created="Tue, 25 Aug 2009 20:07:34 +0100"  >&lt;p&gt;OK I committed the top-level build.xml.  Thanks Simon!&lt;/p&gt;</comment>
                    <comment id="12747585" author="simonw" created="Tue, 25 Aug 2009 20:14:02 +0100"  >&lt;blockquote&gt;&lt;p&gt;For some reason I get hunk #3 failing when I try to apply the patch:&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Hmm... works for me on a clean checkout. did you revert the last changes?! &lt;/p&gt;

&lt;p&gt;I plan to commit shortly - if anybody does not feel comfortable with it speak up.&lt;/p&gt;
</comment>
                    <comment id="12747656" author="mikemccand" created="Tue, 25 Aug 2009 22:23:41 +0100"  >&lt;p&gt;Reopening based on java-dev discussion...&lt;/p&gt;</comment>
                    <comment id="12747836" author="simonw" created="Wed, 26 Aug 2009 09:38:58 +0100"  >&lt;p&gt;I added the short discussion I had on legal-discuss for the record.&lt;br/&gt;
One person confirmed that we could add the jar to SVN if we do not redistribute them. I&apos;m not a license guy but I guess we should first figure out what license this particular jar has. It is not a download from the oracle page (you can only get the sources for this particular jar not the binary as a download) but something from  &lt;a href=&quot;http://downloads.osafoundation.org/db/&quot; class=&quot;external-link&quot;&gt;http://downloads.osafoundation.org/db/&lt;/a&gt; without any license notice.&lt;/p&gt;

&lt;p&gt;I would suggest to try to build the jar from source with the latest release on the oracle page so we can be sure about the license. Once I have done this I will send another request to legal to confirm tha we are not violating anything.&lt;/p&gt;

&lt;p&gt;The discussion from legal-discuss&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;gt; Hey there,
&amp;gt; We (lucene) have a contrib project that provides a Index-Directory
&amp;gt; implementation based on BerkleyDB. This code downloads a jar file from
&amp;gt; http://downloads.osafoundation.org/... to build and test the code.
&amp;gt; This jar-file is not included in any distribution and we do not plan
&amp;gt; to do so. The problem is that the download site is down very
&amp;gt; frequently so we are looking for another way to obtain the jar. Here
&amp;gt; is the question do we violate the license if we add the jar-file to
&amp;gt; the svn repository but not distributing it at all? Another way would
&amp;gt; be to add the jar to a commiter page on people.apache.org and download
&amp;gt; it from there.
&amp;gt; The license is here:
&amp;gt; http://www.oracle.com/technology/software/products/berkeley-db/htdocs/oslicense.html

Complicated matter.
BDB seems viral in that anything that uses must be made available in
source form. So, ASF has no problem fulfilling that requirement, but
downstream users may. OTOH, you say that the BDB is only used to build
(do you really need it to build?) and test your implementation, BUT
you say that you have an implementation based on BDB, so I presume
that it requires it to run.

My interpretation is;
 * IFF your component is purely optional, having a dependency on BDB
is Ok, provided it is not shipped with the release and that the user
is provided with the information that the BDB needs to be downloaded
separately and advised to review their license.

For your second part; Can you stick the BDB jar(s) somewhere more
reliably available?
 * Yes, I think so. The license allows distribution in any form,
source or binary... So, I suggest that you upload it to a dependable
host, such as SF, ibiblio.org or similar. people.apache.org --&amp;gt; I
wouldn&apos;t recommend it. ASF SVN --&amp;gt; yes, that should be Ok, but there
is a strong recommendation of not putting JARs in there... Also there
is a risk that the encumbrance around BDB is forgotten and used beyond
what is acceptable if it is &apos;laying around&apos;.


Cheer
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    <comment id="12747913" author="mikemccand" created="Wed, 26 Aug 2009 13:26:30 +0100"  >&lt;p&gt;OK I think we should simply revert our changes to the build.xml&apos;s, now, and then sort out how to host the JAR more reliably...&lt;/p&gt;

&lt;p&gt;I&apos;ll go revert the changes.&lt;/p&gt;</comment>
                    <comment id="12747919" author="mikemccand" created="Wed, 26 Aug 2009 13:40:52 +0100"  >&lt;p&gt;Moving to 3.0... this need not block 2.9.&lt;/p&gt;</comment>
                    <comment id="12776336" author="simonw" created="Wed, 11 Nov 2009 07:19:45 +0000"  >&lt;p&gt;Moving out for 3.1&lt;/p&gt;</comment>
                    <comment id="12801395" author="simonw" created="Sun, 17 Jan 2010 13:27:32 +0000"  >&lt;p&gt;I haven&apos;t looked at this issue for a while now but I figured today that the version we are using is &quot;not available for download&quot; anymore on the oracle pages. If you follow the link in the build file you will be able to download the zip file but I guess we should upgrade to the latest 3.3 version of BDB-JE.&lt;br/&gt;
(see &lt;a href=&quot;http://www.oracle.com/technology/software/products/berkeley-db/je/index.html&quot; class=&quot;external-link&quot;&gt;http://www.oracle.com/technology/software/products/berkeley-db/je/index.html&lt;/a&gt; - version 3.3.69)&lt;br/&gt;
There is also another mirror that serves the jar directly (a maven repository) that might be more reliable.&lt;br/&gt;
I updated the patch to load the 3.3.93 version of the jar directly and skip the unzip step as we now download only the jar file. I also updated the maven pom template files to reference the right version of BDB-JE which wasn&apos;t the case though.&lt;/p&gt;

&lt;p&gt;I think we should give the maven-repo mirror a chance though.&lt;/p&gt;
</comment>
                    <comment id="12801402" author="mikemccand" created="Sun, 17 Jan 2010 13:50:24 +0000"  >&lt;p&gt;Looks good Simon!  Getting the JAR directly is a good savings (it&apos;s roughly 1 MB, but the full .zip distribution is roughly 6 MB.  I agree we should give maven a shot... hopefully it&apos;s more reliable than the direct download we do now.&lt;/p&gt;</comment>
                    <comment id="12801404" author="simonw" created="Sun, 17 Jan 2010 14:10:28 +0000"  >&lt;p&gt;mike, can you take this issue it unfortunately touches core stuff :/&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12801409" author="mikemccand" created="Sun, 17 Jan 2010 14:32:03 +0000"  >&lt;p&gt;OK...&lt;/p&gt;</comment>
                    <comment id="12801411" author="mikemccand" created="Sun, 17 Jan 2010 14:52:23 +0000"  >&lt;p&gt;Resolving this... if we still have reliability problems download the JAR from Oracle, let&apos;s open a new issue to find a better way to host the jar.&lt;/p&gt;</comment>
                    <comment id="12801416" author="simonw" created="Sun, 17 Jan 2010 15:08:17 +0000"  >&lt;p&gt;mike, thanks for resolving this. I already replied to the commit mail but mention it here again for completeness....&lt;br/&gt;
We should add a changes.txt entry to notify users that we upgraded the version.&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12801417" author="mikemccand" created="Sun, 17 Jan 2010 15:11:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;We should add a changes.txt entry to notify users that we upgraded the version.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ahh right &amp;#8211; will do.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12430550" name="LUCENE-1845.patch" size="2265" author="simonw" created="Sun, 17 Jan 2010 13:27:32 +0000" />
                    <attachment id="12417640" name="LUCENE-1845.patch" size="3951" author="simonw" created="Tue, 25 Aug 2009 19:23:54 +0100" />
                    <attachment id="12417637" name="LUCENE-1845.txt" size="3189" author="simonw" created="Tue, 25 Aug 2009 18:47:10 +0100" />
                    <attachment id="12417413" name="LUCENE-1845.txt" size="1699" author="simonw" created="Sun, 23 Aug 2009 20:36:13 +0100" />
                    <attachment id="12417412" name="LUCENE-1845.txt" size="1699" author="simonw" created="Sun, 23 Aug 2009 20:35:13 +0100" />
                    <attachment id="12417396" name="LUCENE-1845.txt" size="602" author="simonw" created="Sun, 23 Aug 2009 12:34:23 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>6.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sun, 23 Aug 2009 11:34:23 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11918</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25882</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:34:23 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-977/LUCENE-977.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-977] internal hashing improvements</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-977</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Internal power-of-two closed hashtable traversal in DocumentsWriter and CharArraySet could be better.&lt;/p&gt;

&lt;p&gt;Here is the current method of resolving collisions:&lt;br/&gt;
    if (text2 != null &amp;amp;&amp;amp; !equals(text, len, text2)) {&lt;br/&gt;
      final int inc = code*1347|1;&lt;br/&gt;
      do &lt;/p&gt;
{
        code += inc;
        pos = code &amp;amp; mask;
        text2 = entries[pos];
      }
&lt;p&gt; while (text2 != null &amp;amp;&amp;amp; !equals(text, len, text2));&lt;/p&gt;

&lt;p&gt;The problem is that two different hashCodes with the same lower bits will keep picking the same slots (the upper bits will be ignored).&lt;br/&gt;
This is because multiplication (*1347) only really shifts bits to the left... so given that the two codes already matched on the right, they will both pick the same increment, and this will keep them on the same path through the table (even though it&apos;s being added to numbers that differ on the left).  To resolve this, some bits need to be moved to the right when calculating the increment.&lt;/p&gt;
</description>
                <environment></environment>
            <key id="12375823">LUCENE-977</key>
            <summary>internal hashing improvements</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="yseeley@gmail.com">Yonik Seeley</reporter>
                        <labels>
                    </labels>
                <created>Sat, 11 Aug 2007 14:48:02 +0100</created>
                <updated>Mon, 13 Aug 2007 15:59:20 +0100</updated>
                    <resolved>Mon, 13 Aug 2007 15:59:20 +0100</resolved>
                                                                    <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12519230" author="yseeley@gmail.com" created="Sat, 11 Aug 2007 14:56:52 +0100"  >&lt;p&gt;Here is a patch that adds in 7 new bits (the rightmost bit is destroyed to make the number odd) when calculating the incrementor via&lt;br/&gt;
              final int inc = ((code&amp;gt;&amp;gt;8)+code)|1;&lt;br/&gt;
And thus gives 128 different possible paths to follow &lt;b&gt;per slot&lt;/b&gt; on the first collision on that slot.&lt;br/&gt;
Ideally we would shift log2(size_of_hashtable), but it&apos;s probably not worth calculating that and I chose a small shift so it would work well for small hashCodes (say from a very short string).&lt;/p&gt;

&lt;p&gt;Given that equals() in these cases is probably pretty fast, the average speedup is probably relatively minimal.&lt;/p&gt;

&lt;p&gt;Comments?&lt;/p&gt;</comment>
                    <comment id="12519233" author="mikemccand" created="Sat, 11 Aug 2007 15:47:36 +0100"  >&lt;p&gt;This is an excellent change and makes complete sense that it will resolve conflicts faster than the first way.  I say commit it!&lt;/p&gt;</comment>
                    <comment id="12519437" author="yseeley@gmail.com" created="Mon, 13 Aug 2007 15:59:20 +0100"  >&lt;p&gt;committed.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12363654" name="hash.patch" size="2094" author="yseeley@gmail.com" created="Sat, 11 Aug 2007 14:56:52 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 11 Aug 2007 14:47:36 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12766</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26752</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
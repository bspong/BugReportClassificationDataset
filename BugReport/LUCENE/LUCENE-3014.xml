<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:18:59 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3014/LUCENE-3014.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3014] comparator API for segment versions</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3014</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3012&quot; title=&quot;if you use setNorm, lucene writes a headerless separate norms file&quot;&gt;&lt;del&gt;LUCENE-3012&lt;/del&gt;&lt;/a&gt; for an example.&lt;/p&gt;

&lt;p&gt;Things get ugly if you want to use SegmentInfo.getVersion()&lt;/p&gt;

&lt;p&gt;For example, what if we committed my patch, release 3.2, but later released 3.1.1 (will &quot;3.1.1&quot; this be whats written and returned by this function?)&lt;br/&gt;
Then suddenly we broke the index format because we are using Strings here without a reasonable comparator API.&lt;/p&gt;

&lt;p&gt;In this case one should be able to compute if the version is &amp;lt; 3.2 safely.&lt;/p&gt;

&lt;p&gt;If we don&apos;t do this, and we rely upon this version information internally in lucene, I think we are going to break something.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12503356">LUCENE-3014</key>
            <summary>comparator API for segment versions</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="rcmuir">Robert Muir</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Apr 2011 00:28:38 +0100</created>
                <updated>Fri, 3 Jun 2011 17:37:17 +0100</updated>
                    <resolved>Wed, 18 May 2011 14:53:30 +0100</resolved>
                                            <fixVersion>3.2</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13015678" author="thetaphi" created="Tue, 5 Apr 2011 00:33:44 +0100"  >&lt;p&gt;We should use the same code like Harmony has for its java.lang.Package#isCompatibleWith method. I will prepare a patch that exposes this as a Comparator&amp;lt;String&amp;gt; for those version strings (singleton).&lt;/p&gt;</comment>
                    <comment id="13033968" author="rcmuir" created="Mon, 16 May 2011 12:01:33 +0100"  >&lt;p&gt;initial patch&lt;/p&gt;</comment>
                    <comment id="13035359" author="rcmuir" created="Wed, 18 May 2011 14:13:49 +0100"  >&lt;p&gt;any Objections? Uwe you still want to take this or should I?&lt;/p&gt;

&lt;p&gt;I want to get &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3012&quot; title=&quot;if you use setNorm, lucene writes a headerless separate norms file&quot;&gt;&lt;del&gt;LUCENE-3012&lt;/del&gt;&lt;/a&gt; wrapped up.&lt;/p&gt;</comment>
                    <comment id="13035361" author="thetaphi" created="Wed, 18 May 2011 14:18:22 +0100"  >&lt;p&gt;It&apos;s fine, commit it!&lt;/p&gt;

&lt;p&gt;We may look for usage of the version field in SegmentInfos, and use this comparator there (especially e.g. my new one for upgrades or the standard IndexTooOldException stuff).&lt;/p&gt;

&lt;p&gt;But I think that should be a new issue.&lt;/p&gt;</comment>
                    <comment id="13035370" author="shaie" created="Wed, 18 May 2011 14:27:25 +0100"  >&lt;p&gt;Hey guys, does this affect &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2921&quot; title=&quot;Now that we track the code version at the segment level, we can stop tracking it also in each file level&quot;&gt;LUCENE-2921&lt;/a&gt; (or vice versa)?&lt;/p&gt;

&lt;p&gt;Basically, I thought that we should stop writing version header in files and just use the release version as a header.&lt;/p&gt;

&lt;p&gt;Robert, I don&apos;t think we are allowed to change index format versions on bug-fix releases and even if we do, that same bug fix would go into the 3.x release so it would still know how to read 3.1.1? Perhaps that was your point and I missed it ...&lt;/p&gt;</comment>
                    <comment id="13035376" author="thetaphi" created="Wed, 18 May 2011 14:30:37 +0100"  >&lt;p&gt;Shai: we should not change index format, but it still feels bad not to have a correct version comparison API. With this patch you can even compare 3.0 against only 3 or 3.0.0.0.0 and they will be equal. And once we are at version 10, a simple string compare is a bad idea &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thats why Robert and me are against pure string comparisons.&lt;/p&gt;</comment>
                    <comment id="13035378" author="rcmuir" created="Wed, 18 May 2011 14:35:07 +0100"  >&lt;blockquote&gt;
&lt;p&gt;Hey guys, does this affect &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2921&quot; title=&quot;Now that we track the code version at the segment level, we can stop tracking it also in each file level&quot;&gt;LUCENE-2921&lt;/a&gt; (or vice versa)?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hi Shai, I think this helps &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2921&quot; title=&quot;Now that we track the code version at the segment level, we can stop tracking it also in each file level&quot;&gt;LUCENE-2921&lt;/a&gt;. This is a comparator to use, when you want to examine the release version that created the segment (the one you added in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2720&quot; title=&quot;IndexWriter should throw IndexFormatTooOldExc on open, not later during optimize/getReader/close&quot;&gt;&lt;del&gt;LUCENE-2720&lt;/del&gt;&lt;/a&gt;). Its guaranteed to compare correctly if say, we we released 3.10, and also if the number of trailing zeros etc are different.&lt;/p&gt;

&lt;p&gt;In other words, if you implement &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2921&quot; title=&quot;Now that we track the code version at the segment level, we can stop tracking it also in each file level&quot;&gt;LUCENE-2921&lt;/a&gt; I think the idea is typically you will want to use this comparator when examining the version string.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Robert, I don&apos;t think we are allowed to change index format versions on bug-fix releases and even if we do, that same bug fix would go into the 3.x release so it would still know how to read 3.1.1? Perhaps that was your point and I missed it ...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;On &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3012&quot; title=&quot;if you use setNorm, lucene writes a headerless separate norms file&quot;&gt;&lt;del&gt;LUCENE-3012&lt;/del&gt;&lt;/a&gt;, I&apos;ve proposed a fix-for version for Lucene 3.2. But we can discuss on that issue.&lt;/p&gt;</comment>
                    <comment id="13035379" author="shaie" created="Wed, 18 May 2011 14:36:15 +0100"  >&lt;p&gt;Yes, that makes sense. I can use that API in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2921&quot; title=&quot;Now that we track the code version at the segment level, we can stop tracking it also in each file level&quot;&gt;LUCENE-2921&lt;/a&gt;. Thanks a lot for saving me some effort &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                    <comment id="13035385" author="rcmuir" created="Wed, 18 May 2011 14:53:30 +0100"  >&lt;p&gt;Committed revision 1124266, 1124269 (branch3x)&lt;/p&gt;</comment>
                    <comment id="13043505" author="rcmuir" created="Fri, 3 Jun 2011 17:37:17 +0100"  >&lt;p&gt;Bulk closing for 3.2&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10032">
                <name>Blocker</name>
                                <outwardlinks description="blocks">
                            <issuelink>
            <issuekey id="12503327">LUCENE-3012</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12479309" name="LUCENE-3014.patch" size="4163" author="rcmuir" created="Mon, 16 May 2011 12:01:33 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 4 Apr 2011 23:33:44 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2168</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24678</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
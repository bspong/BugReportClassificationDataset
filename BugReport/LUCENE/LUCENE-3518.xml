<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:25:56 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3518/LUCENE-3518.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3518] Add sort-by-term with DocValues</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3518</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;There are two sorted byte[] types with DocValues (BYTES_VAR_SORTED,&lt;br/&gt;
BYTES_FIXED_SORTED), so you can index this type, but you can&apos;t yet&lt;br/&gt;
sort by it.&lt;/p&gt;

&lt;p&gt;So I added a FieldComparator just like TermOrdValComparator, except it&lt;br/&gt;
pulls from the doc values instead.&lt;/p&gt;

&lt;p&gt;There are some small diffs, eg with doc values there are never null&lt;br/&gt;
values (see &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3504&quot; title=&quot;DocValues: deref/sorted bytes types shouldn&amp;#39;t return empty byte[] when doc didn&amp;#39;t have a value&quot;&gt;&lt;del&gt;LUCENE-3504&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</description>
                <environment></environment>
            <key id="12527172">LUCENE-3518</key>
            <summary>Add sort-by-term with DocValues</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Oct 2011 11:31:58 +0100</created>
                <updated>Fri, 10 May 2013 11:44:18 +0100</updated>
                    <resolved>Sun, 13 Nov 2011 15:26:53 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                <component>core/search</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13127420" author="mikemccand" created="Fri, 14 Oct 2011 11:33:06 +0100"  >&lt;p&gt;Patch.&lt;/p&gt;</comment>
                    <comment id="13131559" author="mikemccand" created="Thu, 20 Oct 2011 13:32:27 +0100"  >
&lt;p&gt;New patch: I also added TermValDocValuesComparator, so you can&lt;br/&gt;
sort-by-string when you indexed the non-sorted byte[] doc values types&lt;br/&gt;
(var/fixed X straight/deref).  This is slower since it aways does a&lt;br/&gt;
.compareTo on each ByteRef instead of using pre-sorted ords... but for&lt;br/&gt;
some apps this is a good tradeoff.  (This mirrors the two sort-by-Term&lt;br/&gt;
field comparators we have for field cache).&lt;/p&gt;

&lt;p&gt;I also cleaned up how we handle segments that had no doc values; this&lt;br/&gt;
isn&apos;t necessarily an error condition because it could be the current&lt;br/&gt;
search doesn&apos;t hit any docs in this segment.  I added methods in&lt;br/&gt;
IndexDocValues to get a Source or SortedSource that always returns the&lt;br/&gt;
&quot;default&quot; value for the type.&lt;/p&gt;

&lt;p&gt;I think this is ready!&lt;/p&gt;</comment>
                    <comment id="13131565" author="simonw" created="Thu, 20 Oct 2011 13:42:15 +0100"  >&lt;p&gt;mike, this looks good while I am not sure I understand all the comparators. I didn&apos;t look at it for too long but maybe you can add some comments how those readerGen arrays work?&lt;/p&gt;

&lt;p&gt;there is one nocommit left in the patch though. I think you should go ahead though!&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="13131586" author="simonw" created="Thu, 20 Oct 2011 13:51:50 +0100"  >&lt;p&gt;mike, I looked at it again and found this api addition. You return a PackedInts.Reader from getDocToOrd() on SortedSource&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/**
 * Returns the PackedInts.Reader impl that maps document to ord.
 */
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; PackedInts.Reader getDocToOrd() {
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;this seems to be very specific to in-memory docvalues while we don&apos;t support direct source here. Can we maybe extract an interface from PackedInts.Reader &amp;amp; RandomAccessReaderIterator (those are already very similar) so we can simply use the reader interface for both on-disk and in-memory variants. then I think this API addition is fine. I don&apos;t like apis which are in-mem / on-disk only. &lt;/p&gt;</comment>
                    <comment id="13131837" author="mikemccand" created="Thu, 20 Oct 2011 18:56:32 +0100"  >&lt;p&gt;Thanks Simon, I&apos;ll fix the nocommit and add some comments.. the&lt;br/&gt;
ord/BytesRef comparators are tricky...&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;this seems to be very specific to in-memory docvalues while we don&apos;t support direct source here. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hmm, true; though I suspect sorting by a direct source will be rather&lt;br/&gt;
slow.  Still I agree we should support it for completeness.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can we maybe extract an interface from PackedInts.Reader &amp;amp; RandomAccessReaderIterator (those are already very similar) so we can simply use the reader interface for both on-disk and in-memory variants.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;OK I like your idea of using PackedInts.Reader for on-disk and&lt;br/&gt;
in-memory variants; you shouldn&apos;t have to pull an enum from PackedInts&lt;br/&gt;
if you just need the disk-based get.&lt;/p&gt;

&lt;p&gt;I&apos;ll open a new issue to do that refactoring first; I think we can&lt;br/&gt;
remove the PackedInts.RandomAccessReaderIterator if we just let the&lt;br/&gt;
Reader.get throw IOE?  Lemme try to work up a patch.&lt;/p&gt;</comment>
                    <comment id="13145720" author="mikemccand" created="Mon, 7 Nov 2011 19:19:23 +0000"  >&lt;p&gt;Patch, syncing to trunk, and making it possible to sort off a direct source (though I don&apos;t think this is that useful in practice!).&lt;/p&gt;

&lt;p&gt;I think it&apos;s ready.&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10032">
                <name>Blocker</name>
                                                <inwardlinks description="is blocked by">
                            <issuelink>
            <issuekey id="12527992">LUCENE-3524</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12502784" name="LUCENE-3518.patch" size="47450" author="mikemccand" created="Mon, 7 Nov 2011 19:19:23 +0000" />
                    <attachment id="12499853" name="LUCENE-3518.patch" size="43277" author="mikemccand" created="Thu, 20 Oct 2011 13:32:26 +0100" />
                    <attachment id="12499013" name="LUCENE-3518.patch" size="37172" author="mikemccand" created="Fri, 14 Oct 2011 11:33:06 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 20 Oct 2011 12:42:15 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>85556</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24179</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:05:05 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2768/LUCENE-2768.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2768] add infrastructure for longer running nightly test cases</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2768</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;I&apos;m spinning this out of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2762&quot; title=&quot;Don&amp;#39;t leak deleted open file handles with pooled readers&quot;&gt;&lt;del&gt;LUCENE-2762&lt;/del&gt;&lt;/a&gt;...&lt;/p&gt;

&lt;p&gt;The patch there adds initial infrastructure for tests to pull documents from a line file, and adds a longish running test case using that line file to test NRT.&lt;/p&gt;

&lt;p&gt;I&apos;d like to see some tests run on more substantial indices based on real data... so this is just a start.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12480217">LUCENE-2768</key>
            <summary>add infrastructure for longer running nightly test cases</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Nov 2010 13:43:25 +0000</created>
                <updated>Wed, 30 Mar 2011 16:49:52 +0100</updated>
                    <resolved>Mon, 17 Jan 2011 11:32:27 +0000</resolved>
                                            <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12932952" author="mikemccand" created="Wed, 17 Nov 2010 13:47:45 +0000"  >&lt;p&gt;Patch.&lt;/p&gt;</comment>
                    <comment id="12932956" author="rcmuir" created="Wed, 17 Nov 2010 13:56:27 +0000"  >&lt;p&gt;in revision 1036038 i set -Dtests.nightly=1 for running tests during hudson nightly,&lt;br/&gt;
but i didnt set it for the clover portion... i think it would only cause the nightly job to take an eternity&lt;/p&gt;</comment>
                    <comment id="12932957" author="rcmuir" created="Wed, 17 Nov 2010 14:09:43 +0000"  >&lt;p&gt;ok, i have two potential solutions, and no particular preference as to which we do:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;we upgrade our Junit from 4.7 to 4.8 and use the Category support.&lt;br/&gt;
in this case you would use @IncludeCategory(Nightly.class) to annotate your test.&lt;br/&gt;
&lt;a href=&quot;http://kentbeck.github.com/junit/doc/ReleaseNotes4.8.html&quot; class=&quot;external-link&quot;&gt;http://kentbeck.github.com/junit/doc/ReleaseNotes4.8.html&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;we add our own annotation (e.g. @Nightly) and use that.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;in either case we hack our runner to respect it, so its the same amount of work&lt;br/&gt;
(junit 4.8 won&apos;t actually save us anything since we won&apos;t use its &lt;br/&gt;
@RunWith(Categories.class), but our own runner), its just about syntax and&lt;br/&gt;
possibly if we care about consistency with junit or envision other optional &lt;br/&gt;
categories beyond &quot;nightly&quot;.&lt;/p&gt;</comment>
                    <comment id="12932972" author="thetaphi" created="Wed, 17 Nov 2010 14:55:52 +0000"  >&lt;blockquote&gt;&lt;p&gt;in revision 1036038 i set -Dtests.nightly=1 for running tests during hudson nightly, but i didnt set it for the clover portion... i think it would only cause the nightly job to take an eternity &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1, we also have no tests.multiplier for clover!&lt;/p&gt;</comment>
                    <comment id="12932984" author="rcmuir" created="Wed, 17 Nov 2010 15:22:34 +0000"  >&lt;p&gt;patch that adds support for annotating tests with @Nightly.&lt;/p&gt;

&lt;p&gt;you can also annotate a whole class with this (in that case, import it from LuceneTestCase).&lt;/p&gt;

&lt;p&gt;the only trick is that junit always requires a class to have at least one runnable method, or it throws an exception.&lt;/p&gt;

&lt;p&gt;in this special case that all methods or the whole class are somehow @Nightly, we add a fake @Ignored method so we get &quot;tests run: 0&quot; and the NOTE instead of this exception.&lt;/p&gt;</comment>
                    <comment id="12932990" author="rcmuir" created="Wed, 17 Nov 2010 15:41:44 +0000"  >&lt;p&gt;Here is the output when tests.nightly is disabled (default) and a method or class is @Nightly, respectively:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[junit] Testsuite: org.apache.lucene.TestDemo
[junit] Tests run: 0, Failures: 0, Errors: 0, Time elapsed: 0.17 sec
[junit]
[junit] ------------- Standard Error -----------------
[junit] NOTE: Ignoring nightly-only test method &apos;testDemo&apos;
[junit] ------------- ---------------- ---------------
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[junit] Testsuite: org.apache.lucene.TestDemo
[junit] Tests run: 0, Failures: 0, Errors: 0, Time elapsed: 0.171 sec
[junit]
[junit] ------------- Standard Error -----------------
[junit] NOTE: Ignoring nightly-only test class &apos;TestDemo&apos;
[junit] ------------- ---------------- ---------------
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    <comment id="12932997" author="thetaphi" created="Wed, 17 Nov 2010 15:52:21 +0000"  >&lt;p&gt;Looks good, the hack is a hack &lt;b&gt;lol&lt;/b&gt; but should work and lead to no problems.&lt;/p&gt;

&lt;p&gt;I would only change the sysprop and static var to a Boolean and add a RuntimeException to the empty catch block in the reflection part.&lt;/p&gt;</comment>
                    <comment id="12932998" author="rcmuir" created="Wed, 17 Nov 2010 15:54:41 +0000"  >&lt;p&gt;here is an updated patch with Uwe&apos;s suggestions,&lt;br/&gt;
additionally i made the fake method final.&lt;/p&gt;

&lt;p&gt;I&apos;ll commit this soon, then Mike can setup his test to use it.&lt;/p&gt;</comment>
                    <comment id="12933007" author="rcmuir" created="Wed, 17 Nov 2010 16:14:10 +0000"  >&lt;p&gt;ok I committed the lucenetestcase/ant support in revision 1036088, 1036094 (3x)&lt;/p&gt;

&lt;p&gt;To make nightly-only tests, annotate the methods with @Nightly.&lt;br/&gt;
to run tests including nightly-only tests, use -Dtests.nightly=true&lt;/p&gt;</comment>
                    <comment id="12969779" author="mikemccand" created="Thu, 9 Dec 2010 15:53:00 +0000"  >&lt;p&gt;Another iteration... made the test somewhat more evil (but it didn&apos;t find any bugs... yet!).&lt;/p&gt;

&lt;p&gt;I also made a quick Python script to munge the nice Europarl (&lt;a href=&quot;http://www.statmt.org/europarl/&quot; class=&quot;external-link&quot;&gt;http://www.statmt.org/europarl/&lt;/a&gt;) corpus into a line file.  The resulting line file is multi-lingual and has a nice mix of big and small docs.  I&apos;d like to check this in somewhere where src/test can use it &amp;#8211; any suggestions?  Probably I should check in the Python script in the same place...&lt;/p&gt;

&lt;p&gt;This test is time limited; when it runs under &quot;nightly&quot; it runs for 5 minutes, and under non-nightly for 5 seconds.&lt;/p&gt;</comment>
                    <comment id="12969781" author="mikemccand" created="Thu, 9 Dec 2010 16:00:27 +0000"  >&lt;p&gt;Attached Python script that parses Europarl into lines file, and the small subset (5.7 MB) to checkin for tests to use...&lt;/p&gt;</comment>
                    <comment id="12969839" author="mikemccand" created="Thu, 9 Dec 2010 18:17:38 +0000"  >&lt;p&gt;New patch.&lt;/p&gt;

&lt;p&gt;I put the test line file and the Python script to regenerate it in src/test under oal.util, and use getResourceAsStream to load it.  I also added a -Dtests.linedocsfile so we can override it.  Separately after I commit this I&apos;d like to fix nightly build to have the full line docs file, maybe randomly picking between the &quot;small docs&quot; vs &quot;medium docs&quot; files.&lt;/p&gt;</comment>
                    <comment id="12969889" author="mikemccand" created="Thu, 9 Dec 2010 19:35:38 +0000"  >&lt;p&gt;OK I committed the new test... I&apos;ll leave this open to get the nightly to use the larger test files...&lt;/p&gt;</comment>
                    <comment id="12982599" author="mikemccand" created="Mon, 17 Jan 2011 11:32:27 +0000"  >&lt;p&gt;I think this is fixed.&lt;/p&gt;</comment>
                    <comment id="13013287" author="gsingers" created="Wed, 30 Mar 2011 16:49:52 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12465915" name="europarl.lines.txt.gz" size="5730708" author="mikemccand" created="Thu, 9 Dec 2010 16:00:26 +0000" />
                    <attachment id="12465914" name="europarl.py" size="3333" author="mikemccand" created="Thu, 9 Dec 2010 16:00:26 +0000" />
                    <attachment id="12459800" name="LUCENE-2768_nightly.patch" size="9485" author="rcmuir" created="Wed, 17 Nov 2010 15:54:40 +0000" />
                    <attachment id="12459798" name="LUCENE-2768_nightly.patch" size="9423" author="rcmuir" created="Wed, 17 Nov 2010 15:22:34 +0000" />
                    <attachment id="12465927" name="LUCENE-2768.patch" size="27498" author="mikemccand" created="Thu, 9 Dec 2010 18:17:38 +0000" />
                    <attachment id="12465912" name="LUCENE-2768.patch" size="20347" author="mikemccand" created="Thu, 9 Dec 2010 15:52:59 +0000" />
                    <attachment id="12459795" name="LUCENE-2768.patch" size="11723" author="mikemccand" created="Wed, 17 Nov 2010 13:47:45 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>7.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 17 Nov 2010 13:56:27 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11085</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24924</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:24:24 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2887/LUCENE-2887.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2887] Remove/deprecate IndexReader.undeleteAll</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2887</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;This API is rather dangerous in that it&apos;s &quot;best effort&quot; since it can only un-delete docs that have not yet been merged away, or, dropped (as of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2010&quot; title=&quot;Remove segments with all documents deleted in commit/flush/close of IndexWriter instead of waiting until a merge occurs.&quot;&gt;&lt;del&gt;LUCENE-2010&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Given that it exposes impl details of how Lucene prunes deleted docs, I think we should remove this API.&lt;/p&gt;

&lt;p&gt;Are there legitimate use cases....?&lt;/p&gt;</description>
                <environment></environment>
            <key id="12496598">LUCENE-2887</key>
            <summary>Remove/deprecate IndexReader.undeleteAll</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Jan 2011 20:24:25 +0000</created>
                <updated>Wed, 30 Mar 2011 16:50:11 +0100</updated>
                    <resolved>Tue, 25 Jan 2011 23:16:14 +0000</resolved>
                                            <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12985967" author="ab" created="Mon, 24 Jan 2011 20:34:29 +0000"  >&lt;p&gt;The MultiPassIndexSplitter won&apos;t work without this API. It can be modified to use a subclass of IndexReader &amp;amp; term / postings enumerators to restore the current behavior, or it can be rewritten entirely as a (fabled) SinglePassIndexSplitter. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12986364" author="doronc" created="Tue, 25 Jan 2011 12:39:45 +0000"  >&lt;p&gt;I think it is correct to say that &quot;if the result of ir.numDeletedDocs() is &lt;b&gt;N&lt;/b&gt;, then calling ir.undeleteAll() will undelete exactly &lt;b&gt;N&lt;/b&gt; documents&quot;... or am I missing it? &lt;/p&gt;

&lt;p&gt;Because if a merge was invoked for the segments seen by this reader, I see two options:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;A merge is on going, or the merge is done but uncommitted yet.&lt;br/&gt;
   This means that an index writer has a lock on the index, hence ir.undeleteAll() will fail to get the lock.&lt;/li&gt;
	&lt;li&gt;The merge was already committed.&lt;br/&gt;
   This means that the index reader will fail to get write permission for being Stale.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;So I think this method behaves deterministically - perhaps its jdoc should say something like: &lt;br/&gt;
&lt;b&gt;Undeletes all #numDeletedDocs() documents currently marked as deleted in this index.&lt;/b&gt; ?&lt;/p&gt;</comment>
                    <comment id="12986752" author="mikemccand" created="Tue, 25 Jan 2011 23:07:06 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think it is correct to say that &quot;if the result of ir.numDeletedDocs() is N, then calling ir.undeleteAll() will undelete exactly N documents&quot;... or am I missing it?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s right... it&apos;s just that you can no longer &quot;rely&quot; on how IW reclaims del docs.&lt;/p&gt;

&lt;p&gt;But I&apos;ll just commit that &quot;clarification&quot; to the javadoc and leave the API for now...&lt;/p&gt;</comment>
                    <comment id="12986759" author="mikemccand" created="Tue, 25 Jan 2011 23:16:14 +0000"  >&lt;p&gt;I just sharpened the jdocs...&lt;/p&gt;</comment>
                    <comment id="13013393" author="gsingers" created="Wed, 30 Mar 2011 16:50:11 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 24 Jan 2011 20:34:29 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>10981</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24805</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
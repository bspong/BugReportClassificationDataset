<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:08:44 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2272/LUCENE-2272.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2272] PayloadNearQuery has hardwired explanation for &apos;AveragePayloadFunction&apos;</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2272</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;The &apos;explain&apos; method in PayloadNearSpanScorer assumes the AveragePayloadFunction was used. This patch adds the &apos;explain&apos; method to the &apos;PayloadFunction&apos; interface, where the Scorer can call it. Added unit tests for &apos;explain&apos; and for &lt;/p&gt;
{Min,Max}
&lt;p&gt;PayloadFunction.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12456786">LUCENE-2272</key>
            <summary>PayloadNearQuery has hardwired explanation for &apos;AveragePayloadFunction&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="gsingers">Grant Ingersoll</assignee>
                                <reporter username="pkeegan">Peter Keegan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Feb 2010 14:50:40 +0000</created>
                <updated>Wed, 30 Mar 2011 16:50:15 +0100</updated>
                    <resolved>Sat, 27 Nov 2010 23:25:34 +0000</resolved>
                                            <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>core/search</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12835764" author="pkeegan" created="Fri, 19 Feb 2010 14:51:32 +0000"  >&lt;p&gt;This patch adds the &apos;explain&apos; method to the &apos;PayloadFunction&apos; interface, where the Scorer can call it. Added unit tests for &apos;explain&apos; and for &lt;/p&gt;
{Min,Max}
&lt;p&gt;PayloadFunction.&lt;/p&gt;</comment>
                    <comment id="12837788" author="gsingers" created="Wed, 24 Feb 2010 13:54:00 +0000"  >&lt;p&gt;Peter,&lt;/p&gt;

&lt;p&gt;Couple of comments:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The base explain method can&apos;t be abstract.   Something like:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Explanation explain(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; docId){
    Explanation result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Explanation();
    result.setDescription(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unimpl Payload Function Explain&quot;&lt;/span&gt;);
    result.setValue(1);
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; result;
  };
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;should do the trick&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;The changes don&apos;t seem thread safe any more since there are now member variables.  It may still be all right, but have you looked at this aspect?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12848726" author="pkeegan" created="Tue, 23 Mar 2010 14:36:42 +0000"  >&lt;p&gt;There is a bug in PayloadNearQuery. If there are multiple top level spans that match the query, only the payloads of the first one are retrieved. This patch fixes this bug by iterating over all the top level spans to get the payloads (see &apos;setFreqCurrentDoc&apos;)&lt;/p&gt;

&lt;p&gt;&amp;gt; The base explain method can&apos;t be abstract. Something like&lt;br/&gt;
Ah, right. This is included in the patch&lt;/p&gt;

&lt;p&gt;&amp;gt;The changes don&apos;t seem thread safe any more since there are now member variables. It may still be all right, but have you looked at this aspect?&lt;/p&gt;

&lt;p&gt;I guess that could be said about PayloadTermSpanScorer and PayloadNearSpanScorer, too (payloadScore, payloadsSeen). As for the PayloadFunction classes, they seem lightweight enough to be created with each query. Is there a better pattern?&lt;/p&gt;

&lt;p&gt;Peter&lt;/p&gt;

</comment>
                    <comment id="12869142" author="pkeegan" created="Wed, 19 May 2010 15:20:22 +0100"  >&lt;p&gt;Revisiting this because the PayloadFunction &apos;explain&apos; methods return the wrong value and aren&apos;t thread safe, as Grant points out. A new patch is attached which eliminates the member variables.&lt;/p&gt;</comment>
                    <comment id="12870551" author="mikemccand" created="Mon, 24 May 2010 11:14:55 +0100"  >&lt;p&gt;Thanks Peter &amp;#8211; this looks important to fix.&lt;/p&gt;

&lt;p&gt;The patch, confusingly, seems to recursively include itself!  Ie I see PNQ-patch1.txt in the patch with its own diff lines.  Strange.&lt;/p&gt;

&lt;p&gt;Also, how  come your patch removes generics / @Override / @lucene.experimental, etc.?&lt;/p&gt;</comment>
                    <comment id="12904315" author="pkeegan" created="Mon, 30 Aug 2010 21:16:50 +0100"  >&lt;p&gt;Well, this is embarrassing. &lt;/p&gt;

&lt;p&gt;I used Eclipse to generate the patch, and didn&apos;t exclude an existing text file in the project that already contained the patch. I have regenerated the patch against the trunk, which also restored the generics and missing annotations. Sorry for the confusion.&lt;/p&gt;

&lt;p&gt;I also changed my JIRA e-mail so I don&apos;t miss updates on issues sent to me vs. the java-dev list.&lt;/p&gt;</comment>
                    <comment id="12904317" author="gsingers" created="Mon, 30 Aug 2010 21:19:21 +0100"  >&lt;p&gt;Wow, weird timing, Peter.  I was just looking at this today, hoping to finish it and up you put a patch.&lt;/p&gt;</comment>
                    <comment id="12904328" author="pkeegan" created="Mon, 30 Aug 2010 21:32:13 +0100"  >&lt;p&gt;That is wierd! I hope you didn&apos;t spend too much time on it.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Peter&lt;/p&gt;
</comment>
                    <comment id="12904335" author="gsingers" created="Mon, 30 Aug 2010 22:10:55 +0100"  >&lt;p&gt;Committed to trunk and 3.x&lt;/p&gt;</comment>
                    <comment id="12926267" author="rcmuir" created="Fri, 29 Oct 2010 14:08:03 +0100"  >&lt;p&gt;reopening for possible 2.9.4/3.0.3 backport.&lt;/p&gt;</comment>
                    <comment id="12964470" author="thetaphi" created="Sat, 27 Nov 2010 23:25:34 +0000"  >&lt;p&gt;Resolving again as this issue will not be backported to 2.9/3.0 branches.&lt;/p&gt;</comment>
                    <comment id="13013413" author="gsingers" created="Wed, 30 Mar 2011 16:50:15 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12436326" name="payloadfunctin-patch.txt" size="17626" author="pkeegan" created="Fri, 19 Feb 2010 14:51:32 +0000" />
                    <attachment id="12444936" name="PNQ-patch1.txt" size="44625" author="pkeegan" created="Wed, 19 May 2010 15:20:22 +0100" />
                    <attachment id="12453456" name="PNQ-patch2.txt" size="16627" author="pkeegan" created="Mon, 30 Aug 2010 21:16:50 +0100" />
                    <attachment id="12439571" name="PNQ-patch.txt" size="10349" author="pkeegan" created="Tue, 23 Mar 2010 14:36:42 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>4.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 24 Feb 2010 13:54:00 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11517</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25453</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 12:59:15 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2700/LUCENE-2700.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2700] Expose DocValues via Fields</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2700</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;DocValues Reader are currently exposed / accessed directly via IndexReader. To integrate the new feature in a more &quot;native&quot; way we should expose the DocValues via Fields on a perSegment level and on MultiFields in the multi reader case. DocValues should be side by side with Fields.terms  enabling access to Source, SortedSource and ValuesEnum something like that:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; class Fields {
...

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; DocValues values();

}

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; class DocValues {
  /** on disk &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; based API */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; ValuesEnum getEnum() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException;
  /** in memory Random Access API - with &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; support - first call loads values in ram*/
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; Source getSource() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException;
  /** sorted in memory Random Access API - optional operation */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; SortedSource getSortedSource(Comparator&amp;lt;BytesRef&amp;gt; comparator) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, UnsupportedOperationException;
  /** unloads previously loaded source only but keeps the doc values open */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; unload();
  /** closes the doc values */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; close();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment></environment>
            <key id="12477214">LUCENE-2700</key>
            <summary>Expose DocValues via Fields</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="simonw">Simon Willnauer</assignee>
                                <reporter username="simonw">Simon Willnauer</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Oct 2010 07:39:50 +0100</created>
                <updated>Thu, 25 Nov 2010 10:41:28 +0000</updated>
                    <resolved>Thu, 25 Nov 2010 10:41:28 +0000</resolved>
                                            <fixVersion>CSF branch</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12920628" author="yseeley@gmail.com" created="Wed, 13 Oct 2010 17:03:38 +0100"  >&lt;p&gt;FunctionQuery already has a class called DocValues - perhaps we could call this one FieldValues?&lt;/p&gt;</comment>
                    <comment id="12924895" author="simonw" created="Tue, 26 Oct 2010 09:46:05 +0100"  >&lt;blockquote&gt;&lt;p&gt;FunctionQuery already has a class called DocValues - perhaps we could call this one FieldValues?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ah I must have missed this comment - sry for the late response. I think you are right that we should use a different name. Maybe PerDocValues since FieldValues is doesn&apos;t sound right to me though.&lt;/p&gt;

&lt;p&gt;The other question is if FunctionQuery should be in core at all or if we should move it out to module (solr uses its own anyway right so we can merge them). Then the name similarity would not matter IMO. But thats a different story&lt;/p&gt;</comment>
                    <comment id="12926573" author="simonw" created="Sat, 30 Oct 2010 13:11:35 +0100"  >&lt;p&gt;Some might have followed the recent commit on the &lt;a href=&quot;https://svn.apache.org/repos/asf/lucene/dev/branches/docvalues/&quot; class=&quot;external-link&quot;&gt;branch&lt;/a&gt; some didn&apos;t so I will sum up what has happened so far.&lt;br/&gt;
I integrated the currently named &quot;DocValues&quot; (we might need to rename it to something like &quot;PerDocValues&quot; due to the naming conflict with func queries - I will wait for other suggestions though) into the 4 dimensional Flex API and in turn changed the FieldsConsumer and FieldsProducer interface to accept a new &quot;DocValuesConsumer&quot; / &quot;DocValuesProducer&quot; (implementing Fields) receptively. We have a default implementation for both of them while none of them are used by the &quot;Term / Postings&quot; codecs yet. I added a DocValuesCodec  which wraps any other codec and forwards if there is a TermsConsumer / Producer requested. The test case already uses a random codec wrapped by DocValuesCodec so they are ultimately pluggable. &lt;br/&gt;
DocValues are supported on a SegmentReader as well as DirectoryReader level i.e. they are integrated into MultiFields just the same way as Terms / DocsEnum etc. are.&lt;/p&gt;


&lt;p&gt;I run into one rather big issue while integrating a &quot;PerDoc&quot; consumer / producer into Codec. When a codec instantiates a FieldsConsumer most of the codecs already create all necessary &quot;resources&quot; to consumer terms and postings which is problematic since PerDocConsumers are created way before the segment is flushed while &quot;TermConsumer&quot; are created / needed only before / during flush. So in the case of DocValues I pass in the SegmentsWriteState into Codec#fieldsConsumer(..) and once the segment if flushed DocumentsWriter creates another one which in turn fails since the files for this codec / consumer have already been creates. Yet the solution I have implemented / hacked &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; is that I initialize the wrapped codec lazily with the SegmentsWriteState passed to Codec#fieldsConsumer(..) before the flush. This only works as long as nobody tries to get a TermsConsumer before we are ready to flush which is kind of flaky. &lt;/p&gt;

&lt;p&gt;IMO we should not necessarily create all resources / files in directory etc. when a FieldsConsumer is created but move it one level down and do it onces a TermsConsumer is requested. We gonna need these facilities anyway to integrate StoredFields etc. since they are per doc too. &lt;/p&gt;

&lt;p&gt;Comments welcome.&lt;/p&gt;</comment>
                    <comment id="12935714" author="simonw" created="Thu, 25 Nov 2010 10:41:28 +0000"  >&lt;p&gt;this is done since a while ago - closing&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="12310010">
                <name>Incorporates</name>
                                                <inwardlinks description="is part of">
                            <issuelink>
            <issuekey id="12444498">LUCENE-2186</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 13 Oct 2010 16:03:38 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11145</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24992</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:23:56 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2785/LUCENE-2785.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2785] TopFieldCollector throws AIOOBE if numHits is 0</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2785</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;See solr-user thread &quot;ArrayIndexOutOfBoundsException for query with rows=0 and sort param&quot;.&lt;/p&gt;

&lt;p&gt;I think we should just create a null collector (only tallies up totalHits) if numHits is 0?&lt;/p&gt;</description>
                <environment></environment>
            <key id="12491626">LUCENE-2785</key>
            <summary>TopFieldCollector throws AIOOBE if numHits is 0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Nov 2010 09:31:21 +0000</created>
                <updated>Wed, 30 Mar 2011 16:50:09 +0100</updated>
                    <resolved>Wed, 1 Dec 2010 10:43:59 +0000</resolved>
                                            <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>core/search</component>
                        <due></due>
                    <votes>1</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12965172" author="thetaphi" created="Tue, 30 Nov 2010 09:38:43 +0000"  >&lt;p&gt;+1, I needed the same. Its often a use case to simply get number of results. And a PQ with one entry and all the logic does not make sense here. We should just count hits.&lt;/p&gt;</comment>
                    <comment id="12965180" author="shaie" created="Tue, 30 Nov 2010 10:01:40 +0000"  >&lt;p&gt;It would be good if we could have a TotalHitsCollector which just counts total hits (as a standalone Collector). Problem is, we need to return a TDC from the static create() of TFC and TSDC, and a TotalHitsCollector shouldn&apos;t have topDocs() ... &lt;/p&gt;</comment>
                    <comment id="12965188" author="mikemccand" created="Tue, 30 Nov 2010 10:26:15 +0000"  >&lt;p&gt;So... IndexSearcher.search (the one that sorts by score) throws an EXC if numHits is 0...&lt;/p&gt;

&lt;p&gt;Maybe... we should do the same for the sort-by-field case?&lt;/p&gt;

&lt;p&gt;And, also make this new Collector that only counts hits?  The exception message can then point users to this new Collector?&lt;/p&gt;

&lt;p&gt;I&apos;m all for not making the app handle corner cases... but, then, I don&apos;t like that you silently get bad performance.  It&apos;s better to steer the apps to use the right Collector for the job?&lt;/p&gt;</comment>
                    <comment id="12965192" author="thetaphi" created="Tue, 30 Nov 2010 10:52:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;So... IndexSearcher.search (the one that sorts by score) throws an EXC if numHits is 0... Maybe... we should do the same for the sort-by-field case?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think IndexSearcher should not only throw the exception, in my opinion the create() method in TSDC and TFDC should also check this and throw the exception? A lot of people, also solr are instantiating the collectors themselves (although not recommeneded, because they dont know the correct booleans passed in).&lt;/p&gt;

&lt;p&gt;+1 for TSDC and TFDC throw exception if hitcount &amp;lt;1&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;And, also make this new Collector that only counts hits? The exception message can then point users to this new Collector?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1 to the new collector that simply counts. I have such a collector also sometimes in my code. Misusing TFDC or TSDC is wrong and uses too much resources.&lt;/p&gt;</comment>
                    <comment id="12965202" author="earwin" created="Tue, 30 Nov 2010 11:23:12 +0000"  >&lt;p&gt;&quot;A Collector, that counts&quot; - priceless.&lt;br/&gt;
And, yes, I have one of these too.&lt;/p&gt;</comment>
                    <comment id="12965384" author="mikemccand" created="Tue, 30 Nov 2010 19:49:35 +0000"  >&lt;p&gt;Patch.&lt;/p&gt;

&lt;p&gt;I moved the numHits &amp;gt; 0 check down into TFC.create an TSDC.create, out of IndexSearcher.&lt;/p&gt;

&lt;p&gt;And I added a new TotalHitCountCollector.&lt;/p&gt;</comment>
                    <comment id="13013384" author="gsingers" created="Wed, 30 Mar 2011 16:50:09 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12464982" name="LUCENE-2785.patch" size="6688" author="mikemccand" created="Tue, 30 Nov 2010 19:49:35 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 30 Nov 2010 09:38:43 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11069</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24907</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
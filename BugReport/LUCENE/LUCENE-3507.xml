<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:06:32 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3507/LUCENE-3507.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3507] Improve Memory Consumption for merging DocValues SortedBytes variants</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3507</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Currently SortedBytes are loaded into memory during merge which could be a potential trap. Instead of loading them into Heap memory we can merge those sorted values with much smaller memory and without loading all values into ram.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12526676">LUCENE-3507</key>
            <summary>Improve Memory Consumption for merging DocValues SortedBytes variants</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="simonw">Simon Willnauer</assignee>
                                <reporter username="simonw">Simon Willnauer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Oct 2011 16:19:00 +0100</created>
                <updated>Fri, 10 May 2013 11:42:53 +0100</updated>
                    <resolved>Wed, 12 Oct 2011 08:34:28 +0100</resolved>
                            <version>4.0-ALPHA</version>
                                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13125112" author="simonw" created="Tue, 11 Oct 2011 16:23:23 +0100"  >&lt;p&gt;here is a patch that merges sorted docvalues without loading into main memory. This patch remaps the ordinals, prunes &quot;unreferenced&quot; ords during merge and streams the new sorted datastructure into the new segment without loading into memory. Yet, there is still memory used to remap ords etc. but far less than what it used to require. &lt;/p&gt;

&lt;p&gt;We also don&apos;t need to hash and later sort the merged values again during merge since they are already sorted.&lt;/p&gt;</comment>
                    <comment id="13125153" author="mikemccand" created="Tue, 11 Oct 2011 17:18:16 +0100"  >
&lt;p&gt;Wow very impressive!&lt;/p&gt;

&lt;p&gt;So now we don&apos;t load any of the byte[] nor ord data for the subs&lt;br/&gt;
during merging (we use the new DirectSource); we only allocate the ord&lt;br/&gt;
re-mapping per segment, and docToOrd array for the merged segment.&lt;br/&gt;
Very nice!&lt;/p&gt;

&lt;p&gt;Patch looks great.  Only a couple tiny things:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;In SortedBytesMergeUtils.createOrdMapping, for the deletes case, I&lt;br/&gt;
    think you can move the &lt;tt&gt;int ord = currentSlice.source.ord(j)&lt;/tt&gt; inside&lt;br/&gt;
    the if?  Ie we don&apos;t need to pull the ord unless doc is still live.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Typo in SortedBytesMergeUtils: mapps -&amp;gt; maps&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="13125261" author="simonw" created="Tue, 11 Oct 2011 19:33:45 +0100"  >&lt;p&gt;next iteration, lots of cleanups &amp;amp; code simplification. Fixed spelling issues etc. I think we are close here.&lt;/p&gt;</comment>
                    <comment id="13125647" author="simonw" created="Wed, 12 Oct 2011 08:34:29 +0100"  >&lt;p&gt;committed in rev. 1182240 - thanks mike for reviewing&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="12310051">
                <name>Supercedes</name>
                                <outwardlinks description="supercedes">
                            <issuelink>
            <issuekey id="12510915">LUCENE-3217</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12498641" name="LUCENE-3507.patch" size="28605" author="simonw" created="Tue, 11 Oct 2011 19:33:45 +0100" />
                    <attachment id="12498614" name="LUCENE-3507.patch" size="28227" author="simonw" created="Tue, 11 Oct 2011 16:23:23 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 11 Oct 2011 16:18:16 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>59169</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24190</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:34:32 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2314/LUCENE-2314.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2314] Add AttributeSource.copyTo(AttributeSource)</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2314</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;One problem with AttributeSource at the moment is the missing &quot;insight&quot; into AttributeSource.State. If you want to create TokenStreams that inspect cpatured states, you have no chance. Making the contents of State public is a bad idea, as it does not help for inspecting (its a linked list, so you have to iterate).&lt;/p&gt;

&lt;p&gt;AttributeSource currently contains a cloneAttributes() call, which returns a new AttrubuteSource with all current attributes cloned. This is the (more expensive) captureState. The problem is that you cannot copy back the cloned AS (which is the restoreState). To use this behaviour (by the way, ShingleMatrix can use it), one can alternatively use cloneAttributes and copyTo. You can easily change the cloned attributes and store them in lists and copy them back. The only problem is lower performance of these calls (as State is a very optimized class).&lt;/p&gt;

&lt;p&gt;One use case could be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
AttributeSource state = cloneAttributes();
&lt;span class=&quot;code-comment&quot;&gt;// .... &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; something ...
&lt;/span&gt;state.getAttribute(TermAttribute.class).setTermBuffer(foobar);
&lt;span class=&quot;code-comment&quot;&gt;// ... more work
&lt;/span&gt;state.copyTo(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
            <key id="12459014">LUCENE-2314</key>
            <summary>Add AttributeSource.copyTo(AttributeSource)</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Sat, 13 Mar 2010 11:22:07 +0000</created>
                <updated>Fri, 10 May 2013 11:43:45 +0100</updated>
                    <resolved>Sun, 14 Mar 2010 09:10:05 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12844861" author="thetaphi" created="Sat, 13 Mar 2010 11:36:48 +0000"  >&lt;p&gt;Here the patch.&lt;/p&gt;</comment>
                    <comment id="12844868" author="shaie" created="Sat, 13 Mar 2010 12:55:14 +0000"  >&lt;p&gt;Minor comment - in copyTo, can you put state.attribute.getClass() in the message of the thrown exception, so whoever encounters it will know what&apos;s the invalid attribute?&lt;/p&gt;

&lt;p&gt;On a more general note, can State implement Iterable?&lt;/p&gt;</comment>
                    <comment id="12844871" author="thetaphi" created="Sat, 13 Mar 2010 13:33:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;Minor comment - in copyTo, can you put state.attribute.getClass() in the message of the thrown exception, so whoever encounters it will know what&apos;s the invalid attribute?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good idea, the same should be done for restoreState (the code way copied from there).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;On a more general note, can State implement Iterable?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It could, but as State is itsself a linked list element it would be... strange. But of course we could make it Iterable&amp;lt;AttributeImpl&amp;gt;. But the internal implementations of AttributeSource should not use this interface as it is optimized for speed, so the creation of iterators is a no-go here.&lt;/p&gt;</comment>
                    <comment id="12844874" author="shaie" created="Sat, 13 Mar 2010 13:49:28 +0000"  >&lt;p&gt;I just thought that instead of the for loop you have now you could have written something like: &quot;for (State state : this)&quot; ... a Java 5.0 style iteration. But it&apos;s not critical.&lt;/p&gt;</comment>
                    <comment id="12844876" author="thetaphi" created="Sat, 13 Mar 2010 13:53:43 +0000"  >&lt;p&gt;Because of speed we do not do this. That was performance tested in 2.9 development. The for-loop using the linked list directly is far faster. the captureState is one of the most optimized methods.&lt;/p&gt;</comment>
                    <comment id="12844877" author="shaie" created="Sat, 13 Mar 2010 13:56:56 +0000"  >&lt;p&gt;Ok. Performance is always preferred than beautiful looking code &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                    <comment id="12844913" author="thetaphi" created="Sat, 13 Mar 2010 16:18:36 +0000"  >&lt;p&gt;New patch with some improvements in cloneAttributes() and the requested class names in the IAEs.&lt;/p&gt;</comment>
                    <comment id="12844916" author="simonw" created="Sat, 13 Mar 2010 16:40:19 +0000"  >&lt;p&gt;Small comment on javadoc wording. &lt;/p&gt;

&lt;p&gt;Maybe like that:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/**
 * Copies the contents of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; AttributeSource to the given AttributeSource.
 * The given instance has to provide all {@link Attribute}s &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; instance contains. 
 * The actual attribute implementations must be identical in both {@link AttributeSource} instances.
 * Ideally both AttributeSource instances should use the same {@link AttributeFactory} 
 */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</comment>
                    <comment id="12844925" author="thetaphi" created="Sat, 13 Mar 2010 17:35:13 +0000"  >&lt;p&gt;Updated javadocs. Will commit tomorrow.&lt;/p&gt;</comment>
                    <comment id="12844927" author="simonw" created="Sat, 13 Mar 2010 17:38:40 +0000"  >&lt;p&gt;looks good to me!&lt;/p&gt;</comment>
                    <comment id="12845050" author="thetaphi" created="Sun, 14 Mar 2010 09:10:05 +0000"  >&lt;p&gt;Committed revision: 922797&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                                <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12443422">SOLR-1657</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12438695" name="LUCENE-2314.patch" size="5811" author="thetaphi" created="Sat, 13 Mar 2010 17:35:13 +0000" />
                    <attachment id="12438685" name="LUCENE-2314.patch" size="4994" author="thetaphi" created="Sat, 13 Mar 2010 16:18:36 +0000" />
                    <attachment id="12438677" name="LUCENE-2314.patch" size="2573" author="thetaphi" created="Sat, 13 Mar 2010 11:36:48 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 13 Mar 2010 12:55:14 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11480</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25411</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
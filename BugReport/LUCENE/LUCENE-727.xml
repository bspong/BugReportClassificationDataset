<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:24:31 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-727/LUCENE-727.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-727] MMapDirectory can&apos;t create new index on Windows</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-727</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;When I set the system property to request the use of the mmap directory, and start building a large index, the process dies with an IOException trying to delete a file. Apparently, Lucene isn&apos;t closing down the memory map before deleting the file.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP, JDK 1.4&lt;/p&gt;</environment>
            <key id="12356954">LUCENE-727</key>
            <summary>MMapDirectory can&apos;t create new index on Windows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="bmargulies">Benson Margulies</reporter>
                        <labels>
                    </labels>
                <created>Sun, 26 Nov 2006 18:14:48 +0000</created>
                <updated>Tue, 28 Nov 2006 19:28:44 +0000</updated>
                    <resolved>Tue, 28 Nov 2006 19:28:44 +0000</resolved>
                            <version>2.0.0</version>
                                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12453726" author="hossman" created="Mon, 27 Nov 2006 22:26:00 +0000"  >&lt;p&gt;Can you inlcude a full stack trace of the exception so we can see what code path causes this problem?&lt;/p&gt;

&lt;p&gt;it would be even better if you could inlcude a JUnit test demonstrating the problem.&lt;/p&gt;</comment>
                    <comment id="12453776" author="bmargulies" created="Tue, 28 Nov 2006 02:07:11 +0000"  >&lt;p&gt;Here you go. &lt;/p&gt;</comment>
                    <comment id="12454073" author="hossman" created="Tue, 28 Nov 2006 18:50:59 +0000"  >&lt;p&gt;Per robert engels on java-dev...&lt;/p&gt;

&lt;p&gt;&amp;gt; This is a known JDK issue with memory mapping a file.&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; The references may not be GC&apos;d at the time the request to delete is&lt;br/&gt;
&amp;gt; performed, and thus you will get an IOException.&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; See &lt;a href=&quot;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4715154&quot; class=&quot;external-link&quot;&gt;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4715154&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;...so it may not be possible to fix this.&lt;/p&gt;</comment>
                    <comment id="12454081" author="mikemccand" created="Tue, 28 Nov 2006 19:19:54 +0000"  >
&lt;p&gt;Thank you Benson for the unit test and opening this issue!&lt;/p&gt;

&lt;p&gt;Indeed, when I run your test, I see the exception in Lucene-2.0.0, but, not on the trunk.&lt;/p&gt;

&lt;p&gt;It looks like lockless commits (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-701&quot; title=&quot;Lock-less commits&quot;&gt;&lt;del&gt;LUCENE-701&lt;/del&gt;&lt;/a&gt; ) has fixed this because the files in the index are now &quot;write once&quot;.  Specifically, we no longer try to rename any files (nor do we even use the &quot;deletable&quot; file anymore).  The general philosopy is to rely on as little from the filesystem as we possibly can, so as to maximize portability...&lt;/p&gt;

&lt;p&gt;This is the exception on Lucene 2.0.0:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Testcase: testMmapIndex(org.apache.lucene.index.TestWindowsMMap):	Caused an ERROR&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Cannot delete F:\mike\src\lucene-2.0.0\testLuceneMmap\deletable&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; java.io.IOException: Cannot delete F:\mike\src\lucene-2.0.0\testLuceneMmap\deletable&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.lucene.store.FSDirectory.renameFile(FSDirectory.java:268)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.lucene.index.IndexWriter.writeDeleteableFiles(IndexWriter.java:827)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.lucene.index.IndexWriter.deleteFiles(IndexWriter.java:778)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.lucene.index.IndexWriter.mergeSegments(IndexWriter.java:747)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.lucene.index.IndexWriter.mergeSegments(IndexWriter.java:686)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.lucene.index.IndexWriter.maybeMergeSegments(IndexWriter.java:674)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:479)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:462)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.lucene.index.TestWindowsMMap.testMmapIndex(TestWindowsMMap.java:61)&lt;/p&gt;

&lt;p&gt;Since this is fixed on trunk, I&apos;ll resolve it as fixed.&lt;/p&gt;

&lt;p&gt;But first I&apos;ll commit the new unit test (thanks Benson)!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12345889" name="lucenewindowsmmaptest.tgz" size="4567" author="bmargulies" created="Tue, 28 Nov 2006 02:07:11 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 27 Nov 2006 22:26:00 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>13025</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>27003</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
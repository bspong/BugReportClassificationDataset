<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 12:58:15 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1465/LUCENE-1465.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1465] NearSpansOrdered.getPayload does not return the payload from the minimum match span</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1465</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description></description>
                <environment></environment>
            <key id="12409029">LUCENE-1465</key>
            <summary>NearSpansOrdered.getPayload does not return the payload from the minimum match span</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                <reporter username="markrmiller@gmail.com">Mark Miller</reporter>
                        <labels>
                    </labels>
                <created>Fri, 21 Nov 2008 21:44:28 +0000</created>
                <updated>Fri, 25 Sep 2009 17:23:14 +0100</updated>
                    <resolved>Mon, 23 Feb 2009 14:08:12 +0000</resolved>
                            <version>2.4</version>
                                <fixVersion>2.4.1</fixVersion>
                <fixVersion>2.9</fixVersion>
                                <component>core/search</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12649809" author="markrmiller@gmail.com" created="Fri, 21 Nov 2008 21:45:40 +0000"  >&lt;p&gt;Fix + test&lt;/p&gt;</comment>
                    <comment id="12649811" author="markrmiller@gmail.com" created="Fri, 21 Nov 2008 21:46:21 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1001&quot; title=&quot;Add Payload retrieval to Spans&quot;&gt;&lt;del&gt;LUCENE-1001&lt;/del&gt;&lt;/a&gt; for discussion of the bug.&lt;/p&gt;</comment>
                    <comment id="12650290" author="markrmiller@gmail.com" created="Mon, 24 Nov 2008 19:33:19 +0000"  >&lt;p&gt;I plan on committing this soon. This is a real deal breaker if you are trying to use the new getPayload API with ordered nearspans.&lt;/p&gt;

&lt;p&gt;The attached path has java 1.5 code in the test which I&apos;ll remove.&lt;/p&gt;</comment>
                    <comment id="12650349" author="markrmiller@gmail.com" created="Mon, 24 Nov 2008 22:02:48 +0000"  >&lt;p&gt;Bah. Its even worse than that. Even after you get down to a min match, it might not meet the slop requirements! You have to load the payloads and then dump them if the slop is not met.&lt;/p&gt;

&lt;p&gt;I don&apos;t like all this extra payload loading. Come to think of it, if you don&apos;t use the getPayload, your still paying for it! I don&apos;t have  a way around it, but I don&apos;t like it. In this case, not only do you pay for loading, you also pay for loading the payloads of a bunch of possible matches that don&apos;t end up being a match!&lt;/p&gt;

&lt;p&gt;Over a large index with lots of hits, its a lot of payloads to load...&lt;/p&gt;

&lt;p&gt;I havn&apos;t thought about any of it at a high level, but I think this has to be addressed somehow...maybe you have to turn on payload collecting first, or it doesnt do it? We need something...&lt;/p&gt;

&lt;p&gt;but until then, I think this still has to be fixed, and we are loading them one way or another now...might as well add a few more &quot;possible&quot; wrong loads (this last patch added a couple as well) to make the behavior correct - somewhat useless otherwise &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12650382" author="markrmiller@gmail.com" created="Mon, 24 Nov 2008 23:33:34 +0000"  >&lt;p&gt;That still wasn&apos;t quite right. A third test and a third fix. I am pretty sure this solves it, but my previous concerns still concern me.&lt;/p&gt;</comment>
                    <comment id="12650793" author="markrmiller@gmail.com" created="Tue, 25 Nov 2008 23:40:12 +0000"  >&lt;p&gt;Thanks Jonathan and Greg!&lt;/p&gt;</comment>
                    <comment id="12652010" author="joma" created="Mon, 1 Dec 2008 14:16:00 +0000"  >&lt;p&gt;Hi&lt;br/&gt;
It seems that the fix does not cover the case where 2 terms are indexed at the same position.&lt;br/&gt;
I attach a sample program illustrating the issue. Each 2 terms are indexed at the same position.&lt;br/&gt;
Best regards,&lt;br/&gt;
Jonathan&lt;/p&gt;</comment>
                    <comment id="12652852" author="mikemccand" created="Wed, 3 Dec 2008 16:48:14 +0000"  >&lt;p&gt;Let&apos;s backport fix to 2.4 branch (for eventual 2.4.1).&lt;/p&gt;</comment>
                    <comment id="12653277" author="markrmiller@gmail.com" created="Thu, 4 Dec 2008 12:22:38 +0000"  >&lt;p&gt;Whats involved in a backport - just commit it to the 2.4 branch and thats all?&lt;/p&gt;

&lt;p&gt;Looks like I have to look into terms indexed at the same position first - I&apos;ll try to get to that soon.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Mark&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12653292" author="mikemccand" created="Thu, 4 Dec 2008 13:13:54 +0000"  >&lt;blockquote&gt;&lt;p&gt;Whats involved in a backport - just commit it to the 2.4 branch and thats all? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yup.  &quot;svn merge&quot; works well as long as the code hasn&apos;t diverged much, eg running this in a 2.4 branch checkout:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;svn merge -r(N-1):N https:&lt;span class=&quot;code-comment&quot;&gt;//svn.apache.org/repos/asf/lucene/java/trunk&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;where N was the revision committed to trunk.&lt;/p&gt;</comment>
                    <comment id="12657662" author="markrmiller@gmail.com" created="Thu, 18 Dec 2008 03:37:46 +0000"  >&lt;p&gt;This is an odd one Jonathan. Its actually for the unordered case (the others were for the ordered). I am not exactly clear on whats going on yet.&lt;/p&gt;

&lt;p&gt;When I look at the payloads coming back, it would seem we are get 0,7,7 when we should get 6,7,7. When I look at the offsets for the spans that I get the payloads from though - they appear correct. Its returning the payloads from the right offsets it seems, but somehow one of those payloads is from the term at position 0? Very odd. So when I debug in, it does indeed look like the first match happens at index 6...but the term offsets are start: 2147483647, end:-2147483648. What the heck? This is going to take some more time...&lt;/p&gt;</comment>
                    <comment id="12658530" author="joma" created="Mon, 22 Dec 2008 13:07:10 +0000"  >&lt;p&gt;Mark, I would expect to get 0,0,3,6,7,7 and not only 6,7,7. &lt;/p&gt;

&lt;p&gt;As you wrote, &quot;a SpanAndQuery could easily be a SpanNearQuery if a huge distance was allowed.&quot; at &lt;a href=&quot;http://www.gossamer-threads.com/lists/lucene/java-user/51983&quot; class=&quot;external-link&quot;&gt;http://www.gossamer-threads.com/lists/lucene/java-user/51983&lt;/a&gt;&lt;/p&gt;</comment>
                    <comment id="12658531" author="markrmiller@gmail.com" created="Mon, 22 Dec 2008 13:11:46 +0000"  >&lt;p&gt;Hmmm...I think thats true, but thats for finding &apos;a hit&apos; on a document, not for finding every possible sequence of spans that could cause hit. Spans work by finding a minimum match, not greedily finding every match (which is a different algorithm).&lt;/p&gt;</comment>
                    <comment id="12675904" author="markrmiller@gmail.com" created="Mon, 23 Feb 2009 14:08:12 +0000"  >&lt;p&gt;This has been backported to 2.4 and is resolved. The unresolved dangling issue is a separate issue involving a different class, and is being tracked with &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1542&quot; title=&quot;Lucene can incorrectly set the position of tokens that start a field with positonInc 0.&quot;&gt;&lt;del&gt;LUCENE-1542&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12415141">LUCENE-1542</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12378356">LUCENE-1001</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12394610" name="LUCENE-1465.patch" size="10007" author="markrmiller@gmail.com" created="Mon, 24 Nov 2008 23:33:34 +0000" />
                    <attachment id="12394601" name="LUCENE-1465.patch" size="8624" author="markrmiller@gmail.com" created="Mon, 24 Nov 2008 22:02:48 +0000" />
                    <attachment id="12394592" name="LUCENE-1465.patch" size="6794" author="markrmiller@gmail.com" created="Mon, 24 Nov 2008 20:16:52 +0000" />
                    <attachment id="12394451" name="LUCENE-1465.patch" size="6794" author="markrmiller@gmail.com" created="Fri, 21 Nov 2008 21:45:39 +0000" />
                    <attachment id="12395020" name="Test.java" size="3552" author="joma" created="Mon, 1 Dec 2008 14:16:00 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>5.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 1 Dec 2008 14:16:00 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12286</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26262</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
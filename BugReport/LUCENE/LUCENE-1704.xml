<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:02:51 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1704/LUCENE-1704.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1704] org.apache.lucene.ant.HtmlDocument added Tidy config file passthrough availability</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1704</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Parsing HTML documents using the org.apache.lucene.ant.HtmlDocument.Document method resulted in many error messages such as this:&lt;/p&gt;

&lt;p&gt;    line 152 column 725 - Error: &amp;lt;as-html&amp;gt; is not recognized!&lt;br/&gt;
    This document has errors that must be fixed before&lt;br/&gt;
    using HTML Tidy to generate a tidied up version.&lt;/p&gt;

&lt;p&gt;The solution is to configure Tidy to accept these abnormal tags by adding the tag name to the &quot;new-inline-tags&quot; option in the Tidy config file (or the command line which does not make sense in this context), like so:&lt;/p&gt;

&lt;p&gt;    new-inline-tags: as-html&lt;/p&gt;

&lt;p&gt;Tidy needs to know where the configuration file is, so a new constructor and Document method can be added.  Here is the code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    /**                                                                                                                                                                                            
     *  Constructs an &amp;lt;code&amp;gt;HtmlDocument&amp;lt;/code&amp;gt; from a {@link                                                                                                                                      
     *  java.io.File}.                                                                                                                                                                             
     *                                                                                                                                                                                             
     *@param  file             the &amp;lt;code&amp;gt;File&amp;lt;/code&amp;gt; containing the                                                                                                                                
     *      HTML to parse                                                                                                                                                                          
     *@param  tidyConfigFile   the &amp;lt;code&amp;gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;lt;/code&amp;gt; containing                                                                                                                                  
     *      the full path to the Tidy config file                                                                                                                                                  
     *@exception  IOException  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; an I/O exception occurs                                                                                                                                          
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; HtmlDocument(File file, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tidyConfigFile) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        Tidy tidy = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Tidy();
        tidy.setConfigurationFromFile(tidyConfigFile);
        tidy.setQuiet(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        tidy.setShowWarnings(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
        org.w3c.dom.Document root =
                tidy.parseDOM(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(file), &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        rawDoc = root.getDocumentElement();
    }

    /**                                                                                                                                                                                            
     *  Creates a Lucene &amp;lt;code&amp;gt;Document&amp;lt;/code&amp;gt; from a {@link                                                                                                                                       
     *  java.io.File}.                                                                                                                                                                             
     *                                                                                                                                                                                             
     *@param  file                                                                                                                                                                                 
     *@param  tidyConfigFile the full path to the Tidy config file                                                                                                                                 
     *@exception  IOException                                                                                                                                                                      
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; org.apache.lucene.document.Document
        Document(File file, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tidyConfigFile) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {

        HtmlDocument htmlDoc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HtmlDocument(file, tidyConfigFile);

        org.apache.lucene.document.Document luceneDoc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.lucene.document.Document();

        luceneDoc.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Field(&lt;span class=&quot;code-quote&quot;&gt;&quot;title&quot;&lt;/span&gt;, htmlDoc.getTitle(), Field.Store.YES, Field.Index.ANALYZED));
        luceneDoc.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Field(&lt;span class=&quot;code-quote&quot;&gt;&quot;contents&quot;&lt;/span&gt;, htmlDoc.getBody(), Field.Store.YES, Field.Index.ANALYZED));

        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; contents = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        BufferedReader br =
            &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileReader(file));
        StringWriter sw = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringWriter();
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; line = br.readLine();
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (line != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            sw.write(line);
            line = br.readLine();
        }
        br.close();
        contents = sw.toString();
        sw.close();

        luceneDoc.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Field(&lt;span class=&quot;code-quote&quot;&gt;&quot;rawcontents&quot;&lt;/span&gt;, contents, Field.Store.YES, Field.Index.NO));

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; luceneDoc;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I am using this now and it is working fine.  The configuration file is being passed to Tidy and now I am able to index thousands of HTML pages with no more Tidy tag errors.&lt;/p&gt;
</description>
                <environment></environment>
            <key id="12428394">LUCENE-1704</key>
            <summary>org.apache.lucene.ant.HtmlDocument added Tidy config file passthrough availability</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                    <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png">Resolved</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="ksprochi">Keith Sprochi</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Jun 2009 19:52:30 +0100</created>
                <updated>Mon, 6 Jul 2009 20:55:12 +0100</updated>
                    <resolved>Mon, 6 Jul 2009 20:55:12 +0100</resolved>
                            <version>2.4.1</version>
                                                <component>modules/other</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                          <timeoriginalestimate seconds="1800">0.5h</timeoriginalestimate>
                    <timeestimate seconds="1800">0.5h</timeestimate>
                                  <comments>
                    <comment id="12721932" author="ksprochi" created="Fri, 19 Jun 2009 19:56:09 +0100"  >&lt;p&gt;The code got mangled when converted to HTML, so I tried adding &amp;lt;pre&amp;gt; tags to prevent formatting. Their is no preview option, so I won&apos;t know if it worked until I hit the update button.&lt;/p&gt;</comment>
                    <comment id="12721935" author="ksprochi" created="Fri, 19 Jun 2009 19:58:40 +0100"  >&lt;p&gt;Ok, pre tags did not work, so I took them out.  I have no remedy that will make the code format properly.&lt;/p&gt;</comment>
                    <comment id="12727723" author="mikemccand" created="Mon, 6 Jul 2009 20:35:03 +0100"  >&lt;p&gt;There is a preview button (that small blue computer-like icon to the left of the yellow question mark help icon), and, you can use {code} to wrap code so Jira doesn&apos;t format it.&lt;/p&gt;</comment>
                    <comment id="12727727" author="ksprochi" created="Mon, 6 Jul 2009 20:42:32 +0100"  >&lt;p&gt;Much better, thanks.  I guess I should have RTFM.&lt;/p&gt;</comment>
                    <comment id="12727732" author="mikemccand" created="Mon, 6 Jul 2009 20:53:23 +0100"  >&lt;p&gt;OK the patch looks good &amp;#8211; I&apos;ll commit shortly.  Thanks Keith!&lt;/p&gt;</comment>
                    <comment id="12727734" author="mikemccand" created="Mon, 6 Jul 2009 20:55:12 +0100"  >&lt;p&gt;Thanks Keith!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 6 Jul 2009 19:35:03 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12054</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26022</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
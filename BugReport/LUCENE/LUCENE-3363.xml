<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:26:17 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3363/LUCENE-3363.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3363] minimizeHopcroft OOMEs on smallish (2096 states, finite) automaton</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3363</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Not sure what&apos;s up w/ this... if you check out the blocktree branch (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3030&quot; title=&quot;Block tree terms dict &amp;amp; index&quot;&gt;&lt;del&gt;LUCENE-3030&lt;/del&gt;&lt;/a&gt;) and comment out the @Ignore in TestTermsEnum2.testFiniteVersusInfinite then this should hit OOME: &lt;/p&gt;
{[ant test-core -Dtestcase=TestTermsEnum2 -Dtestmethod=testFiniteVersusInfinite -Dtests.seed=-2577608857970454726:-2463580050179334504}
&lt;p&gt;}&lt;/p&gt;</description>
                <environment></environment>
            <key id="12518048">LUCENE-3363</key>
            <summary>minimizeHopcroft OOMEs on smallish (2096 states, finite) automaton</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Aug 2011 17:57:42 +0100</created>
                <updated>Fri, 10 May 2013 11:43:53 +0100</updated>
                    <resolved>Sun, 30 Oct 2011 04:42:53 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                <component>core/other</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13080358" author="thetaphi" created="Sat, 6 Aug 2011 06:31:14 +0100"  >&lt;p&gt;I have no idea, too. I hope this is not caused by minimizeSchindler changes and is the orginal minimizeHopcroft. Have you tried to undo the relevant commit? It still looks strange, as there must be something totally weird going on. I am away from computer this weekend, can look into it on Monday.&lt;/p&gt;</comment>
                    <comment id="13080977" author="rcmuir" created="Mon, 8 Aug 2011 15:43:04 +0100"  >&lt;p&gt;patch for the blocktree branch:&lt;/p&gt;

&lt;p&gt;The issue with this automaton:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;its already minimal! so all of this work is stupid.&lt;/li&gt;
	&lt;li&gt;it only has 2096 states, but sigma=3544, this is what causes the hopcroft blowup.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Originally, AutomatonQuery minimized the automaton in its ctor, but I&apos;m not sure we should do this, the input automaton could be large and if someone wants to do this, they should do it themselves? &lt;/p&gt;

&lt;p&gt;I think my original motivation was to try to fend off any adversaries (some crazy worst-case crap that would make the query slow)... but I think this is obselete.&lt;/p&gt;

&lt;p&gt;The patch changes this to determinize() + removeDeadTransitions() + reduce(), the first 2 operations really being all we need, but reduce() might help speed up the intersection.&lt;/p&gt;

&lt;p&gt;Note: RegExp already minimizes &quot;incrementally&quot; during its parsing, but this is one op at a time, so I think there is no problem here. I tested removing this too and replacing it with det + removeDead + reduce, but it slowed down regex parsing considerably, so I think we should continue to use minimize here.&lt;/p&gt;

&lt;p&gt;Additionally, I optimized wildcardquery here to use the optimized concatenate() to avoid useless determinize() calls when the LHS is a string, before it was using the concatenate(List) method.&lt;/p&gt;</comment>
                    <comment id="13080985" author="rcmuir" created="Mon, 8 Aug 2011 15:54:44 +0100"  >&lt;p&gt;by the way, for whatever reason the seed never OOM&apos;ed for me, but:&lt;br/&gt;
before:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;junit-sequential:
    [junit] Testsuite: org.apache.lucene.index.TestTermsEnum2
    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 211.474 sec
    [junit] 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;after:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;junit-sequential:
    [junit] Testsuite: org.apache.lucene.index.TestTermsEnum2
    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.856 sec
    [junit] 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    <comment id="13081005" author="rcmuir" created="Mon, 8 Aug 2011 16:39:54 +0100"  >&lt;p&gt;here is the quote from the original hopcroft paper, explaining why this crazy test that uses lots of random unicode strings causes the blowup:&lt;/p&gt;

&lt;p&gt;An algorithm is given for minimizing the number of states in a finite automaton or for&lt;br/&gt;
determining if two finite automata are equivalent. The asymptotic running time of the&lt;br/&gt;
algorithm is bounded by &lt;b&gt;knlogn&lt;/b&gt; where k is some constant and n is the number of&lt;br/&gt;
states. The constant &lt;b&gt;k depends linearly on the size of the input alphabet&lt;/b&gt;.&lt;/p&gt;
</comment>
                </comments>
                    <attachments>
                    <attachment id="12489692" name="LUCENE-3363.patch" size="5954" author="rcmuir" created="Mon, 8 Aug 2011 15:43:03 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 6 Aug 2011 05:31:14 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2965</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24333</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
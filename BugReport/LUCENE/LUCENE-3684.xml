<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:19:01 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3684/LUCENE-3684.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3684] Add offsets to postings (D&amp;PEnum)</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3684</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;I think should explore making start/end offsets a first-class attr in the&lt;br/&gt;
postings APIs, and fixing the indexer to index them into postings.&lt;/p&gt;

&lt;p&gt;This will make term vector access cleaner (we now have to jump through&lt;br/&gt;
hoops w/ non-first-class offset attr).  It can also enable efficient&lt;br/&gt;
highlighting without term vectors / reanalyzing, if the app indexes&lt;br/&gt;
offsets into the postings.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12537848">LUCENE-3684</key>
            <summary>Add offsets to postings (D&amp;PEnum)</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Jan 2012 01:26:51 +0000</created>
                <updated>Fri, 10 May 2013 11:43:05 +0100</updated>
                    <resolved>Sun, 15 Jan 2012 23:19:20 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13182986" author="mikemccand" created="Tue, 10 Jan 2012 01:28:01 +0000"  >
&lt;p&gt;Initial patch:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Adds needsPositions/needsOffsets to TermsEnum.d&amp;amp;pEnum().&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Cuts over all term vectors impls/usages to the new API.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Fixed one codec (SimpleText!) to be able to store offsets in the&lt;br/&gt;
    postings; added initial test to cover this.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;It&apos;s an early patch... I still need to fix the other codecs to index&lt;br/&gt;
offsets.&lt;/p&gt;</comment>
                    <comment id="13183138" author="simonw" created="Tue, 10 Jan 2012 08:24:48 +0000"  >&lt;p&gt;+1 this is awesome. seems we really need PositionIterators too &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="13186167" author="mikemccand" created="Sat, 14 Jan 2012 11:33:23 +0000"  >&lt;p&gt;New patch; I changed it so you only pass &quot;needsOffets&quot; bool when pulling D&amp;amp;PEnum.  I think it&apos;s ready!&lt;/p&gt;</comment>
                    <comment id="13186309" author="rcmuir" created="Sat, 14 Jan 2012 19:16:25 +0000"  >&lt;p&gt;I agree, this patch looks good. I think we just need two assertEquals() in TestDuelingCodecs for the future.&lt;/p&gt;

&lt;p&gt;I agree about checkIndex, we shouldnt check anything about the offsets. The user could store something crazy&lt;br/&gt;
in the offsets if they want.&lt;/p&gt;

&lt;p&gt;For checkindex, long term i think we should really consider adding a (slow, not by default) option to verify &lt;br/&gt;
the term vectors against the postings. we could at least turn it on in tests..., but thats another separate issue.&lt;/p&gt;</comment>
                    <comment id="13186310" author="rcmuir" created="Sat, 14 Jan 2012 19:20:40 +0000"  >&lt;p&gt;Actually: just looking at FieldInfos i think i found another annoyance, we have this assertion everywhere (not just that class either):&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; assert this.indexOptions == IndexOptions.DOCS_AND_FREQS_AND_POSITIONS || !this.storePayloads;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But i think this is wrong, we must use compareTo &amp;gt;= 0?&lt;/p&gt;</comment>
                    <comment id="13186331" author="simonw" created="Sat, 14 Jan 2012 20:24:46 +0000"  >&lt;p&gt;do we really need &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; FORMAT_CURRENT = FORMAT_OFFSETS_IN_POSTINGS;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; I mean the FORMAT_FLEX was introduced with flexible indexing and since we didn&apos;t release since then I think its confusing. We already changed this format since flex (ie. DocValues) without adding a new format. In &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3687&quot; title=&quot;Allow similarity to encode norms other than a single byte&quot;&gt;&lt;del&gt;LUCENE-3687&lt;/del&gt;&lt;/a&gt; I separated the 3x and 4.0 format and removed all the previous formats from 4.0 I think this code should start with a min3xFormat-1.&lt;/p&gt;

</comment>
                    <comment id="13186364" author="mikemccand" created="Sat, 14 Jan 2012 23:06:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think we just need two assertEquals() in TestDuelingCodecs for the future.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good &amp;#8211; I added that, it found a bug in SimpleText (only codec that can index offsets currently...) and I fixed that.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;For checkindex, long term i think we should really consider adding a (slow, not by default) option to verify &lt;br/&gt;
the term vectors against the postings. we could at least turn it on in tests..., but thats another separate issue.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I added that, in one direction (for each TV it seeks the Terms/Docs/AndPositionsEnum to verify everything is the same)... and it uncovered a sneaky bug in Lucene3x codec (not present in 3.x) where we were failing to make a deep copy of the Term before using it as a key in the terms cache... I fixed it.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;But i think this is wrong, we must use compareTo &amp;gt;= 0?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right &amp;#8211; I fixed several places that were still doing == or !=.  I left ones in non-SimpleText codecs &amp;#8211; they are still OK since they refuse to index offsets.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think this code should start with a min3xFormat-1.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ahh right!  I removed that and just kept FORMAT_FLEX.&lt;/p&gt;

&lt;p&gt;Thanks for the reviews Robert and Simon!&lt;/p&gt;</comment>
                    <comment id="13186368" author="mikemccand" created="Sat, 14 Jan 2012 23:19:48 +0000"  >&lt;p&gt;New patch w/ above feedback incorporated...&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12510605" name="LUCENE-3684.patch" size="216319" author="mikemccand" created="Sat, 14 Jan 2012 23:19:47 +0000" />
                    <attachment id="12510572" name="LUCENE-3684.patch" size="198806" author="mikemccand" created="Sat, 14 Jan 2012 11:33:23 +0000" />
                    <attachment id="12509991" name="LUCENE-3684.patch" size="185897" author="mikemccand" created="Tue, 10 Jan 2012 01:28:01 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 10 Jan 2012 08:24:48 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>223355</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24014</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
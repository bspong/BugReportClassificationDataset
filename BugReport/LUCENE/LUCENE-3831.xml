<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:21:16 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3831/LUCENE-3831.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3831] Passing a null fieldname to MemoryFields#terms in MemoryIndex throws a NPE</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3831</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;I found this when querying a MemoryIndex using a RegexpQuery wrapped by a SpanMultiTermQueryWrapper.  If the regexp doesn&apos;t match anything in the index, it gets rewritten to an empty SpanOrQuery with a null field value, which then triggers the NPE.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12544403">LUCENE-3831</key>
            <summary>Passing a null fieldname to MemoryFields#terms in MemoryIndex throws a NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="romseygeek">Alan Woodward</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Feb 2012 11:31:37 +0000</created>
                <updated>Fri, 10 May 2013 11:43:46 +0100</updated>
                    <resolved>Wed, 7 Mar 2012 19:38:41 +0000</resolved>
                            <version>4.0-ALPHA</version>
                                <fixVersion>3.6</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13218077" author="romseygeek" created="Tue, 28 Feb 2012 11:32:38 +0000"  >&lt;p&gt;Trivial fix - we just check if the passed in fieldname is null, and if it is, return null.&lt;/p&gt;</comment>
                    <comment id="13218171" author="mikemccand" created="Tue, 28 Feb 2012 13:41:17 +0000"  >&lt;p&gt;Hmm I don&apos;t think the Fields.terms API should be expected to accept null (eg I don&apos;t know if the other codecs will NPE).&lt;/p&gt;

&lt;p&gt;I&apos;d rather fix span queries to not pass the null field.  Is this happening in SpanTermQuery.getSpans()?&lt;/p&gt;</comment>
                    <comment id="13218222" author="romseygeek" created="Tue, 28 Feb 2012 14:28:41 +0000"  >&lt;p&gt;Here&apos;s a test case.  The error is thrown in SpanQuery.createWeight() when it&apos;s called on a bare SpanMultiTermQueryWrapper.&lt;/p&gt;

&lt;p&gt;It looks as though a simple workaround is to always wrap SpanMultiTermQueryWrapper in a SpanOrQuery.  &lt;/p&gt;

&lt;p&gt;Maybe SpanOrQuery should not have a default constructor, but should require a fieldname if no clauses are supplied?&lt;/p&gt;</comment>
                    <comment id="13218266" author="mikemccand" created="Tue, 28 Feb 2012 15:23:26 +0000"  >&lt;p&gt;Thanks for the test cases Alan!&lt;/p&gt;

&lt;p&gt;I folded those into a patch, added a few &lt;tt&gt;assert field != null&lt;/tt&gt;,&lt;br/&gt;
and then fixed SpanWeight to detect when its .getField() is&lt;br/&gt;
null and return a null scorer in that case.&lt;/p&gt;

&lt;p&gt;I&apos;d like to avoid the API break (changing Span*Query API to force&lt;br/&gt;
up-front providing of the field) if we can...&lt;/p&gt;</comment>
                    <comment id="13224638" author="mikemccand" created="Wed, 7 Mar 2012 19:38:41 +0000"  >&lt;p&gt;Thanks Alan.&lt;/p&gt;

&lt;p&gt;I couldn&apos;t provoke an NPE on 3.x but I still fixed SpanWeight to not pass on a null field to IR.norms.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12516340" name="LUCENE-3831.patch" size="8912" author="mikemccand" created="Tue, 28 Feb 2012 15:23:26 +0000" />
                    <attachment id="12516313" name="mindex-null-field.patch" size="660" author="romseygeek" created="Tue, 28 Feb 2012 11:32:37 +0000" />
                    <attachment id="12516332" name="TestNullFieldAfterRegexpRewrite.java" size="1757" author="romseygeek" created="Tue, 28 Feb 2012 14:28:41 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 28 Feb 2012 13:41:17 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>229641</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>23868</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
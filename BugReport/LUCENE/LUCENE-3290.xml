<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:35:16 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3290/LUCENE-3290.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3290] add FieldInvertState.numUniqueTerms, Terms.sumDocFreq</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3290</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;For scoring systems like lnu.ltc (&lt;a href=&quot;http://trec.nist.gov/pubs/trec16/papers/ibm-haifa.mq.final.pdf&quot; class=&quot;external-link&quot;&gt;http://trec.nist.gov/pubs/trec16/papers/ibm-haifa.mq.final.pdf&lt;/a&gt;), we need to supply 3 stats:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;average tf within d&lt;/li&gt;
	&lt;li&gt;# of unique terms within d&lt;/li&gt;
	&lt;li&gt;average number of unique terms across field&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If we add FieldInvertState.numUniqueTerms, you can incorporate the first two into your norms/docvalues (once we cut over),&lt;br/&gt;
the average tf within d being length / numUniqueTerms.&lt;/p&gt;

&lt;p&gt;to compute the average across the field, we can just write the sum of all terms&apos; docfreqs into the terms dictionary header,&lt;br/&gt;
and you can then divide this by maxdoc to get the average.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12513208">LUCENE-3290</key>
            <summary>add FieldInvertState.numUniqueTerms, Terms.sumDocFreq</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="rcmuir">Robert Muir</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Jul 2011 03:25:21 +0100</created>
                <updated>Sun, 27 Nov 2011 12:31:45 +0000</updated>
                    <resolved>Sat, 9 Jul 2011 12:18:17 +0100</resolved>
                                            <fixVersion>3.4</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13061723" author="rcmuir" created="Fri, 8 Jul 2011 03:27:12 +0100"  >&lt;p&gt;Patch: I think its ready to commit but before committing I want mike to double-check the unrelated nocommit i added for MemoryCodec.&lt;/p&gt;

&lt;p&gt;Looks like its TermsWriter writes a vLong for sumTotalTermFreq, its TermsReader reads a vInt... maybe we need a Test2BPostings &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="13061876" author="mikemccand" created="Fri, 8 Jul 2011 11:14:43 +0100"  >&lt;p&gt;You are right &amp;#8211; nice catch!  Can you change the sumTotalTF to be a readVLong?  Thanks.&lt;/p&gt;</comment>
                    <comment id="13061887" author="mikemccand" created="Fri, 8 Jul 2011 11:40:19 +0100"  >&lt;p&gt;Patch looks awesome!  Nice to add these additional status.&lt;/p&gt;</comment>
                    <comment id="13061903" author="rcmuir" created="Fri, 8 Jul 2011 12:25:54 +0100"  >&lt;p&gt;i committed the fix to memorycodec, synced the patch up to trunk, and renamed the confusing &apos;sumDF&apos; variable in termsconsumer, that actually is no sumDF at all &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I think this is ready to go&lt;/p&gt;</comment>
                    <comment id="13062192" author="rcmuir" created="Fri, 8 Jul 2011 22:22:55 +0100"  >&lt;p&gt;The FieldInvertState.numUniqueTerms portion is backported to 3.x (no collection level stats are in 3.x in general, seems tricky)&lt;/p&gt;</comment>
                    <comment id="13062202" author="yseeley@gmail.com" created="Fri, 8 Jul 2011 22:40:21 +0100"  >&lt;p&gt;Is there currently a way to get the number of documents that have a value in the field?&lt;br/&gt;
Then one could compute the average length of a (sparse) field via sumTotalTermFreq(field)/docsWithField(field)&lt;br/&gt;
docsWithField(field) would be useful in other contexts that want to know how sparse a field is (automatically selecting faceting algorithms, etc).&lt;/p&gt;</comment>
                    <comment id="13062214" author="rcmuir" created="Fri, 8 Jul 2011 22:57:47 +0100"  >&lt;p&gt;not at the moment, we would have to write this separately.&lt;/p&gt;</comment>
                    <comment id="13062361" author="thetaphi" created="Sat, 9 Jul 2011 12:17:06 +0100"  >&lt;p&gt;I reopen this one:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The FieldInvertState.numUniqueTerms portion is backported to 3.x (no collection level stats are in 3.x in general, seems tricky)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;As we backported this, we must add a Lucene 3.4 backwards index to the TestBackwardsCompatibility test. And hopefully this new 3.4 Index format opens sucessfully in trunk!&lt;/p&gt;</comment>
                    <comment id="13062362" author="rcmuir" created="Sat, 9 Jul 2011 12:18:17 +0100"  >&lt;p&gt;Uwe, the index format did not change in 3.x !&lt;/p&gt;</comment>
                    <comment id="13062363" author="rcmuir" created="Sat, 9 Jul 2011 12:21:59 +0100"  >&lt;p&gt;Just more explanation, there are two parts to the patch:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;FieldInvertState gets an additional variable, numUniqueTerms. its not stored anywhere. this just allows you to use this as part of your Similarity.computeNorm calculation, if you like.&lt;/li&gt;
	&lt;li&gt;in trunk &lt;b&gt;only&lt;/b&gt; we store sumDocFreq, which changes the index format. but this is not easy to backport to 3.x, as fields are not clearly separated (which would make it a little tricky), and its missing new stats anyway like totalTermFreq (because it would bloat TermInfos).&lt;/li&gt;
&lt;/ol&gt;
</comment>
                    <comment id="13062366" author="thetaphi" created="Sat, 9 Jul 2011 12:47:09 +0100"  >&lt;p&gt;OK, sorry for the noise!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12485725" name="LUCENE-3290.patch" size="28671" author="rcmuir" created="Fri, 8 Jul 2011 12:25:54 +0100" />
                    <attachment id="12485677" name="LUCENE-3290.patch" size="28468" author="rcmuir" created="Fri, 8 Jul 2011 03:27:12 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Fri, 8 Jul 2011 10:14:43 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2770</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24406</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
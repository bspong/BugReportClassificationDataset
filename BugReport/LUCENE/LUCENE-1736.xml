<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:19:03 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1736/LUCENE-1736.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1736] DateTools.java general improvements</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1736</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Applying the attached patch shows the improvements to DateTools.java that I think should be done. All logic that does anything at all is moved to instance methods of the inner class Resolution. I argue this is more object-oriented.&lt;/p&gt;

&lt;p&gt;1. In cases where Resolution is an argument to the method, I can simply invoke the appropriate call on the Resolution object. Formerly there was a big branch if/else.&lt;br/&gt;
2. Instead of &quot;synchronized&quot; being used seemingly everywhere, synchronized is used to sync on the object that is not threadsafe, be it a DateFormat or Calendar instance.&lt;br/&gt;
3. Since different DateFormat and Calendar instances are created per-Resolution, there is now less lock contention since threads using different resolutions will not use the same locks.&lt;br/&gt;
4. The old implementation of timeToString rounded the time before formatting it. That&apos;s unnecessary since the format only includes the resolution desired.&lt;br/&gt;
5. round() now uses a switch statement that benefits from fall-through (no break).&lt;/p&gt;

&lt;p&gt;Another debatable improvement that could be made is putting the resolution instances into an array indexed by format length. This would mean I could remove the switch in lookupResolutionByLength() and avoid the length constants there. Maybe that would be a bit too over-engineered when the switch is fine.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12429774">LUCENE-1736</key>
            <summary>DateTools.java general improvements</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="steve_rowe">Steve Rowe</assignee>
                                <reporter username="dsmiley">David Smiley</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Jul 2009 04:39:33 +0100</created>
                <updated>Sat, 2 Jul 2011 03:40:12 +0100</updated>
                    <resolved>Mon, 6 Jun 2011 23:36:37 +0100</resolved>
                            <version>2.9</version>
                                <fixVersion>3.3</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13045018" author="steve_rowe" created="Mon, 6 Jun 2011 19:38:13 +0100"  >&lt;p&gt;David, I tried to apply your patch, but it failed (using &quot;patch&quot;) - maybe partly because the patch is in git format?  I don&apos;t use git, so it&apos;s tough for me to review issues with git formatted patches.&lt;/p&gt;

&lt;p&gt;I went and looked at the DateTools.java and compared it to your patch, and things have changed significantly since you wrote the patch, especially as a result of Uwe&apos;s changes from &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1472&quot; title=&quot;DateTools.stringToDate() can cause lock contention under load&quot;&gt;&lt;del&gt;LUCENE-1472&lt;/del&gt;&lt;/a&gt;.  Could you take a look at that issue, see if it resolves (enough of) the problems you addressed in your patch to make this issue now obsolete?  If not, could you regenerate the patch (diff/patch format please)?&lt;/p&gt;</comment>
                    <comment id="13045113" author="dsmiley" created="Mon, 6 Jun 2011 22:11:18 +0100"  >&lt;p&gt;This is an updated patch.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The former &quot;DateFormats&quot; class was used as a value in a ThreadLocal which isn&apos;t a good idea as it hampers class reloading.&lt;/li&gt;
	&lt;li&gt;Improvements to a switch statement to benefit from fall-through.&lt;/li&gt;
	&lt;li&gt;Removed a pointless conversion to Calendar in timeToString()&lt;/li&gt;
	&lt;li&gt;Moved functionality to Resolution enum, and used arrays of Resolutions indexed by format length instead of large if-else or switch blocks for format &amp;amp; parse. The ramification is 48 fewer lines of code.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="13045172" author="steve_rowe" created="Mon, 6 Jun 2011 23:18:20 +0100"  >&lt;p&gt;David, this is your patch with a CHANGES.txt entry and a couple of comments added (&quot;for javadocs&quot; next to the two imports that are javadocs-only; and formatLen spelled out over the shared format string).&lt;/p&gt;

&lt;p&gt;Nice improvements.  All tests pass.&lt;/p&gt;

&lt;p&gt;I plan on committing shortly.&lt;/p&gt;</comment>
                    <comment id="13045185" author="steve_rowe" created="Mon, 6 Jun 2011 23:36:37 +0100"  >&lt;p&gt;Committed:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;r1132806: trunk&lt;/li&gt;
	&lt;li&gt;r1132812: branch_3x&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks David!&lt;/p&gt;</comment>
                    <comment id="13058909" author="rcmuir" created="Sat, 2 Jul 2011 03:40:12 +0100"  >&lt;p&gt;bulk close for 3.3&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12412819" name="cleanerDateTools.patch" size="11196" author="dsmiley" created="Wed, 8 Jul 2009 04:40:02 +0100" />
                    <attachment id="12481627" name="LUCENE-1736_DateTools_improvements.patch" size="8238" author="dsmiley" created="Mon, 6 Jun 2011 22:11:18 +0100" />
                    <attachment id="12481635" name="LUCENE-1736.patch" size="8400" author="steve_rowe" created="Mon, 6 Jun 2011 23:18:20 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 6 Jun 2011 18:38:13 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12023</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25990</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
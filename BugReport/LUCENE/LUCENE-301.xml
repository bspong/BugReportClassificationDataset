<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:04:44 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-301/LUCENE-301.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-301] Index Writer constructor flags unclear - and annoying in certain cases</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-301</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Wouldn&apos;t it make more sense if the constructor for the IndexWriter always&lt;br/&gt;
created an index if it doesn&apos;t exist - and the boolean parameter should be&lt;br/&gt;
&quot;clear&quot; (instead of &quot;create&quot;)&lt;/p&gt;

&lt;p&gt;So instead of this (from javadoc):&lt;/p&gt;

&lt;p&gt;IndexWriter&lt;/p&gt;

&lt;p&gt;public IndexWriter(Directory d,&lt;br/&gt;
                   Analyzer a,&lt;br/&gt;
                   boolean create)&lt;br/&gt;
            throws IOException&lt;/p&gt;

&lt;p&gt;    Constructs an IndexWriter for the index in d. Text will be analyzed with a.&lt;br/&gt;
If create is true, then a new, empty index will be created in d, replacing the&lt;br/&gt;
index already there, if any.&lt;/p&gt;

&lt;p&gt;Parameters:&lt;br/&gt;
    d - the index directory&lt;br/&gt;
    a - the analyzer to use&lt;br/&gt;
    create - true to create the index or overwrite the existing one; false to&lt;br/&gt;
append to the existing index &lt;br/&gt;
Throws:&lt;br/&gt;
    IOException - if the directory cannot be read/written to, or if it does not&lt;br/&gt;
exist, and create is false&lt;/p&gt;


&lt;p&gt;We would have this:&lt;/p&gt;

&lt;p&gt;IndexWriter&lt;/p&gt;

&lt;p&gt;public IndexWriter(Directory d,&lt;br/&gt;
                   Analyzer a,&lt;br/&gt;
                   boolean clear)&lt;br/&gt;
            throws IOException&lt;/p&gt;

&lt;p&gt;    Constructs an IndexWriter for the index in d. Text will be analyzed with a.&lt;br/&gt;
If clear is true, and a index exists at location d, then it will be erased, and&lt;br/&gt;
a new, empty index will be created in d.&lt;/p&gt;

&lt;p&gt;Parameters:&lt;br/&gt;
    d - the index directory&lt;br/&gt;
    a - the analyzer to use&lt;br/&gt;
    clear - true to overwrite the existing one; false to append to the existing&lt;br/&gt;
index &lt;br/&gt;
Throws:&lt;br/&gt;
    IOException - if the directory cannot be read/written to, or if it does not&lt;br/&gt;
exist.&lt;/p&gt;



&lt;p&gt;Its current behavior is kind of annoying, because I have an app that should&lt;br/&gt;
never clear an existing index, it should always append.  So I want create set to&lt;br/&gt;
false.  But when I am starting a brand new index, then I have to change the&lt;br/&gt;
create flag to keep it from throwing an exception...  I guess for now I will&lt;br/&gt;
have to write code to check if a index actually has content yet, and if it&lt;br/&gt;
doesn&apos;t, change the flag on the fly.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
            <key id="12314451">LUCENE-301</key>
            <summary>Index Writer constructor flags unclear - and annoying in certain cases</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="armbrust">Dan Armbrust</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Nov 2004 06:05:04 +0000</created>
                <updated>Tue, 27 Feb 2007 18:10:32 +0000</updated>
                    <resolved>Tue, 19 Dec 2006 11:37:39 +0000</resolved>
                            <version>1.4</version>
                                <fixVersion>2.1</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>1</votes>
                        <watches>2</watches>
                                                    <comments>
                    <comment id="12322013" author="armbrust" created="Sun, 26 Jun 2005 01:46:32 +0100"  >&lt;p&gt;Also note that, by changing the parameters in this way, no breakage or behavior&lt;br/&gt;
change occurs for end users.  &lt;/p&gt;

&lt;p&gt;When the 3rd parameter flag is set to true - it will erase the existing index,&lt;br/&gt;
just like it does now.&lt;/p&gt;

&lt;p&gt;If it is set to false, it will not erase the existing index - it will append,&lt;br/&gt;
just like it does now.&lt;/p&gt;

&lt;p&gt;The only change (and I consider it an improvment, and unlikely to break anyones&lt;br/&gt;
code) is that if it is set to false, and no index exists yet, then it will&lt;br/&gt;
create a new empty index at the specified location.&lt;/p&gt;</comment>
                    <comment id="12330502" author="armbrust" created="Tue, 27 Sep 2005 05:48:54 +0100"  >&lt;p&gt;Could this be addresses or WONT FIXED before the 1.9 release?&lt;/p&gt;</comment>
                    <comment id="12366834" author="hossman" created="Sat, 18 Feb 2006 04:10:56 +0000"  >
&lt;p&gt;&amp;gt;The only change (and I consider it an improvment, and unlikely to break anyones&lt;br/&gt;
&amp;gt;code) is that if it is set to false, and no index exists yet, then it will&lt;br/&gt;
&amp;gt;create a new empty index at the specified location.&lt;/p&gt;

&lt;p&gt;...that could be very bad for tools/apps that wantto update an existing index after reading the directory path from user input or configs when the user makes a typo.  In the past &quot;new IndexWriter(d,a,false) would throw an Exception indicating a problem, with the change you describe it would happily make a new index.&lt;/p&gt;


&lt;p&gt;I&apos;d be happy to see a more explict API with more options about what you want IndexWRiter to do if/when the directory does&apos;doesn&apos;t exist ... but it should be 100% backwards compatible.  deprecating this constructor but leaving it alone and adding a new one with more options seems like a much safer approach.&lt;/p&gt;</comment>
                    <comment id="12367227" author="cutting" created="Wed, 22 Feb 2006 02:09:34 +0000"  >&lt;p&gt;I agree with Hoss that we need to be very careful about compatibility.&lt;/p&gt;

&lt;p&gt;Why not add a new constructor, IndexWriter(Directory, Analyzer) which, if no such index exists, creates one?  Or we could deprecate the existing constructors and add new ones whose third parameter is a type-safe enumeration of IfExists:OVERWRITE, IfExists:APPEND or somesuch.&lt;/p&gt;</comment>
                    <comment id="12367239" author="armbrust" created="Wed, 22 Feb 2006 03:31:59 +0000"  >&lt;p&gt;I&apos;m perfectly happy with either new constructor approach - as long as there is a better constructor than what is currently available for my (and I suspect many other folks) &quot;normal&quot; use case of these constructors.&lt;/p&gt;

&lt;p&gt;It doesn&apos;t really matter to me if the current one stays or gets deprecated.  If it was going to be deprecated, it seems like 1.9 would be a good place to do it.&lt;/p&gt;
</comment>
                    <comment id="12459479" author="mikemccand" created="Mon, 18 Dec 2006 22:06:24 +0000"  >&lt;p&gt;I like Doug&apos;s solution &quot;add a new constructor, IndexWriter(Directory, Analyzer) which, if no such index exists, creates one&quot; &amp;#8211; I think this makses sense.  I will commit this.&lt;/p&gt;</comment>
                    <comment id="12459604" author="mikemccand" created="Tue, 19 Dec 2006 11:37:39 +0000"  >&lt;p&gt;OK I&apos;ve added the new constructors for IndexWriter.  Thank you Dan and sorry for the long delay!&lt;/p&gt;</comment>
                    <comment id="12476253" author="mikemccand" created="Tue, 27 Feb 2007 18:10:32 +0000"  >&lt;p&gt;Closing all issues that were resolved for 2.1.&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                <customfieldname>Bugzilla Id</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>32088</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 18 Feb 2006 04:10:56 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>13448</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>27430</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
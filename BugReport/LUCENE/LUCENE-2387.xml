<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:04:06 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2387/LUCENE-2387.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2387] IndexWriter retains references to Readers used in Fields (memory leak)</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2387</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;As described in &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; IndexWriter retains references to Reader used in Fields and that can lead to big memory leaks when using tika&apos;s ParsingReaders (as those can take 1MB per ParsingReader). &lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; shows a screenshot of the reference chain to the Reader from the IndexWriter taken with Eclipse MAT (Memory Analysis Tool) . The chain is the following:&lt;/p&gt;

&lt;p&gt;IndexWriter -&amp;gt; DocumentsWriter -&amp;gt; DocumentsWriterThreadState -&amp;gt; DocFieldProcessorPerThread  -&amp;gt; DocFieldProcessorPerField -&amp;gt; Fieldable -&amp;gt; Field (fieldsData) &lt;/p&gt;


&lt;p&gt;-------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://markmail.org/thread/ndmcgffg2mnwjo47&quot; class=&quot;external-link&quot;&gt;http://markmail.org/thread/ndmcgffg2mnwjo47&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://skitch.com/ecerulm/n7643/eclipse-memory-analyzer&quot; class=&quot;external-link&quot;&gt;http://skitch.com/ecerulm/n7643/eclipse-memory-analyzer&lt;/a&gt;&lt;/p&gt;
</description>
                <environment></environment>
            <key id="12461584">LUCENE-2387</key>
            <summary>IndexWriter retains references to Readers used in Fields (memory leak)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="ecerulm">Ruben Laguna</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Apr 2010 21:29:57 +0100</created>
                <updated>Fri, 18 Jun 2010 09:04:01 +0100</updated>
                    <resolved>Wed, 5 May 2010 00:45:13 +0100</resolved>
                            <version>3.0.1</version>
                                <fixVersion>2.9.3</fixVersion>
                <fixVersion>3.0.2</fixVersion>
                <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12855340" author="mikemccand" created="Fri, 9 Apr 2010 11:31:21 +0100"  >&lt;p&gt;Attached patch nulls out the Fieldable reference.&lt;/p&gt;</comment>
                    <comment id="12855345" author="thetaphi" created="Fri, 9 Apr 2010 11:56:31 +0100"  >&lt;p&gt;As Tokenizers are reused, the analyzer holds also a reference to the last used Reader. The easy fix would be to unset the Reader in Tokenizer.close(). If this is the case for you, that may be easy to do. So Tokenizer.close() looks like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/** By &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;, closes the input Reader. */
@Override
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void close() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    input.close();
    input = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; &lt;span class=&quot;code-comment&quot;&gt;// &amp;lt;-- &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;!
&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    <comment id="12855347" author="mikemccand" created="Fri, 9 Apr 2010 11:59:51 +0100"  >&lt;p&gt;I agree, Uwe &amp;#8211; I&apos;ll fold that into the patch.  Thanks.&lt;/p&gt;</comment>
                    <comment id="12856823" author="mikemccand" created="Wed, 14 Apr 2010 11:03:21 +0100"  >&lt;p&gt;29x version of this patch.&lt;/p&gt;</comment>
                    <comment id="12864044" author="kimchy" created="Tue, 4 May 2010 23:09:53 +0100"  >&lt;p&gt;Is there a chance that this can also be applied to 3.0.2 / 3.1? It would be really helpful to get this as soon as possible in the next Lucene version.&lt;/p&gt;</comment>
                    <comment id="12864064" author="mikemccand" created="Wed, 5 May 2010 00:19:01 +0100"  >&lt;p&gt;OK I&apos;ll backport.&lt;/p&gt;</comment>
                    <comment id="12864157" author="kimchy" created="Wed, 5 May 2010 06:11:05 +0100"  >&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12441710" name="ASF.LICENSE.NOT.GRANTED--LUCENE-2387-29x.patch" size="1238" author="mikemccand" created="Wed, 14 Apr 2010 11:03:21 +0100" />
                    <attachment id="12441284" name="LUCENE-2387.patch" size="597" author="mikemccand" created="Fri, 9 Apr 2010 11:31:21 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Fri, 9 Apr 2010 10:31:21 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11414</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25304</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
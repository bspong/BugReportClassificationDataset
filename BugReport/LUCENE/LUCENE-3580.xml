<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:11:38 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3580/LUCENE-3580.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3580] Most 4.0 PostingsReaders don&apos;t obey DISI contract</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3580</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;While trying to do some refactoring, I noticed funky things going on with some codecs.&lt;/p&gt;

&lt;p&gt;One problem is that DocIdSetIterator says the following:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Returns the following:
   * &amp;lt;ul&amp;gt;
   * &amp;lt;li&amp;gt;-1 or {@link #NO_MORE_DOCS} if {@link #nextDoc()} or
   * {@link #advance(int)} were not called yet.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But most 4.0 Docs/DocsAndPositionsEnums don&apos;t actually do this (e.g. return 0). instead we &lt;br/&gt;
are relying on Scorers to &apos;cover&apos; for them, which is inconsistent. Some scorers actually rely&lt;br/&gt;
upon this behavior, for example look at ReqExclScorer.toNonExcluded(), it calls docId() on the&lt;br/&gt;
excluded part before it calls nextDoc()&lt;/p&gt;

&lt;p&gt;So we need to either fix these enums, change these enums to not extend DocIdSetIterator (and redefine&lt;br/&gt;
what the actual contract should be for these enums), change DocIdSetIterator, or something else.&lt;/p&gt;

&lt;p&gt;Fixing the enums to return -1 here when they are uninitialized kinda sucks for the ones summing up&lt;br/&gt;
document deltas...&lt;/p&gt;</description>
                <environment></environment>
            <key id="12531738">LUCENE-3580</key>
            <summary>Most 4.0 PostingsReaders don&apos;t obey DISI contract</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="rcmuir">Robert Muir</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Nov 2011 03:32:29 +0000</created>
                <updated>Fri, 10 May 2013 11:44:42 +0100</updated>
                    <resolved>Thu, 17 Nov 2011 15:21:14 +0000</resolved>
                            <version>4.0-ALPHA</version>
                                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13151768" author="rcmuir" created="Thu, 17 Nov 2011 03:33:36 +0000"  >&lt;p&gt;patch with a test, and fixes for SimpleText and PreFlex, but i didn&apos;t fix any of the other postings readers.&lt;/p&gt;
</comment>
                    <comment id="13152051" author="rcmuir" created="Thu, 17 Nov 2011 13:45:04 +0000"  >&lt;p&gt;updated patch fixing the other postings readers... i don&apos;t think this will hurt performance, so I plan to commit soon.&lt;/p&gt;</comment>
                    <comment id="13152058" author="mikemccand" created="Thu, 17 Nov 2011 13:53:04 +0000"  >&lt;p&gt;+1, good catch!&lt;/p&gt;</comment>
                    <comment id="13152060" author="thetaphi" created="Thu, 17 Nov 2011 14:02:25 +0000"  >&lt;p&gt;+1, thanks Robert! I think DISI as basis/contract for DocsEnum is a good thing, so we should not remove that dependency.&lt;/p&gt;</comment>
                    <comment id="13152069" author="rcmuir" created="Thu, 17 Nov 2011 14:23:44 +0000"  >&lt;p&gt;Same bug in termvectors reader (sorry, i forgot). I&apos;ll add tests for those and fix them as well!&lt;/p&gt;</comment>
                    <comment id="13152071" author="rcmuir" created="Thu, 17 Nov 2011 14:26:21 +0000"  >&lt;p&gt;actually i will reopen the issue: i think we should add a check to QueryUtils to validate this for Scorers too, since they are also DISIs.&lt;/p&gt;</comment>
                    <comment id="13152072" author="rcmuir" created="Thu, 17 Nov 2011 14:26:35 +0000"  >&lt;p&gt;reopening to add tests/fixes for other DISI impls&lt;/p&gt;</comment>
                    <comment id="13152077" author="thetaphi" created="Thu, 17 Nov 2011 14:34:37 +0000"  >&lt;p&gt;Finally, I think the idea to have two separate state variables is a nice fix for this, I like that! After the first next()/advance() both are synchronous but the undefined state -1 for the docId is solved very elegant.&lt;/p&gt;</comment>
                    <comment id="13152079" author="rcmuir" created="Thu, 17 Nov 2011 14:35:56 +0000"  >&lt;p&gt;for scorers, i found no bugs at least in core tests... attached is my patch to AssertingIndexSearcher to check.&lt;/p&gt;</comment>
                    <comment id="13152092" author="rcmuir" created="Thu, 17 Nov 2011 15:12:48 +0000"  >&lt;p&gt;here&apos;s a patch fixing the TV DISIs and adding tests.&lt;/p&gt;

&lt;p&gt;I think we can resolve the issue now.&lt;/p&gt;</comment>
                    <comment id="13152095" author="rcmuir" created="Thu, 17 Nov 2011 15:21:14 +0000"  >&lt;p&gt;resolving for real this time hopefully &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12504061" name="LUCENE-3580.patch" size="20807" author="rcmuir" created="Thu, 17 Nov 2011 13:45:04 +0000" />
                    <attachment id="12504018" name="LUCENE-3580.patch" size="4649" author="rcmuir" created="Thu, 17 Nov 2011 03:33:36 +0000" />
                    <attachment id="12504065" name="LUCENE-3580_scorers.patch" size="1141" author="rcmuir" created="Thu, 17 Nov 2011 14:35:56 +0000" />
                    <attachment id="12504068" name="LUCENE-3580_tv.patch" size="7815" author="rcmuir" created="Thu, 17 Nov 2011 15:12:47 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>4.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 17 Nov 2011 13:53:04 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>217475</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24117</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
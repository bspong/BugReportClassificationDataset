<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:06:50 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1666/LUCENE-1666.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1666] Constants causing NullPointerException when fetching metadata &quot;Implementation Version&quot; in MANIFEST</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1666</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;If the MANIFEST.MF file does not contain the metadata IMPLEMENTATION_VERSION, a null value is returned, causing NullPointerException during commit:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.lang.NullPointerException&lt;br/&gt;
	at org.apache.lucene.store.IndexOutput.writeString(IndexOutput.java:109)&lt;br/&gt;
	at org.apache.lucene.store.IndexOutput.writeStringStringMap(IndexOutput.java:229)&lt;br/&gt;
	at org.apache.lucene.index.SegmentInfo.write(SegmentInfo.java:558)&lt;br/&gt;
	at org.apache.lucene.index.SegmentInfos.write(SegmentInfos.java:337)&lt;br/&gt;
	at org.apache.lucene.index.SegmentInfos.prepareCommit(SegmentInfos.java:808)&lt;br/&gt;
	at org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:5319)&lt;br/&gt;
	at org.apache.lucene.index.IndexWriter.prepareCommit(IndexWriter.java:3895)&lt;br/&gt;
	at org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:3956)&lt;/p&gt;

&lt;p&gt;This happened after having build a jar assembly using Maven, the original MANIFEST.MF of lucene jar has been overwritten, and didn&apos;t contain anynore the implementation version metadata.&lt;/p&gt;

&lt;p&gt;Path attached.&lt;/p&gt;</description>
                <environment>&lt;p&gt;os=Linux, os.version=2.6.28-11-generic, source=flush, lucene.version=2.9-dev, os.arch=i386, java.version=1.6.0_13, java.vendor=Sun Microsystems Inc.&lt;/p&gt;</environment>
            <key id="12426587">LUCENE-1666</key>
            <summary>Constants causing NullPointerException when fetching metadata &quot;Implementation Version&quot; in MANIFEST</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="rendel">Renaud Delbru</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 May 2009 15:52:05 +0100</created>
                <updated>Fri, 25 Sep 2009 17:23:26 +0100</updated>
                    <resolved>Thu, 28 May 2009 16:39:04 +0100</resolved>
                                            <fixVersion>2.9</fixVersion>
                                <component>core/other</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12714016" author="mikemccand" created="Thu, 28 May 2009 16:39:04 +0100"  >&lt;p&gt;Woops, thanks Renaud &amp;#8211; I just committed this.&lt;/p&gt;</comment>
                    <comment id="12714025" author="thetaphi" created="Thu, 28 May 2009 16:58:18 +0100"  >&lt;p&gt;Mike, you were a little bit too fast &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I worked out a better solution (the problem also ocurred on tests, when no manifest file was available, because it is only in the JAR file, not in the classpath during tests).&lt;br/&gt;
The attached patch does not use such &quot;hacks&quot; like opening the manifest directly. It just uses LucenePackage to get the implementation information. If it is NULL (because no manifest), it uses the same algorithm for resolving like you proposed.&lt;/p&gt;</comment>
                    <comment id="12714030" author="thetaphi" created="Thu, 28 May 2009 17:02:21 +0100"  >&lt;p&gt;Oh forget the &quot;-dev&quot; thing... Attached is fixed patch.&lt;/p&gt;</comment>
                    <comment id="12714046" author="mikemccand" created="Thu, 28 May 2009 17:31:15 +0100"  >&lt;p&gt;Much simpler, thanks Uwe!&lt;/p&gt;

&lt;p&gt;But, shouldn&apos;t we protect for null return from LucenePackage.get()?  Googling, it seems there are some occasions where .getPackage() might return null (seems to be w/ custom classloaders).&lt;/p&gt;

&lt;p&gt;And.... are there any situations where .getPackage() would fail but the current way would work (and vice/versa)?  (This is all voodoo magic to me!).&lt;/p&gt;</comment>
                    <comment id="12714055" author="thetaphi" created="Thu, 28 May 2009 17:53:48 +0100"  >&lt;p&gt;I think the check should be simply if getPackage() returns null do the same as with no implementation version. I see no case why the JAR/META-INF part should work better. It fails more often with custom classloaders, because the JAR file may not be directly available using jar:-URL because of security restrictionsin web containers.&lt;/p&gt;

&lt;p&gt;Attached is a patch that handles the null of get()&lt;/p&gt;</comment>
                    <comment id="12714074" author="mikemccand" created="Thu, 28 May 2009 18:28:20 +0100"  >&lt;p&gt;Excellent &amp;#8211; I just committed this.  Thanks Renaud &amp;amp; Uwe!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12409281" name="LUCENE-1666.patch" size="2174" author="thetaphi" created="Thu, 28 May 2009 17:53:48 +0100" />
                    <attachment id="12409279" name="LUCENE-1666.patch" size="1875" author="thetaphi" created="Thu, 28 May 2009 17:02:21 +0100" />
                    <attachment id="12409270" name="LUCENE-1666.patch" size="728" author="rendel" created="Thu, 28 May 2009 15:53:37 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 28 May 2009 15:39:04 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12092</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26061</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:14:26 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-337/LUCENE-337.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-337] Combination of BooleanQuery and PhrasePrefixQuery can provoke UnsupportedOperationException</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-337</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;A BooleanQuery including a PhrasePrefixQuery can cause an exception to be thrown&lt;br/&gt;
from BooleanScorer#skipTo when the search is executed:  &lt;/p&gt;

&lt;p&gt;java.lang.UnsupportedOperationException&lt;br/&gt;
	at org.apache.lucene.search.BooleanScorer.skipTo(BooleanScorer.java:189)&lt;br/&gt;
	at org.apache.lucene.search.ConjunctionScorer.doNext(ConjunctionScorer.java:53)&lt;br/&gt;
	at org.apache.lucene.search.ConjunctionScorer.next(ConjunctionScorer.java:48)&lt;br/&gt;
	at org.apache.lucene.search.Scorer.score(Scorer.java:37)&lt;br/&gt;
	at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:92)&lt;br/&gt;
	at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:64)&lt;br/&gt;
	at org.apache.lucene.search.Hits.&amp;lt;init&amp;gt;(Hits.java:43)&lt;br/&gt;
	at org.apache.lucene.search.Searcher.search(Searcher.java:33)&lt;br/&gt;
	at org.apache.lucene.search.Searcher.search(Searcher.java:27)&lt;br/&gt;
        ... (non-lucene code)&lt;/p&gt;

&lt;p&gt;The problem appears to be that PhrasePrefixQuery optimizes itself into a&lt;br/&gt;
BooleanQuery when it contains only one term.  However, it does this in the&lt;br/&gt;
createWeight() method of its scorer instead of in the rewrite method of the&lt;br/&gt;
query itself.  Thus it bypasses the boolean typecheck when BooleanQuery is&lt;br/&gt;
deciding whether to use ConjunctionScorer or BooleanScorer, eventually resulting&lt;br/&gt;
in the UOE.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Mac OS X 10.3&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
            <key id="12314487">LUCENE-337</key>
            <summary>Combination of BooleanQuery and PhrasePrefixQuery can provoke UnsupportedOperationException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="java-dev@lucene.apache.org">Lucene Developers</assignee>
                                <reporter username="rhett@detailedbalance.net">Rhett Sutphin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Jan 2005 07:22:34 +0000</created>
                <updated>Sat, 27 May 2006 02:38:50 +0100</updated>
                    <resolved>Sat, 27 May 2006 02:38:50 +0100</resolved>
                            <version>1.4</version>
                                                <component>core/search</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12322156" author="rhett@detailedbalance.net" created="Wed, 19 Jan 2005 07:31:39 +0000"  >&lt;p&gt;Created an attachment (id=14044)&lt;br/&gt;
Patch to optimize in rewrite instead of createWeight&lt;/p&gt;

&lt;p&gt;This patch moves the optimization from createWeight to rewrite.  This patch is&lt;br/&gt;
against the current CVS even though my initial bug report was against the 1.4.3&lt;br/&gt;
release.&lt;/p&gt;</comment>
                    <comment id="12322157" author="daniel.naber@t-online.de" created="Wed, 19 Jan 2005 08:05:48 +0000"  >&lt;p&gt;Thank you &amp;#8211; could you also attach a test case or a code snippet that triggers &lt;br/&gt;
the problem? &lt;/p&gt;
</comment>
                    <comment id="12322158" author="rhett@detailedbalance.net" created="Wed, 19 Jan 2005 08:58:03 +0000"  >&lt;p&gt;Created an attachment (id=14045)&lt;br/&gt;
A testcase that demonstrates the bug&lt;/p&gt;</comment>
                    <comment id="12322159" author="rhett@detailedbalance.net" created="Wed, 19 Jan 2005 09:00:34 +0000"  >&lt;p&gt;Here&apos;s the stacktrace I get when running that test without the fix in place:&lt;/p&gt;

&lt;p&gt;java.lang.UnsupportedOperationException&lt;br/&gt;
	at org.apache.lucene.search.BooleanScorer.skipTo(BooleanScorer.java:189)&lt;br/&gt;
	at org.apache.lucene.search.ConjunctionScorer.doNext(ConjunctionScorer.java:53)&lt;br/&gt;
	at org.apache.lucene.search.ConjunctionScorer.next(ConjunctionScorer.java:48)&lt;br/&gt;
	at org.apache.lucene.search.Scorer.score(Scorer.java:37)&lt;br/&gt;
	at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:92)&lt;br/&gt;
	at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:64)&lt;br/&gt;
	at org.apache.lucene.search.Hits.&amp;lt;init&amp;gt;(Hits.java:43)&lt;br/&gt;
	at org.apache.lucene.search.Searcher.search(Searcher.java:33)&lt;br/&gt;
	at org.apache.lucene.search.Searcher.search(Searcher.java:27)&lt;br/&gt;
	at&lt;br/&gt;
org.apache.lucene.search.TestBooleanQueryContainingPhrasePrefixQueries.testBooleanQueryContainingSingleTermPrefixQuery(TestBooleanQueryContainingPhrasePrefixQueries.java:57)&lt;/p&gt;</comment>
                    <comment id="12322160" author="daniel.naber@t-online.de" created="Thu, 20 Jan 2005 08:35:48 +0000"  >&lt;p&gt;Thanks, I committed your patch and the testcase to our CVS.  &lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12312508" name="ASF.LICENSE.NOT.GRANTED--33161.patch" size="1518" author="rhett@detailedbalance.net" created="Wed, 19 Jan 2005 07:31:39 +0000" />
                    <attachment id="12312509" name="ASF.LICENSE.NOT.GRANTED--TestBooleanQueryContainingPhrasePrefixQueries.java" size="2525" author="rhett@detailedbalance.net" created="Wed, 19 Jan 2005 08:58:03 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                <customfieldname>Bugzilla Id</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>33161</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 19 Jan 2005 08:05:48 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>13412</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>27394</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
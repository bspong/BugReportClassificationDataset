<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:17:19 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3071/LUCENE-3071.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3071] PathHierarchyTokenizer adaptation for urls: splits reversed</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3071</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;&lt;tt&gt;PathHierarchyTokenizer&lt;/tt&gt; should be usable to split urls the a &quot;reversed&quot; way (useful for faceted search against urls):&lt;br/&gt;
&lt;tt&gt;www.site.com&lt;/tt&gt; -&amp;gt; &lt;tt&gt;www.site.com, site.com, com&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Moreover, it should be able to skip a given number of first (or last, if reversed) tokens:&lt;br/&gt;
&lt;tt&gt;/usr/share/doc/somesoftware/INTERESTING/PART&lt;/tt&gt;&lt;br/&gt;
Should give with 4 tokens skipped:&lt;br/&gt;
&lt;tt&gt;INTERESTING&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;INTERESTING/PART&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
            <key id="12506187">LUCENE-3071</key>
            <summary>PathHierarchyTokenizer adaptation for urls: splits reversed</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="ryantxu">Ryan McKinley</assignee>
                                <reporter username="ofavre">Olivier Favre</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 May 2011 17:10:02 +0100</created>
                <updated>Sun, 27 Nov 2011 12:29:24 +0000</updated>
                    <resolved>Sat, 12 Nov 2011 21:14:54 +0000</resolved>
                                            <fixVersion>3.5</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>modules/analysis</component>
                        <due></due>
                    <votes>1</votes>
                        <watches>1</watches>
                          <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                    <timeestimate seconds="7200">2h</timeestimate>
                                  <comments>
                    <comment id="13029368" author="ofavre" created="Thu, 5 May 2011 16:20:27 +0100"  >&lt;p&gt;Proposed patch attached.&lt;/p&gt;

&lt;p&gt;Working against Lucene 3.1 (remove the &lt;tt&gt;path.length()&lt;/tt&gt; last parameter to assert call).&lt;br/&gt;
But I am having difficulties making the tests work against trunk (&lt;tt&gt;ant&lt;/tt&gt; and &lt;tt&gt;ant test&lt;/tt&gt; fail, at global scope).&lt;/p&gt;</comment>
                    <comment id="13029369" author="rcmuir" created="Thu, 5 May 2011 16:23:40 +0100"  >&lt;blockquote&gt;&lt;p&gt;But I am having difficulties making the tests work against trunk (ant and ant test fail, at global scope).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Can you provide more details about this?&lt;/p&gt;

&lt;p&gt;If possible stuff like ant version, whether you are using an svn checkout (and what the full path is), logs of what error messages, etc would be great.&lt;/p&gt;

&lt;p&gt;Feel free to open a new jira issue for these problems!&lt;/p&gt;</comment>
                    <comment id="13029390" author="ofavre" created="Thu, 5 May 2011 16:48:37 +0100"  >&lt;p&gt;I&apos;m using Ubuntu 10.04.2 LTS.&lt;br/&gt;
ant -version&lt;br/&gt;
Apache Ant version 1.7.1 compiled on September 8 2010&lt;br/&gt;
I followed the wiki: &lt;a href=&quot;http://wiki.apache.org/lucene-java/HowToContribute&quot; class=&quot;external-link&quot;&gt;http://wiki.apache.org/lucene-java/HowToContribute&lt;/a&gt;&lt;br/&gt;
I used svn checkout &lt;a href=&quot;http://svn.eu.apache.org/repos/asf/lucene/dev/trunk/&quot; class=&quot;external-link&quot;&gt;http://svn.eu.apache.org/repos/asf/lucene/dev/trunk/&lt;/a&gt; lucene-trunk.&lt;br/&gt;
I&apos;m working under revision 1099843 (yours).&lt;br/&gt;
See ant log attached.&lt;/p&gt;</comment>
                    <comment id="13029393" author="rcmuir" created="Thu, 5 May 2011 16:54:35 +0100"  >&lt;p&gt;Hi Olivier, thanks for uploading the log. &lt;/p&gt;

&lt;p&gt;This test fails for me sometimes too, somehow we should get to the bottom of it. &lt;br/&gt;
I opened an issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2500&quot; title=&quot;TestSolrProperties sometimes fails with &amp;quot;no such core: core0&amp;quot;&quot;&gt;&lt;del&gt;SOLR-2500&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As a workaround, perhaps using &apos;ant clean test&apos; will help... I fought with this&lt;br/&gt;
test a little bit the other day and somehow &apos;clean&apos; seemed to temporarily get the&lt;br/&gt;
test passing...&lt;/p&gt;</comment>
                    <comment id="13029413" author="ofavre" created="Thu, 5 May 2011 17:23:29 +0100"  >&lt;p&gt;&lt;tt&gt;ant clean test&lt;/tt&gt; did it for me, thanks!&lt;/p&gt;

&lt;p&gt;As for the failing tests, it is because of the &lt;tt&gt;finalOffset&lt;/tt&gt; that I set to &lt;tt&gt;path.length()&lt;/tt&gt;.&lt;br/&gt;
I&apos;m not sure whether I should use &lt;tt&gt;path.length()&lt;/tt&gt;, as my tokens don&apos;t go up to there when using the reverse mode.&lt;br/&gt;
When I take a look at the the end() function, I think that I &quot;should&quot; set it to the end of the string. But I can&apos;t see it on the javadoc.&lt;br/&gt;
If the purpose of the &lt;tt&gt;finalOffset&lt;/tt&gt; parameter in &lt;tt&gt;assertTokenStreamContents()&lt;/tt&gt; it to make sure of the &lt;tt&gt;endOffset&lt;/tt&gt; of the last term, then I should not use &lt;tt&gt;path.length()&lt;/tt&gt; blindly when using reverse and skip.&lt;/p&gt;

&lt;p&gt;Can you help me with the purpose of &lt;tt&gt;finalOffset&lt;/tt&gt;? Or can I simply skip it in my tests (they are working if I skip it)?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                    <comment id="13029416" author="rcmuir" created="Thu, 5 May 2011 17:28:55 +0100"  >&lt;blockquote&gt;&lt;p&gt;Can you help me with the purpose of finalOffset? Or can I simply skip it in my tests (they are working if I skip it)?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The finalOffset is supposed to be the offset of the entire document, this is useful so that offsets are correct on multivalued fields.&lt;/p&gt;

&lt;p&gt;Example multivalued field &quot;foo&quot; with two values:&lt;br/&gt;
&quot;bar &quot; &amp;lt;-- this one ends with a space&lt;br/&gt;
&quot;baz&quot;&lt;/p&gt;

&lt;p&gt;With a whitespace tokenizer, value 1 will have a single token &quot;bar&quot; with startOffset=0, endOffset=3. But, finalOffset needs to be 4 (essentially however many chars you read in from the Reader)&lt;/p&gt;

&lt;p&gt;This way, the offsets will then accumulate correctly for &quot;baz&quot;.&lt;/p&gt;</comment>
                    <comment id="13029444" author="ofavre" created="Thu, 5 May 2011 18:18:19 +0100"  >&lt;p&gt;Fixed patch attached.&lt;/p&gt;

&lt;p&gt;Tests run fine now.&lt;/p&gt;

&lt;p&gt;Ready to ship?&lt;/p&gt;</comment>
                    <comment id="13029471" author="rcmuir" created="Thu, 5 May 2011 19:07:59 +0100"  >&lt;p&gt;Hi Olivier, at a glance the patch looks really great to me, thanks!&lt;/p&gt;

&lt;p&gt;I took a quick look (not in enough detail) but had these thoughts, neither of which I think are really mandatory for this feature, just ideas:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;do you think it would be cleaner if we made it a separate tokenizer? (e.g. ReversePath....). The main logic of the tokenizer seems to be completely split, depending on whether you are reversing or not.&lt;/li&gt;
	&lt;li&gt;i think its possible in the future we could simplify the way finalOffset is being tracked, such that we just accumulate it on every read(), and then correctOffset a single time in end(). (i don&apos;t think this has much to do with your patch, just looking at the code in general).&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="13029502" author="ryantxu" created="Thu, 5 May 2011 20:00:12 +0100"  >&lt;p&gt;i&apos;ll take a look&lt;/p&gt;</comment>
                    <comment id="13029533" author="ryantxu" created="Thu, 5 May 2011 20:43:10 +0100"  >&lt;blockquote&gt;&lt;p&gt;do you think it would be cleaner if we made it a separate tokenizer?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think its a tossup &amp;#8211; having keeping them together makes one less factory in solr (not much of an argument) and the other three parameters (delimiter,replacement,skip) are nice to keep consistent.&lt;/p&gt;</comment>
                    <comment id="13029536" author="ryantxu" created="Thu, 5 May 2011 20:44:34 +0100"  >&lt;p&gt;updated patch that includes solr factory.&lt;/p&gt;

&lt;p&gt;Robert if this looks ok to you, i will go ahead and commit&lt;/p&gt;</comment>
                    <comment id="13029540" author="rcmuir" created="Thu, 5 May 2011 20:54:21 +0100"  >&lt;blockquote&gt;&lt;p&gt;having keeping them together makes one less factory in solr (not much of an argument) &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t understand this?&lt;/p&gt;

&lt;p&gt;You can still have one solr factory, if reverse=true it creates ReverseXXX...&lt;/p&gt;</comment>
                    <comment id="13029607" author="hossman" created="Thu, 5 May 2011 23:00:54 +0100"  >&lt;blockquote&gt;&lt;p&gt;You can still have one solr factory, if reverse=true it creates ReverseXXX...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;right ... if it makes the code cleaner to have two distinct Tokenizer impls, they can still share one factory.&lt;/p&gt;</comment>
                    <comment id="13029622" author="ryantxu" created="Thu, 5 May 2011 23:26:22 +0100"  >&lt;p&gt;split into two classes... and two test classes&lt;/p&gt;</comment>
                    <comment id="13029645" author="rcmuir" created="Fri, 6 May 2011 00:11:30 +0100"  >&lt;p&gt;this looks great!&lt;/p&gt;</comment>
                    <comment id="13029707" author="ryantxu" created="Fri, 6 May 2011 04:11:11 +0100"  >&lt;p&gt;I had some trouble merging from trunk to 3.x, and needed to just copy a few files &amp;#8211; i hope that does not muck stuff up.&lt;/p&gt;

&lt;p&gt;Thanks Olivier!&lt;/p&gt;</comment>
                    <comment id="13029837" author="simonw" created="Fri, 6 May 2011 09:43:19 +0100"  >&lt;p&gt;we got failures due to a missing file on 3.x - reopen &lt;/p&gt;</comment>
                    <comment id="13029840" author="simonw" created="Fri, 6 May 2011 09:51:59 +0100"  >&lt;blockquote&gt;&lt;p&gt;I had some trouble merging from trunk to 3.x, and needed to just copy a few files &#8211; i hope that does not muck stuff up.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;that change didn&apos;t seem to be hard to merge what did you do instead or merging? Maybe next time you should ask how to do it before copying stuff from trunk to branch?&lt;/p&gt;

&lt;p&gt;we also have a &quot;how to merge&quot; wiki here &lt;a href=&quot;http://wiki.apache.org/lucene-java/SvnMerge&quot; class=&quot;external-link&quot;&gt;http://wiki.apache.org/lucene-java/SvnMerge&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I merged the missing file in and committed I will close once hudson is building correctly.&lt;/p&gt;</comment>
                    <comment id="13029942" author="ryantxu" created="Fri, 6 May 2011 15:03:27 +0100"  >&lt;p&gt;thanks simon &amp;#8211; sorry about that, i will check for merge help next time.&lt;/p&gt;</comment>
                    <comment id="13029944" author="ofavre" created="Fri, 6 May 2011 15:12:06 +0100"  >&lt;p&gt;It seems you forgot to commit lucene/contrib/CHANGES.txt to describe the new feature.&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;</comment>
                    <comment id="13029946" author="ryantxu" created="Fri, 6 May 2011 15:20:00 +0100"  >&lt;p&gt;check:&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc/lucene/dev/branches/branch_3x/lucene/CHANGES.txt?p2=%2Flucene%2Fdev%2Fbranches%2Fbranch_3x%2Flucene%2FCHANGES.txt&amp;amp;p1=%2Flucene%2Fdev%2Fbranches%2Fbranch_3x%2Flucene%2FCHANGES.txt&amp;amp;r1=1100033&amp;amp;r2=1100032&amp;amp;view=diff&amp;amp;pathrev=1100033&quot; class=&quot;external-link&quot;&gt;http://svn.apache.org/viewvc/lucene/dev/branches/branch_3x/lucene/CHANGES.txt?p2=%2Flucene%2Fdev%2Fbranches%2Fbranch_3x%2Flucene%2FCHANGES.txt&amp;amp;p1=%2Flucene%2Fdev%2Fbranches%2Fbranch_3x%2Flucene%2FCHANGES.txt&amp;amp;r1=1100033&amp;amp;r2=1100032&amp;amp;view=diff&amp;amp;pathrev=1100033&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It is on the 3.x branch &amp;#8211; my understanding is that will get merged with the trunk changes when 4.x is valid.   &lt;/p&gt;

&lt;p&gt;I &lt;b&gt;think&lt;/b&gt; this was the resolution of how we will handle changes, but now that you ask, i am not sure...  anyone know what the current CHANGES policy is?&lt;/p&gt;</comment>
                    <comment id="13043544" author="rcmuir" created="Fri, 3 Jun 2011 17:40:41 +0100"  >&lt;p&gt;bulk move 3.2 -&amp;gt; 3.3&lt;/p&gt;</comment>
                    <comment id="13148849" author="simonw" created="Fri, 11 Nov 2011 23:42:20 +0000"  >&lt;p&gt;Ryan, are you working on this? This seems to have a working patch (at the time being) any reason why this didn&apos;t make it? if you are not working on this can you move it to unassigned?&lt;/p&gt;</comment>
                    <comment id="13149157" author="ryantxu" created="Sat, 12 Nov 2011 21:14:54 +0000"  >&lt;p&gt;Looks like this was actually resolved long ago... the only thing pending was that I did not understand how to manage the CHANGES.txt from 3.x and /trunk&lt;/p&gt;</comment>
                    <comment id="13157746" author="thetaphi" created="Sun, 27 Nov 2011 12:29:24 +0000"  >&lt;p&gt;Bulk close after release of 3.5&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12478287" name="ant.log.tar.bz2" size="15144" author="ofavre" created="Thu, 5 May 2011 16:48:37 +0100" />
                    <attachment id="12478341" name="LUCENE-3071.patch" size="22442" author="ryantxu" created="Thu, 5 May 2011 23:26:22 +0100" />
                    <attachment id="12478319" name="LUCENE-3071.patch" size="19286" author="ryantxu" created="Thu, 5 May 2011 20:44:34 +0100" />
                    <attachment id="12478299" name="LUCENE-3071.patch" size="18650" author="ofavre" created="Thu, 5 May 2011 18:18:19 +0100" />
                    <attachment id="12478282" name="LUCENE-3071.patch" size="18575" author="ofavre" created="Thu, 5 May 2011 16:20:27 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>5.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 5 May 2011 15:23:40 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>10844</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24622</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
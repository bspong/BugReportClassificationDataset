<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:30:24 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1812/LUCENE-1812.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1812] Static index pruning by in-document term frequency (Carmel pruning)</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1812</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;This module provides tools to produce a subset of input indexes by removing postings data for those terms where their in-document frequency is below a specified threshold. The net effect of this processing is a much smaller index that for common types of queries returns nearly identical top-N results as compared with the original index, but with increased performance. &lt;/p&gt;

&lt;p&gt;Optionally, stored values and term vectors can also be removed. This functionality is largely independent, so it can be used without term pruning (when term freq. threshold is set to 1).&lt;/p&gt;

&lt;p&gt;As the threshold value increases, the total size of the index decreases, search performance increases, and recall decreases (i.e. search quality deteriorates). NOTE: especially phrase recall deteriorates significantly at higher threshold values. &lt;/p&gt;

&lt;p&gt;Primary purpose of this class is to produce small first-tier indexes that fit completely in RAM, and store these indexes using IndexWriter.addIndexes(IndexReader[]). Usually the performance of this class will not be sufficient to use the resulting index view for on-the-fly pruning and searching. &lt;/p&gt;

&lt;p&gt;NOTE: If the input index is optimized (i.e. doesn&apos;t contain deletions) then the index produced via IndexWriter.addIndexes(IndexReader[]) will preserve internal document id-s so that they are in sync with the original index. This means that all other auxiliary information not necessary for first-tier processing, such as some stored fields, can also be removed, to be quickly retrieved on-demand from the original index using the same internal document id. &lt;/p&gt;

&lt;p&gt;Threshold values can be specified globally (for terms in all fields) using defaultThreshold parameter, and can be overriden using per-field or per-term values supplied in a thresholds map. Keys in this map are either field names, or terms in field:text format. The precedence of these values is the following: first a per-term threshold is used if present, then per-field threshold if present, and finally the default threshold.&lt;/p&gt;

&lt;p&gt;A command-line tool (PruningTool) is provided for convenience. At this moment it doesn&apos;t support all functionality available through API.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12433153">LUCENE-1812</key>
            <summary>Static index pruning by in-document term frequency (Carmel pruning)</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="doronc">Doron Cohen</assignee>
                                <reporter username="ab">Andrzej Bialecki </reporter>
                        <labels>
                    </labels>
                <created>Sat, 15 Aug 2009 15:57:41 +0100</created>
                <updated>Fri, 10 May 2013 11:44:42 +0100</updated>
                    <resolved>Sun, 25 Mar 2012 17:51:31 +0100</resolved>
                                            <fixVersion>3.6</fixVersion>
                                <component>modules/other</component>
                        <due></due>
                    <votes>4</votes>
                        <watches>8</watches>
                                                    <comments>
                    <comment id="12743722" author="ab" created="Sat, 15 Aug 2009 15:58:42 +0100"  >&lt;p&gt;Patch relative to the current trunk.&lt;/p&gt;</comment>
                    <comment id="12772521" author="ab" created="Mon, 2 Nov 2009 14:36:21 +0000"  >&lt;p&gt;Updated patch against trunk/ . This patch is a major refactoring that opens way for other implementations of stored fields and postings pruning. Two policies are included in this patch - the original Carmel method, and a simple TF-based threshold method.&lt;/p&gt;</comment>
                    <comment id="12774355" author="steve_rowe" created="Fri, 6 Nov 2009 18:36:18 +0000"  >&lt;p&gt;Andzrej, when I try to look at &lt;a href=&quot;http://wiki.apache.org/lucene-java/StaticIndexPruning?action=AttachFile&amp;amp;do=get&amp;amp;target=pruning.pdf&quot; class=&quot;external-link&quot;&gt;the PDF you posted&lt;/a&gt; on &lt;a href=&quot;http://wiki.apache.org/lucene-java/StaticIndexPruning&quot; class=&quot;external-link&quot;&gt;the StaticIndexPruning wiki page&lt;/a&gt;, Adobe Acrobat gives me the following error:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Cannot extract the embedded font &apos;CAAAA+ArialMT&apos;.  Some characters may not display or print correctly.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;and the text is illegible - everything except the page titles looks like a series of dots.&lt;/p&gt;</comment>
                    <comment id="12774363" author="ab" created="Fri, 6 Nov 2009 18:46:22 +0000"  >&lt;p&gt;There have been problems with PDF uploads since the recent Wiki upgrade ... I&apos;ll keep trying until it gets through in one piece. Sorry ...&lt;/p&gt;</comment>
                    <comment id="12775266" author="rcmuir" created="Tue, 10 Nov 2009 03:46:48 +0000"  >&lt;p&gt;Andrzej, i tested your patch. I found two places where @override was on an interface, only problem so far.&lt;/p&gt;

&lt;p&gt;here are some results on the hamshahri persian test collection (I used TF method with -t 2)&lt;/p&gt;

&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Measure&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Unpruned&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Pruned&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;index size&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;98627KB&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;42339KB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;map&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.4809&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.4241&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;recip_rank&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.8368&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.8393&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;P5&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.6277&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.6369&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;P10&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.5677&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.5785&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;P15&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.5436&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.5231&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;P20&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.5185&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.4969&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;P30&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.4703&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.4385&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;P100&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.2782&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.2440&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;the queries in this corpus are somewhat general, but seems to be a nice way to reduce the index to more than half its size, still with reasonable quality.&lt;/p&gt;</comment>
                    <comment id="12775358" author="ab" created="Tue, 10 Nov 2009 09:50:23 +0000"  >&lt;p&gt;Nice job, Robert - thanks! BTW, your results show an effect that was reported in the papers on this subject, namely that some metrics may actually improve, like MRR and P@10 above.&lt;/p&gt;</comment>
                    <comment id="12775443" author="rcmuir" created="Tue, 10 Nov 2009 15:10:53 +0000"  >&lt;p&gt;Andrzej, are you still working on the carmel policy? &lt;br/&gt;
I see -conf isn&apos;t yet implemented, and I can&apos;t seem to get it to prune anything with just a default threshold... guessing its still work in progress?&lt;/p&gt;</comment>
                    <comment id="12776450" author="ab" created="Wed, 11 Nov 2009 13:38:06 +0000"  >&lt;p&gt;Default threshold of what? When using the Carmel method, the threshold value should be between 0.0 - 1.0, where 1.0 means no pruning, i.e. 100% of docs are retained. I&apos;m sorry for the confusion - the documentation should be clearer on this point.&lt;/p&gt;</comment>
                    <comment id="12776472" author="rcmuir" created="Wed, 11 Nov 2009 14:45:43 +0000"  >&lt;blockquote&gt;&lt;p&gt;Default threshold of what?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;What was confusing me is that the console output always says &quot;deleted: 0&quot; for -impl carmel&lt;br/&gt;
For -impl tf, the console output is correct.&lt;/p&gt;

&lt;p&gt;But looking at the resulting index (which I should have done earlier, sorry), I can see that -impl carmel does work.&lt;/p&gt;</comment>
                    <comment id="12776479" author="thetaphi" created="Wed, 11 Nov 2009 15:05:37 +0000"  >&lt;p&gt;Code seems to be Java 1.5, which is good, but I am wondering about some @SuppressWarnings e.g. in getFieldNames(). The original overriden method returns Collection&amp;lt;String&amp;gt;, if you change that to return the correct type it doesn&apos;t need SuppressWarnings. There are more places. Also if you use Collections.&amp;lt;Type&amp;gt;emptyMap() and so on, it is also type safe.&lt;/p&gt;

&lt;p&gt;Also we use no space after comma in Generic type parameters.&lt;/p&gt;

&lt;p&gt;But I like the patch, nice work!&lt;/p&gt;</comment>
                    <comment id="12776589" author="ab" created="Wed, 11 Nov 2009 19:23:02 +0000"  >&lt;p&gt;I&apos;ll prepare a new patch - the reason for these deficiencies is that I worked against trunk just before the generics patches were applied &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12868678" author="ab" created="Tue, 18 May 2010 16:18:43 +0100"  >&lt;p&gt;Updated patch relative to branch_3x.&lt;/p&gt;</comment>
                    <comment id="12868719" author="rcmuir" created="Tue, 18 May 2010 17:41:13 +0100"  >&lt;p&gt;Hi Andrzej, thanks for updating the patch.&lt;/p&gt;

&lt;p&gt;I am curious about package organization here, do you anticipate adding some additional pruning functionality in the future that would be different than an index modification tool?&lt;/p&gt;

&lt;p&gt;I only ask, because looking at reorganizing our contrib area (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2323&quot; title=&quot;reorganize contrib modules&quot;&gt;&lt;del&gt;LUCENE-2323&lt;/del&gt;&lt;/a&gt;), I&apos;ve often thought that perhaps we need a &quot;contrib/index&quot; for all the index-related tools, instead of having various ones in &quot;miscellaneous&quot;, and I wonder what your opinions are on that.&lt;/p&gt;

&lt;p&gt;In any event we could always reorganize this after this issue is resolved if thats the best thing to do, and it could temporarily be contrib/pruning, its just svn moves.&lt;/p&gt;</comment>
                    <comment id="12868730" author="ab" created="Tue, 18 May 2010 17:52:11 +0100"  >&lt;p&gt;I&apos;m fine with reorganizing it - I originally put this into contrib/pruning to avoid polluting the contrib/misc. If we end up putting this stuff in contrib/index together with other tools then perhaps we should create sub-packages for related functionality, otherwise it would look messy.&lt;/p&gt;</comment>
                    <comment id="12870383" author="doronc" created="Sun, 23 May 2010 11:30:22 +0100"  >&lt;p&gt;Hi Andrzej, Robert, please note that IBM holds a &lt;a href=&quot;http://patft.uspto.gov/netacgi/nph-Parser?Sect2=PTO1&amp;amp;Sect2=HITOFF&amp;amp;p=1&amp;amp;u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&amp;amp;r=1&amp;amp;f=G&amp;amp;l=50&amp;amp;d=PALL&amp;amp;RefSrch=yes&amp;amp;Query=PN%2F7356527&quot; class=&quot;external-link&quot;&gt;patent on Lossy index compression&lt;/a&gt;.&lt;br/&gt;
I am checking with the IP department at IBM about committing an implementation of the patent in Lucene, and will update here as soon as I know where it stands - could you hold committing this until then?&lt;/p&gt;</comment>
                    <comment id="12870507" author="ab" created="Mon, 24 May 2010 06:10:50 +0100"  >&lt;p&gt;Thank you - yes, I think we will need to wait with this. I wasn&apos;t aware of the patent when I implemented this patch, and now after reading it I have the impression that it covers the exact algorithm described in the original paper, so perhaps we should be in the clear if we focus on other methods or a modified versions of it, but of course IANAL.&lt;/p&gt;</comment>
                    <comment id="12896742" author="ab" created="Tue, 10 Aug 2010 01:11:03 +0100"  >&lt;p&gt;Doron, were you able to check on the patent situation? If there&apos;s a chance of solving this in a positive way, how long do you think this could take?&lt;/p&gt;</comment>
                    <comment id="12897030" author="doronc" created="Tue, 10 Aug 2010 21:25:08 +0100"  >&lt;p&gt;Hi Andrzej, chances seem pretty good. We were thinking about further developing the index pruning implementation, however didn&apos;t get to it, hope to, later this year. If you rather not wait for that please go ahead with the current implementation. Thanks, Doron.&lt;/p&gt;</comment>
                    <comment id="12897043" author="ab" created="Tue, 10 Aug 2010 22:08:41 +0100"  >&lt;p&gt;That&apos;s great news, thanks! However, now you got me thinking ... considering there is legal aspect to the matter, do we (the Apache Lucene project) need something more substantial from IBM (e.g. a statement from your IP dept.) than just your &quot;go ahead&quot; in a JIRA comment?&lt;/p&gt;</comment>
                    <comment id="12897671" author="doronc" created="Thu, 12 Aug 2010 11:12:42 +0100"  >&lt;p&gt;Hi Andrzej, I would have asked the same question &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Fortunately this is cleared by the following patch I am attaching next (with that little check box in the Attach-Files dialog)&lt;/p&gt;</comment>
                    <comment id="12897715" author="doronc" created="Thu, 12 Aug 2010 13:12:09 +0100"  >&lt;p&gt;The pruning framework is pretty cool - it is quite easy to add a new pruning policy!&lt;/p&gt;

&lt;p&gt;Initially I planned to focus on CarmelPruningPolicy plus add the more sophisticated algorithm (tpoK) described in the paper, but eventually found myself doing more changes - Andrzej, I hope you like the changes - like some methods I renamed - otherwise please feel free to rename them back.&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Patch Details&lt;/ins&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Documentation changes - mainly moved things to where I thought they belong, like moving from CarmelPruning to TFPruning the general discussion that applies to any Term pruning implementation.&lt;/li&gt;
	&lt;li&gt;Renamed some of TermPruningPolicy methods for better readability - well, to me :&amp;#41; &amp;#8211; hope you agree with the new names, othewise please feel free to change back.&lt;/li&gt;
	&lt;li&gt;Renamed CarmelTermPruningPolicy to CarmelTermPruningUniformPolicy. - quite a long name... but descriptive, as this an enhanced form of the &quot;uniform&quot; case from the paper. Modified documentation accordingly.&lt;/li&gt;
	&lt;li&gt;Added CarmelTermPruningTopKPolicy - this is the more sophisticated/strong form of pruning described in the paper. (Test case added.)&lt;/li&gt;
	&lt;li&gt;Fixed some compiler warnings (1.5, Lucene.Version..)&lt;/li&gt;
	&lt;li&gt;Bug (&amp;#63;) in CarmelTermPruningPolicy in initTermPositions() - it sorts by docid before selecting the top subset, but in fact this seems dead code? Added a &quot;TODO deadcode&quot; there, maybe I am missing something.&lt;/li&gt;
	&lt;li&gt;Enabled topK pruning through the PruningTool program (untested)&lt;/li&gt;
	&lt;li&gt;Simplified the if statements in PruningRedaer.PruningTermEnum.next() - hopefully not missing something t here...&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;There&apos;s more to do though not sure when I&apos;ll have the cycles..:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Quality/performance test for the topK pruning algorithm - using LAtimes or some other judged collection.&lt;br/&gt;
  Or perhaps Robert can try it on that Persian test collection. &lt;/li&gt;
	&lt;li&gt;Add also the &quot;Delta Pruning&quot; policy as described in the paper&lt;/li&gt;
	&lt;li&gt;Junit for CarmelTermPruningUniformPolicy&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Doron&lt;/p&gt;</comment>
                    <comment id="12898139" author="ab" created="Fri, 13 Aug 2010 10:11:59 +0100"  >&lt;p&gt;Doron, thank you very much for pushing forward this issue! I think your patch looks good, I&apos;m still reviewing it in the light of 3.1 APIs. It&apos;s great that you added a new policy and test cases - this looks solid now.&lt;/p&gt;

&lt;p&gt;In the meantime however I still doubt if the JIRA checkbox is a sufficient counterweight to a possibility of a patent infringement suit against users of Lucene... I think in cases like this, where there is a known existing patent that this implementation uses, the ASF requires an explicit software grant to be made (&lt;a href=&quot;http://www.apache.org/licenses/software-grant.txt&quot; class=&quot;external-link&quot;&gt;http://www.apache.org/licenses/software-grant.txt&lt;/a&gt;) which would protect Lucene users from infringing on IBM&apos;s IP. I&apos;ll forward this to legal@apache.org to see what they say about it - if you can obtain such a grant without too much trouble then I&apos;m sure we could then close this issue.&lt;/p&gt;</comment>
                    <comment id="12898275" author="ab" created="Fri, 13 Aug 2010 16:29:29 +0100"  >&lt;p&gt;ASF legal thinks this is sufficient, so fortunately a software grant is not needed and from a legal point of view we can commit it. Yay!&lt;/p&gt;</comment>
                    <comment id="12898290" author="doronc" created="Fri, 13 Aug 2010 17:02:50 +0100"  >&lt;p&gt;Great!&lt;/p&gt;</comment>
                    <comment id="12901437" author="ab" created="Mon, 23 Aug 2010 16:20:48 +0100"  >&lt;blockquote&gt;&lt;p&gt;Renamed some of TermPruningPolicy methods for better readability - well, to me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree, this looks clearer now.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Bug &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; in CarmelTermPruningPolicy in initTermPositions() - it sorts by docid before selecting the top subset, but in fact this seems dead code? Added a &quot;TODO deadcode&quot; there, maybe I am missing something.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Well spotted, indeed this section was not needed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Simplified the if statements in PruningRedaer.PruningTermEnum.next() - hopefully not missing something t here...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Looks good to me. Thanks!&lt;/p&gt;

&lt;p&gt;Okay, if there are no further comments I&apos;d like to commit this soon.&lt;/p&gt;</comment>
                    <comment id="12975304" author="kaktuchakarabati" created="Mon, 27 Dec 2010 18:29:31 +0000"  >&lt;p&gt;Hey,&lt;br/&gt;
While trying to use this (wonderful!) component I noticed few things that might require some work:&lt;/p&gt;

&lt;p&gt;1. The issue says this affects lucene 2.9 as well, however the code seems to be hard-coded for 3.0 (uses the LUCENE_30 constant, as well as some new API&apos;s such as IndexWriterConfig).&lt;br/&gt;
     I created a patch that&apos;ll make it work with 2.9.3 (so I can use it with a Solr 1.4.1 deployment), and I can post it as a patch if seems useful, but I suspect we might want to come up with a more generic solution as well&lt;br/&gt;
     as clear definition of supported versions. Personally I think will be very useful to have a backport for 2.9.x so that users of current stable Solr release can use it (1.4.x)&lt;/p&gt;

&lt;p&gt;2. The code does not compile with the trunk (lucene/solr 4.0). Is this known issue? something we wish to solve? &lt;/p&gt;

&lt;p&gt;3. When using it with the 3.0 branch, it does indeed work, However when it reads an older version of the index and emits a newer one (e.g reads in 2.9.x, spits out 3.x) it renders the pruned index unusable by some platforms (e.g solr 1.4.x as mentioned above). Is this something that can be fixed? i.e forcing output index to be same version as input one? I was gonna do some work on my own there but this issue seems alittle more delicate and requires deeper understanding of lucene innards than i afford..&lt;/p&gt;

&lt;p&gt;-Chak&lt;/p&gt;
</comment>
                    <comment id="12975380" author="doronc" created="Mon, 27 Dec 2010 23:33:22 +0000"  >&lt;p&gt;I plan to work on this for 3.x and trunk, did not notice that it was marked for 2.9, but can look at that as well. &lt;br/&gt;
Andrej are you working on this or can I take it? &lt;br/&gt;
As for writing in 2.9 format I think it is better to backport to 2.9 rather than having the 3.x (or trunk) version write in 2.9 format?&lt;br/&gt;
Doron&lt;/p&gt;</comment>
                    <comment id="12976752" author="ab" created="Mon, 3 Jan 2011 14:20:37 +0000"  >&lt;p&gt;Doron, feel free to work on this - I won&apos;t be able to do any work on this in January.&lt;/p&gt;</comment>
                    <comment id="13043559" author="rcmuir" created="Fri, 3 Jun 2011 17:40:46 +0100"  >&lt;p&gt;bulk move 3.2 -&amp;gt; 3.3&lt;/p&gt;</comment>
                    <comment id="13092696" author="todaylxp" created="Mon, 29 Aug 2011 09:29:06 +0100"  >&lt;p&gt;where can i download the codes about the pruning ,i can&apos;t found in &lt;br/&gt;
&lt;a href=&quot;https://svn.apache.org/repos/asf/lucene/dev/branches/branch_3x&quot; class=&quot;external-link&quot;&gt;https://svn.apache.org/repos/asf/lucene/dev/branches/branch_3x&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;thanks&lt;/p&gt;</comment>
                    <comment id="13191205" author="doronc" created="Mon, 23 Jan 2012 15:31:36 +0000"  >&lt;p&gt;Updated patch for current 3x.&lt;/p&gt;</comment>
                    <comment id="13191206" author="doronc" created="Mon, 23 Jan 2012 15:33:18 +0000"  >&lt;p&gt;Getting to this, at last. &lt;/p&gt;

&lt;p&gt;I did not handle the above TODO&apos;s and I rather commit so they can be handled later separately (&quot;progress not perfection&quot; as Mike says). &lt;/p&gt;

&lt;p&gt;Changes in this patch: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PruningReader overrides also getSequentialSubReaders(), otherwise no pruning takes place on sub-readers (and tests fail).&lt;/li&gt;
	&lt;li&gt;StorePruningPolicy fixed to use FieldInfos API.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I modified for Idea and maven by following templates for other contrib components but have no way to test this and would appreciate a review of this.&lt;/p&gt;</comment>
                    <comment id="13191209" author="doronc" created="Mon, 23 Jan 2012 15:40:32 +0000"  >&lt;p&gt;I now see that all other contrib components have svn:ignore for *.iml and pom.xml - I&apos;ll add that for pruning as well (though it is not in the attached patch).&lt;/p&gt;</comment>
                    <comment id="13191211" author="steve_rowe" created="Mon, 23 Jan 2012 15:42:22 +0000"  >&lt;p&gt;Hi Doron,&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I modified for Idea and maven by following templates for other contrib components but have no way to test this and would appreciate a review of this.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I looked at these configurations and they should be functional.  I didn&apos;t test them, but I will once they have been committed.&lt;/p&gt;</comment>
                    <comment id="13191222" author="doronc" created="Mon, 23 Jan 2012 15:57:02 +0000"  >&lt;blockquote&gt;&lt;p&gt;I didn&apos;t test them, but I will once they have been committed.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Great, thanks! &lt;/p&gt;</comment>
                    <comment id="13192101" author="doronc" created="Tue, 24 Jan 2012 12:53:35 +0000"  >&lt;p&gt;I ran &apos;javadocs&apos; under 3x/lucene/contrib/pruning and &apos;javadocs-all&apos; under 3x/lucene. &lt;/p&gt;

&lt;p&gt;The latter failed due to multiple package.html under o.a.l.index - in core and under contrib/pruning. &lt;/p&gt;

&lt;p&gt;Entirely renaming the package to o.a.l.pruning.index won&apos;t work because PruningReader accesses package protected SegmentTermVector.&lt;/p&gt;

&lt;p&gt;I can move the other classes to that new package and keep only PruningReader in that &quot;index friend&quot; package. (Unless there are javadoc/ant tricks that will avoid this error and still generate valid javadocs in both cases).&lt;/p&gt;</comment>
                    <comment id="13196282" author="doronc" created="Mon, 30 Jan 2012 18:30:43 +0000"  >&lt;p&gt;Updated patch: package.html and all pruning classes moved to another package, except for PruningReader. Now ant javadocs-all passes as well. There are 3 TODO&apos;s:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;implement CarmelTermPruningDeltaTopPolicy&lt;/li&gt;
	&lt;li&gt;dead code question in CarmelUniformTermPruningPolicy&lt;/li&gt;
	&lt;li&gt;missing details in package.html&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;The first one can wait but the other two I would like to handle before committing.&lt;/p&gt;</comment>
                    <comment id="13196339" author="doronc" created="Mon, 30 Jan 2012 19:20:22 +0000"  >&lt;p&gt;That dead code was removed and some javadocs added. &lt;br/&gt;
Still room for more javadocs - e.g.  the static tool - and better test coverage.&lt;br/&gt;
Committed to 3x: r1237937.&lt;/p&gt;</comment>
                    <comment id="13196385" author="ab" created="Mon, 30 Jan 2012 20:16:11 +0000"  >&lt;p&gt;Excellent, thanks for seeing this through!&lt;/p&gt;</comment>
                    <comment id="13196429" author="doronc" created="Mon, 30 Jan 2012 21:23:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;Excellent, thanks for seeing this through!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, only more than a year delay &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;BTW in trunk it will be under modules.&lt;/p&gt;</comment>
                    <comment id="13196845" author="doronc" created="Tue, 31 Jan 2012 11:42:51 +0000"  >&lt;p&gt;while merging to trunk I noticed that idea&apos;s settings for modules/queries and modules/queryparser refer to lucene/contrib instead of modules. Seems trivial to fix but I have no Idea installed at the moment so no way to verify. Created &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3737&quot; title=&quot;Idea modules settings - verify and fix&quot;&gt;&lt;del&gt;LUCENE-3737&lt;/del&gt;&lt;/a&gt; to handle that later.&lt;/p&gt;</comment>
                    <comment id="13237922" author="rcmuir" created="Sun, 25 Mar 2012 17:49:27 +0100"  >&lt;p&gt;This is really still open I think for the 4.x port.&lt;/p&gt;

&lt;p&gt;To eliminate confusion: I&apos;ll mark this resolved and create a 4.0 issue to port pruning to trunk APIs.&lt;/p&gt;</comment>
                    <comment id="13237923" author="rcmuir" created="Sun, 25 Mar 2012 17:51:31 +0100"  >&lt;p&gt;Marking this resolved: I created &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3917&quot; title=&quot;Port pruning module to trunk apis&quot;&gt;LUCENE-3917&lt;/a&gt; for the 4.x port for JIRA organization purposes.&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10032">
                <name>Blocker</name>
                                                <inwardlinks description="is blocked by">
                            <issuelink>
            <issuekey id="12471520">LEGAL-78</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12512439" name="pruning.patch" size="94533" author="doronc" created="Mon, 30 Jan 2012 18:30:43 +0000" />
                    <attachment id="12511503" name="pruning.patch" size="91513" author="doronc" created="Mon, 23 Jan 2012 15:31:36 +0000" />
                    <attachment id="12451892" name="pruning.patch" size="81811" author="doronc" created="Thu, 12 Aug 2010 13:12:09 +0100" />
                    <attachment id="12444804" name="pruning.patch" size="60236" author="ab" created="Tue, 18 May 2010 16:18:43 +0100" />
                    <attachment id="12423821" name="pruning.patch" size="55000" author="ab" created="Mon, 2 Nov 2009 14:36:21 +0000" />
                    <attachment id="12416662" name="pruning.patch" size="30397" author="ab" created="Sat, 15 Aug 2009 15:58:42 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>6.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Fri, 6 Nov 2009 18:36:18 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2975</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25914</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
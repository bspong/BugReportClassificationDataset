<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:04:07 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-908/LUCENE-908.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-908] MANIFEST.MF cleanup (main jar and luci customizations)</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-908</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;there are several problems with the MANIFEST.MF file used in the core jar, and some inconsistencies in th luci jar:&lt;/p&gt;

&lt;p&gt;Lucli&apos;s build.xml has an own &quot;jar&quot; target and does not use the jar target from common-build.xml. The result&lt;br/&gt;
is that the MANIFEST.MF file is not consistent and the META-INF dir does not contain LICENSE.TXT and NOTICE.TXT.&lt;/p&gt;

&lt;p&gt;Is there a reason why lucli behaves different in this regard? If not I think we should fix this.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12370964">LUCENE-908</key>
            <summary>MANIFEST.MF cleanup (main jar and luci customizations)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="michaelbusch">Michael Busch</assignee>
                                <reporter username="michaelbusch">Michael Busch</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jun 2007 21:45:37 +0100</created>
                <updated>Fri, 25 Jan 2008 03:23:57 +0000</updated>
                    <resolved>Thu, 23 Aug 2007 00:18:10 +0100</resolved>
                                            <fixVersion>2.3</fixVersion>
                                <component>general/build</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12501702" author="steven_parkes" created="Tue, 5 Jun 2007 22:41:49 +0100"  >&lt;p&gt;I&apos;m pretty sure it&apos;s to get the stuff that&apos;s in the MANIFEST.MF in there: the Main-Class header, in particular. With this, you can say java -jar jar w/o having to specify the main class.&lt;/p&gt;

&lt;p&gt;Probably simplest just to also add the necessary files/lines manually? It&apos;s not DRY with the code common-build.xml, but it&apos;s simple for an uncommon case.&lt;/p&gt;</comment>
                    <comment id="12501711" author="hossman" created="Tue, 5 Jun 2007 22:56:44 +0100"  >&lt;p&gt;the existing jar logic in common-build.xml could be refacotred into a macro with a a nested tag option so that contribs could add additional items, that would probably be the cleanest way to support MANIFEST.MF add ons.&lt;/p&gt;

&lt;p&gt;on a related subject, when i was setting up the solr MANIFEST.MF i discovered lots of things are &quot;wrong&quot; about the way Lucene&apos;s MANIFEST file is built (aparently i never raised them in lucene-java, or if i did we never did anythng about them), here are the comments from Solr&apos;s build.xml that we may also want to fix...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc/lucene/solr/trunk/build.xml&quot; class=&quot;external-link&quot;&gt;http://svn.apache.org/viewvc/lucene/solr/trunk/build.xml&lt;/a&gt;&lt;br/&gt;
        &amp;lt;!--&lt;br/&gt;
        &lt;a href=&quot;http://java.sun.com/j2se/1.5.0/docs/guide/jar/jar.html#JAR%20Manifest&quot; class=&quot;external-link&quot;&gt;http://java.sun.com/j2se/1.5.0/docs/guide/jar/jar.html#JAR%20Manifest&lt;/a&gt;&lt;br/&gt;
        &lt;a href=&quot;http://java.sun.com/j2se/1.5.0/docs/guide/versioning/spec/versioning2.html&quot; class=&quot;external-link&quot;&gt;http://java.sun.com/j2se/1.5.0/docs/guide/versioning/spec/versioning2.html&lt;/a&gt;&lt;br/&gt;
        &lt;a href=&quot;http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Package.html&quot; class=&quot;external-link&quot;&gt;http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Package.html&lt;/a&gt;&lt;br/&gt;
        &lt;a href=&quot;http://java.sun.com/j2se/1.5.0/docs/api/java/util/jar/package-summary.html&quot; class=&quot;external-link&quot;&gt;http://java.sun.com/j2se/1.5.0/docs/api/java/util/jar/package-summary.html&lt;/a&gt;&lt;br/&gt;
        &lt;a href=&quot;http://java.sun.com/developer/Books/javaprogramming/JAR/basics/manifest.html&quot; class=&quot;external-link&quot;&gt;http://java.sun.com/developer/Books/javaprogramming/JAR/basics/manifest.html&lt;/a&gt;&lt;br/&gt;
        --&amp;gt;&lt;br/&gt;
        &amp;lt;!-- Don&apos;t set &apos;Manifest-Version&apos; it identifies the version of the&lt;br/&gt;
             manifest file format, and should allways be 1.0 (the default)&lt;/p&gt;

&lt;p&gt;             Don&apos;t set &apos;Created-by&apos; attribute, it&apos;s purpose is &lt;br/&gt;
             to identify the version of java used to build the jar,&lt;br/&gt;
             which ant will do by default.&lt;/p&gt;

&lt;p&gt;             Ant will happily override these with bogus strings if you&lt;br/&gt;
             tell it to, so don&apos;t.&lt;/p&gt;

&lt;p&gt;             NOTE: we don&apos;t use section info because all of our manifest data&lt;br/&gt;
             applies to the entire jar/war ... no package specific info.&lt;br/&gt;
        --&amp;gt;&lt;br/&gt;
        &amp;lt;!-- spec version must match &quot;digit+&lt;/p&gt;
{.digit+}
&lt;p&gt;*&quot; --&amp;gt;&lt;br/&gt;
        &amp;lt;!-- impl version can be any string --&amp;gt;&lt;/p&gt;





</comment>
                    <comment id="12501713" author="michaelbusch" created="Tue, 5 Jun 2007 23:04:24 +0100"  >&lt;p&gt;Hi Hoss,&lt;/p&gt;

&lt;p&gt;I think this makes sense. It would be great if you could provide a patch here?&lt;/p&gt;</comment>
                    <comment id="12501757" author="hossman" created="Wed, 6 Jun 2007 01:39:53 +0100"  >&lt;p&gt;quick pass at adopting some of the stuff i learned doing the Solr MANIFEST.MF ... i haven&apos;t tested it extensively (Michael i&apos;m hoping you can take the ball and run with it, i&apos;ve got about a million other things going on at the moment)&lt;/p&gt;

&lt;p&gt;note: it was a while ago when i looked into all of this MANIFEST stuff and i&apos;m not sure i fully understood it then, let alone now.&lt;/p&gt;

&lt;p&gt;patch moves jaring into a new macro (jarify) ... contribs can override the &quot;jar-core&quot; target to call jarify and override some options as well as add new &amp;lt;attributes&amp;gt; to appear in the manifest file.&lt;/p&gt;

&lt;p&gt;manifest now includes a lot more information then it did before.&lt;/p&gt;

&lt;p&gt;things this doesn&apos;t address...&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;manifest file in demo war file&lt;/li&gt;
	&lt;li&gt;manifest file in any of gdata&apos;s jars/war (it doesn&apos;t use the contrib-build.xml either)&lt;/li&gt;
	&lt;li&gt;spec version must match &quot;digit+
{.digit+}
&lt;p&gt;*&quot; ... this is true for our official releases, but broken in our nightlies.&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;need to svn remove the existing luci MANIFEST file&lt;/li&gt;
	&lt;li&gt;should luci&apos;s &quot;Class-Path&quot; refer to the full name of the lucene core jar?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12501798" author="michaelbusch" created="Wed, 6 Jun 2007 06:46:37 +0100"  >&lt;p&gt;&amp;gt; Michael i&apos;m hoping you can take the ball and run with it,&lt;/p&gt;

&lt;p&gt;Thanks for the pass, Hoss, I&apos;m already running...&lt;/p&gt;</comment>
                    <comment id="12502040" author="michaelbusch" created="Wed, 6 Jun 2007 19:58:09 +0100"  >&lt;p&gt;&amp;gt; * manifest file in any of gdata&apos;s jars/war (it doesn&apos;t use the contrib-build.xml either) &lt;br/&gt;
&amp;gt; * should luci&apos;s &quot;Class-Path&quot; refer to the full name of the lucene core jar? &lt;/p&gt;

&lt;p&gt;I would like to ask the contrib owners to take care of these issues.&lt;/p&gt;

&lt;p&gt;&amp;gt; * spec version must match &quot;digit+&lt;/p&gt;
{.digit+}
&lt;p&gt;*&quot; ... this is true for our official releases, &lt;br/&gt;
&amp;gt;   but broken in our nightlies. &lt;/p&gt;

&lt;p&gt;I will leave this for now as this patch doesn&apos;t change the spec version.&lt;/p&gt;

&lt;p&gt;&amp;gt; * need to svn remove the existing luci MANIFEST file &lt;br/&gt;
&amp;gt; * manifest file in demo war file &lt;/p&gt;

&lt;p&gt;Will take care...&lt;/p&gt;</comment>
                    <comment id="12502060" author="michaelbusch" created="Wed, 6 Jun 2007 20:38:50 +0100"  >&lt;p&gt;In addition to Hoss&apos; great patch this one:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;changes the MANIFEST file in the demo jar and war in a consistent way&lt;/li&gt;
	&lt;li&gt;adds a patternset via refid to the metainf type of jarify. This can&lt;br/&gt;
  be used by contrib modules to add additional files to the META-INF dir.&lt;br/&gt;
  I use it to add SNOWBALL-LICENSE.txt to META-INF of the snowball jar.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;m planning to commit this soon.&lt;/p&gt;</comment>
                    <comment id="12502104" author="hossman" created="Wed, 6 Jun 2007 22:11:19 +0100"  >&lt;p&gt;A couple of random thoughts...&lt;/p&gt;

&lt;p&gt;1) macro&apos;s can take multiple optional named &amp;lt;element&amp;gt; tags to embed in their bodies ... so instead of declaring a refid for what to include in the metinf, callers of the macro could put &amp;lt;metainf&amp;gt; call directly in the call to &amp;lt;jarify&amp;gt;&lt;/p&gt;

&lt;p&gt;2) one way to reduce some redundancy in the build files (between jar-core, jar-demo, and war-demo) might be to use the &amp;lt;manifest&amp;gt; task instead of the &amp;lt;manifest&amp;gt; sub element of the &amp;lt;jar&amp;gt; task ... there are a few subtle differences but the main key is that the &amp;lt;manifest&amp;gt; taks let&apos;s you build up a file which you can then refer to by name from the &amp;lt;jar&amp;gt; task ... we could have a single &amp;lt;buildmanifest&amp;gt; macro with all of the common attributes in it and then it could be called from the various jar/war targets just before building the actual jar using attributes and &amp;lt;element&amp;gt; tags to customize things that need to be different. &lt;/p&gt;


&lt;p&gt;...neither of these are crucial, they&apos;re just things you might want to consider to keep the build files smaller (and arguably simpler)&lt;/p&gt;</comment>
                    <comment id="12502156" author="michaelbusch" created="Thu, 7 Jun 2007 01:27:32 +0100"  >&lt;p&gt;As always these are very good recommendations Hoss! I think I will commit my patch for 2.2, because it works fine. But I will leave this issue open (just clear the Fix version) to keep in mind that we want to make these improvements.&lt;/p&gt;</comment>
                    <comment id="12502159" author="michaelbusch" created="Thu, 7 Jun 2007 01:50:23 +0100"  >&lt;p&gt;Patch committed. Leaving this issue open for the simplifications suggested by Hoss.&lt;/p&gt;</comment>
                    <comment id="12520967" author="michaelbusch" created="Sun, 19 Aug 2007 18:11:38 +0100"  >&lt;p&gt;This patch:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;removes the patternset &quot;metainf.includes&quot;; adds the optional element &amp;lt;metainf-includes&amp;gt; to the body of jarify&lt;/li&gt;
	&lt;li&gt;adds the macro &quot;build-manifest&quot; to common-build.xml to remove redundant code from the demo targets&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12521961" author="michaelbusch" created="Thu, 23 Aug 2007 00:18:10 +0100"  >&lt;p&gt;Committed. Revision: 568766&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12364108" name="lucene-908-new.patch" size="15508" author="michaelbusch" created="Sun, 19 Aug 2007 18:11:38 +0100" />
                    <attachment id="12359104" name="lucene-908.patch" size="11012" author="michaelbusch" created="Wed, 6 Jun 2007 20:38:50 +0100" />
                    <attachment id="12359014" name="LUCENE-908.patch" size="4645" author="hossman" created="Wed, 6 Jun 2007 01:39:53 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 5 Jun 2007 21:41:49 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12834</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26821</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
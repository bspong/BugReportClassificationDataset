<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:28:42 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1571/LUCENE-1571.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1571] DistanceFilter problem with deleted documents</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1571</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;I know this is the locallucene lib, but wanted to make sure we don&apos;t get this bug when it gets into lucene contrib.&lt;/p&gt;

&lt;p&gt;I suspect that the issue is that deleted documents are trying to be evaluated by the filter.  I did some debugging and I confirmed that it is bombing on a document that is marked as deleted (using Luke).&lt;/p&gt;


&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;Using the locallucene library 1.51, I get a NullPointerException at line 123 of DistanceFilter&lt;br/&gt;
The method is 	public BitSet bits(IndexReader reader) &lt;br/&gt;
The line is double x = NumberUtils.SortableStr2double(sx);&lt;/p&gt;

&lt;p&gt;The stack trace is:&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.solr.util.NumberUtils.SortableStr2long(NumberUtils.java:149)&lt;br/&gt;
	at org.apache.solr.util.NumberUtils.SortableStr2double(NumberUtils.java:104)&lt;br/&gt;
	at com.pjaol.search.geo.utils.DistanceFilter.bits(DistanceFilter.java:123)&lt;br/&gt;
	at org.apache.lucene.search.Filter.getDocIdSet(Filter.java:49)&lt;br/&gt;
	at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:140)&lt;br/&gt;
	at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:112)&lt;br/&gt;
	at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:113)&lt;br/&gt;
	at org.apache.lucene.search.Hits.&amp;lt;init&amp;gt;(Hits.java:90)&lt;br/&gt;
	at org.apache.lucene.search.Searcher.search(Searcher.java:72)&lt;/p&gt;</description>
                <environment>&lt;p&gt;N/A&lt;/p&gt;</environment>
            <key id="12419363">LUCENE-1571</key>
            <summary>DistanceFilter problem with deleted documents</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="rhodebump">Phillip Rhodes</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Mar 2009 03:32:44 +0000</created>
                <updated>Fri, 25 Sep 2009 17:23:20 +0100</updated>
                    <resolved>Sun, 14 Jun 2009 16:47:34 +0100</resolved>
                                            <fixVersion>2.9</fixVersion>
                                <component>modules/spatial</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12718276" author="markrmiller@gmail.com" created="Thu, 11 Jun 2009 03:13:59 +0100"  >&lt;p&gt;Can someone that knows LocalLucene comment on whether this needs to be fixed for 2.9?&lt;/p&gt;</comment>
                    <comment id="12719258" author="mikemccand" created="Sun, 14 Jun 2009 14:23:52 +0100"  >&lt;p&gt;Indeed, this bug looks like it&apos;s still present, in LatLongDistanceFilter.java.  That bits() method simply iterates through all docs, looking up &amp;amp; parsing lat/lng.&lt;/p&gt;

&lt;p&gt;I&apos;ll change it to use a TermDocs(null) iter instead, which won&apos;t visit deleted docs.&lt;/p&gt;</comment>
                    <comment id="12719263" author="mikemccand" created="Sun, 14 Jun 2009 14:50:29 +0100"  >&lt;p&gt;OK I fixed it by switching to TermDocs(null), and also found another bug in the process (an accidental leftover copy/paste &lt;tt&gt;i = bits.nextSetBit(i+1)&lt;/tt&gt; in the non-chained case).  I also fixed the chained case to avoid deleted docs.  I plan to commit in a day or two.&lt;/p&gt;</comment>
                    <comment id="12719272" author="pjaol" created="Sun, 14 Jun 2009 15:35:21 +0100"  >&lt;p&gt;patch looks good to me, tests passed as well&lt;/p&gt;</comment>
                    <comment id="12719290" author="mikemccand" created="Sun, 14 Jun 2009 16:43:49 +0100"  >&lt;p&gt;OK thanks for reviewing Patrick.  I&apos;ll commit shortly...&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12410572" name="LUCENE-1571.patch" size="4546" author="mikemccand" created="Sun, 14 Jun 2009 14:50:29 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 11 Jun 2009 02:13:59 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12184</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26158</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
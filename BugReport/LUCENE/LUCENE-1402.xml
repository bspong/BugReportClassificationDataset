<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:05:02 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1402/LUCENE-1402.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1402] CheckIndex API changed without backwards compaitibility</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1402</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;The API of CheckIndex changed. The Check function returns a CheckIndexStatus and not boolean. And JavaDocs notes the boolean return value.&lt;/p&gt;

&lt;p&gt;I am not sure if it works, but it would be good to have the check method that returns boolean available @Deprecated, i.e.&lt;br/&gt;
@Deprecated public static CheckIndexStatus check(Directory dir, boolean doFix) throws IOException {&lt;br/&gt;
 final CheckIndexStatus stat=this.check(dir,doFix);&lt;br/&gt;
 return stat.clean;&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;I am not sure, if it can be done with the same method name, but it prevents drop-in-replacements of Lucene to work.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12404954">LUCENE-1402</key>
            <summary>CheckIndex API changed without backwards compaitibility</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Sep 2008 13:17:21 +0100</created>
                <updated>Sat, 11 Oct 2008 13:49:42 +0100</updated>
                    <resolved>Thu, 25 Sep 2008 10:45:16 +0100</resolved>
                            <version>2.4</version>
                                <fixVersion>2.4</fixVersion>
                <fixVersion>2.9</fixVersion>
                                <component>core/index</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12633785" author="mikemccand" created="Tue, 23 Sep 2008 17:25:13 +0100"  >&lt;p&gt;Good point &amp;#8211; I&apos;ll restore the old one &amp;amp; rename the new one. This happened with &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1354&quot; title=&quot;Provide Programmatic Access to CheckIndex&quot;&gt;&lt;del&gt;LUCENE-1354&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    <comment id="12633808" author="mikemccand" created="Tue, 23 Sep 2008 18:13:14 +0100"  >&lt;p&gt;Attached patch.  I plan to commit later today.&lt;/p&gt;

&lt;p&gt;I renamed the new methods to checkIndex, deprecated the old ones, and fix their javadocs.&lt;/p&gt;

&lt;p&gt;I also added javadocs for CheckIndexStatus, plus a warning that this API is new &amp;amp; experimental and subject to change.&lt;/p&gt;

&lt;p&gt;I also changed thew CheckIndexStatus.newSegments to be package protected, since its type is SegmentInfos which is not public.&lt;/p&gt;</comment>
                    <comment id="12633812" author="thetaphi" created="Tue, 23 Sep 2008 18:25:14 +0100"  >&lt;p&gt;I did not realize about &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1354&quot; title=&quot;Provide Programmatic Access to CheckIndex&quot;&gt;&lt;del&gt;LUCENE-1354&lt;/del&gt;&lt;/a&gt;, so I am a little bit late with my concerns. In my opinion, the way how CheckIndex is implemented, is not the cleanest obect-oriented way. It looks like a standard console program, what it was at the beginning, but not like a tool for use in other tools (like startup or maintenance tasks of Solr or my project panFMP). There is one problem:&lt;/p&gt;

&lt;p&gt;We have a &lt;b&gt;static&lt;/b&gt; variable pointing to the output Stream. As this variable is static, it is everywhere the same. If I want to create a web application that checks two indexes and this maybe in parallel (because two users started the check index task), I cannot redirect the output stream to an individual &quot;console&quot; (e.g. the servlet output stream).&lt;/p&gt;

&lt;p&gt;In my opinion, to be a handy tool, there should be some minor changes:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the class should have an public constructor getting the Directory&lt;/li&gt;
	&lt;li&gt;a public method to set the output stream for the instance (like IndexWriter does with setInfoStream())&lt;/li&gt;
	&lt;li&gt;the check/fix methods as instance methods&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The main() method (which must stay static, which is clear) and the two static and deprecated methods, should instantiate an CheckIndex instance and call the methods using System.err&lt;/p&gt;</comment>
                    <comment id="12633814" author="thetaphi" created="Tue, 23 Sep 2008 18:32:05 +0100"  >&lt;p&gt;In principle, by making each Checkindex an instance, you would also not need the CheckIndexStatus class, the variables could be members of CheckIndex, the usage would be:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;instantiate CheckIndex with Directory&lt;/li&gt;
	&lt;li&gt;boolean ok=check&lt;/li&gt;
	&lt;li&gt;if (!ok) fix()&lt;/li&gt;
	&lt;li&gt;close checkindex instance&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;For backwards compatibility, the main() and two static methods could do exactly this. For more detailed status info, look into instance variables.&lt;/p&gt;</comment>
                    <comment id="12633821" author="thetaphi" created="Tue, 23 Sep 2008 18:43:14 +0100"  >&lt;p&gt;And I found a bug in CheckIndex.checkIndex(): the boolean parameter &quot;fix&quot; is not used, you must always manually call fix() after checking, so this parameter is useless!&lt;/p&gt;</comment>
                    <comment id="12633840" author="mikemccand" created="Tue, 23 Sep 2008 19:48:05 +0100"  >&lt;p&gt;Good comments all around Uwe; I&apos;ll work out a new patch!  Thanks.&lt;/p&gt;</comment>
                    <comment id="12633851" author="thetaphi" created="Tue, 23 Sep 2008 20:15:47 +0100"  >&lt;p&gt;I hope you did not start to do a patch. I created one, that contains all the comments and fixes also some bugs:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the parameter fix in static method remove&lt;/li&gt;
	&lt;li&gt;if infoStream/out==null NPE&apos;s at different positions&lt;/li&gt;
	&lt;li&gt;main() does not set output stream, so main() does not show any messages&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;It is not completely tested, but it compiles correct and works for me (using the API, not main()). &lt;br/&gt;
So it needs intensive testing, but should be OK.&lt;/p&gt;

&lt;p&gt;Maybe rename method fix() to fixIndex() in comparison to checkIndex().&lt;/p&gt;</comment>
                    <comment id="12633858" author="mikemccand" created="Tue, 23 Sep 2008 20:30:09 +0100"  >&lt;p&gt;Thanks Uwe.  I&apos;ll merge yours with mine and post a new one.&lt;/p&gt;</comment>
                    <comment id="12633935" author="mikemccand" created="Tue, 23 Sep 2008 23:15:02 +0100"  >&lt;p&gt;OK I merged the two patches.&lt;/p&gt;

&lt;p&gt;Uwe, I prefer to keep CheckIndexStatus as a separate class: I don&apos;t like that after you create a new CheckIndex and before you call checkIndex, all of these members are undefined.  I&apos;d like to keep CheckIndex itself stateless (except for its infoStream).&lt;/p&gt;

&lt;p&gt;Otherwise I think everything is merged!&lt;/p&gt;</comment>
                    <comment id="12634060" author="thetaphi" created="Wed, 24 Sep 2008 09:15:57 +0100"  >&lt;p&gt;Patch looks OK. In my opinion, for consistency, the fix() method should spell fixIndex() like checkIndex().&lt;br/&gt;
Maybe the CheckIndexStatus class could be an inner class like the others.&lt;/p&gt;</comment>
                    <comment id="12634064" author="mikemccand" created="Wed, 24 Sep 2008 09:49:46 +0100"  >&lt;blockquote&gt;&lt;p&gt;In my opinion, for consistency, the fix() method should spell fixIndex() like checkIndex().&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;OK I&apos;ll do this.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Maybe the CheckIndexStatus class could be an inner class like the others. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;And this too.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                    <comment id="12634082" author="mikemccand" created="Wed, 24 Sep 2008 10:50:00 +0100"  >&lt;p&gt;OK new rev of patch with changes above folded in!&lt;/p&gt;</comment>
                    <comment id="12634421" author="mikemccand" created="Thu, 25 Sep 2008 10:45:16 +0100"  >&lt;p&gt;Committed revision 698909 on trunk (2.9) and 698911 on 2.4.  Thanks Uwe!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12390822" name="LUCENE-1402.patch" size="24989" author="mikemccand" created="Wed, 24 Sep 2008 10:50:00 +0100" />
                    <attachment id="12390793" name="LUCENE-1402.patch" size="20021" author="mikemccand" created="Tue, 23 Sep 2008 23:15:02 +0100" />
                    <attachment id="12390769" name="LUCENE-1402.patch" size="10338" author="mikemccand" created="Tue, 23 Sep 2008 18:13:13 +0100" />
                    <attachment id="12390775" name="LUCENE-1402-uwe.patch" size="21611" author="thetaphi" created="Tue, 23 Sep 2008 20:15:47 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>4.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 23 Sep 2008 16:25:13 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12349</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26326</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
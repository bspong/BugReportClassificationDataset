<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:24:07 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2484/LUCENE-2484.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2484] Remove deprecated TermAttribute from tokenattributes and legacy support in indexer</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2484</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;The title says it:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Remove interface TermAttribute&lt;/li&gt;
	&lt;li&gt;Remove empty fake implementation TermAttributeImpl extends CharTermAttributeImpl&lt;/li&gt;
	&lt;li&gt;Remove methods from CharTermAttributeImpl (and indirect from Token)&lt;/li&gt;
	&lt;li&gt;Remove sophisticated&#174; backwards&#8482; Layer in TermsHash*&lt;/li&gt;
	&lt;li&gt;Remove IAE from NumericTokenStream, if TA is available in AS&lt;/li&gt;
	&lt;li&gt;Fix rest of core tests (TestToken)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
            <key id="12465861">LUCENE-2484</key>
            <summary>Remove deprecated TermAttribute from tokenattributes and legacy support in indexer</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Jun 2010 13:51:17 +0100</created>
                <updated>Fri, 10 May 2013 11:43:10 +0100</updated>
                    <resolved>Tue, 8 Jun 2010 12:28:26 +0100</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12874002" author="thetaphi" created="Tue, 1 Jun 2010 14:45:59 +0100"  >&lt;p&gt;So after hours of waiting:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Lucene Core, Contrib is fine&lt;/li&gt;
	&lt;li&gt;Modules fine&lt;/li&gt;
	&lt;li&gt;Solr core works&lt;/li&gt;
	&lt;li&gt;&lt;b&gt;Solr carrot2 is broken and this is not fixable!&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Its broken by itsself:&lt;br/&gt;
The contrib module for carrot clustering depends on carrot, but carrot itsself depends on an older version of Lucene! We only have the binary, so we cannot fix it:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.NoClassDefFoundError: org/apache/lucene/analysis/tokenattributes/TermAttribute
	at org.carrot2.text.analysis.ExtendedWhitespaceTokenizer.&amp;amp;lt;init&amp;amp;gt;(ExtendedWhitespaceTokenizer.java:53)
	at org.carrot2.text.analysis.ExtendedWhitespaceAnalyzer.tokenStream(ExtendedWhitespaceAnalyzer.java:28)
	at org.carrot2.text.analysis.ActiveLanguageAnalyzer.tokenStream(ActiveLanguageAnalyzer.java:53)
	at org.carrot2.text.preprocessing.Tokenizer.tokenize(Tokenizer.java:171)
	at org.carrot2.text.preprocessing.PreprocessingPipeline.preprocess(PreprocessingPipeline.java:96)
	at org.carrot2.text.preprocessing.PreprocessingPipeline.preprocess(PreprocessingPipeline.java:87)
	at org.carrot2.clustering.lingo.LingoClusteringAlgorithm.process(LingoClusteringAlgorithm.java:155)
	at org.carrot2.core.ControllerUtils.performProcessing(ControllerUtils.java:95)
	at org.carrot2.core.ControllerUtils.performProcessing(ControllerUtils.java:138)
	at org.carrot2.core.CachingController.processInternal(CachingController.java:279)
	at org.carrot2.core.CachingController.process(CachingController.java:224)
	at org.apache.solr.handler.clustering.carrot2.CarrotClusteringEngine.cluster(CarrotClusteringEngine.java:78)
	at org.apache.solr.handler.clustering.ClusteringComponent.process(ClusteringComponent.java:75)
	at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:195)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)
	at org.apache.solr.handler.clustering.ClusteringComponentTest.testComponent(ClusteringComponentTest.java:57)
Caused by: java.lang.ClassNotFoundException: org.apache.lucene.analysis.tokenattributes.TermAttribute
	at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
	at java.security.AccessController.doPrivileged(Native Method)
	at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:248)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We cannot move forward in breaking backwards in trunk, so I suggest to disable this contrib in trunk! We can only support it if, it moves to Lucene/Solr in complete and we have the source code in solr&apos;s SVN.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                    <comment id="12874004" author="rcmuir" created="Tue, 1 Jun 2010 14:46:56 +0100"  >&lt;blockquote&gt;&lt;p&gt;We cannot move forward in breaking backwards in trunk, so I suggest to disable this contrib in trunk!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                    <comment id="12874008" author="stanislaw.osinski" created="Tue, 1 Jun 2010 14:56:02 +0100"  >&lt;p&gt;Hi!&lt;/p&gt;

&lt;p&gt;Against which version of Lucene should we refactor/ build Carrot2 to fix the issue? Does it have to be trunk?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;S.&lt;/p&gt;</comment>
                    <comment id="12874012" author="thetaphi" created="Tue, 1 Jun 2010 15:02:14 +0100"  >&lt;blockquote&gt;&lt;p&gt;Against which version of Lucene should we refactor/ build Carrot2 to fix the issue? Does it have to be trunk?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is against Solr &lt;b&gt;trunk&lt;/b&gt;, what does the question mean? This is marked deprecated in branch_3x, so you have to fix it&lt;/p&gt;

&lt;p&gt;The whole thing is broken per se:&lt;br/&gt;
&lt;b&gt;Solr trunk cannot depend on external APIs that itsself depend on older Lucene APIs&lt;/b&gt;&lt;/p&gt;</comment>
                    <comment id="12874015" author="rcmuir" created="Tue, 1 Jun 2010 15:09:08 +0100"  >&lt;p&gt;Since this clustering contrib depends on binary files that are tied to specific versions of the Lucene API,&lt;br/&gt;
I suggest the following:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;only enable clustering in release branches (such as 3x)&lt;/li&gt;
	&lt;li&gt;when we cut a new release branch from trunk (say we make a 4x), then add the new version there that works with it.&lt;/li&gt;
	&lt;li&gt;but never have this enabled in trunk, as it is a cyclic dependency&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;the problem is, further changes might happen in trunk as it is backwards-incompatible.&lt;/p&gt;

&lt;p&gt;as a realistic theoretical example, we might all decide to move to write-once attributes API (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2450&quot; title=&quot;Explore write-once attr bindings in the analysis chain&quot;&gt;LUCENE-2450&lt;/a&gt;). &lt;br/&gt;
In this case perhaps Uwe writes a sophisticated &#174; backwards for 3x, to enable easy migration, &lt;br/&gt;
but then the old TokenStream API itself would be deprecated in 3x and removed in trunk so we can keep going.&lt;/p&gt;</comment>
                    <comment id="12874017" author="thetaphi" created="Tue, 1 Jun 2010 15:10:38 +0100"  >&lt;p&gt;Additionally:&lt;br/&gt;
I will commit this soon. I dont care on external APIs. This is &lt;b&gt;trunk&lt;/b&gt; and as discussed in the mailing list: Lucene trunk is no longer backwards compatible!&lt;/p&gt;

&lt;p&gt;So: This contrib has to be removed from solr trunk! This contrib is part of carrot, so why is it in Solr&apos;s contrib at all. It&apos;s License itsself is incompatible. We will remove &lt;b&gt;all&lt;/b&gt; deprecated APIs in trunk soon! Whole Lucene &lt;b&gt;trunk&lt;/b&gt; moves to &lt;b&gt;FLEX&lt;/b&gt; APIs now, so this broken at all.&lt;/p&gt;

&lt;p&gt;Sorry, this is outside of this issue, please move this discussion to mailing list!&lt;/p&gt;

&lt;p&gt;Out of Scope:&lt;br/&gt;
As a Lucene-affiliated committer (personally, I dont care of Solr at all and I was against merging Solr+Lucene!), I cannot take care of external binary-only JARs that itsself depend on old Lucene APIs !!!&lt;/p&gt;</comment>
                    <comment id="12874024" author="stanislaw.osinski" created="Tue, 1 Jun 2010 15:19:16 +0100"  >&lt;blockquote&gt;
&lt;p&gt;Since this clustering contrib depends on binary files that are tied to specific versions of the Lucene API,&lt;br/&gt;
I suggest the following:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;only enable clustering in release branches (such as 3x)&lt;/li&gt;
	&lt;li&gt;when we cut a new release branch from trunk (say we make a 4x), then add the new version there that works with it.&lt;/li&gt;
	&lt;li&gt;but never have this enabled in trunk, as it is a cyclic dependency&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;Sounds very good to me, thanks for the explanation!&lt;/p&gt;</comment>
                    <comment id="12874453" author="thetaphi" created="Wed, 2 Jun 2010 07:32:50 +0100"  >&lt;p&gt;Updated patch, that also fixes a bug in NumericTokenStreams isAssignableFrom checks to prevent addition of a CTA subclass. This bug existed before, but its easier to fix here (and not serious).&lt;/p&gt;</comment>
                    <comment id="12876642" author="thetaphi" created="Tue, 8 Jun 2010 12:28:26 +0100"  >&lt;p&gt;Committed revision: 952616&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10032">
                <name>Blocker</name>
                                                <inwardlinks description="is blocked by">
                            <issuelink>
            <issuekey id="12466442">SOLR-1943</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                        <issuelinktype id="10001">
                <name>dependent</name>
                                <outwardlinks description="depends upon">
                            <issuelink>
            <issuekey id="12461305">LUCENE-2372</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12446116" name="LUCENE-2484.patch" size="32494" author="thetaphi" created="Wed, 2 Jun 2010 07:32:50 +0100" />
                    <attachment id="12446021" name="LUCENE-2484.patch" size="30904" author="thetaphi" created="Tue, 1 Jun 2010 13:58:21 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 1 Jun 2010 13:46:56 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11337</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25208</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
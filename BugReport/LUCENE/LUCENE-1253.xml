<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:17:20 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1253/LUCENE-1253.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1253] LengthFilter and other TokenFilters that skip tokens ignore relative positionIncrement</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1253</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;See for reference:&lt;br/&gt;
&lt;a href=&quot;http://www.nabble.com/WordDelimiterFilter%2BLenghtFilter-results-in-termPosition%3D%3D-1-td16306788.html&quot; class=&quot;external-link&quot;&gt;http://www.nabble.com/WordDelimiterFilter%2BLenghtFilter-results-in-termPosition%3D%3D-1-td16306788.html&lt;/a&gt;&lt;br/&gt;
and &lt;a href=&quot;http://www.nabble.com/Lucene---Java-f24284.html&quot; class=&quot;external-link&quot;&gt;http://www.nabble.com/Lucene---Java-f24284.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It seems that LengthFilter (at least) could produce a stream in which the first Token has a positionIncrement of 0, which make CheckIndex and Luke function &quot;Reconstruct&amp;amp;Edit&quot; to generate exception.&lt;/p&gt;

&lt;p&gt;Should something be done to avoid this situation, or could the error be ignored (by allowing Term with a position of -1, and relaxing CheckIndex checks?)&lt;/p&gt;</description>
                <environment></environment>
            <key id="12392675">LUCENE-1253</key>
            <summary>LengthFilter and other TokenFilters that skip tokens ignore relative positionIncrement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="waltersbox">Walter Ferrara</reporter>
                        <labels>
                    </labels>
                <created>Sun, 30 Mar 2008 19:56:30 +0100</created>
                <updated>Mon, 16 May 2011 19:15:52 +0100</updated>
                    <resolved>Sun, 30 Jan 2011 18:30:57 +0000</resolved>
                            <version>2.3.1</version>
                                <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>modules/analysis</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12583486" author="hossman" created="Sun, 30 Mar 2008 22:01:02 +0100"  >&lt;p&gt;the more general question is: should LengthFilter have an option to (or by default) change the position of the Tokens it lets through to be realative the positions of the tokens it strips out.&lt;/p&gt;

&lt;p&gt;ie given a stream of tokens expressed as &amp;lt;term,positionIncrement&amp;gt; ...&lt;/p&gt;

&lt;p&gt;  &amp;lt;a,1&amp;gt; &amp;lt;b,1&amp;gt; &amp;lt;c,1&amp;gt; &amp;lt;ddddd,0&amp;gt; &amp;lt;e,0&amp;gt; &amp;lt;f,2&amp;gt; &amp;lt;ggggg,0&amp;gt; &amp;lt;hhhhhh,1&amp;gt;&lt;/p&gt;

&lt;p&gt;should the resulting stream after using a LengthFilter with min=3 be...&lt;/p&gt;

&lt;p&gt;  &amp;lt;ddddd,0&amp;gt; &amp;lt;ggggg,0&amp;gt; &amp;lt;hhhhhh,1&amp;gt;&lt;/p&gt;

&lt;p&gt;...(which i believe is the current behavior) or should it be...&lt;/p&gt;

&lt;p&gt;   &amp;lt;ddddd,3&amp;gt; &amp;lt;ggggg,2&amp;gt; &amp;lt;hhhhhh,1&amp;gt;&lt;/p&gt;

&lt;p&gt;FWIW: StopFilter seems to have code to handle this (but I haven&apos;t tested that it works correctly)&lt;/p&gt;

&lt;p&gt;The question of whether or not it&apos;s legal for the first token of a stream to have a positionIncrement of &quot;0&quot; is being discussed on the list, most likely if it needs changed, that would be done in IndexWriter DocumentsWriter&lt;/p&gt;</comment>
                    <comment id="12583488" author="hossman" created="Sun, 30 Mar 2008 22:05:02 +0100"  >&lt;p&gt;tweaking issue Summary to describe the more general problem with LengthFilter&lt;/p&gt;</comment>
                    <comment id="12987053" author="thetaphi" created="Wed, 26 Jan 2011 15:27:33 +0000"  >&lt;p&gt;EDIT: &lt;del&gt;Fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1542&quot; title=&quot;Lucene can incorrectly set the position of tokens that start a field with positonInc 0.&quot;&gt;&lt;del&gt;LUCENE-1542&lt;/del&gt;&lt;/a&gt;.&lt;/del&gt;&lt;/p&gt;</comment>
                    <comment id="12987075" author="thetaphi" created="Wed, 26 Jan 2011 16:04:42 +0000"  >&lt;p&gt;After some discussion with Robert, we realized, that all TokenFilters that remove tokens from the stream must preserve the position increment like StopFilter. Else it could also happen that synonyms of a removed token appear as synonyms of the token before the removed one. If the removed one has posIncr=1, this would produce wrong synonyms.&lt;/p&gt;

&lt;p&gt;Two filters that remove tokanes need to be fixed in the same way like StopFilter:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;LengthFilter&lt;/li&gt;
	&lt;li&gt;KeepWordFilter&lt;/li&gt;
	&lt;li&gt;... (find more and add here)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    <comment id="12988602" author="thetaphi" created="Sun, 30 Jan 2011 15:51:35 +0000"  >&lt;p&gt;Patch for the two broekn TokenFilters and refactoring of StopFilter. Also tests improved. No Version was added, instead the whole thing was done like for StopFilter by a ctor boolean. Tests were added for both Lucene and Solr. Also Solr&apos;s KeepWordFilter(+Factory) were changed to respect matchVersion for the CharArraySet. Also synced this filter&apos;s factory with the StopFilterFactory (params, parsing,...).&lt;/p&gt;

&lt;p&gt;After commit to 3.x I will port to trunk - oh no &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12988606" author="thetaphi" created="Sun, 30 Jan 2011 16:49:05 +0000"  >&lt;p&gt;After discussion with Robert, we optimized the code of incrementToken() in the base class a little bit to reduce number of branches and method calls for the common cases.&lt;/p&gt;</comment>
                    <comment id="12988609" author="rcmuir" created="Sun, 30 Jan 2011 17:06:19 +0000"  >&lt;p&gt;+1, this looks really good.&lt;/p&gt;

&lt;p&gt;I looked for other filters, the only other one this could apply to is ChineseFilter, but this one is deprecated&lt;br/&gt;
and we should just leave it alone (it exists for index backwards compatibility only).&lt;/p&gt;</comment>
                    <comment id="12988612" author="thetaphi" created="Sun, 30 Jan 2011 17:21:25 +0000"  >&lt;p&gt;Committed 3.x revision: 1065324&lt;/p&gt;

&lt;p&gt;Now porting to trunk, damn!&lt;/p&gt;</comment>
                    <comment id="12988623" author="thetaphi" created="Sun, 30 Jan 2011 18:11:29 +0000"  >&lt;p&gt;Merged patch for trunk, Robert can you review, I am totally clumsy now?&lt;/p&gt;</comment>
                    <comment id="12988628" author="thetaphi" created="Sun, 30 Jan 2011 18:30:57 +0000"  >&lt;p&gt;Committed trunk revision: 1065343&lt;/p&gt;</comment>
                    <comment id="13013297" author="gsingers" created="Wed, 30 Mar 2011 16:49:54 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12392738">LUCENE-1255</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12469779" name="LUCENE-1253-3x.patch" size="20397" author="thetaphi" created="Sun, 30 Jan 2011 16:49:05 +0000" />
                    <attachment id="12469773" name="LUCENE-1253-3x.patch" size="20213" author="thetaphi" created="Sun, 30 Jan 2011 15:51:35 +0000" />
                    <attachment id="12469784" name="LUCENE-1253-trunk.patch" size="17935" author="thetaphi" created="Sun, 30 Jan 2011 18:11:29 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sun, 30 Mar 2008 21:01:02 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12495</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26475</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
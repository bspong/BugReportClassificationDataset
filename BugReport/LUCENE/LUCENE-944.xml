<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:10:29 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-944/LUCENE-944.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-944] Remove deprecated methods in BooleanQuery</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-944</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Remove deprecated methods setUseScorer14 and getUseScorer14 in BooleanQuery, and adapt javadocs.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12372417">LUCENE-944</key>
            <summary>Remove deprecated methods in BooleanQuery</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="michaelbusch">Michael Busch</assignee>
                                <reporter username="paul.elschot@xs4all.nl">Paul Elschot</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Jun 2007 10:26:17 +0100</created>
                <updated>Thu, 2 May 2013 03:29:22 +0100</updated>
                    <resolved>Tue, 13 Oct 2009 19:29:21 +0100</resolved>
                                            <fixVersion>3.0</fixVersion>
                                <component>core/search</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12508119" author="paul.elschot@xs4all.nl" created="Tue, 26 Jun 2007 10:28:17 +0100"  >&lt;p&gt;Patches BooleanQuery only. Tests pass, javadocs build.&lt;/p&gt;</comment>
                    <comment id="12512207" author="michaelbusch" created="Thu, 12 Jul 2007 19:42:04 +0100"  >&lt;p&gt;Committed. Thanks, Paul!&lt;/p&gt;</comment>
                    <comment id="12550149" author="gsingers" created="Mon, 10 Dec 2007 18:47:27 +0000"  >&lt;p&gt;Hmm, I was just trying to compile Luke source against the latest Lucene and am getting compiler errors on this being missing.  Doesn&apos;t this violate our back-compatibility clause or did I miss something?  Don&apos;t we have to wait until 3.0-dev to remove these?&lt;/p&gt;</comment>
                    <comment id="12550412" author="michaelbusch" created="Tue, 11 Dec 2007 12:04:23 +0000"  >&lt;p&gt;You are right, Grant.&lt;/p&gt;

&lt;p&gt;I will revert this for 2.3. Thanks for catching this!!&lt;/p&gt;</comment>
                    <comment id="12761392" author="michaelbusch" created="Fri, 2 Oct 2009 00:10:55 +0100"  >&lt;p&gt;Some test fail with this patch when a MatchAllDocQuery is used, e.g. TestSimpleExplanations.testMA1. skipTo() tries to get the delete bit for a negative document, which throws an Exception of course. This happens for a searcher that contains a MultiReader created by QueryUtils.wrapUnderlyingReader().&lt;/p&gt;

&lt;p&gt;I assume this is related to the change I made in QueryUtils. I need to spend some more time to figure out what exactly leads to this exception. Maybe I&apos;m doing something silly here - I&apos;m still catching up on some changes, such as the out-of-order scoring changes. &lt;/p&gt;

&lt;p&gt;I can&apos;t work on this till Monday, so anyone familiar with these tests feel free to take a look! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12761397" author="markrmiller@gmail.com" created="Fri, 2 Oct 2009 00:24:02 +0100"  >&lt;p&gt;Hoss added some multireader test stuff that counts on where the deletes are if I remember right.&lt;/p&gt;

&lt;p&gt;so &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (BooleanQuery.getAllowDocsOutOfOrder()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;  &lt;span class=&quot;code-comment&quot;&gt;// in &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; order of skipTo() might differ from that of next().
&lt;/span&gt;+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (q.weight(s).scoresDocsOutOfOrder()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;  &lt;span class=&quot;code-comment&quot;&gt;// in &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; order of skipTo() might differ from that of next().&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;must not be exactly equiv and where it wasn&apos;t scoring out of order for this test, now it is, or vice versa (I havn&apos;t looked closely).&lt;/p&gt;</comment>
                    <comment id="12761401" author="michaelbusch" created="Fri, 2 Oct 2009 00:32:18 +0100"  >&lt;p&gt;Yeah I figured it has to do with that, but it seems weird to me that a call to scorer.advance() (in QueryUtils, line 348) leads to a ArrayIndexOutOfBoundsException?&lt;/p&gt;</comment>
                    <comment id="12761402" author="markrmiller@gmail.com" created="Fri, 2 Oct 2009 00:32:46 +0100"  >&lt;p&gt;So this was always there - but in the past, because BoolQuery.getAllowOutOfOrder was always returning true for these tests, it didn&apos;t get into the code thats now failing.&lt;/p&gt;

&lt;p&gt;With the replacement, because it only returns true or false based on if its a booleanquery, it gets through there for other queries, and we are seeing the results.&lt;/p&gt;</comment>
                    <comment id="12761403" author="markrmiller@gmail.com" created="Fri, 2 Oct 2009 00:34:14 +0100"  >&lt;blockquote&gt;&lt;p&gt;but it seems weird to me that a call to scorer.advance() (in QueryUtils, line 348) leads to a ArrayIndexOutOfBoundsException?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We had similar issues when we were working on these tests before. Hoss knows how the MultiReader/delete stuff is better than I do though - he wrote it, I just addressed issues/bugs.&lt;/p&gt;</comment>
                    <comment id="12761406" author="thetaphi" created="Fri, 2 Oct 2009 00:40:31 +0100"  >&lt;p&gt;When we change this, don&apos;t forget to remove the 2.9 BW tests that may fail because of this change - whenever we remove deprecated methods, the new 2.9 BW branch must be updated.&lt;/p&gt;</comment>
                    <comment id="12761407" author="markrmiller@gmail.com" created="Fri, 2 Oct 2009 00:41:32 +0100"  >&lt;p&gt;Part of it or all of it is that the tests that are failing are using external ids, which doesn&apos;t work with this multireader stuff (since they are tech illegal, though they worked before per segment). We fixed a bunch of these, but missed these ones, since they didn&apos;t hit these tests. They need to be fixed in the same manner.&lt;/p&gt;</comment>
                    <comment id="12761421" author="markrmiller@gmail.com" created="Fri, 2 Oct 2009 01:15:50 +0100"  >&lt;p&gt;A second part is that there looks to be some insane fieldcache usage that needs to be fixed in these tests - again, because the code wasn&apos;t hit before, we didn&apos;t see it before ...&lt;/p&gt;

&lt;p&gt;I just keep randomly taking peeks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12761424" author="michaelbusch" created="Fri, 2 Oct 2009 01:24:55 +0100"  >&lt;blockquote&gt;
&lt;p&gt;So this was always there - but in the past, because BoolQuery.getAllowOutOfOrder was always returning true for these tests, it didn&apos;t get into the code thats now failing. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Exactly. &lt;/p&gt;

&lt;p&gt;Now I just hope all bugs are in the tests... &lt;br/&gt;
Sorry, have to leave now. Thanks for your help, Mark! &lt;/p&gt;</comment>
                    <comment id="12761440" author="markrmiller@gmail.com" created="Fri, 2 Oct 2009 02:03:46 +0100"  >&lt;blockquote&gt;&lt;p&gt;Now I just hope all bugs are in the tests...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m pretty sure they are (though obviously I cant gaurantee). Its all stuff Hoss and I saw before and fixed from what I can tell - we just fixed what was causing failures though, so getting past that line is exposing stuff we didn&apos;t handle.&lt;/p&gt;</comment>
                    <comment id="12763742" author="michaelbusch" created="Fri, 9 Oct 2009 00:03:47 +0100"  >&lt;p&gt;Hey Mark, any interest in taking this, since you seem to have experience with fixing those tests? &lt;/p&gt;

&lt;p&gt;Otherwise I&apos;ll continue here later tonight or tomorrow... you&apos;d probably be faster though &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12764848" author="michaelbusch" created="Mon, 12 Oct 2009 22:32:54 +0100"  >&lt;p&gt;All core &amp;amp; contrib tests pass now.&lt;/p&gt;

&lt;p&gt;The problem was QueryUtils#checkSkipTo(). It still performed the checks using a global scorer, which resulted in failures in the FieldCacheSanityChecker. (the same values were cached twice: once for the global reader plus for the per-segment readers).&lt;/p&gt;

&lt;p&gt;QueryUtils#checkFirstSkipTo() was already implemented correctly so that it performs the checks with per-segment scorers.&lt;/p&gt;

&lt;p&gt;I think this is ready to commit now. Mark, do you want to take a look at my checkSkipTo() changes before I commit?&lt;/p&gt;</comment>
                    <comment id="12765156" author="michaelbusch" created="Tue, 13 Oct 2009 18:17:01 +0100"  >&lt;p&gt;Tiny change in QueryUtils#checkSkipTo() to keep it more consistent to how it worked before.&lt;/p&gt;

&lt;p&gt;Also attaching the back-compat patch. Note that I have to make the change to checkSkipTo() there too, because it was not changed before to do the search per-segment. Now more tests actually run this check, exposing this problem.&lt;/p&gt;

&lt;p&gt;All tests pass now.&lt;/p&gt;</comment>
                    <comment id="12765182" author="michaelbusch" created="Tue, 13 Oct 2009 19:29:21 +0100"  >&lt;p&gt;Committed revision 824870.&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10001">
                <name>dependent</name>
                                                <inwardlinks description="is depended upon by">
                            <issuelink>
            <issuekey id="12437819">LUCENE-1973</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12360558" name="BooleanQuery20070626.patch" size="2537" author="paul.elschot@xs4all.nl" created="Tue, 26 Jun 2007 10:28:17 +0100" />
                    <attachment id="12422002" name="lucene-944-bw.patch" size="12977" author="michaelbusch" created="Tue, 13 Oct 2009 18:17:01 +0100" />
                    <attachment id="12422001" name="lucene-944.patch" size="15731" author="michaelbusch" created="Tue, 13 Oct 2009 18:17:01 +0100" />
                    <attachment id="12421912" name="lucene-944.patch" size="15716" author="michaelbusch" created="Mon, 12 Oct 2009 22:32:54 +0100" />
                    <attachment id="12421080" name="lucene-944.patch" size="11394" author="michaelbusch" created="Fri, 2 Oct 2009 00:10:55 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>5.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 12 Jul 2007 18:42:04 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12798</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26785</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
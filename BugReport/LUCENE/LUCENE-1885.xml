<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:07:32 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1885/LUCENE-1885.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1885] NativeFSLockFactory.makeLock(...).isLocked() does not work</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1885</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;IndexWriter.isLocked() or IndexReader.isLocked() do not work with NativeFSLockFactory.&lt;/p&gt;

&lt;p&gt;The problem is, that the method NativeFSLock.isLocked() just checks if the same lock instance was locked before (lock != null). If the LockFactory created a new lock instance, this always returns false, even if its locked.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12434648">LUCENE-1885</key>
            <summary>NativeFSLockFactory.makeLock(...).isLocked() does not work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Sep 2009 16:54:08 +0100</created>
                <updated>Fri, 25 Sep 2009 17:23:38 +0100</updated>
                    <resolved>Thu, 3 Sep 2009 23:18:24 +0100</resolved>
                                            <fixVersion>2.9</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12750536" author="thetaphi" created="Wed, 2 Sep 2009 18:04:39 +0100"  >&lt;p&gt;I will solve this together with &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1877&quot; title=&quot;Use NativeFSLockFactory as default for new API (direct ctors &amp;amp; FSDir.open)&quot;&gt;&lt;del&gt;LUCENE-1877&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;To test, if lock is obtained, you have to try locking and release the lock after that (if the lock was obtained):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isLocked() {
    &lt;span class=&quot;code-comment&quot;&gt;// the test &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; is isLocked is not directly possible with &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt; file locks:
&lt;/span&gt;    
    &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; we have a lock instance in &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; class, it is &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; sure locked:
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lockExists()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
    
    &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to obtain and release (&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; was locked) the lock to test
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; obtained = obtain();
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (obtained) release();
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; !obtained;
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ioe) {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
    }    
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The method lockExists contains the same like isLocked contained before and is used instead to check if a local lock instance is available (as quick break-out).&lt;/p&gt;

&lt;p&gt;There is no patch as it is included in my work for 1877 and hard to unwire.&lt;/p&gt;</comment>
                    <comment id="12750590" author="mikemccand" created="Wed, 2 Sep 2009 19:27:42 +0100"  >&lt;p&gt;Nice catch Uwe!&lt;/p&gt;</comment>
                    <comment id="12750610" author="thetaphi" created="Wed, 2 Sep 2009 19:52:48 +0100"  >&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;It was not so hard. After changing the default lock factory, a lot of tests were failing because of this.&lt;/p&gt;</comment>
                    <comment id="12750841" author="thetaphi" created="Thu, 3 Sep 2009 07:16:30 +0100"  >&lt;p&gt;The new patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1877&quot; title=&quot;Use NativeFSLockFactory as default for new API (direct ctors &amp;amp; FSDir.open)&quot;&gt;&lt;del&gt;LUCENE-1877&lt;/del&gt;&lt;/a&gt; changes the isLocked() method to shortcut, if no lock file is present. In this case, without a lockfile, it cannot be not locked. This prevent NativeFSLock for creating the lock short time without really using it.&lt;/p&gt;</comment>
                    <comment id="12751196" author="thetaphi" created="Thu, 3 Sep 2009 23:18:24 +0100"  >&lt;p&gt;Committed revision: 811157&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="12310010">
                <name>Incorporates</name>
                                                <inwardlinks description="is part of">
                            <issuelink>
            <issuekey id="12434383">LUCENE-1877</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 2 Sep 2009 18:27:42 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11880</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25842</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
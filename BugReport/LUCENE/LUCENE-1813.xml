<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:16:28 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1813/LUCENE-1813.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1813] Add option to ReverseStringFilter to mark reversed tokens</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1813</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;This patch implements additional functionality in the filter to &quot;mark&quot; reversed tokens with a special marker character (Unicode 0001). This is useful when indexing both straight and reversed tokens (e.g. to implement efficient leading wildcards search).&lt;/p&gt;</description>
                <environment></environment>
            <key id="12433156">LUCENE-1813</key>
            <summary>Add option to ReverseStringFilter to mark reversed tokens</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="ab">Andrzej Bialecki </reporter>
                        <labels>
                    </labels>
                <created>Sat, 15 Aug 2009 17:16:00 +0100</created>
                <updated>Mon, 16 May 2011 19:15:28 +0100</updated>
                    <resolved>Wed, 19 Aug 2009 13:08:38 +0100</resolved>
                            <version>2.9</version>
                                <fixVersion>2.9</fixVersion>
                                <component>modules/analysis</component>
                        <due></due>
                    <votes>1</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12743732" author="ab" created="Sat, 15 Aug 2009 17:16:30 +0100"  >&lt;p&gt;Patch and unit tests.&lt;/p&gt;</comment>
                    <comment id="12743737" author="rcmuir" created="Sat, 15 Aug 2009 17:52:31 +0100"  >&lt;p&gt;the corresponding solr task (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1321&quot; title=&quot;Support for efficient leading wildcards search&quot;&gt;&lt;del&gt;SOLR-1321&lt;/del&gt;&lt;/a&gt;) is marked as version 1.4&lt;/p&gt;

&lt;p&gt;does anyone oppose putting this one in 2.9? &lt;/p&gt;</comment>
                    <comment id="12743740" author="rcmuir" created="Sat, 15 Aug 2009 18:07:21 +0100"  >&lt;p&gt;andrzej, the reverse() methods are public, can you supply default impls (withMark=false) just in the case that someone is using them?&lt;/p&gt;

&lt;p&gt;alternatively, maybe the reverse() methods could stay the same, and the marking could happen in incrementToken() ?&lt;/p&gt;</comment>
                    <comment id="12743743" author="ab" created="Sat, 15 Aug 2009 19:08:13 +0100"  >&lt;p&gt;Either way is fine with me. To preserve the public API I think it&apos;s better to move this marking logic to incrementToken(). I&apos;ll prepare an updated patch.&lt;/p&gt;</comment>
                    <comment id="12743765" author="ab" created="Sat, 15 Aug 2009 21:23:16 +0100"  >&lt;p&gt;Updated patch that moves the marking logic to incrementToken().&lt;/p&gt;</comment>
                    <comment id="12743834" author="rcmuir" created="Sun, 16 Aug 2009 12:48:15 +0100"  >&lt;p&gt;thanks Andrzej, i think this patch is ready.&lt;/p&gt;</comment>
                    <comment id="12743916" author="rcmuir" created="Sun, 16 Aug 2009 23:10:16 +0100"  >&lt;p&gt;if no one objects to this one I will commit it tomorrow.&lt;/p&gt;</comment>
                    <comment id="12743918" author="markrmiller@gmail.com" created="Sun, 16 Aug 2009 23:26:19 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                    <comment id="12743926" author="pcowan" created="Mon, 17 Aug 2009 00:29:14 +0100"  >&lt;p&gt;Very very minor thing, but does it make more sense to choose a more suitable character? U+0001 is an assigned character, with some semantic meaning (&quot;Start of Heading&quot;, same as ASCII character 0x01) which isn&apos;t really relevant to this use. It mightn&apos;t be a bad idea to (a) choose a control character which makes sense in context, if there is one (I can&apos;t see one, myself), (b) using a character from the private-use area (U+E000 to U+F8FF) or (c) my preferred option, using the Unicode tag characters. The tag characters are designed for just such a purpose.. embedding contextual metadata in text fields. The general syntax for a tag is &amp;lt;TAG TYPE&amp;gt; followed by one or more &amp;lt;TAG CHARACTER&amp;gt;s. Unfortunately, only one tag type is defined in unicode at present (language tag), which isn&apos;t suitable.&lt;/p&gt;

&lt;p&gt;That said, I think it makes sense (and is probably &apos;nicer&apos;) to pick one of the Unicode tag characters &amp;#8211; say, U+E0052 TAG LATIN CAPITAL LETTER R (for &apos;reverse&apos;) and use that. This could lead to a de facto standard for Lucene fields, where different variations of the same token could use different leading tag characters. Rather than just everyone picking a character at random, this could lead to some sort of structure around similar situations (i.e. I could envisage a filter which uses U+E004E TAG LATIN CAPITAL LETTER N for a normalised version of the token, etc). &lt;/p&gt;

&lt;p&gt;Sorry, I&apos;m really anal about Unicode. Can&apos;t help it.&lt;/p&gt;</comment>
                    <comment id="12743928" author="markrmiller@gmail.com" created="Mon, 17 Aug 2009 00:42:19 +0100"  >&lt;blockquote&gt;&lt;p&gt;Sorry, I&apos;m really anal about Unicode. Can&apos;t help it.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is a full text search engine - we love it!&lt;/p&gt;</comment>
                    <comment id="12743929" author="rcmuir" created="Mon, 17 Aug 2009 00:44:06 +0100"  >&lt;blockquote&gt;
&lt;p&gt;Sorry, I&apos;m really anal about Unicode. Can&apos;t help it.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Me too &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; My problem with tag characters is that they are deprecated.&lt;/p&gt;

&lt;p&gt;I will take your advice and look and see if there is something more suitable. &lt;/p&gt;</comment>
                    <comment id="12743931" author="rcmuir" created="Mon, 17 Aug 2009 00:51:26 +0100"  >&lt;p&gt;another issue, besides the fact they are deprecated, is that tag characters are outside of the BMP. &lt;/p&gt;

&lt;p&gt;Currently, the reverse filter does not properly reverse characters outside of the BMP &lt;span class=&quot;error&quot;&gt;&amp;#91;it does not recognize them as one character&amp;#93;&lt;/span&gt;, &lt;br/&gt;
This means characters such as tag characters will be &apos;reversed&apos; into trail surrogate followed by lead surrogate (two unpaired surrogates).&lt;br/&gt;
But we cannot fix the above, as lucene wildcard support does not recognize codepoints &amp;gt; FFFF as one &apos;character&apos; either.&lt;/p&gt;

&lt;p&gt;If we are gonna pick a character other than U+0001, it needs to be inside the BMP.&lt;/p&gt;</comment>
                    <comment id="12743933" author="pcowan" created="Mon, 17 Aug 2009 01:04:09 +0100"  >&lt;p&gt;Yeah, ok, makes sense.&lt;/p&gt;

&lt;p&gt;I&apos;d suggest choosing a range of Private Use characters from the BMP block then, that&apos;s what they&apos;re for. Doesn&apos;t really matter which... we can pick a block of (say) 256 and use the first one for this, then others can be used for other purposes later if required. U+ECxx, maybe, because that&apos;s got 3 letters out of &apos;lucene&apos; in it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; . So EC00 means &apos;reversed&apos;, and then people who need other similar filters can organise amongst themselves.&lt;/p&gt;</comment>
                    <comment id="12743935" author="rcmuir" created="Mon, 17 Aug 2009 01:10:15 +0100"  >&lt;p&gt;I looked into this and I think using the private use area (U+E000 to U+F8FF) would also not be the best.&lt;br/&gt;
I do not think Lucene should use PUA characters system-internally, besides I have at least a few docs with PUA characters, and I think others will as well.&lt;br/&gt;
We should leave PUA characters available to the end user.&lt;/p&gt;

&lt;p&gt;So personally I have nothing against this U+0001, but I&apos;ll take any recommendations...&lt;/p&gt;</comment>
                    <comment id="12743936" author="rcmuir" created="Mon, 17 Aug 2009 01:18:51 +0100"  >&lt;p&gt;what if we simply make it so there is no boolean option for a marker character, instead it is ReverseFilter() and ReverseFilter(char marker)&lt;br/&gt;
This way, lucene does not define the character used for this operation, and someone can feel free to select whichever they want (such as U+0001)&lt;/p&gt;

&lt;p&gt;When we are on java 5 and can support supp. characters properly (reversing/wildcards,etc), then we can change this to ReverseFilter(int marker) and someone can use anything they want, including outside of the BMP?&lt;/p&gt;

&lt;p&gt;If this is ok, I will supply a patch.&lt;/p&gt;</comment>
                    <comment id="12743937" author="pcowan" created="Mon, 17 Aug 2009 01:27:21 +0100"  >&lt;p&gt;OK, cool. I&apos;m taking an interest in this purely because I have some ideas for other token filters which would do something similar, and really like the idea of tagging them in the same way just with different &apos;headers&apos;. It would be really beneficial, I think, to come up with something that can be reused and, more importantly, combined (so different filters don&apos;t &apos;clash&apos; with their output). What about making it 2 characters, at least? &lt;/p&gt;

&lt;p&gt;U+0001 START OF HEADER&lt;br/&gt;
U+xxxx whatever you like to indicate &apos;reversing&apos; (i.e. an &apos;R&apos;, or just a 0-byte as this is the first purpose allocated, or whatever)&lt;/p&gt;

&lt;p&gt;This adds 2 bytes to each term, not 1, but terms generally don&apos;t take up that much room in the scale of a whole index and I think it&apos;s worth the flexibility. Hell, if you&apos;re willing to use 3 (that IS starting to seem wasteful, I admit) then maybe&lt;/p&gt;

&lt;p&gt;U+0001 START OF HEADER&lt;br/&gt;
U+xxxx whatever&lt;br/&gt;
U+0002 START OF TEXT&lt;/p&gt;

&lt;p&gt;That&apos;s at least semantically meaningful. Other ideas, just looking at the ASCII control characters:&lt;/p&gt;

&lt;p&gt;U+xxxx whatever&lt;br/&gt;
U+001F UNIT SEPARATOR&lt;/p&gt;

&lt;p&gt;or&lt;/p&gt;

&lt;p&gt;U+000E SHIFT OUT&lt;br/&gt;
U+xxxx whatever&lt;br/&gt;
U+000F SHIFT IN&lt;/p&gt;

&lt;p&gt;I don&apos;t really mind, but it&apos;s always nice to plan ahead.&lt;/p&gt;</comment>
                    <comment id="12743938" author="pcowan" created="Mon, 17 Aug 2009 01:28:35 +0100"  >&lt;p&gt;Yes, or +1 on passing in your own marker, that lets everyone choose a character that won&apos;t clash with whatever unicode subset gets used for their tokens.&lt;/p&gt;</comment>
                    <comment id="12743939" author="rcmuir" created="Mon, 17 Aug 2009 01:28:38 +0100"  >&lt;p&gt;Paul ok, how about instead of char, a sequence &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Then you can use however many characters you want...&lt;/p&gt;</comment>
                    <comment id="12743940" author="rcmuir" created="Mon, 17 Aug 2009 01:40:41 +0100"  >&lt;p&gt;updated patch so you can choose your own character for marking.&lt;/p&gt;

&lt;p&gt;if one character is not enough let me know (i suppose we could make it a sequence), but I&apos;d rather keep this simple.&lt;/p&gt;</comment>
                    <comment id="12743943" author="pcowan" created="Mon, 17 Aug 2009 02:12:00 +0100"  >&lt;p&gt;Simple&apos;s good. I&apos;m a happy man, thanks Robert.&lt;/p&gt;</comment>
                    <comment id="12743944" author="rcmuir" created="Mon, 17 Aug 2009 02:17:17 +0100"  >&lt;p&gt;Paul, thanks very much for your feedback... I think its a cleaner change now.&lt;/p&gt;</comment>
                    <comment id="12743983" author="ab" created="Mon, 17 Aug 2009 08:20:25 +0100"  >&lt;p&gt;+1. One comment, perhaps stating the obvious .. I picked char 0001 for two reasons - it&apos;s not likely to be used in regular text, and its UTF-8 encoding uses one byte. The use case for this filter means that it will create more or less as many tokens as there were in the original token stream, thus doubling the size of term dictionary. One byte here, one byte there, and suddenly it matters whether we use 0001 or FFFF ...&lt;/p&gt;</comment>
                    <comment id="12743994" author="tdunning" created="Mon, 17 Aug 2009 09:04:25 +0100"  >
&lt;p&gt;I understand the desire to use a mark that requires fewer bytes, but the unicode bidi marks might be better for the purpose of marking writing direction: (U+200E LTR or U+200F RTL)&lt;/p&gt;

</comment>
                    <comment id="12744023" author="rcmuir" created="Mon, 17 Aug 2009 12:27:54 +0100"  >&lt;p&gt;Ted, with the current patch you can do this: new ReverseStringFilter(&apos;\u200E&apos;), or new ReverseStringFilter(&apos;\u200F&apos;), or new ReverseStringFilter(&apos;\u0001&apos;), or whatever.&lt;/p&gt;

&lt;p&gt;Also, for anyone using this filter its my understanding that each term in lucene&apos;s term dictionary is a &quot;delta&quot; versus the previous term, so the character you choose should not affect its size?&lt;/p&gt;</comment>
                    <comment id="12744062" author="gsingers" created="Mon, 17 Aug 2009 14:47:00 +0100"  >&lt;p&gt;Perhaps it is useful to define a few constants for each of these suggested characters to make it super easy for people to use them?  Just a thought.  Otherwise, I like the idea of passing in your own marker.&lt;/p&gt;</comment>
                    <comment id="12744092" author="dmsmith" created="Mon, 17 Aug 2009 15:58:01 +0100"  >&lt;p&gt;I like the idea of a constant and it presented as a default. I suggest that others be given in the JavaDoc.&lt;/p&gt;

&lt;p&gt;I have some texts which are using PUAs until Unicode includes the code points (e.g. Myanmar text), so I&apos;m glad that allowing a choice doesn&apos;t create a potential conflict there. I think PUA should be left to the text author.&lt;/p&gt;

&lt;p&gt;As my texts are all derived from XML, I like the use of a character that is not allowed in XML. I think 0001 is just fine, even if not from a purity perspective.&lt;/p&gt;

&lt;p&gt;Some of my texts have BIDI markers and while these will be stripped by filters, I don&apos;t think this use is analogous.&lt;/p&gt;
</comment>
                    <comment id="12744184" author="rcmuir" created="Mon, 17 Aug 2009 21:27:12 +0100"  >&lt;p&gt;thanks for your comments guys, I like the idea of constants for some of these suggested characters.&lt;/p&gt;

&lt;p&gt;i will update the patch later tonight if no one wants to tackle it and beat me to it first &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12744335" author="rcmuir" created="Tue, 18 Aug 2009 03:50:09 +0100"  >&lt;p&gt;same as before (you pick your own character), but with some constants for example marker characters, ones mentioned under this issue.&lt;/p&gt;</comment>
                    <comment id="12744586" author="rcmuir" created="Tue, 18 Aug 2009 17:25:19 +0100"  >&lt;p&gt;please let me know if you have any feedback on the latest patch. &lt;br/&gt;
if there are no comments I would like to resolve this issue tomorrow or thursday, thanks!&lt;/p&gt;</comment>
                    <comment id="12744835" author="rcmuir" created="Wed, 19 Aug 2009 02:53:00 +0100"  >&lt;p&gt;just some additional javadocs.&lt;/p&gt;</comment>
                    <comment id="12745025" author="rcmuir" created="Wed, 19 Aug 2009 13:08:38 +0100"  >&lt;p&gt;Committed revision 805769.&lt;/p&gt;

&lt;p&gt;Thanks Andrzej and also everyone who provided feedback&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12416949" name="LUCENE-1813.patch" size="4954" author="rcmuir" created="Wed, 19 Aug 2009 02:53:00 +0100" />
                    <attachment id="12416826" name="LUCENE-1813.patch" size="4319" author="rcmuir" created="Tue, 18 Aug 2009 03:50:09 +0100" />
                    <attachment id="12416732" name="LUCENE-1813.patch" size="3970" author="rcmuir" created="Mon, 17 Aug 2009 01:40:41 +0100" />
                    <attachment id="12416671" name="reverseMark-2.patch" size="3475" author="ab" created="Sat, 15 Aug 2009 21:23:16 +0100" />
                    <attachment id="12416664" name="reverseMark.patch" size="4901" author="ab" created="Sat, 15 Aug 2009 17:16:30 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>5.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sat, 15 Aug 2009 16:52:31 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11950</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25913</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 12:59:31 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2689/LUCENE-2689.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2689] remove NativeFSLockFactory&apos;s attempt to acquire a test lock</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2689</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;NativeFSLockFactory tries to acquire a test lock the first time a lock is created.  It&apos;s the only LF to do this, and, it&apos;s caused us hassle (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2421&quot; title=&quot;Hardening of NativeFSLock&quot;&gt;&lt;del&gt;LUCENE-2421&lt;/del&gt;&lt;/a&gt;,  &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2688&quot; title=&quot;NativeFSLockFactory throws an exception on Android 2.2 platform as java.lang.management package is not available on android.&quot;&gt;&lt;del&gt;LUCENE-2688&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;I think we should just remove it.  The caller of .makeLock will presumably immediately thereafter acquire the lock and at the point hit any exception that acquireTestLock would&apos;ve hit.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12475860">LUCENE-2689</key>
            <summary>remove NativeFSLockFactory&apos;s attempt to acquire a test lock</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Oct 2010 16:42:22 +0100</created>
                <updated>Wed, 1 Dec 2010 14:50:35 +0000</updated>
                    <resolved>Thu, 7 Oct 2010 10:12:34 +0100</resolved>
                            <version>3.0.1</version>
                                <fixVersion>2.9.4</fixVersion>
                <fixVersion>3.0.3</fixVersion>
                <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12918036" author="shaie" created="Tue, 5 Oct 2010 16:53:40 +0100"  >&lt;p&gt;All tests passed for me.&lt;/p&gt;

&lt;p&gt;BTW, according to the code, this method was added due to NFS cache issues, but I agree that it&apos;s useless to call makeLock just to call obtain() some time later on.  It&apos;s almost as if we should make makeLock obtain the lock right away. Is there a reason why we don&apos;t do it? Is it essential to separate it into two calls?&lt;/p&gt;</comment>
                    <comment id="12918059" author="mikemccand" created="Tue, 5 Oct 2010 17:27:36 +0100"  >&lt;blockquote&gt;&lt;p&gt;BTW, according to the code, this method was added due to NFS cache issues,&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, but, we now recommend SimpleFSLockFactory for NFS... so I think it&apos;s OK to remove this, now.&lt;/p&gt;

&lt;p&gt;I think the makeLock/obtain/release separation is OK?  Ie a Lock is stateful (eg can have an open file) so it makes sense that we return a real object...&lt;/p&gt;</comment>
                    <comment id="12918061" author="shaie" created="Tue, 5 Oct 2010 17:33:35 +0100"  >&lt;p&gt;Oh sure, we should return an Object upon makeLock. I was just asking whether makeLock should return an already obtained lock. Instead of just &quot;return new Lock()&quot;, we do &quot;Lock l = new Lock(); l.obtain();&quot;. That way, if obtain fails, makeLock fails as well. That&apos;s sort of what acquireTestLock attempted to achieve, no?&lt;/p&gt;

&lt;p&gt;At any rate, today you can call makeLock, succeed in obtaining the test lock, but later fail on obtaining the real lock. Hence, if we attempt to obtain on makeLock (removing obtain from the API?), we guarantee to the user that this lock is valid and should later be released.&lt;/p&gt;

&lt;p&gt;I don&apos;t mind if we stay w/ the current API as well.&lt;/p&gt;</comment>
                    <comment id="12918823" author="shaie" created="Thu, 7 Oct 2010 09:12:23 +0100"  >&lt;p&gt;Mike - are you going to commit this?&lt;/p&gt;

&lt;p&gt;BTW, shouldn&apos;t we have handled it as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2688&quot; title=&quot;NativeFSLockFactory throws an exception on Android 2.2 platform as java.lang.management package is not available on android.&quot;&gt;&lt;del&gt;LUCENE-2688&lt;/del&gt;&lt;/a&gt;? One of them is a duplicate of the other I think?&lt;/p&gt;</comment>
                    <comment id="12918833" author="mikemccand" created="Thu, 7 Oct 2010 09:40:11 +0100"  >&lt;p&gt;Sorry yeah I&apos;ll commit this shortly.&lt;/p&gt;

&lt;p&gt;I&apos;ll resolve &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-2688&quot; title=&quot;NativeFSLockFactory throws an exception on Android 2.2 platform as java.lang.management package is not available on android.&quot;&gt;&lt;del&gt;LUCENE-2688&lt;/del&gt;&lt;/a&gt; after I resolve this one...&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12475839">LUCENE-2688</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 5 Oct 2010 15:53:40 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11155</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>25003</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
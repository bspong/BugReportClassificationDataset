<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:05:19 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1407/LUCENE-1407.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1407] Refactor Searchable to not have RMI Remote dependency</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1407</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Per &lt;a href=&quot;http://lucene.markmail.org/message/fu34tuomnqejchfj?q=RemoteSearchable&quot; class=&quot;external-link&quot;&gt;http://lucene.markmail.org/message/fu34tuomnqejchfj?q=RemoteSearchable&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We should refactor Searchable slightly so that it doesn&apos;t extend the java.rmi.Remote marker interface.  I believe the same could be achieved by just marking the RemoteSearchable and refactoring the RMI implementation out of core and into a contrib.&lt;/p&gt;

&lt;p&gt;If we do this, we should deprecate/denote it for 2.9 and then move it for 3.0&lt;/p&gt;</description>
                <environment></environment>
            <key id="12405250">LUCENE-1407</key>
            <summary>Refactor Searchable to not have RMI Remote dependency</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="gsingers">Grant Ingersoll</reporter>
                        <labels>
                    </labels>
                <created>Fri, 26 Sep 2008 17:05:16 +0100</created>
                <updated>Fri, 25 Sep 2009 17:23:08 +0100</updated>
                    <resolved>Sun, 14 Jun 2009 12:13:23 +0100</resolved>
                                            <fixVersion>2.9</fixVersion>
                                        <due></due>
                    <votes>3</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12718264" author="markrmiller@gmail.com" created="Thu, 11 Jun 2009 01:35:52 +0100"  >&lt;p&gt;No work yet on this issue right? I&apos;m going to pull off the 2.9 and leave the 3.0. Feel free to flip back if you plan on doing it.&lt;/p&gt;</comment>
                    <comment id="12718360" author="simonw" created="Thu, 11 Jun 2009 10:14:49 +0100"  >&lt;p&gt;This bugs me for a while already. Just started on refactoring it - Would be happy to get it into 2.9.&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12718363" author="mikemccand" created="Thu, 11 Jun 2009 10:19:44 +0100"  >&lt;p&gt;I&apos;d also like to see this in 2.9 as well...&lt;/p&gt;</comment>
                    <comment id="12718379" author="shaie" created="Thu, 11 Jun 2009 10:55:38 +0100"  >&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1630&quot; title=&quot;Mating Collector and Scorer on doc Id orderness&quot;&gt;&lt;del&gt;LUCENE-1630&lt;/del&gt;&lt;/a&gt; I&apos;m going to do just that, as part of deprecating Weight in favor of a new QueryWeight. I&apos;m going to deprecate Searchable entirely. So perhaps we should wait with this until 1630 is resolved, or fold that issue under 1630?&lt;/p&gt;</comment>
                    <comment id="12718382" author="markrmiller@gmail.com" created="Thu, 11 Jun 2009 10:59:59 +0100"  >&lt;p&gt;Looks like we flip back for now in either case&lt;/p&gt;</comment>
                    <comment id="12718398" author="shaie" created="Thu, 11 Jun 2009 11:42:15 +0100"  >&lt;p&gt;Hmm ... maybe that won&apos;t be that simple. As part of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1630&quot; title=&quot;Mating Collector and Scorer on doc Id orderness&quot;&gt;&lt;del&gt;LUCENE-1630&lt;/del&gt;&lt;/a&gt;, I&apos;m deprecating Searchable, and the plan is to stick with just Searcher. Now, RemoteSearchable today implements Searchalbe (and by inheritance java.rmi.Remote) as well as extend UnicastRemoteObject.&lt;/p&gt;

&lt;p&gt;After refactoring, it will need to extend both Searcher and UnicastRemoteObject. Unless we make Searcher extend UnicastRemoteObject, but that will bring the RMI stuff back into core.&lt;/p&gt;

&lt;p&gt;Anybody got an idea how we can work around that besides keeping Searchable, or have Searcher extend UnicastRemoteObject?&lt;/p&gt;</comment>
                    <comment id="12718403" author="simonw" created="Thu, 11 Jun 2009 12:07:31 +0100"  >&lt;p&gt;Shai, I have looked at &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1630&quot; title=&quot;Mating Collector and Scorer on doc Id orderness&quot;&gt;&lt;del&gt;LUCENE-1630&lt;/del&gt;&lt;/a&gt; but haven&apos;t  seen any patch available. I looked briefly at the comments and what you are doing and I feel removing Searchable in 2.9 is a heavy change and will most likely break back compat. &lt;br/&gt;
The RMI related classes this issue is about will just be moved to contrib but the problem which are you talking about will stay the same. With or without a patch for this issue.&lt;br/&gt;
Removing the RMI dependency would be a great step forward and will not keep you from working on your patch.&lt;/p&gt;

&lt;p&gt;Simon&lt;/p&gt;</comment>
                    <comment id="12718428" author="shaie" created="Thu, 11 Jun 2009 13:42:32 +0100"  >&lt;blockquote&gt;&lt;p&gt;Shai, I have looked at &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1630&quot; title=&quot;Mating Collector and Scorer on doc Id orderness&quot;&gt;&lt;del&gt;LUCENE-1630&lt;/del&gt;&lt;/a&gt; but haven&apos;t seen any patch available&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s in the oven &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I feel removing Searchable in 2.9 is a heavy change and will most likely break back compat. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Back-compat is already broken in 2.9 due to the Collector work. So people who extend Searcher will need to implement the new search(***, Collector) methods. As I understood it, Searcher was really a replacement for Searchable, and I suspect it was left there not deprecated just because of RMI.&lt;/p&gt;

&lt;p&gt;We preferred to add new methods to Searcher as abstract, rather than to Searchable, b/c we want to move away from interfaces. Therefore I don&apos;t think that delaying that work will do any good - we&apos;ll have more methods to maintain on the interface as well.&lt;/p&gt;

&lt;p&gt;But to be honest I don&apos;t know what&apos;s better. I can have Searcher extend the RMI class, but that will leave RMI in core. Or I can have Searchable implement new methods, but that won&apos;t take us in the ultimate direction we want - getting rid of interfaces.&lt;/p&gt;</comment>
                    <comment id="12718466" author="shaie" created="Thu, 11 Jun 2009 15:06:24 +0100"  >&lt;p&gt;I did the following: removed the &quot;extends Remote&quot; from Searchable and move it to RemoteSearchable. But TestSort.testRemoteSort fails to lookup the searchable. The object it returns from lookup is of type Remote, while if Searchable extends Remote, the object returned from lookup is Searchable. I&apos;m still debugging this, but if someone knows what&apos;s going on, please don&apos;t be shy &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    <comment id="12718472" author="shaie" created="Thu, 11 Jun 2009 15:22:04 +0100"  >&lt;p&gt;From UnicastRemoteObject&apos;s documentation:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;If the remote object is exported using the exportObject(Remote) UnicastRemoteObject.exportObject(Remote) method, a stub class (typically pregenerated from the remote object&apos;s class using the rmic tool) is loaded and an instance of that stub class is constructed as follows. &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A &quot;root class&quot; is determined as follows: if the remote object&apos;s class directly implements an interface that extends Remote, then the remote object&apos;s class is the root class; otherwise, the root class is the most derived superclass of the remote object&apos;s class that directly implements an interface that extends Remote.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;Naming.lookup only succeeds when Searchable extends Remote, and RemoteSearchable implements Searchable. In fact, the type returned by lookup() is Searchable, not even RemoteSearchable.&lt;/p&gt;

&lt;p&gt;I guess we can solve it by having RemoteSearchable implement a Remoteable interface which extends Remote .. but that&apos;s just spooky. For now I left the code in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1630&quot; title=&quot;Mating Collector and Scorer on doc Id orderness&quot;&gt;&lt;del&gt;LUCENE-1630&lt;/del&gt;&lt;/a&gt; as-is in that area.&lt;/p&gt;</comment>
                    <comment id="12718481" author="simonw" created="Thu, 11 Jun 2009 15:45:35 +0100"  >&lt;p&gt;Shai, you miss one little tricky thing with RMI. RMI uses a DynamicProxy (java.lang.reflect.Proxy) together with a java.lang.reflect.InvocationHandler to proxy the remote call. A proxy can only be created using an interface. All calls to the interface are passed to the InvocationHandler instance and subsequently to the remote server. You can only cast an object returned by lookup() into an interface implemented by the remote object. If you would implement Remotable in you remote object you can only cast it into Remotable (while I have never seen that interface). This will only offer you the methods of this interface but not the methods of the remote object, in our case RemoteSeachable. Eventually we need an interface that defines all methods needed to use RemoteSearchable, without a base interface this is not gonna work together with RMI.&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12718526" author="simonw" created="Thu, 11 Jun 2009 16:53:04 +0100"  >&lt;p&gt;Moved&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;org.apache.lucene.search.RemoteSearchable.java&lt;/li&gt;
	&lt;li&gt;org.apache.lucene.search.RemoteCachingWrapperFilter.java&lt;br/&gt;
and depending test-cases to contrib/remote&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Removed ant#rmci call from build.xml&lt;br/&gt;
Added build.xml to contrib/remote&lt;br/&gt;
Added pom.xml.template to contrib/remote&lt;br/&gt;
Added package.html to contrib/remote/src/java/org/apache/lucene/search/&lt;/p&gt;

&lt;p&gt;Ideally, the move should be done using svn copy which does not appear in a diff afaik.&lt;/p&gt;

&lt;p&gt;I did run test-cases with success. &lt;br/&gt;
After finishing the patch I removed the Java standard library and compiled against android.jar version 1.1 / 1.5 and did not get any compile errors.&lt;br/&gt;
I did not run the build in an emulator neither did I run any test-cases in it I guess that is little out of scope but I will do it one in the near future just in case I can catch another problem.&lt;/p&gt;

&lt;p&gt;This change has one downside &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, the ant target &quot;test-tag&quot; will fail which is correct in my eyes as this patch breaks the compatibility in a certain way. I do have some ideas to make is succeed but I did not include them in the patch.&lt;/p&gt;</comment>
                    <comment id="12718550" author="mikemccand" created="Thu, 11 Jun 2009 17:54:57 +0100"  >&lt;blockquote&gt;&lt;p&gt;the ant target &quot;test-tag&quot; will fail which is correct in my eyes as this patch breaks the compatibility in a certain way.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is actually fine, assuming we&apos;re OK with making an exception (to break back-compat), here (which I believe we are &amp;#8211; if anyone objects, speak up!).&lt;/p&gt;

&lt;p&gt;If you can work out the patch to src/tags/... source code, and attach it, then when we commit this we&apos;ll commit the fixes to the back-compat branch, too.&lt;/p&gt;</comment>
                    <comment id="12718559" author="simonw" created="Thu, 11 Jun 2009 18:07:00 +0100"  >&lt;p&gt;What do you mean by:&lt;br/&gt;
If you can work out the patch to src/tags/... source code, and attach it, then when we commit this we&apos;ll commit the fixes to the back-compat branch, too.&lt;/p&gt;

&lt;p&gt;Are you talking about &lt;a href=&quot;http://svn.apache.org/repos/asf/lucene/java/branches/lucene_2_4_back_compat_tests/?&quot; class=&quot;external-link&quot;&gt;http://svn.apache.org/repos/asf/lucene/java/branches/lucene_2_4_back_compat_tests/?&lt;/a&gt;&lt;br/&gt;
please gimme some more details on that.&lt;/p&gt;

&lt;p&gt;thanks,&lt;br/&gt;
simon&lt;/p&gt;</comment>
                    <comment id="12718561" author="mikemccand" created="Thu, 11 Jun 2009 18:09:52 +0100"  >&lt;p&gt;Woops, sorry... &quot;ant test-tag&quot; check out that branch into your local area, eg under tags/lucene_2_4_back_compat_tests_2009060.&lt;/p&gt;

&lt;p&gt;Under there is src/test/... which you can go ahead and fix up with &quot;accepted&quot; changes to back-compat, until it passes &quot;ant test-tag&quot;.&lt;/p&gt;

&lt;p&gt;Then, from within there do &quot;svn diff&quot; and attach that patch here.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                    <comment id="12718625" author="shaie" created="Thu, 11 Jun 2009 21:14:43 +0100"  >&lt;blockquote&gt;&lt;p&gt;If you would implement Remotable in you remote object you can only cast it into Remotable (while I have never seen that interface).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;By Remotable I meant exactly what you came up eventually with RMIRemoteSearchable - a mediator class between Searchable and RemoteSearchable which also extends Remote.&lt;/p&gt;

&lt;p&gt;If this issue will be committed before &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1630&quot; title=&quot;Mating Collector and Scorer on doc Id orderness&quot;&gt;&lt;del&gt;LUCENE-1630&lt;/del&gt;&lt;/a&gt;, I&apos;ll make the necessary updates to RemoteSearchable - implementing the new methods that will be added.&lt;/p&gt;</comment>
                    <comment id="12718764" author="simonw" created="Fri, 12 Jun 2009 10:13:47 +0100"  >&lt;p&gt;Attached patches for back compat tag lucene_2_4_back_compat_tests_20090607b&lt;br/&gt;
The patch /back_compat_20090607b_without_contrib.patch contains only the changes to build.xml, /src/java and /src/test  while back_compat_20090607b_with_contrib.patch has also the created remote contrib project in it.&lt;/p&gt;

&lt;p&gt;The third patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1407&quot; title=&quot;Refactor Searchable to not have RMI Remote dependency&quot;&gt;&lt;del&gt;LUCENE-1407&lt;/del&gt;&lt;/a&gt;_with_back_compat.patch) is an update to the original &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1407&quot; title=&quot;Refactor Searchable to not have RMI Remote dependency&quot;&gt;&lt;del&gt;LUCENE-1407&lt;/del&gt;&lt;/a&gt;.patch where I addtionally removed the rmic call in the test-tag target. This call is obsolete and would fail as the RemoteSearchable.java is not present in src/java.&lt;/p&gt;

&lt;p&gt;I did run ant test and ant test-tag on trunk with the local modified compat tag directory set to tags-dir. The test do all pass on trunk. &lt;br/&gt;
I did also run ant test on the compat tag where a lot of unrelated tests do fail but I guess that is due to modifications on accepted changes, correct?!&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12718908" author="mikemccand" created="Fri, 12 Jun 2009 18:20:56 +0100"  >&lt;blockquote&gt;&lt;p&gt;I did also run ant test on the compat tag where a lot of unrelated tests do fail but I guess that is due to modifications on accepted changes, correct?!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, this won&apos;t work (and yeah, it&apos;s confusing).  You can&apos;t checkout the back compat tag dir and run its tests because many changes we&apos;ve made to src/test/* on that branch rely on trunk.  Ie we only really use src/test/* on the back compat branch.&lt;/p&gt;</comment>
                    <comment id="12718939" author="mikemccand" created="Fri, 12 Jun 2009 19:56:58 +0100"  >&lt;p&gt;Patch looks good Simon!  Thanks.  I plan to commit in a day or two...&lt;/p&gt;</comment>
                    <comment id="12719249" author="mikemccand" created="Sun, 14 Jun 2009 12:13:23 +0100"  >&lt;p&gt;Thanks Simon!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12410465" name="back_compat_20090607b_with_contrib.patch" size="78982" author="simonw" created="Fri, 12 Jun 2009 10:13:47 +0100" />
                    <attachment id="12410466" name="back_compat_20090607b_without_contrib.patch" size="34080" author="simonw" created="Fri, 12 Jun 2009 10:13:47 +0100" />
                    <attachment id="12410408" name="LUCENE-1407.patch" size="83928" author="simonw" created="Thu, 11 Jun 2009 16:53:04 +0100" />
                    <attachment id="12410467" name="LUCENE-1407_with_back_compat.patch" size="84390" author="simonw" created="Fri, 12 Jun 2009 10:13:47 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>4.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 11 Jun 2009 00:35:52 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12344</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26321</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
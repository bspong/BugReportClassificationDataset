<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 12:58:11 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1327/LUCENE-1327.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1327] TermSpans skipTo() doesn&apos;t always move forwards</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1327</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;In TermSpans (or the anonymous Spans class returned by SpansTermQuery, depending on the version), the skipTo() method is improperly implemented if the target doc is less than or equal to the current doc:&lt;/p&gt;

&lt;p&gt;  public boolean skipTo(int target) throws IOException {&lt;br/&gt;
          // are we already at the correct position?&lt;br/&gt;
          if (doc &amp;gt;= target) &lt;/p&gt;
{
            return true;
          }

&lt;p&gt;          ...&lt;/p&gt;


&lt;p&gt;This violates the correct behavior (as described in the Spans interface documentation), that skipTo() should always move forwards, in other words the correct implementation would be:&lt;/p&gt;

&lt;p&gt;if (doc &amp;gt;= target) &lt;/p&gt;
{
  return next();
}

&lt;p&gt;This bug causes particular problems if one wants to use the payloads feature - this is because if one loads a payload, then performs a skipTo() to the same document, then tries to load the &quot;next&quot; payload, the spans hasn&apos;t changed position and it attempts to load the same payload again (which is an error).&lt;/p&gt;</description>
                <environment></environment>
            <key id="12399666">LUCENE-1327</key>
            <summary>TermSpans skipTo() doesn&apos;t always move forwards</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="michaelbusch">Michael Busch</assignee>
                                <reporter username="motinis">Moti Nisenson</reporter>
                        <labels>
                    </labels>
                <created>Sun, 6 Jul 2008 13:02:03 +0100</created>
                <updated>Fri, 25 Sep 2009 17:23:07 +0100</updated>
                    <resolved>Fri, 20 Mar 2009 17:32:53 +0000</resolved>
                            <version>1.9</version>
                <version>2.0.0</version>
                <version>2.1</version>
                <version>2.2</version>
                <version>2.3</version>
                <version>2.3.1</version>
                <version>2.3.2</version>
                <version>2.4</version>
                                <fixVersion>2.9</fixVersion>
                                <component>core/query/scoring</component>
                <component>core/search</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12621785" author="markrmiller@gmail.com" created="Tue, 12 Aug 2008 13:06:45 +0100"  >&lt;p&gt;I swear I saw this discussion in another issue...this a dupe?&lt;/p&gt;

&lt;p&gt;In any case, if you use the isPayloadAvailable method before trying to get the payload, that should help. &lt;/p&gt;</comment>
                    <comment id="12626050" author="mikemccand" created="Wed, 27 Aug 2008 11:05:05 +0100"  >&lt;p&gt;This is indeed a bug in that the implementation does not match the javadocs.  Mark or Grant, what should we do here?&lt;/p&gt;</comment>
                    <comment id="12626093" author="markrmiller@gmail.com" created="Wed, 27 Aug 2008 13:39:32 +0100"  >&lt;p&gt;I found the issue this one dupes. It looks to me like relaxing the spec is the most likely fix. I don&apos;t know if that solves this guys problem though - is calling isPayloadAvailable good enough, or is his logic screwed up as a result...&lt;/p&gt;</comment>
                    <comment id="12626102" author="markrmiller@gmail.com" created="Wed, 27 Aug 2008 14:16:24 +0100"  >&lt;p&gt;Not an exact dupe by the way (spans vs scorer), but same issue, and from Dougs comment, should probably be handled in a similar manner (whatever is decided).&lt;/p&gt;</comment>
                    <comment id="12629165" author="mikemccand" created="Mon, 8 Sep 2008 15:00:08 +0100"  >&lt;p&gt;We&apos;re still iterating on the approach to resolve this, and &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-914&quot; title=&quot;Scorer.skipTo(current) remains on current for some scorers&quot;&gt;&lt;del&gt;LUCENE-914&lt;/del&gt;&lt;/a&gt;, so I&apos;m taking this out of 2.4.&lt;/p&gt;</comment>
                    <comment id="12683503" author="michaelbusch" created="Thu, 19 Mar 2009 16:15:29 +0000"  >&lt;p&gt;I think the right fix here is to simply remove these lines:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// are we already at the correct position?
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (doc &amp;gt;= target) { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then TermSpans#skipTo() basically returns what the TermPositions#skipTo() call returns.&lt;br/&gt;
TermPositions#skipTo() has the same semantics as described in the javadocs of Spans#skipTo().&lt;/p&gt;

&lt;p&gt;The patch I&apos;m attaching contains a junit that fails before applying the fix, and passes after applying. All other tests pass too.&lt;/p&gt;

&lt;p&gt;Any objections here? Otherwise I&apos;ll commit in a day or two.&lt;/p&gt;</comment>
                    <comment id="12683958" author="michaelbusch" created="Fri, 20 Mar 2009 17:32:53 +0000"  >&lt;p&gt;Committed revision 756669.&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12371090">LUCENE-914</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12402582" name="lucene-1327.patch" size="3295" author="michaelbusch" created="Thu, 19 Mar 2009 16:15:29 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 12 Aug 2008 12:06:45 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12421</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26401</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:00:01 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-1602/LUCENE-1602.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-1602] Rewrite TrieRange to use MultiTermQuery</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-1602</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Issue for discussion here: &lt;a href=&quot;http://www.lucidimagination.com/search/document/46a548a79ae9c809/move_trierange_to_core_module_and_integration_issues&quot; class=&quot;external-link&quot;&gt;http://www.lucidimagination.com/search/document/46a548a79ae9c809/move_trierange_to_core_module_and_integration_issues&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This patch is a rewrite of TrieRange using MultiTermQuery like all other core queries. This should make TrieRange identical in functionality to core range queries.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12422796">LUCENE-1602</key>
            <summary>Rewrite TrieRange to use MultiTermQuery</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="thetaphi">Uwe Schindler</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Apr 2009 15:13:24 +0100</created>
                <updated>Thu, 2 May 2013 03:29:23 +0100</updated>
                    <resolved>Thu, 16 Apr 2009 13:59:18 +0100</resolved>
                            <version>2.9</version>
                                <fixVersion>2.9</fixVersion>
                                <component>modules/other</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12698783" author="thetaphi" created="Tue, 14 Apr 2009 15:22:16 +0100"  >&lt;p&gt;Here the patch:&lt;br/&gt;
1. There are some changes to FilterTermEnum in core:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Make the private members protected, to have access to them from the very special TrieRangeTermEnum&lt;/li&gt;
	&lt;li&gt;Fix a small inconsistency (docFreq() now only returns a value, if a valid term is existing)&lt;/li&gt;
	&lt;li&gt;All core tests pass&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;2. TrieRange patch:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;New TrieRangeQuery classes&lt;/li&gt;
	&lt;li&gt;TrieRangeFilter is now only a wrapper (like in core)&lt;/li&gt;
	&lt;li&gt;The work is done in package-private TrieRangeTermEnum. This was really a fun to implement this: It started with a very large and complicated version that got simplier and simplier at the end. I am really happy with it now. Maybe a extra test for the &quot;special cases&quot; should be added&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;Some additional comments:&lt;/b&gt;&lt;br/&gt;
The functions that return the unique term count hit during executing query/filter is implemented as a counter in the enum that counts all valid terms in termCompare(). Maybe this information is also interesting for other MultiTermQueries. How about counting this directly in MultiTermQuery for all such queries and export the method there? It would be really nice, to get e.g. the number of terms for a classical range query, to see the improvement. I could patch the MultiTermQuery to do this internally. Any comments about that?&lt;/p&gt;

&lt;p&gt;The package and class names are still contrib-like as before. A move to core would rename the classes as discussed.&lt;/p&gt;</comment>
                    <comment id="12698784" author="thetaphi" created="Tue, 14 Apr 2009 15:28:49 +0100"  >&lt;p&gt;An additional extension to MultiTermQuery:&lt;br/&gt;
The original version of TrieRange had a shortcut in the getDocIdSet call: If the range was inverse and would return for sure no documents, it returned the DocIdSet.EMPTY_DOCID_SET instance and did not allocate any OpenBitSet. MultiTermQuery could also do this automatically, if the FilteredTermEnum is empty from the beginning (simple check before allocating the bitset). This would be a nice memory-friendly imporvement. I could try to implement this in MultiTermQuery&apos;s getDocIdSet().&lt;/p&gt;</comment>
                    <comment id="12698792" author="mikemccand" created="Tue, 14 Apr 2009 15:50:13 +0100"  >&lt;p&gt;It&apos;d be great to do both the EMPTY_DOCID_SET optimization and the getTermCount() addition to MultiTermQuery.&lt;/p&gt;</comment>
                    <comment id="12698823" author="mikemccand" created="Tue, 14 Apr 2009 17:33:14 +0100"  >&lt;p&gt;For some reason, I&apos;m having trouble applying this patch &amp;#8211; alot of failures:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
patch -p0 &amp;lt; patch.x
patching file contrib/queries/src/java/org/apache/lucene/search/trie/AbstractTrieRangeFilter.java
Hunk #1 FAILED at 18.
1 out of 1 hunk FAILED -- saving rejects to file contrib/queries/src/java/org/apache/lucene/search/trie/AbstractTrieRangeFilter.java.rej
patching file contrib/queries/src/java/org/apache/lucene/search/trie/AbstractTrieRangeQuery.java
patching file contrib/queries/src/java/org/apache/lucene/search/trie/IntTrieRangeFilter.java
Hunk #1 FAILED at 17.
Hunk #2 FAILED at 39.
2 out of 2 hunks FAILED -- saving rejects to file contrib/queries/src/java/org/apache/lucene/search/trie/IntTrieRangeFilter.java.rej
patching file contrib/queries/src/java/org/apache/lucene/search/trie/IntTrieRangeQuery.java
patching file contrib/queries/src/java/org/apache/lucene/search/trie/LongTrieRangeFilter.java
Hunk #1 FAILED at 17.
Hunk #2 FAILED at 39.
2 out of 2 hunks FAILED -- saving rejects to file contrib/queries/src/java/org/apache/lucene/search/trie/LongTrieRangeFilter.java.rej
patching file contrib/queries/src/java/org/apache/lucene/search/trie/LongTrieRangeQuery.java
patching file contrib/queries/src/java/org/apache/lucene/search/trie/&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;.html
patching file contrib/queries/src/java/org/apache/lucene/search/trie/TrieRangeTermEnum.java
patching file contrib/queries/src/test/org/apache/lucene/search/trie/TestIntTrieRangeFilter.java
Reversed (or previously applied) patch detected!  Assume -R? [n] n
n
Apply anyway? [n] n
n
Skipping patch.
1 out of 1 hunk ignored -- saving rejects to file contrib/queries/src/test/org/apache/lucene/search/trie/TestIntTrieRangeFilter.java.rej
patching file contrib/queries/src/test/org/apache/lucene/search/trie/TestIntTrieRangeQuery.java
patching file contrib/queries/src/test/org/apache/lucene/search/trie/TestLongTrieRangeFilter.java
patching file contrib/queries/src/test/org/apache/lucene/search/trie/TestLongTrieRangeQuery.java
patching file src/java/org/apache/lucene/search/FilteredTermEnum.java
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Uwe, is your area up to date?  How did you generate the diff?&lt;/p&gt;</comment>
                    <comment id="12698827" author="thetaphi" created="Tue, 14 Apr 2009 17:47:04 +0100"  >&lt;p&gt;New patch that includes new tests: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;EMPTY_DOCIDSET case on inverse range&lt;/li&gt;
	&lt;li&gt;a comparison of TrieRange and classic Range in term numbers&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The patch &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1603&quot; title=&quot;Changes for TrieRange in FilteredTermEnum and MultiTermQuery improvement&quot;&gt;&lt;del&gt;LUCENE-1603&lt;/del&gt;&lt;/a&gt; must be applied before.&lt;/p&gt;</comment>
                    <comment id="12698828" author="thetaphi" created="Tue, 14 Apr 2009 17:49:32 +0100"  >&lt;p&gt;Hi Mike:&lt;br/&gt;
I&apos;m up-to-date. Maybe its the old problem of TortoiseSVN on Windows: It generates CR-LF instead of LF alone. dostounix should help. I always apply patches using the TortoiseSVN merge function (that also keeps track of correct local versions from patch header and merges alltogether).&lt;/p&gt;</comment>
                    <comment id="12698837" author="mikemccand" created="Tue, 14 Apr 2009 18:09:27 +0100"  >&lt;p&gt;Hmm it&apos;s not the end-of-line issue (though I see that the files are all DOS; we should fix with &quot;svn propset svn:eol-style native contrib/queries/src/java/org/apache/lucene/search/trie/*.java&quot; after we&apos;ve committed these changes); when I normalize the EOLs it&apos;s failing in the same way.  Odd.&lt;/p&gt;

&lt;p&gt;Can you instead post a tar file w/ your current *.java?&lt;/p&gt;</comment>
                    <comment id="12698842" author="thetaphi" created="Tue, 14 Apr 2009 18:30:19 +0100"  >&lt;p&gt;Here a ZIP file with the source and tests only of the trie package. Please note: two test files were removed by the patch, so you must remove them by hand.&lt;/p&gt;

&lt;p&gt;I tried to patch a fresh checkout of trunk without problems. TortoiseMerge patched all files without problems.&lt;/p&gt;</comment>
                    <comment id="12698897" author="mikemccand" created="Tue, 14 Apr 2009 20:53:31 +0100"  >&lt;p&gt;These changes look good on quick pass.  I can&apos;t compile/test based on the zip (since we renamed the new method), but I like the new approach.&lt;/p&gt;</comment>
                    <comment id="12698921" author="thetaphi" created="Tue, 14 Apr 2009 21:50:30 +0100"  >&lt;p&gt;Here updated files. It also fixes a bug in the tests (filter term count was incorrect)&lt;/p&gt;</comment>
                    <comment id="12698948" author="mikemccand" created="Tue, 14 Apr 2009 22:34:36 +0100"  >&lt;p&gt;OK all tests pass for me!  Looks good.&lt;/p&gt;</comment>
                    <comment id="12699084" author="thetaphi" created="Wed, 15 Apr 2009 07:35:51 +0100"  >&lt;p&gt;This patch adds some missing getter methods in filter variant. The ZIP file is not added, as this methods are not really needed for testing, just for completeness.&lt;/p&gt;</comment>
                    <comment id="12699667" author="thetaphi" created="Thu, 16 Apr 2009 13:12:50 +0100"  >&lt;p&gt;This is the final patch, with the changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-1603&quot; title=&quot;Changes for TrieRange in FilteredTermEnum and MultiTermQuery improvement&quot;&gt;&lt;del&gt;LUCENE-1603&lt;/del&gt;&lt;/a&gt;. I also added svn:eol-style to all files in trie and test-trie.&lt;br/&gt;
Because this is not yet committed, the patch may still fail to apply, but I will commit in the next few hours.&lt;/p&gt;</comment>
                    <comment id="12699689" author="thetaphi" created="Thu, 16 Apr 2009 13:59:18 +0100"  >&lt;p&gt;Committed revision 765618.&lt;/p&gt;</comment>
                    <comment id="12702013" author="thetaphi" created="Thu, 23 Apr 2009 18:08:54 +0100"  >&lt;p&gt;Fixed the incomplete hashcode(), equals() and toString() of TrieRangeQueries in revision 767982.&lt;/p&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10001">
                <name>dependent</name>
                                <outwardlinks description="depends upon">
                            <issuelink>
            <issuekey id="12422805">LUCENE-1603</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12405644" name="LUCENE-1602.patch" size="106604" author="thetaphi" created="Thu, 16 Apr 2009 13:12:50 +0100" />
                    <attachment id="12405505" name="LUCENE-1602.patch" size="98304" author="thetaphi" created="Wed, 15 Apr 2009 07:35:51 +0100" />
                    <attachment id="12405458" name="LUCENE-1602.patch" size="96680" author="thetaphi" created="Tue, 14 Apr 2009 21:50:29 +0100" />
                    <attachment id="12405434" name="LUCENE-1602.patch" size="96103" author="thetaphi" created="Tue, 14 Apr 2009 17:47:04 +0100" />
                    <attachment id="12405419" name="LUCENE-1602.patch" size="97327" author="thetaphi" created="Tue, 14 Apr 2009 15:22:16 +0100" />
                    <attachment id="12405459" name="queries.zip" size="39575" author="thetaphi" created="Tue, 14 Apr 2009 21:50:30 +0100" />
                    <attachment id="12405438" name="queries.zip" size="39504" author="thetaphi" created="Tue, 14 Apr 2009 18:30:19 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>7.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 14 Apr 2009 14:50:13 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>12153</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>26126</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:21:23 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3639/LUCENE-3639.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3639] Add test case support for shard searching</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3639</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;New test case that helps stress test the APIs to support sharding....&lt;/p&gt;</description>
                <environment></environment>
            <key id="12534681">LUCENE-3639</key>
            <summary>Add test case support for shard searching</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mikemccand">Michael McCandless</assignee>
                                <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Sun, 11 Dec 2011 20:20:48 +0000</created>
                <updated>Fri, 10 May 2013 11:43:38 +0100</updated>
                    <resolved>Sun, 18 Dec 2011 15:36:22 +0000</resolved>
                                            <fixVersion>3.5</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13167190" author="mikemccand" created="Sun, 11 Dec 2011 20:22:45 +0000"  >&lt;p&gt;Initial patch; I think it&apos;s close.&lt;/p&gt;

&lt;p&gt;It only tests random TermQuery, verifying the hits match across a IS(MR) and searching as shards... we can improve over time.&lt;/p&gt;

&lt;p&gt;I also found a minor bug in TopDocs.merge, where it sets maxScore to Float.MIN_VALUE instead of Float.NaN when there are 0 hits.&lt;/p&gt;</comment>
                    <comment id="13169628" author="mikemccand" created="Wed, 14 Dec 2011 19:50:17 +0000"  >&lt;p&gt;New patch, beefing up the test some more.  I think it&apos;s ready.&lt;/p&gt;

&lt;p&gt;I improved SLM&apos;s age calculation to use double precision&lt;br/&gt;
and to compute age by how long ago the searcher  was replaced with a&lt;br/&gt;
new searcher (not how long ago the searcher was first enrolled).&lt;/p&gt;

&lt;p&gt;I also fixed a bug TopDocs.merge when you use searchAfter with shards:&lt;br/&gt;
it was incorrectly assuming that topDocs.scoreDocs.length == 0 meant&lt;br/&gt;
topDocs.totalHits == 0, which is not necessarily true if you use&lt;br/&gt;
searchAfter.&lt;/p&gt;</comment>
                    <comment id="13169662" author="rcmuir" created="Wed, 14 Dec 2011 20:22:04 +0000"  >&lt;p&gt;starting to look good, i like testing of the distributed stats!&lt;/p&gt;

&lt;p&gt;I think, looking at this test, that unfortunately that distributed scoring is still too difficult with lucene.&lt;br/&gt;
Its nice how you dont do any extra rewrites or anything like that, but I don&apos;t like this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+    // TODO: nothing evicts from here!!!  Somehow, on searcher
+    // expiration on remote nodes we must evict from our
+    // local cache...?
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There are two problems here we should separate:&lt;br/&gt;
1. the searcher should be able to get the stats, and ensure that they are available for scorers. this is separate from:&lt;br/&gt;
2. the searcher doing some caching of stats to prevent network traffic.&lt;/p&gt;

&lt;p&gt;Currently your cache handles both 1 and 2, but i think a cache should be a cache.&lt;/p&gt;

&lt;p&gt;Maybe we can improve the scoring api, here is where the problem is:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  public Weight createNormalizedWeight(Query query) throws IOException {
    query = rewrite(query);
    // right here is where you want to extractTerms and get stats (from cache or remotely)
    Weight weight = query.createWeight(this); // right here, in the weights ctor, is where its going to callback to your IS to ask for those stats
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I don&apos;t like the fact that you need to handle this crazy state here... there has to be somethign we can do to simplify this.&lt;/p&gt;</comment>
                    <comment id="13169664" author="rcmuir" created="Wed, 14 Dec 2011 20:26:03 +0000"  >&lt;p&gt;By the way, the test is great... i actually think we should just commit it as-is.&lt;/p&gt;

&lt;p&gt;Otherwise, how can we improve this stuff? we need this test!&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12507420" name="LUCENE-3639.patch" size="43798" author="mikemccand" created="Wed, 14 Dec 2011 19:50:17 +0000" />
                    <attachment id="12506910" name="LUCENE-3639.patch" size="22381" author="mikemccand" created="Sun, 11 Dec 2011 20:22:44 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 14 Dec 2011 20:22:04 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>220403</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24059</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:10:35 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2964/LUCENE-2964.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2964] Allow benchmark tasks from alternative packages</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2964</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;Relax current limitation of all tasks in same package - that of PerfTask.&lt;br/&gt;
Add a property &quot;alt.tasks.packages&quot; - its value are comma separated full package names.&lt;br/&gt;
If the task class is not found in the default package, an attempt is made to load it from the alternate packages specified in that property.&lt;/p&gt;</description>
                <environment></environment>
            <key id="12501040">LUCENE-2964</key>
            <summary>Allow benchmark tasks from alternative packages</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="doronc">Doron Cohen</assignee>
                                <reporter username="doronc">Doron Cohen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Mar 2011 17:09:08 +0000</created>
                <updated>Fri, 3 Jun 2011 17:37:17 +0100</updated>
                    <resolved>Mon, 21 Mar 2011 12:05:13 +0000</resolved>
                                            <fixVersion>3.2</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>modules/benchmark</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13005170" author="doronc" created="Thu, 10 Mar 2011 17:14:00 +0000"  >&lt;p&gt;Patch implements this relaxation.&lt;br/&gt;
It is working for me conveniently.&lt;br/&gt;
To do:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;add a test&lt;/li&gt;
	&lt;li&gt;update the package documentation about this property&lt;/li&gt;
&lt;/ol&gt;
</comment>
                    <comment id="13005220" author="shaie" created="Thu, 10 Mar 2011 18:19:10 +0000"  >&lt;p&gt;Big +1 !&lt;/p&gt;

&lt;p&gt;What a nice addition Doron. Now I can change my benchmark code to stop looking like I hack Lucene w/ those package names.&lt;/p&gt;

&lt;p&gt;About the patch, looks good. I have two questions:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Can you pass &apos;null&apos; to config.get() and then just compare the &apos;alt&apos; to null in the next line?&lt;/li&gt;
	&lt;li&gt;Maybe instead of this &apos;fallback&apos; logic, you always create a packages[] array with the first package being that of PerfTask? Then you can loop over all packages until the first one succeeds. Since this is not a hotspot section (executed once when algorithm is parsed), I think perf-wise we should be ok. It will also mean looking up the alt package names in the config before this method is invoked ...&lt;/li&gt;
	&lt;li&gt;I&apos;d add a comment to the javadocs that if someone uses the same task name by two packages, then whichever is found first is used.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                    <comment id="13008981" author="doronc" created="Sun, 20 Mar 2011 22:41:12 +0000"  >&lt;p&gt;Thanks Shai for the review!&lt;br/&gt;
Followed all your suggestions, it indeed made the code simpler. &lt;br/&gt;
Also added a test case and a Changes entry,&lt;/p&gt;</comment>
                    <comment id="13009020" author="shaie" created="Mon, 21 Mar 2011 04:23:58 +0000"  >&lt;p&gt;Patch looks good and nice updates to package.html !&lt;/p&gt;

&lt;p&gt;In Algorithm.taskClass, I see that you store the CNFE and later reference it in the thrown CNFE (if the class wasn&apos;t found in all package). I think it&apos;s redundant? Because if I specify 4 alt packages and the task is not in any of them, the referenced error will be of the last one, which is just confusing. The CNFE message that you pass is already descriptive enough, IMO.&lt;/p&gt;

&lt;p&gt;Can we put AltTestTask an inner public static member of AltPackageTaskTest?&lt;/p&gt;</comment>
                    <comment id="13009060" author="doronc" created="Mon, 21 Mar 2011 08:59:50 +0000"  >&lt;p&gt;Thanks for reviewing.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The CNFE message that you pass is already descriptive enough, IMO.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agree, I&apos;ll change that.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;put AltTestTask an inner public static member of AltPackageTaskTest&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This makes sense - but is tricky, as the alg line should now look like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; altTask = &lt;span class=&quot;code-quote&quot;&gt;&quot;{ AltPackageTaskTest$AltTest }&quot;&lt;/span&gt;; &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; class peculiarities - &apos;$&apos; as separator&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which is rather not too nice (took me some time to figure why just &lt;b&gt;AltPackageTaskTest.AltTest&lt;/b&gt; fails).&lt;br/&gt;
But in addition, &lt;b&gt;$&lt;/b&gt; causes the Algorithm&apos;s tokenizer to break that into two task names, I am not sure it is worth to modify it for removing that test class, but I&apos;ll give it a few more minutes. &lt;/p&gt;</comment>
                    <comment id="13009062" author="doronc" created="Mon, 21 Mar 2011 09:11:32 +0000"  >&lt;p&gt;Apparently using &apos;$&apos; is safe in that it is always correct as this is the standard definition for inner class separator - see &lt;a href=&quot;http://www.retrologic.com/innerclasses.doc7.html&quot; class=&quot;external-link&quot;&gt;Inner Classes Specification &lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The required change to the Benchmark Algorithm is to define &apos;$&apos; as a word part, by adding this to the Algorithm&apos;s tokenizer intialization:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
stok.wordChars(&apos;$&apos;,&apos;$&apos;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I am not sure about this.&lt;br/&gt;
It would allow easier creation of tasks as inner classes.&lt;br/&gt;
But this is mainly for tests I assume, because for real tasks one would want them to read nicely - without that &apos;$&apos; and to have their own class file. &lt;br/&gt;
And making &apos;$&apos; a regular word char just for this test need, will prevent us from adding some semantics to it in the future, should the need arise,&lt;/p&gt;

&lt;p&gt;So, I rather keep the additional class file in the test package.&lt;/p&gt;</comment>
                    <comment id="13009073" author="doronc" created="Mon, 21 Mar 2011 09:37:54 +0000"  >&lt;p&gt;Updated patch, fixing per Shai suggestion on the exception. &lt;br/&gt;
Planning to commit shortly.&lt;/p&gt;</comment>
                    <comment id="13009080" author="shaie" created="Mon, 21 Mar 2011 09:57:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;So, I rather keep the additional class file in the test package.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m fine with it.&lt;/p&gt;</comment>
                    <comment id="13009107" author="doronc" created="Mon, 21 Mar 2011 12:05:13 +0000"  >&lt;p&gt;Committed:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;r1083726 - 3x&lt;/li&gt;
	&lt;li&gt;r1083731 - trunk&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;(Hudson&apos;s Lucene-Solr-tests-only-trunk #6185 passed the new Benchmarks tests.)&lt;/p&gt;</comment>
                    <comment id="13043507" author="rcmuir" created="Fri, 3 Jun 2011 17:37:17 +0100"  >&lt;p&gt;Bulk closing for 3.2&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12474162" name="LUCENE-2964.patch" size="9555" author="doronc" created="Mon, 21 Mar 2011 09:37:54 +0000" />
                    <attachment id="12474134" name="LUCENE-2964.patch" size="9452" author="doronc" created="Sun, 20 Mar 2011 22:41:12 +0000" />
                    <attachment id="12473292" name="LUCENE-2964.patch" size="3345" author="doronc" created="Thu, 10 Mar 2011 17:14:00 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 10 Mar 2011 18:19:10 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>10914</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24728</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:01:21 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-2787/LUCENE-2787.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-2787] disable atime for DirectIOLinuxDirectory</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-2787</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;In Linux&apos;s open():&lt;br/&gt;
O_NOATIME&lt;br/&gt;
    (Since Linux 2.6.8) Do not update the file last access time (st_atime in the inode) when the file is read(2). This flag is intended for use by indexing or backup programs, where its use can significantly reduce the amount of disk activity. This flag may not be effective on all filesystems. One example is NFS, where the server maintains the access time.&lt;/p&gt;

&lt;p&gt;So we should do this in our linux-specific DirectIOLinuxDirectory.&lt;/p&gt;

&lt;p&gt;Separately (offtopic), it would be better if this was a LinuxDirectory that only uses O_DIRECT when it should &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
It would be nice to think about an optional modules/native for common platforms similar to what tomcat provides&lt;br/&gt;
Its easier to test directories like this now (-Dtests.directory)...&lt;/p&gt;</description>
                <environment></environment>
            <key id="12491757">LUCENE-2787</key>
            <summary>disable atime for DirectIOLinuxDirectory</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="rcmuir">Robert Muir</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Dec 2010 14:18:52 +0000</created>
                <updated>Wed, 30 Mar 2011 16:50:12 +0100</updated>
                    <resolved>Fri, 3 Dec 2010 19:09:27 +0000</resolved>
                                            <fixVersion>3.1</fixVersion>
                <fixVersion>4.0-ALPHA</fixVersion>
                                <component>modules/other</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12965688" author="rcmuir" created="Wed, 1 Dec 2010 14:19:28 +0000"  >&lt;p&gt;all core tests pass with this directory.&lt;/p&gt;</comment>
                    <comment id="12965695" author="simonw" created="Wed, 1 Dec 2010 14:37:58 +0000"  >&lt;p&gt;robert, you can also control this through mount options / how you mount your filesystems with setting the noatime option on the mount command do you think this is absolutely necessary to set this in here by default? &lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12965697" author="rcmuir" created="Wed, 1 Dec 2010 14:40:00 +0000"  >&lt;p&gt;Simon, of course you can, but why not set it? Our indexes don&apos;t need the atime for any reason.&lt;/p&gt;

&lt;p&gt;The option exists specifically for apps like lucene... see the description from the man page!!!!&lt;/p&gt;</comment>
                    <comment id="12965700" author="rcmuir" created="Wed, 1 Dec 2010 14:45:14 +0000"  >&lt;p&gt;Also simon, i just wanted to say, you need to be root to change the mount option etc.&lt;/p&gt;

&lt;p&gt;I think this is totally appropriate for us to do, again quoting from the page:&lt;/p&gt;

&lt;p&gt;&quot;This flag is intended for use by &lt;b&gt;indexing&lt;/b&gt; or backup programs, where its use can significantly reduce the amount of disk activity.&quot;&lt;/p&gt;
</comment>
                    <comment id="12965701" author="thetaphi" created="Wed, 1 Dec 2010 14:45:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;The option exists specifically for apps like lucene... see the description from the man page!!!!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The intention behind the man page is not for the part of the app that manages the &lt;b&gt;index&lt;/b&gt; itsself (like Lucene) - it is for the part of the app, that &lt;b&gt;reads&lt;/b&gt; files &lt;b&gt;to index them&lt;/b&gt; (so that would be the app that uses lucene and e.g. uses TIKA to read all files, this one should set noatime). The idea is to not mark the file as &quot;accessed&quot; when the virus scanner or the KDE/gnome file system browser indexes it.&lt;/p&gt;

&lt;p&gt;Simon is right about setting it as a mount option.&lt;/p&gt;</comment>
                    <comment id="12965705" author="rcmuir" created="Wed, 1 Dec 2010 15:00:55 +0000"  >&lt;p&gt;Uwe: I don&apos;t interpret it that way!&lt;/p&gt;

&lt;p&gt;I don&apos;t think our indexinputs should be doing writes!&lt;/p&gt;</comment>
                    <comment id="12965740" author="mikemccand" created="Wed, 1 Dec 2010 16:50:06 +0000"  >&lt;p&gt;+1, this is a no brainer.  I had no idea linux lets you turn off atime per file desriptor!&lt;/p&gt;

&lt;p&gt;It&apos;s ridiculous that the OS maintains an atime on our index files.&lt;/p&gt;

&lt;p&gt;Uwe, I agree about the intention of the man page (so eg back when contrib/benchmark used to write 10,000 files to run its tests, and then index them, we could&apos;ve seen a big speedup &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;20&quot; width=&quot;20&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; ), but still it can&apos;t hurt to also turn it off when opening the index files for reading.&lt;/p&gt;

&lt;p&gt;I think atime is updated per-read not just at open (&lt;a href=&quot;http://lkml.org/lkml/1998/12/14/81&quot; class=&quot;external-link&quot;&gt;http://lkml.org/lkml/1998/12/14/81&lt;/a&gt;) though I&apos;m not sure.  Even so, it&apos;s presumably cached in the OS&apos;s write buffer and then only flushed periodically, so I don&apos;t think we&apos;ll see sizable gains here.  But every bit counts so I think we should do it.&lt;/p&gt;</comment>
                    <comment id="12965752" author="simonw" created="Wed, 1 Dec 2010 17:28:47 +0000"  >&lt;p&gt;after all i think we should really do it. I can not think of any situation where you want atime to be updated here. It seems that lots of distributions use relatime which is smarter about it see: &lt;a href=&quot;http://lwn.net/Articles/244829/&quot; class=&quot;external-link&quot;&gt;http://lwn.net/Articles/244829/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;we should really document that on the wiki so that folks can check what their dist does or by default set it to noatime.&lt;/p&gt;

&lt;p&gt;simon&lt;/p&gt;</comment>
                    <comment id="12966631" author="rcmuir" created="Fri, 3 Dec 2010 19:09:26 +0000"  >&lt;p&gt;Committed revision 1041954 (trunk), 1041957 (3x)&lt;/p&gt;</comment>
                    <comment id="13013398" author="gsingers" created="Wed, 30 Mar 2011 16:50:12 +0100"  >&lt;p&gt;Bulk close for 3.1&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12465043" name="LUCENE-2787.patch" size="758" author="rcmuir" created="Wed, 1 Dec 2010 14:19:28 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 1 Dec 2010 14:37:58 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>11067</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24905</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Tue Jul 16 13:03:45 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-3533/LUCENE-3533.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[LUCENE-3533] Nuke SpanFilters and CachingSpanFilter (maybe move to sandbox)</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-3533</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                        <description>&lt;p&gt;SpanFilters are inefficient and OOM easily (they don&apos;t scale at all: Create large Lists of Objects for every match, also filtering deleted docs is a pain). Some talks with Grant on Eurocon and also the fact that caching of them is still broken in 3.x (but fixed on trunk) - I assume nobody uses them, so let&apos;s nuke them. They are also in wrong package, so standard statement: &quot;Die, SpanFilters, die!&quot;&lt;/p&gt;</description>
                <environment></environment>
            <key id="12528662">LUCENE-3533</key>
            <summary>Nuke SpanFilters and CachingSpanFilter (maybe move to sandbox)</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="rcmuir">Robert Muir</assignee>
                                <reporter username="thetaphi">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Tue, 25 Oct 2011 13:32:04 +0100</created>
                <updated>Fri, 10 May 2013 11:43:53 +0100</updated>
                    <resolved>Mon, 14 Nov 2011 17:02:39 +0000</resolved>
                                            <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13134981" author="gsingers" created="Tue, 25 Oct 2011 13:34:07 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                    <comment id="13144799" author="rcmuir" created="Sat, 5 Nov 2011 19:17:57 +0000"  >&lt;p&gt;I&apos;m gonna try to work on this: I have a perf improvement to spans and this class prevents it.&lt;/p&gt;</comment>
                    <comment id="13144812" author="rcmuir" created="Sat, 5 Nov 2011 19:55:22 +0000"  >&lt;p&gt;Patch, nuking these, but also removing stupid extra seeks from SpanQueries.&lt;/p&gt;

&lt;p&gt;The problem is currently:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;seek to every term in every segment to compute IDF/etc&lt;/li&gt;
	&lt;li&gt;seek to every term again in every segment to get docsAndPositionsEnum&lt;/li&gt;
	&lt;li&gt;(possibly) seek to every term AGAIN in each segment if it doesn&apos;t exist, this is when d&amp;amp;penum returns null, to throw an error message &quot;positions were not indexed&quot;. if this third seek returns null it will return EMPTY_SPANS&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;with the patch we just do 1 seek&lt;/p&gt;</comment>
                    <comment id="13148870" author="thetaphi" created="Sat, 12 Nov 2011 00:04:24 +0000"  >&lt;p&gt;Robert do you want to take this? Should we nuke it on 3.x, too?&lt;/p&gt;</comment>
                    <comment id="13148888" author="rcmuir" created="Sat, 12 Nov 2011 00:20:35 +0000"  >&lt;p&gt;It would be good to get a review on the patch: I think its ok in general.&lt;/p&gt;

&lt;p&gt;it removes a lot of stupidity from the spans, except for one case:&lt;/p&gt;

&lt;p&gt;the SpanMultiTermQueryWrapper is still not single pass (it simply throws all termcontexts away).&lt;/p&gt;

&lt;p&gt;I thought about how to solve that one too, and I&apos;m convinced its unfixable&lt;br/&gt;
because SpanQueries aren&apos;t really query trees, its just one query that&lt;br/&gt;
calls extractTerms on everything underneath it.&lt;/p&gt;

&lt;p&gt;For this reason, even if i made this MTQ one single-pass by allowing TermContexts&lt;br/&gt;
to be passed to e.g. SpanOrQuery, it would work, but if you had that query inside&lt;br/&gt;
another SpanQuery then it would still do the extra seek like it does now.&lt;/p&gt;

&lt;p&gt;But still, with the patch spans are a little better.&lt;/p&gt;</comment>
                    <comment id="13149327" author="mikemccand" created="Sun, 13 Nov 2011 18:39:01 +0000"  >&lt;p&gt;Patch looks good!  One less query relying on TermsEnum caching...&lt;/p&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12502615" name="LUCENE-3533.patch" size="56217" author="rcmuir" created="Sat, 5 Nov 2011 19:55:22 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 25 Oct 2011 12:34:07 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>214523</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                <customfieldname>Lucene Fields</customfieldname>
                <customfieldvalues>
                        <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>24164</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
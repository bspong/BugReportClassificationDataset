<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:34:51 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-2772/JCR-2772.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-2772] replacing an extended mixin with it&apos;s supertype is problematic</title>
                <link>https://issues.apache.org/jira/browse/JCR-2772</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>node.addMixin() / node.removeMixin() have some checks to avoid redundant mixin settings on a node and not only when the node is saved.&lt;br/&gt;
&lt;br/&gt;
eg: have 2 mixins: mix:A and mix:AA where mix:AA &amp;gt; mix:A and a node (N with mix:AA) on it.&lt;br/&gt;
&lt;br/&gt;
then, N.addMixin(mix:A)  has no effect, since it&amp;#39;s regarded as redundant.  so you have to remove mix:AA first and then add mix:A.&lt;br/&gt;
there is the first problem when applying mixin types programmatically, just be sure to remove them first before adding new ones.&lt;br/&gt;
&lt;br/&gt;
the 2nd problem occurs when mix:A has a mandatory property. then somehow when downgrading from mix:AA to mix:A, some information is lost, and a save call results in&lt;br/&gt;
&lt;br/&gt;
Unable to save node &amp;#39;N&amp;#39;: javax.jcr.nodetype.ConstraintViolationException: /test/A: mandatory property {}prop does not exist.&lt;br/&gt;
you need to &amp;quot;touch&amp;quot; the property, otherwise it will not work.&lt;br/&gt;
&lt;br/&gt;
so only this works:&lt;br/&gt;
&lt;br/&gt;
N.removeMixin(&amp;quot;mix:AA&amp;quot;);&lt;br/&gt;
N.addMixin(&amp;quot;mix:A&amp;quot;);&lt;br/&gt;
N.setProperty(&amp;quot;prop&amp;quot;, N.getProperty(&amp;quot;prop&amp;quot;).getValue());&lt;br/&gt;
session.save();&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12476890">JCR-2772</key>
            <summary>replacing an extended mixin with it&apos;s supertype is problematic</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="tripod">Tobias Bocanegra</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Oct 2010 20:31:55 +0100</created>
                <updated>Tue, 8 Nov 2011 15:52:10 +0000</updated>
                    <resolved>Mon, 25 Oct 2010 17:25:49 +0100</resolved>
                            <version>2.0</version>
                                <fixVersion>2.2</fixVersion>
                                <component>jackrabbit-core</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12919358" author="tripod" created="Fri, 8 Oct 2010 20:33:40 +0100"  >ideally, unneeded mixin types are not removed until the save call.</comment>
                    <comment id="12919756" author="mreutegg" created="Mon, 11 Oct 2010 09:49:22 +0100"  >&amp;gt; checks to avoid redundant mixin&lt;br/&gt;
&lt;br/&gt;
is this mandated by the specification?</comment>
                    <comment id="12919764" author="stefan@jira" created="Mon, 11 Oct 2010 10:34:09 +0100"  >not a bug since the current behavior is according to the spec.</comment>
                    <comment id="12919878" author="stefan@jira" created="Mon, 11 Oct 2010 16:51:23 +0100"  >&amp;gt; &amp;gt; checks to avoid redundant mixin &lt;br/&gt;
&amp;gt;&lt;br/&gt;
&amp;gt; is this mandated by the specification?&lt;br/&gt;
&lt;br/&gt;
yes, see [1].&lt;br/&gt;
&lt;br/&gt;
&amp;lt;quote&amp;gt;&lt;br/&gt;
If this node is already of type mixinName (either due to a previously added mixin or due to its primary type, through inheritance) then this method has no effect. Otherwise mixinName is added to this node&amp;#39;s jcr:mixinTypes property.&lt;br/&gt;
&amp;lt;/quote&amp;gt;&lt;br/&gt;
&lt;br/&gt;
there&amp;#39;s also a TCK test which expects the current behavior (adding a redundant mixin results in a nop).&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://www.day.com/maven/jsr170/javadocs/jcr-2.0/javax/jcr/Node.html#addMixin(java.lang.String)&quot;&gt;http://www.day.com/maven/jsr170/javadocs/jcr-2.0/javax/jcr/Node.html#addMixin(java.lang.String)&lt;/a&gt;</comment>
                    <comment id="12924611" author="stefan@jira" created="Mon, 25 Oct 2010 17:24:37 +0100"  >&lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2788&quot; title=&quot;Provide a JackrabbitNode#setMixins(String[] mixinNames) method&quot;&gt;&lt;strike&gt;JCR-2788&lt;/strike&gt;&lt;/a&gt; resolves this issue by providing a JackrabbitNode#setMixins() method</comment>
                    <comment id="12924613" author="stefan@jira" created="Mon, 25 Oct 2010 17:25:49 +0100"  >resolved as duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2788&quot; title=&quot;Provide a JackrabbitNode#setMixins(String[] mixinNames) method&quot;&gt;&lt;strike&gt;JCR-2788&lt;/strike&gt;&lt;/a&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="12310000">
                <name>Duplicate</name>
                                                <inwardlinks description="is duplicated by">
                            <issuelink>
            <issuekey id="12477633">JCR-2788</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 11 Oct 2010 08:49:22 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>97835</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>280278</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
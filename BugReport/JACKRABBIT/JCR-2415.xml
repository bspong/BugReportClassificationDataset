<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:36:45 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-2415/JCR-2415.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-2415] Update Lucene to 3.0</title>
                <link>https://issues.apache.org/jira/browse/JCR-2415</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>Lucene 3.0 was released on 2009/11/25. They migrated to Java 1.5 as Jackrabbit is doing with 2.0. Also they added some new optimizations. It would be nice if Jackrabbit could switch to the new lucene version too.</description>
                <environment></environment>
            <key id="12442073">JCR-2415</key>
            <summary>Update Lucene to 3.0</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mduerig">Michael D&#252;rig</assignee>
                                <reporter username="akiraly">Attila Kir&#225;ly</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Dec 2009 11:30:30 +0000</created>
                <updated>Tue, 8 Nov 2011 15:56:08 +0000</updated>
                    <resolved>Thu, 27 Jan 2011 09:36:18 +0000</resolved>
                            <version>2.0-beta3</version>
                                <fixVersion>2.3</fixVersion>
                                <component>query</component>
                        <due></due>
                    <votes>9</votes>
                        <watches>8</watches>
                                                    <comments>
                    <comment id="12967187" author="kimmobj" created="Mon, 6 Dec 2010 13:58:19 +0000"  >Just a comment on recent developments regarding this issue.&lt;br/&gt;
&lt;br/&gt;
With Hibernate 3.6 this is even more important now. Hibernate 3.6 does not work with older Hibernate Search.&lt;br/&gt;
And new Hibernate Search can not work with Lucene 2.4.x&lt;br/&gt;
&lt;br/&gt;
So everyone using Hibernate + Hibernate Search + Jackrabbit is now stuck upgrading until Jackrabbit supports newer Lucene (2.9.x is enough at the moment).&lt;br/&gt;
&lt;br/&gt;
This is really urgent for us.&lt;br/&gt;
</comment>
                    <comment id="12973168" author="kimmobj" created="Mon, 20 Dec 2010 10:56:22 +0000"  >No comment on this yet?&lt;br/&gt;
&lt;br/&gt;
At the moment we run Jackrabbit and Hibernate in production on a big Swedish website. We encountered a bug in Hibernate 3.5.x that is fixed in 3.6.x. So we have to upgrade to 3.6.x. Getting urgent.&lt;br/&gt;
&lt;br/&gt;
Hibernate Search 3.3 was just released supporting Lucene 3.0 as well. It&amp;#39;s sad we can not run Jackrabbit and Hibernate Search 3.3 either.&lt;br/&gt;
</comment>
                    <comment id="12977848" author="jukkaz" created="Wed, 5 Jan 2011 17:03:14 +0000"  >Anyone interested in working on this? I&amp;#39;d love to help out, but don&amp;#39;t have the time to drive the effort.</comment>
                    <comment id="12978270" author="bhillou" created="Thu, 6 Jan 2011 11:04:49 +0000"  >I wish I could help out but it&amp;#39;s not possible in the immediate future but I&amp;#39;m also very interested in this.</comment>
                    <comment id="12983791" author="yabon" created="Wed, 19 Jan 2011 16:52:38 +0000"  >I have a working upgrade to Lucene 2.9.4 where code compiles and tests are running fine.&lt;br/&gt;
I just created a topic branch for this in sandbox to ease review and do not break the trunk:&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc/jackrabbit/sandbox/JCR-2415-lucene-3.0/&quot;&gt;http://svn.apache.org/viewvc/jackrabbit/sandbox/JCR-2415-lucene-3.0/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Here is what I have done so far, but I am not confident so it will need a serious review :):&lt;br/&gt;
- change dependency to use Lucene 2.9.4&lt;br/&gt;
- remove most of the deprecated classes/methods&lt;br/&gt;
- JR HitCollector =&amp;gt; Lucene Collector =&amp;gt; JR AbstractHitCollector&lt;br/&gt;
- use new Scorer abstract class with new  boolean params scoreDocsInOrder and topScorer&lt;br/&gt;
- use Version.LUCENE_24 for backward compatibility (JackrabbitQueryParser, JackrabbitAnalyzer, StandardAnalyzer, MoreLikeThis)&lt;br/&gt;
- creating the directory in FSDirectoryManager (not done by Lucene anymore?)&lt;br/&gt;
- use Java 5 generics when appropriate&lt;br/&gt;
- use @SuppressWarnings annotation with &amp;quot;unchecked&amp;quot;, &amp;quot;serial&amp;quot; and &amp;quot;rawtypes&amp;quot;&lt;br/&gt;
&lt;br/&gt;
What need to be done:&lt;br/&gt;
- remove last deprecated classe/methods, that is convert SortComparatorSource/ScoreDocComparator implementation to FieldComparatorSource/FieldComparator&lt;br/&gt;
- test integration with Lucene 3.0.3 to ensure compatibility with Lucene 3.0.x&lt;br/&gt;
&lt;br/&gt;
I think that sticking to 2.9.4 might be the best approach because:&lt;br/&gt;
- users still using Lucene 2.4.x/2.9.x will have an easier integration that migrating Lucene 3.0.x&lt;br/&gt;
- users wanting to use Lucene 3.0.x can force it it maven and have a working search in JR&lt;br/&gt;
</comment>
                    <comment id="12984310" author="mduerig" created="Thu, 20 Jan 2011 18:02:28 +0000"  >Coincidentally I did just about the same thing yesterday and it seems we arrived at more or less the same point independently. However, your work seems to be more mature than mine. &lt;br/&gt;
&lt;br/&gt;
It would certainly be nice to get to the point where Lucene 3.0.x could be used. Therefore we need to get rid of SortComparatorSource/ScoreDocComparator which have been removed in Lucene 3. It doesn&amp;#39;t seem to be a simple matter of switching to FieldComparatorSource/FieldComparator since these do not compose (i.e. for implementing upper/lower case sorting on top of an existing comparator). &lt;br/&gt;
&lt;br/&gt;
I just switched to your branch and will see what I can do.</comment>
                    <comment id="12984599" author="bhillou" created="Fri, 21 Jan 2011 08:02:23 +0000"  >Thanks for the work. &lt;br/&gt;
&lt;br/&gt;
Do you know how this change should affect query performance ? Should it improve, or will it degrade ?&lt;br/&gt;
&lt;br/&gt;
Best regards,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;Serge Huber.</comment>
                    <comment id="12984657" author="mduerig" created="Fri, 21 Jan 2011 10:10:17 +0000"  >Some proposed changes/fixes to S&amp;#xE9;bastien Launay&amp;#39;s initial work</comment>
                    <comment id="12984736" author="mduerig" created="Fri, 21 Jan 2011 13:38:15 +0000"  >DocIdSetIterator.patch: removing usages of deprecated methods from DocIdSetIterator</comment>
                    <comment id="12984777" author="mduerig" created="Fri, 21 Jan 2011 15:46:34 +0000"  >cumulative patch: this patch includes changes from both previous patches (review.patch and DocIdSetIterator.patch). Furthermore it removes more deprecated API usage. &lt;br/&gt;
&lt;br/&gt;
With this patch the remaining cases where deprecated API is used are all related to sorting (i.e. ScoreDocComparator, SortComaratorSource, SortComparator, TopFieldDocCollector). The respective locations are marked with // fixme lucene</comment>
                    <comment id="12985560" author="yabon" created="Mon, 24 Jan 2011 08:39:36 +0000"  >&amp;gt; It would certainly be nice to get to the point where Lucene 3.0.x could be used. &lt;br/&gt;
&lt;br/&gt;
Definitely, I&amp;#39;ll see if I can find a way to keep the Adapter pattern and use String[Ord]ValComparator.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; Some proposed changes/fixes&lt;br/&gt;
&lt;br/&gt;
Indeed from what I have seen these changes look complementary so do not hesitate to commit them, that&amp;#39;s why I created a topic branch at first.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; Do you know how this change should affect query performance ? Should it improve, or will it degrade ?&lt;br/&gt;
&lt;br/&gt;
I think performance will be better because the new Lucene classes are more complex in order to be more efficient (this is typically the case for FieldComparator [1] which render migration difficult).&lt;br/&gt;
One thing I&amp;#39;m sure is that the index size on disk will be larger because we no longer compress stored field larger than 16K.&lt;br/&gt;
Jukka&amp;#39;s performance test suite will be handy to produce performance numbers before/after the migration.&lt;br/&gt;
&lt;br/&gt;
[1] &lt;a href=&quot;http://lucene.apache.org/java/3_0_3/api/core/org/apache/lucene/search/FieldComparator.html&quot;&gt;http://lucene.apache.org/java/3_0_3/api/core/org/apache/lucene/search/FieldComparator.html&lt;/a&gt;</comment>
                    <comment id="12985707" author="mduerig" created="Mon, 24 Jan 2011 14:32:42 +0000"  >Applied cumulative.patch with some minor cleanup at revision 1062799:&lt;br/&gt;
&lt;br/&gt;
- closing token stream&lt;br/&gt;
- removed usage of deprecated methods of DocIdSetIterator&lt;br/&gt;
- removed deprecated usage of Token class&lt;br/&gt;
- eomved deprecated usage of StandardAnalyzer&lt;br/&gt;
- various minor improvements</comment>
                    <comment id="12987017" author="mduerig" created="Wed, 26 Jan 2011 14:17:02 +0000"  >Revision 1063730 upgrades Lucene to version 3.0.3. All test cases pass.&lt;br/&gt;
</comment>
                    <comment id="12987459" author="mduerig" created="Thu, 27 Jan 2011 09:36:18 +0000"  >Fixed at revision 1064058:&lt;br/&gt;
Merge all from &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2415&quot; title=&quot;Update Lucene to 3.0&quot;&gt;&lt;strike&gt;JCR-2415&lt;/strike&gt;&lt;/a&gt;-lucene-3.0 at 1064038 (reintegration)</comment>
                    <comment id="13024694" author="topping" created="Mon, 25 Apr 2011 00:52:16 +0100"  >Any chance of deploying a SNAPSHOT?  </comment>
                    <comment id="13025188" author="yabon" created="Tue, 26 Apr 2011 12:58:09 +0100"  >You can find the snapshot build by Jenkins (&lt;a href=&quot;https://builds.apache.org/hudson/job/Jackrabbit-trunk/&quot;&gt;https://builds.apache.org/hudson/job/Jackrabbit-trunk/&lt;/a&gt;) and uploaded here:&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/&quot;&gt;https://repository.apache.org/&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
You can also build the project from the sources:&lt;br/&gt;
&lt;a href=&quot;http://jackrabbit.apache.org/building-jackrabbit.html&quot;&gt;http://jackrabbit.apache.org/building-jackrabbit.html&lt;/a&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12468979" name="cumulative.patch" size="67690" author="mduerig" created="Fri, 21 Jan 2011 15:46:34 +0000" />
                    <attachment id="12468972" name="DocIdSetIterator.patch" size="32181" author="mduerig" created="Fri, 21 Jan 2011 13:38:15 +0000" />
                    <attachment id="12468960" name="review.patch" size="1263" author="mduerig" created="Fri, 21 Jan 2011 10:10:17 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 6 Dec 2010 13:58:19 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>97783</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>250319</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:42:44 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-2655/JCR-2655.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-2655] initVersions crashes with NPE</title>
                <link>https://issues.apache.org/jira/browse/JCR-2655</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>After delete some old versions. I get serious problems accessing the version history.&lt;br/&gt;
This is the stacktrace:&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.jackrabbit.core.version.VersionIteratorImpl.initVersions(VersionIteratorImpl.java:169)&lt;br/&gt;
	at org.apache.jackrabbit.core.version.VersionIteratorImpl.&amp;lt;init&amp;gt;(VersionIteratorImpl.java:87)&lt;br/&gt;
	at org.apache.jackrabbit.core.version.VersionIteratorImpl.&amp;lt;init&amp;gt;(VersionIteratorImpl.java:72)&lt;br/&gt;
	at org.apache.jackrabbit.core.version.VersionHistoryImpl.getAllVersions(VersionHistoryImpl.java:92)&lt;br/&gt;
&lt;br/&gt;
I stepped threw the code and see that the Method &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;currentVersion.getSuccessors() &lt;br/&gt;
returns an empty Array.&lt;br/&gt;
&lt;br/&gt;
After all the VersionHistory seems to be corrupt!!</description>
                <environment></environment>
            <key id="12466892">JCR-2655</key>
            <summary>initVersions crashes with NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="tripod">Tobias Bocanegra</assignee>
                                <reporter username="jmelzer">Juergen Melzer</reporter>
                        <labels>
                        <label>VersionHistory</label>
                        <label>VersionIterator</label>
                    </labels>
                <created>Mon, 14 Jun 2010 12:55:17 +0100</created>
                <updated>Fri, 23 Sep 2011 15:23:00 +0100</updated>
                    <resolved>Fri, 24 Sep 2010 16:35:03 +0100</resolved>
                            <version>1.6.2</version>
                <version>2.1</version>
                                <fixVersion>2.0.5</fixVersion>
                <fixVersion>2.1.6</fixVersion>
                <fixVersion>2.2</fixVersion>
                                <component>versioning</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12878550" author="tripod" created="Mon, 14 Jun 2010 13:21:30 +0100"  >this issue is fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2613&quot; title=&quot;NoSuchItemStateException on checkin after removeVersion in XA Environment&quot;&gt;&lt;strike&gt;JCR-2613&lt;/strike&gt;&lt;/a&gt;</comment>
                    <comment id="12878590" author="jmelzer" created="Mon, 14 Jun 2010 15:25:09 +0100"  >Sorry but the bug still exists in my repository.&lt;br/&gt;
Update to 1.6.2 but the Exception is the same.&lt;br/&gt;
&lt;br/&gt;
Is the repository now corrupt?</comment>
                    <comment id="12878597" author="tripod" created="Mon, 14 Jun 2010 15:44:45 +0100"  >yes. the issue is only fixed for new version removals. if the repository is corrupt, it stays corrupt.</comment>
                    <comment id="12878867" author="tripod" created="Tue, 15 Jun 2010 07:30:23 +0100"  >the inconsistent versions that no longer exist in the repository should be skipped in initVersions().</comment>
                    <comment id="12879494" author="tripod" created="Wed, 16 Jun 2010 22:02:17 +0100"  >i will look at this before the respective releases</comment>
                    <comment id="12895268" author="jukkaz" created="Wed, 4 Aug 2010 15:19:15 +0100"  >Unblocking 2.1.1 and 1.6.3.</comment>
                    <comment id="12914504" author="jukkaz" created="Fri, 24 Sep 2010 16:35:03 +0100"  >Fixed in revision 1000912 by making the code explicitly skip (and log warnings for) missing successors.</comment>
                    <comment id="13061229" author="rah003" created="Thu, 7 Jul 2011 12:50:41 +0100"  >Hi Jukka,&lt;br/&gt;
&lt;br/&gt;
can I ask why you &amp;quot;unblocked&amp;quot; the 1.6.3 when the issue is fixed only in 2.2.0? Imho this issue is still a blocker for 1.6 branch.&lt;br/&gt;
Would it be possible to backport the fix?&lt;br/&gt;
&lt;br/&gt;
Also the fix in 2.2.0 seems to be just working around the problem, but not attempting to fix already corrupted version history. Is there a way to fix this problem by removing the invalid versions?&lt;br/&gt;
&lt;br/&gt;
Thanks.</comment>
                    <comment id="13113359" author="jukkaz" created="Fri, 23 Sep 2011 13:19:04 +0100"  >&amp;gt; can I ask why you &amp;quot;unblocked&amp;quot; the 1.6.3 when the issue is fixed only in 2.2.0?&lt;br/&gt;
&lt;br/&gt;
We didn&amp;#39;t have a fix ready in time for 1.6.3, and I considered it more important to have the other fixes in the 1.6.x branches released at the time without waiting for this fix.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; Would it be possible to backport the fix? &lt;br/&gt;
&lt;br/&gt;
Backporting the fix to 1.6.x is non-trivial, since the relevant code has evolved quite a bit since the 1.6 branch was created. I have now backported the fix to the 2.1 and 2.0 branches (see revisions 1174686 and 1174688). I would recommend upgrading to 2.x since we&amp;#39;re in any case about to declare the end of life of the 1.6 branch after the next patch release.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; Also the fix in 2.2.0 seems to be just working around the problem, but&lt;br/&gt;
&amp;gt; not attempting to fix already corrupted version history. Is there a way&lt;br/&gt;
&amp;gt; to fix this problem by removing the invalid versions?&lt;br/&gt;
&lt;br/&gt;
I haven&amp;#39;t tried it, but with this fix in place you should be able to access and modify the version history, so removing broken versions should be possible.</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 14 Jun 2010 12:21:30 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>59579</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>189681</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
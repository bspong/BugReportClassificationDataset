<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:29:11 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-2880/JCR-2880.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-2880] Save fails after setting a binary property twice</title>
                <link>https://issues.apache.org/jira/browse/JCR-2880</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>Setting a binary property twice discards the blob value of the first property state but does not remove the change from the changelog, resulting in an error on save:&lt;br/&gt;
&lt;br/&gt;
javax.jcr.RepositoryException: this BLOBFileValue has been disposed&lt;br/&gt;
	at org.apache.jackrabbit.core.value.RefCountingBLOBFileValue.copy(RefCountingBLOBFileValue.java:105)&lt;br/&gt;
&lt;br/&gt;
will attach patch that adds the respective test to the jcr2spi tests.</description>
                <environment></environment>
            <key id="12497826">JCR-2880</key>
            <summary>Save fails after setting a binary property twice</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="anchela">angela</assignee>
                                <reporter username="tripod">Tobias Bocanegra</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Feb 2011 10:06:23 +0000</created>
                <updated>Thu, 21 Apr 2011 11:38:36 +0100</updated>
                    <resolved>Tue, 5 Apr 2011 14:33:50 +0100</resolved>
                            <version>2.2</version>
                <version>2.2.1</version>
                <version>2.2.2</version>
                                <fixVersion>2.2.7</fixVersion>
                <fixVersion>2.3</fixVersion>
                                <component>jackrabbit-jcr2spi</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12991318" author="tripod" created="Mon, 7 Feb 2011 10:08:57 +0000"  >based on jackrabbit 2.2 branch</comment>
                    <comment id="12991967" author="anchela" created="Tue, 8 Feb 2011 13:52:46 +0000"  >&amp;gt; Setting a binary property twice discards the blob value of the first property state but does not remove the change from the changelog&lt;br/&gt;
&lt;br/&gt;
consolidation (or cleanup) of the changelog is not the responsibility of jcr2spi but rather of the SPI implementation.&lt;br/&gt;
i assume discarding the previous values is wrong... but will take a closer look at it asap.</comment>
                    <comment id="12991978" author="tripod" created="Tue, 8 Feb 2011 14:14:18 +0000"  >from the little debugging i conducted, i think that the first setProperty() adds the state to the &amp;quot;added&amp;quot; collection, and the 2nd to the &amp;quot;modified&amp;quot; collection.&lt;br/&gt;
imo this is not correct, the state should remain in the &amp;quot;added&amp;quot; collection only.</comment>
                    <comment id="12991981" author="anchela" created="Tue, 8 Feb 2011 14:17:46 +0000"  >jcr2spi records all modifications without making any kind of cleanup... it doesn&amp;#39;t work the same way as jackrabbit-core.</comment>
                    <comment id="13015808" author="anchela" created="Tue, 5 Apr 2011 09:46:33 +0100"  >btw: the problem is not caused by &amp;#39;added&amp;#39; vs. &amp;#39;modified&amp;#39;. the same error occurs if you have an existing binary property and modify it twice before saving. imo the cause of the problem is the disposal of the values upon modification. that should be deferred to the completion of the SetProperty operation.</comment>
                    <comment id="13016206" author="tripod" created="Wed, 6 Apr 2011 02:02:15 +0100"  >thanks. works as expected.</comment>
                </comments>
                    <attachments>
                    <attachment id="12470429" name="add_bin_twice.patch" size="928" author="tripod" created="Mon, 7 Feb 2011 10:08:57 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 8 Feb 2011 13:52:46 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>78141</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>190377</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
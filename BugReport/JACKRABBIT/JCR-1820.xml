<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:52:46 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-1820/JCR-1820.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-1820] Ensure queries are not blocked during large updates</title>
                <link>https://issues.apache.org/jira/browse/JCR-1820</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>The index currently guarantees that long running queries do not block updates. In addition a query *may* run during an update, but there is not guarantee because it depends on the availability of an index reader being available when the update starts. The index reader is invalidated at the end of the update, which will force the creation of a new index reader when the next query is executed.&lt;br/&gt;
&lt;br/&gt;
Consider the following scenario:&lt;br/&gt;
&lt;br/&gt;
1) update index -&amp;gt; transaction id T1&lt;br/&gt;
2) potential index reader is invalidated&lt;br/&gt;
3) execute query -&amp;gt; creates index reader R1, which includes changes up to T1&lt;br/&gt;
4) update index -&amp;gt; transaction id T2&lt;br/&gt;
5) index reader R1 is invalidated&lt;br/&gt;
6) update index (large transaction) -&amp;gt; transaction id T3&lt;br/&gt;
7) while previous update is running execute query -&amp;gt; thread is blocked because no reader is available&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
The improvement should detect the large transaction and prepare an index reader for potential queries during the update. That is, 6) should be split into:&lt;br/&gt;
&lt;br/&gt;
6a) detect large transaction and prepare index reader R2, which includes changes up to T2&lt;br/&gt;
6b) update index -&amp;gt; transaction id T3&lt;br/&gt;
&lt;br/&gt;
While the update is running a query will use index reader R2.</description>
                <environment></environment>
            <key id="12406692">JCR-1820</key>
            <summary>Ensure queries are not blocked during large updates</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="mreutegg">Marcel Reutegger</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Oct 2008 17:07:30 +0100</created>
                <updated>Thu, 13 Aug 2009 16:03:39 +0100</updated>
                    <resolved>Tue, 21 Oct 2008 16:07:20 +0100</resolved>
                                            <fixVersion>1.6</fixVersion>
                                <component>jackrabbit-core</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12641008" author="mreutegg" created="Mon, 20 Oct 2008 14:19:45 +0100"  >The proposed patch performs a check on the number of nodes that get added by the update and prepares an index reader when the number is higher than the buffer size. This should be a reasonable threshold because it will only trigger a writer flush when it is inevitable anyway.</comment>
                    <comment id="12641401" author="mreutegg" created="Tue, 21 Oct 2008 16:07:19 +0100"  >Committed patch in revision: 706649</comment>
                </comments>
                    <attachments>
                    <attachment id="12392483" name="JCR-1820.patch" size="13995" author="mreutegg" created="Mon, 20 Oct 2008 14:19:45 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>142870</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>279946</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
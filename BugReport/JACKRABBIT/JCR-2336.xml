<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:41:29 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-2336/JCR-2336.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-2336] Automatic type conversion no longer works</title>
                <link>https://issues.apache.org/jira/browse/JCR-2336</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>String values are no longer converted to binary when required. Example:&lt;br/&gt;
&lt;br/&gt;
Node n = testRootNode.addNode(&amp;quot;testConvert&amp;quot;, &amp;quot;nt:file&amp;quot;);&lt;br/&gt;
Node content = n.addNode(&amp;quot;jcr:content&amp;quot;, &amp;quot;nt:resource&amp;quot;);&lt;br/&gt;
content.setProperty(&amp;quot;jcr:lastModified&amp;quot;, Calendar.getInstance());&lt;br/&gt;
content.setProperty(&amp;quot;jcr:mimeType&amp;quot;, &amp;quot;text/html&amp;quot;);&lt;br/&gt;
content.setProperty(&amp;quot;jcr:data&amp;quot;, &amp;quot;Hello&amp;quot;);&lt;br/&gt;
n.getSession().save();&lt;br/&gt;
&lt;br/&gt;
This used to work in a previous 2.0 build, but now throws:&lt;br/&gt;
&lt;br/&gt;
javax.jcr.nodetype.ConstraintViolationException: no matching property definition found for {&lt;a href=&quot;http://www.jcp.org/jcr/1.0&quot;&gt;http://www.jcp.org/jcr/1.0&lt;/a&gt;}data&lt;br/&gt;
at org.apache.jackrabbit.core.nodetype.EffectiveNodeType.getApplicablePropertyDef(EffectiveNodeType.java:782)&lt;br/&gt;
at org.apache.jackrabbit.core.NodeImpl.getApplicablePropertyDefinition(NodeImpl.java:747)&lt;br/&gt;
at org.apache.jackrabbit.core.ItemManager.getDefinition(ItemManager.java:241)&lt;br/&gt;
at org.apache.jackrabbit.core.ItemData.getDefinition(ItemData.java:101)&lt;br/&gt;
at org.apache.jackrabbit.core.ItemManager.canRead(ItemManager.java:409)&lt;br/&gt;
at org.apache.jackrabbit.core.ItemManager.getItemData(ItemManager.java:383)&lt;br/&gt;
at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:316)&lt;br/&gt;
at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:595)&lt;br/&gt;
at org.apache.jackrabbit.core.NodeImpl.removeChildProperty(NodeImpl.java:554)&lt;br/&gt;
at org.apache.jackrabbit.core.NodeImpl.removeChildProperty(NodeImpl.java:534)&lt;br/&gt;
at org.apache.jackrabbit.core.NodeImpl.setProperty(NodeImpl.java:2303)&lt;br/&gt;
at org.apache.jackrabbit.core.nodetype.ConvertDataTypeTest.testStringToBinary(ConvertDataTypeTest.java:36)&lt;br/&gt;
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</description>
                <environment></environment>
            <key id="12436991">JCR-2336</key>
            <summary>Automatic type conversion no longer works</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mreutegg">Marcel Reutegger</assignee>
                                <reporter username="tmueller">Thomas Mueller</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Oct 2009 10:03:45 +0100</created>
                <updated>Mon, 11 Jan 2010 14:16:26 +0000</updated>
                    <resolved>Fri, 2 Oct 2009 07:55:58 +0100</resolved>
                            <version>2.0-alpha11</version>
                                <fixVersion>2.0-beta1</fixVersion>
                                <component>jackrabbit-core</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12761149" author="mreutegg" created="Thu, 1 Oct 2009 10:40:35 +0100"  >This is probably a regression caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2170&quot; title=&quot;Remove PropDefId and NodeDefId&quot;&gt;&lt;strike&gt;JCR-2170&lt;/strike&gt;&lt;/a&gt;.</comment>
                    <comment id="12761150" author="stefan@jira" created="Thu, 1 Oct 2009 10:45:45 +0100"  >yes, it is a regression of &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2170&quot; title=&quot;Remove PropDefId and NodeDefId&quot;&gt;&lt;strike&gt;JCR-2170&lt;/strike&gt;&lt;/a&gt;. &lt;br/&gt;
&lt;br/&gt;
other type conversions are probably affected as well.</comment>
                    <comment id="12761151" author="tmueller" created="Thu, 1 Oct 2009 10:50:43 +0100"  >There should be a test case in the TCK, but I&amp;#39;m not sure where. Relevant section in the spec is at page 31:&lt;br/&gt;
&lt;br/&gt;
&amp;quot;3.6.4 Property Type Conversion&lt;br/&gt;
When the value of a property is read or written using a type different from that &lt;br/&gt;
declared for the property, the repository attempts a type conversion according to &lt;br/&gt;
the following rules.&amp;quot;&lt;br/&gt;
&lt;br/&gt;
Is there a lookup table that links the spec to the TCK tests and back?</comment>
                    <comment id="12761211" author="alexander.klimetschek" created="Thu, 1 Oct 2009 14:28:19 +0100"  >I experienced the same issue. Proper workaround (because setProperty(String, InputStream) is deprecated in JCR 2.0) is:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;node.setProperty(JcrConstants.JCR_DATA,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;node.getSession().getValueFactory().createBinary(new ByteArrayInputStream(new byte[] {}))&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;);&lt;br/&gt;
&lt;br/&gt;
Grrr.</comment>
                    <comment id="12761487" author="mreutegg" created="Fri, 2 Oct 2009 07:33:59 +0100"  >&amp;gt; [...] workround [...]&lt;br/&gt;
&lt;br/&gt;
that will work, but you should also call Binary.dispose() once you are done with the created Binary instance. Otherwise you depend on the GC and a well behaving implementation that will hopefully clean up resource held by the Binary (e.g. temp file).</comment>
                    <comment id="12761489" author="mreutegg" created="Fri, 2 Oct 2009 07:55:58 +0100"  >- fixed automatic type conversion&lt;br/&gt;
- cleaned up setProperty() methods and removed duplicate code&lt;br/&gt;
- added tests in core.NodeImplTest&lt;br/&gt;
&lt;br/&gt;
svn revision: 820908</comment>
                    <comment id="12761517" author="alexander.klimetschek" created="Fri, 2 Oct 2009 11:04:18 +0100"  >&amp;gt; but you should also call Binary.dispose() once you are done with the created Binary instance&lt;br/&gt;
&lt;br/&gt;
Argh.... who came up with that beast ;-)</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 1 Oct 2009 09:40:35 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>78255</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>190696</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
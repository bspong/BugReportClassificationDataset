<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:41:23 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-540/JCR-540.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-540] AbstractJCRTest fails on level 1 repositories</title>
                <link>https://issues.apache.org/jira/browse/JCR-540</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>If a test case indicates that it&amp;#39;s not read-only, org.apache.jackrabbit.test.AbstractJCRTest tries to cleanup the test root in the setUp method. This will cause the test case to fail, because a Level 1 repository will throw an UnsupportedOperationException here.&lt;br/&gt;
&lt;br/&gt;
Proposal: before trying the cleanup, check for L2 functionality and throw a NotExecutableException otherwise:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (! isSupported(Repository.LEVEL_2_SUPPORTED)) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;cleanUp();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String msg = &amp;quot;Test case requires level 2 functionality&amp;quot;;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;throw new NotExecutableException(msg);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12347696">JCR-540</key>
            <summary>AbstractJCRTest fails on level 1 repositories</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="reschke">Julian Reschke</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Aug 2006 14:00:08 +0100</created>
                <updated>Fri, 13 Oct 2006 17:03:29 +0100</updated>
                    <resolved>Fri, 11 Aug 2006 13:33:21 +0100</resolved>
                                            <fixVersion>1.1</fixVersion>
                                <component>jackrabbit-jcr-tests</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12427210" author="reschke" created="Thu, 10 Aug 2006 14:20:34 +0100"  >Proposed patch.</comment>
                    <comment id="12427226" author="mreutegg" created="Thu, 10 Aug 2006 15:02:50 +0100"  >This is done on purpose. Throwing a NotExecutableException will indicate to the TCK that the test case&lt;br/&gt;
did not fail even though it did not run. Hence the test was successful.&lt;br/&gt;
&lt;br/&gt;
If all Level 2 tests on a Level 1 repository throw NotExecutableExceptions the TCK would finally declare the Repository Level 2 compliant which is not the case.&lt;br/&gt;
&lt;br/&gt;
Failing Level 2 test cases of a Level 1 repository do *not* have an effect on its Level 1 compliance.</comment>
                    <comment id="12427233" author="reschke" created="Thu, 10 Aug 2006 15:13:24 +0100"  >Well.&lt;br/&gt;
&lt;br/&gt;
I can&amp;#39;t run api.TestAll on a level 1 rep, because the cleanup code tails, and leaves dangling sessions. So - at least over here - the test suite never terminates. Can we agree that at a minimum, that needs to be fixed?&lt;br/&gt;
&lt;br/&gt;
Furthermore, is there a way to run just the level 1 tests? If not, how is a tester supposed to know whether the repository is L1 compliant without having to investigate each and every test failure?&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12427273" author="reschke" created="Thu, 10 Aug 2006 18:09:46 +0100"  >New proposed patch, not using NotExecutableException.&lt;br/&gt;
&lt;br/&gt;
I&amp;#39;d still like to see an easy way to find out whether a repository supports L1 completely. Did I miss something? If not, should I open a separate issue?&lt;br/&gt;
</comment>
                    <comment id="12427463" author="mreutegg" created="Fri, 11 Aug 2006 09:01:50 +0100"  >I agree. This session leak should be fixed. Which means this is indeed a bug not an enhancement.</comment>
                    <comment id="12427464" author="mreutegg" created="Fri, 11 Aug 2006 09:07:12 +0100"  >Thank you for the patch. I slightly changed your proposal because I would rather like to call fail() instead of throwing a RepositoryException.&lt;br/&gt;
&lt;br/&gt;
WDYT?&lt;br/&gt;
&lt;br/&gt;
Does that work for you?</comment>
                    <comment id="12427467" author="mreutegg" created="Fri, 11 Aug 2006 09:16:36 +0100"  >&amp;gt; I&amp;#39;d still like to see an easy way to find out whether a repository supports L1 completely.&lt;br/&gt;
&lt;br/&gt;
Yes, there is the official TCK, which comes with a test harness that executes the various test cases grouped in the specified compliance levels and optional features. There you can easily see which level 1 tests failed.&lt;br/&gt;
&lt;br/&gt;
See: &lt;br/&gt;
&lt;a href=&quot;http://jcp.org/aboutJava/communityprocess/final/jsr170/index.html&quot;&gt;http://jcp.org/aboutJava/communityprocess/final/jsr170/index.html&lt;/a&gt;&lt;br/&gt;
and&lt;br/&gt;
&lt;a href=&quot;http://www.day.com/site/en/index/related/downloads/tck_form.html&quot;&gt;http://www.day.com/site/en/index/related/downloads/tck_form.html&lt;/a&gt;&lt;br/&gt;
&lt;br/&gt;
Please note that the currently available TCK is based on the test cases present in the jackrabbit branch ri-1.0. While you are the test cases from jackrabbit trunk, which will eventually go into a maintenance release of the TCK at some time.</comment>
                    <comment id="12427479" author="reschke" created="Fri, 11 Aug 2006 10:19:26 +0100"  >Marcel, yes that patch works for me. Thanks.&lt;br/&gt;
</comment>
                    <comment id="12427513" author="mreutegg" created="Fri, 11 Aug 2006 13:33:21 +0100"  >Applied &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-540&quot; title=&quot;AbstractJCRTest fails on level 1 repositories&quot;&gt;&lt;strike&gt;JCR-540&lt;/strike&gt;&lt;/a&gt;-svn430367.patch.&lt;br/&gt;
&lt;br/&gt;
svn revision: 430758&lt;br/&gt;
&lt;br/&gt;
Thank you for reporting this issue.</comment>
                </comments>
                    <attachments>
                    <attachment id="12338609" name="JCR-540.diff.txt" size="737" author="reschke" created="Thu, 10 Aug 2006 18:09:46 +0100" />
                    <attachment id="12338593" name="JCR-540.diff.txt" size="740" author="reschke" created="Thu, 10 Aug 2006 14:20:34 +0100" />
                    <attachment id="12338678" name="JCR-540-svn430367.patch" size="1386" author="mreutegg" created="Fri, 11 Aug 2006 09:07:12 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 10 Aug 2006 14:02:50 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>142237</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>253509</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
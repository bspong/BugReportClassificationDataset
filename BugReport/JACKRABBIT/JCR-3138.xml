<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:33:07 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-3138/JCR-3138.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-3138] Skip sync delay when changes are found</title>
                <link>https://issues.apache.org/jira/browse/JCR-3138</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>The cluster synchronization on a slave does always wait for some time (as specified in the sync delay) before fetching changes. If a lot of changes are being written to the master, a slave will considerably fall behind the master in term of revisions, which may endanger the integrity of the cluster if the master will crash. I therefore suggest that a slave should rather immediately contact the master again after some changes have been found, until it sees no more changes.</description>
                <environment></environment>
            <key id="12530546">JCR-3138</key>
            <summary>Skip sync delay when changes are found</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="dpfister">Dominique Pfister</assignee>
                                <reporter username="dpfister">Dominique Pfister</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Nov 2011 10:17:29 +0000</created>
                <updated>Mon, 17 Sep 2012 12:51:58 +0100</updated>
                    <resolved>Tue, 29 Nov 2011 16:43:50 +0000</resolved>
                            <version>2.3.2</version>
                                <fixVersion>2.3.5</fixVersion>
                                <component>clustering</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13145327" author="schans" created="Mon, 7 Nov 2011 10:45:06 +0000"  >Hi Dominique,&lt;br/&gt;
&lt;br/&gt;
The &amp;quot;master&amp;quot; (although in a JR cluster all nodes are equal) writes it&amp;#39;s changes to the database in a clustered setup. The slave queries the database (and not the JR node) for changes. So even when all other nodes are down the slave will just pull the changes from the database. As long as the database is running there is no riks of loosing data or endangering the integrity. &lt;br/&gt;
&lt;br/&gt;
BTW, if you want to pull in changes on the slave you can do  a Session.refresh(). This will force the ClusterNode to perform a sync().&lt;br/&gt;
&lt;br/&gt;
Regards,&lt;br/&gt;
Bart</comment>
                    <comment id="13145335" author="dpfister" created="Mon, 7 Nov 2011 10:55:13 +0000"  >Hi Bart,&lt;br/&gt;
&lt;br/&gt;
Thank you for your comment. You&amp;#39;re absolutely right, in a standard cluster where the data itself is in shared storage such as a database, the slave will of course not talk to the master itself and the data does not get lost when the master crashes. We have a customized setup, however, where the data is not shared (every cluster node has a complete copy of the data) and where the slaves actually talk to the master: in order to support such a configuration, I&amp;#39;d like to make the sync loop more &amp;quot;customizable&amp;quot; by the actual journal implementation.&lt;br/&gt;
&lt;br/&gt;
Kind regards&lt;br/&gt;
Dominique</comment>
                    <comment id="13145341" author="schans" created="Mon, 7 Nov 2011 11:08:08 +0000"  >Hi Dominique,&lt;br/&gt;
&lt;br/&gt;
Thanks for explaining. I&amp;#39;ve been working on &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2968&quot; title=&quot;Add an option to read the Clustering Journal from a different source than the rest of the clustering info&quot;&gt;JCR-2968&lt;/a&gt; to get a similar setup (full replicas), but then through database replication. Maybe we should combine this issues with that one? I guess you&amp;#39;re mostly looking for a &amp;quot;hook&amp;quot; to plugin your customized code?&lt;br/&gt;
&lt;br/&gt;
Bart</comment>
                    <comment id="13145556" author="dpfister" created="Mon, 7 Nov 2011 15:29:40 +0000"  >Hi Bart,&lt;br/&gt;
&lt;br/&gt;
not quite: we already have our own journal implementation, derived from o.a.j.core.journal.AbstractJournal, and what I&amp;#39;d like to do now is break the body of doSync() into multiple steps that can be separately invoked by a subclass without having to resort to copy-paste. AFAICS, &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2968&quot; title=&quot;Add an option to read the Clustering Journal from a different source than the rest of the clustering info&quot;&gt;JCR-2968&lt;/a&gt; is related to database journaling, whereas our implementation is not, so I don&amp;#39;t think these two issues should be combined, what do you think?&lt;br/&gt;
&lt;br/&gt;
Dominique</comment>
                    <comment id="13159352" author="dpfister" created="Tue, 29 Nov 2011 16:43:50 +0000"  >Implemented as optional behavior that can be switched on with a subclass overridable.</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="12310050">
                <name>Regression</name>
                                <outwardlinks description="breaks">
                            <issuelink>
            <issuekey id="12607892">JCR-3427</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 7 Nov 2011 10:45:06 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>216285</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>250207</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
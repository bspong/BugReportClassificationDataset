<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:42:14 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-2427/JCR-2427.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-2427] UUIDDocId.getDocumentNumbers() may return illegal value</title>
                <link>https://issues.apache.org/jira/browse/JCR-2427</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>Happens when the node with the given UUID is not present in the index. The method then returns -1, which is illegal. Document numbers must be &amp;gt;= 0. The method must returns an empty array when the id is invalid, as documented in DocId.getDocumentNumbers().</description>
                <environment></environment>
            <key id="12442736">JCR-2427</key>
            <summary>UUIDDocId.getDocumentNumbers() may return illegal value</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="mreutegg">Marcel Reutegger</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Dec 2009 14:52:26 +0000</created>
                <updated>Thu, 23 Feb 2012 16:35:22 +0000</updated>
                    <resolved>Tue, 8 Dec 2009 14:53:44 +0000</resolved>
                            <version>2.0-beta5</version>
                                <fixVersion>1.6.5</fixVersion>
                <fixVersion>2.0-beta6</fixVersion>
                                <component>jackrabbit-core</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>3</watches>
                                                    <comments>
                    <comment id="12787481" author="mreutegg" created="Tue, 8 Dec 2009 14:53:44 +0000"  >Fixed in revision: 888419</comment>
                    <comment id="12898867" author="gjoseph" created="Mon, 16 Aug 2010 13:03:33 +0100"  >Any chance we could get a fix for this in the 1.6 branch ?</comment>
                    <comment id="12921358" author="deanjones" created="Fri, 15 Oct 2010 14:49:05 +0100"  >We are experiencing this problem on production systems running v1.6 of Jackrabbit, so would also appreciate a backport of the fix into the 1.6 stream.</comment>
                    <comment id="13105420" author="upsetduck" created="Thu, 15 Sep 2011 16:15:53 +0100"  >We need this for 1.6 as well.&lt;br/&gt;
&lt;br/&gt;
It looks like the backport would be easy:&lt;br/&gt;
&lt;br/&gt;
-            if (itemState.isNode()) {&lt;br/&gt;
-                def = itemMgr.getDefinition((NodeState) itemState).unwrap();&lt;br/&gt;
-            } else {&lt;br/&gt;
-                def = itemMgr.getDefinition((PropertyState) itemState).unwrap();&lt;br/&gt;
+            try {&lt;br/&gt;
+                if (itemState.isNode()) {&lt;br/&gt;
+                    def = itemMgr.getDefinition((NodeState) itemState).unwrap();&lt;br/&gt;
+                } else {&lt;br/&gt;
+                    def = itemMgr.getDefinition((PropertyState) itemState).unwrap();&lt;br/&gt;
+                }&lt;br/&gt;
+            } catch (ConstraintViolationException e) {&lt;br/&gt;
+                // since identifier of assigned definition is not stored anymore&lt;br/&gt;
+                // with item state (see &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2170&quot; title=&quot;Remove PropDefId and NodeDefId&quot;&gt;&lt;strike&gt;JCR-2170&lt;/strike&gt;&lt;/a&gt;), correct definition cannot be&lt;br/&gt;
+                // determined for items which have been removed due to removal&lt;br/&gt;
+                // of a mixin (see also &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2130&quot; title=&quot;Node.removeMixin() should not remove valid items&quot;&gt;&lt;strike&gt;JCR-2130&lt;/strike&gt;&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2408&quot; title=&quot;Mixin removal exception&quot;&gt;&lt;strike&gt;JCR-2408&lt;/strike&gt;&lt;/a&gt;)&lt;br/&gt;
+                continue;&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="13113494" author="jukkaz" created="Fri, 23 Sep 2011 16:04:13 +0100"  >Merged to the 1.6 branch in revision 1174823.</comment>
                    <comment id="13214636" author="ravish" created="Thu, 23 Feb 2012 13:37:59 +0000"  >We just faced this issue with Magnolia CMS running on Jackrabbit 1.6.4.  We ran consistency check on the affected repository and restarted Jackrabbit.  Consistency check found a bunch of errors it could not fix (orphaned nodes mainly but nothing else obvious was reported). The exception has disappeared since.  &lt;br/&gt;
&lt;br/&gt;
Is there any way to reproduce this?  We have seen this before, so need to understand when/how it happens so we can decide a way to proceed.</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="12310000">
                <name>Duplicate</name>
                                                <inwardlinks description="is duplicated by">
                            <issuelink>
            <issuekey id="12462416">JCR-2610</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 16 Aug 2010 12:03:33 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>59499</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>252545</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
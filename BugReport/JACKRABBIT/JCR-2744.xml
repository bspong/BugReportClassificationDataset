<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:44:41 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-2744/JCR-2744.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-2744] Avoid element arrays in PathImpl</title>
                <link>https://issues.apache.org/jira/browse/JCR-2744</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>The path handling code in spi-commons shows quite often in thread dumps and profiling results, as the current implementation does quite a bit of repetitive allocating and copying of path element arrays. We should be able to streamline and simplify the path handling code by only tracking the latest path element and a reference to the parent path. To do this efficiently we may need to adjust some of the Path and PathFactory method declarations (that currently assume element array -based paths) also in the SPI.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12473691">JCR-2744</key>
            <summary>Avoid element arrays in PathImpl</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="jukkaz">Jukka Zitting</assignee>
                                <reporter username="jukkaz">Jukka Zitting</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Sep 2010 16:22:36 +0100</created>
                <updated>Tue, 8 Nov 2011 15:52:12 +0000</updated>
                    <resolved>Wed, 4 May 2011 09:00:15 +0100</resolved>
                                            <fixVersion>2.2</fixVersion>
                                <component>jackrabbit-spi</component>
                <component>jackrabbit-spi-commons</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12908783" author="mduerig" created="Mon, 13 Sep 2010 14:43:44 +0100"  >This looks very good to me. Do you have some performance figures already?&lt;br/&gt;
&lt;br/&gt;
However I think that RelativePath#getElements() need to improve. The current implementations recursively calls getElements() on the parent and adds its own element to the returned array. To do so the returned array needs to be copied. Copying the array once for each recursive invocation effectively results in O(n^2) run time characteristics. I suggest to change the recursive implementation into an iterative one which collects the name elements of all ancestors of the current path into a pre allocated array. </comment>
                    <comment id="12908814" author="jukkaz" created="Mon, 13 Sep 2010 16:09:05 +0100"  >The attached graph shows already some performance improvement that I believe is mostly due to these changes. I see some gains also in other benchmarks, but it&amp;#39;s hard to say whether it&amp;#39;s this or some of the other recent improvements at work.&lt;br/&gt;
&lt;br/&gt;
Re: getElements(); I&amp;#39;m actually hoping to get rid of this method entirely, which is why I so far haven&amp;#39;t put too much effort into optimizing it.&lt;br/&gt;
&lt;br/&gt;
Going even further, I believe we could (and should) merge the Path and Path.Element interfaces to further drop the number of objects we need to instantiate and track.&lt;br/&gt;
</comment>
                    <comment id="12908816" author="mduerig" created="Mon, 13 Sep 2010 16:20:34 +0100"  >I&amp;#39;m in favor of further optimizing Path.Element or even trying to get rid of it when it turns out to be feasible. Since getElements() is called from quite many places, we might gain some quick insight into the impact of further optimization from changing the method to an iterative implementation and running the performance test suite. &lt;br/&gt;
&lt;br/&gt;
Also - if it turn out to be beneficial performance wise - I&amp;#39;d prefer to have an iterative implementation of getElements() in 2.2 if further optimizations won&amp;#39;t make it into the release.</comment>
                    <comment id="12910108" author="jukkaz" created="Thu, 16 Sep 2010 12:46:21 +0100"  >I&amp;#39;ve now gotten rid of the separate Element objects. The AbstractPath class now implements both the Path and Element interfaces (the latter properly only when dealing with a single-element path).&lt;br/&gt;
&lt;br/&gt;
I also improved the getElements() method to avoid the O(n^2) behaviour.&lt;br/&gt;
&lt;br/&gt;
The attached plot shows the current performance improvements (about 20% on large transient operations) that are mostly due to these changes. There&amp;#39;s still room for additional improvements, but I believe the biggest wins have already been achieved here.</comment>
                    <comment id="13028660" author="anchela" created="Wed, 4 May 2011 09:00:15 +0100"  >i think this issue should have been resolved, shouldn&amp;#39;t it?</comment>
                </comments>
                    <attachments>
                    <attachment id="12454754" name="TransientManyChildNodesTest-2.png" size="32400" author="jukkaz" created="Thu, 16 Sep 2010 12:46:21 +0100" />
                    <attachment id="12454450" name="TransientManyChildNodesTest.png" size="32877" author="jukkaz" created="Mon, 13 Sep 2010 16:09:05 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 13 Sep 2010 13:43:44 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>97778</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>190801</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
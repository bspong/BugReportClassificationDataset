<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:39:39 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-414/JCR-414.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-414] jcr:successors property not persisted correctly within a transaction</title>
                <link>https://issues.apache.org/jira/browse/JCR-414</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>During a transaction, if you create a new version then read the version history the &amp;quot;jcr:successors&amp;quot; property is not updated. Note that &amp;quot;jcr:predecessors&amp;quot; is updated properly.&lt;br/&gt;
&lt;br/&gt;
Also, the version history is sometimes not propertly read. During the transaction, it might appear empty. This behavior in not consistent from one execution to another.&lt;br/&gt;
&lt;br/&gt;
After a restart of the repository, the version history and the &amp;quot;jcr:successors&amp;quot; property is read properly.&lt;br/&gt;
&lt;br/&gt;
* Tests cases will follow shortly.&lt;br/&gt;
&lt;br/&gt;
Thanks, &lt;br/&gt;
&lt;br/&gt;
Nicolas</description>
                <environment>Java 5.0. </environment>
            <key id="12332738">JCR-414</key>
            <summary>jcr:successors property not persisted correctly within a transaction</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="tripod">Tobias Bocanegra</assignee>
                                <reporter username="nbelisle">Nicolas Belisle</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Apr 2006 23:40:11 +0100</created>
                <updated>Tue, 4 Jul 2006 17:04:39 +0100</updated>
                    <resolved>Fri, 9 Jun 2006 18:10:36 +0100</resolved>
                            <version>0.9</version>
                <version>1.0</version>
                <version>1.0.1</version>
                                <fixVersion>1.1</fixVersion>
                                <component>versioning</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12376501" author="nbelisle" created="Wed, 26 Apr 2006 23:49:51 +0100"  >Shows that &amp;quot;jcr:successors&amp;quot; in not properly updated in the context of a transaction.</comment>
                    <comment id="12376502" author="nbelisle" created="Wed, 26 Apr 2006 23:55:51 +0100"  >If you execute this a couple of times, you should notice that reads are not consistent. Sometimes the version history is empty on the first print, sometimes not. &lt;br/&gt;
&lt;br/&gt;
Note also that successors are never updated correclty.</comment>
                    <comment id="12377219" author="tripod" created="Mon, 1 May 2006 21:01:14 +0100"  >i modified the versionmanager behaviour a little. the jcr:successor virtual property is not longer virtual but is also persisted in the version persistence manager.&lt;br/&gt;
&lt;br/&gt;
unfortunately, this does not fix this issue at all. it is a fundamental problem, that modifications to the version store within a transaction are not &amp;#39;seen&amp;#39; from the session using that transaction. i also added a new testcase that finds this problem.&lt;br/&gt;
&lt;br/&gt;
(v1 is a version from session 1, v2 the same version from session 2)&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;OK: V1, name=jcr:rootVersion, succ=0&lt;br/&gt;
&amp;nbsp;OK: V2, name=jcr:rootVersion, succ=0&lt;br/&gt;
---------checkout/checkin n1 (uncommitted)----------&lt;br/&gt;
ERR: V1, name=jcr:rootVersion, succ=0 != 1&lt;br/&gt;
&amp;nbsp;OK: V2, name=jcr:rootVersion, succ=0&lt;br/&gt;
&amp;nbsp;OK: V1, name=1.0, succ=0&lt;br/&gt;
--------checkout/checkin n1 (comitted)----------&lt;br/&gt;
&amp;nbsp;OK: V1, name=jcr:rootVersion, succ=1&lt;br/&gt;
&amp;nbsp;OK: V2, name=jcr:rootVersion, succ=1&lt;br/&gt;
&amp;nbsp;OK: V1, name=1.0, succ=0&lt;br/&gt;
&lt;br/&gt;
As you can see, the number of successors is only correct after the commit. the same happens for &amp;#39;RemoveVersion&amp;#39;.&lt;br/&gt;
&lt;br/&gt;
this probably needs a more thorough change to the code.</comment>
                    <comment id="12415521" author="tripod" created="Fri, 9 Jun 2006 18:10:36 +0100"  >fixed.&lt;br/&gt;
&lt;br/&gt;
Committed revision 412995.</comment>
                </comments>
                    <attachments>
                    <attachment id="12325914" name="PropertyTest.java" size="3716" author="nbelisle" created="Wed, 26 Apr 2006 23:49:51 +0100" />
                    <attachment id="12325915" name="VersionHistoryTest.java" size="3258" author="nbelisle" created="Wed, 26 Apr 2006 23:55:51 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 1 May 2006 20:01:14 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>80383</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>192066</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
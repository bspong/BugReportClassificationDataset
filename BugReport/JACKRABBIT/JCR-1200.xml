<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:35:14 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-1200/JCR-1200.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-1200] allow SPI implementation to compute default values for autocreated properties</title>
                <link>https://issues.apache.org/jira/browse/JCR-1200</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>Currently, when creating nodes in transient space, JCR2SPI uses hard-wired logic trying to populate system generated properties such as jcr:created, jcr;uuid and so on.&lt;br/&gt;
&lt;br/&gt;
This is problematic as&lt;br/&gt;
&lt;br/&gt;
- it doesn&amp;#39;t scale -- it fails for autocreated properties not known to JCR2SPI, and&lt;br/&gt;
&lt;br/&gt;
- the syntax for the defaults may be dependant on the back end, such as legal syntax for (UU)IDs.&lt;br/&gt;
&lt;br/&gt;
Proposal:&lt;br/&gt;
&lt;br/&gt;
- extend QValueFactory with something like&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;QValue computeDefaultValue(QPropertyDefinition)&lt;br/&gt;
&lt;br/&gt;
- use that in JCR2SPI, getting rid of the currently hard-wired logic.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12381556">JCR-1200</key>
            <summary>allow SPI implementation to compute default values for autocreated properties</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="reschke">Julian Reschke</assignee>
                                <reporter username="reschke">Julian Reschke</reporter>
                        <labels>
                    </labels>
                <created>Wed, 31 Oct 2007 14:17:25 +0000</created>
                <updated>Tue, 15 Jan 2008 23:27:02 +0000</updated>
                    <resolved>Wed, 31 Oct 2007 17:33:21 +0000</resolved>
                                            <fixVersion>1.4</fixVersion>
                                <component>jackrabbit-spi</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12539090" author="anchela" created="Wed, 31 Oct 2007 14:48:47 +0000"  >i think i would rather name it create(QPropertyDefinition) or createFromDefinition(QPropertyDefinition).&lt;br/&gt;
&lt;br/&gt;
and i think i would return a QValue[].... since the prop def could be multi valued, couldn&amp;#39;t it?&lt;br/&gt;
&lt;br/&gt;
but i&amp;#39;m definitely in favor of this improvement.&lt;br/&gt;
angela&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12539100" author="reschke" created="Wed, 31 Oct 2007 15:35:26 +0000"  >&amp;gt; i think i would rather name it create(QPropertyDefinition) or createFromDefinition(QPropertyDefinition).&lt;br/&gt;
&lt;br/&gt;
In which case I&amp;#39;d prefer the latter in order to avoid confusion with the other create methods.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; and i think i would return a QValue[].... since the prop def could be multi valued, couldn&amp;#39;t it? &lt;br/&gt;
&lt;br/&gt;
Correct.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12539110" author="anchela" created="Wed, 31 Oct 2007 16:01:01 +0000"  >&amp;gt; In which case I&amp;#39;d prefer the latter in order to avoid confusion with the other create methods.&lt;br/&gt;
&lt;br/&gt;
ok. the &amp;#39;from&amp;#39; is may be not totally accurate either. i liked your &amp;#39;compute&amp;#39; but i wasn&amp;#39;t too happy with&lt;br/&gt;
the default-value... because the default value is something different and it&amp;#39;s already &lt;br/&gt;
present in the property definition, isn&amp;#39;t it ? there is no need to compute that one... &lt;br/&gt;
&lt;br/&gt;
is it meant to be used for both retrieved default-values AND autocreated values?&lt;br/&gt;
then it would probably be&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;computeValues.&lt;br/&gt;
&lt;br/&gt;
i guess we should also define the behaviour of the method if the QPropertyDefinition&lt;br/&gt;
does neither define defaultvalues nor is autocreated... throwing?</comment>
                    <comment id="12539111" author="reschke" created="Wed, 31 Oct 2007 16:10:31 +0000"  >&amp;gt;ok. the &amp;#39;from&amp;#39; is may be not totally accurate either. i liked your &amp;#39;compute&amp;#39; but i wasn&amp;#39;t too happy with&lt;br/&gt;
&amp;gt; the default-value... because the default value is something different and it&amp;#39;s already&lt;br/&gt;
&amp;gt; present in the property definition, isn&amp;#39;t it ? there is no need to compute that one...&lt;br/&gt;
&lt;br/&gt;
Right.&lt;br/&gt;
&lt;br/&gt;
So how about &lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;QValue[] computeAuto[Created]Value(...)&lt;br/&gt;
&lt;br/&gt;
(personally preferring the shorter variant)&lt;br/&gt;
&lt;br/&gt;
&amp;gt; is it meant to be used for both retrieved default-values AND autocreated values?&lt;br/&gt;
&amp;gt; then it would probably be&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt;  computeValues.&lt;br/&gt;
&lt;br/&gt;
As we already have an API to get defaults I&amp;#39;d prefer to do this just for autocreated values.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; i guess we should also define the behaviour of the method if the QPropertyDefinition&lt;br/&gt;
&amp;gt; does neither define defaultvalues nor is autocreated... throwing?&lt;br/&gt;
&lt;br/&gt;
Yes. The contract would be that the method should only be called for autocreated properties, and the implementation then could throw a RepositoryException otherwise.&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12539114" author="reschke" created="Wed, 31 Oct 2007 16:24:26 +0000"  >Proposed patch (SPI/JCR2SPI).&lt;br/&gt;
</comment>
                    <comment id="12539117" author="anchela" created="Wed, 31 Oct 2007 16:38:19 +0000"  >fine by me.</comment>
                    <comment id="12539132" author="reschke" created="Wed, 31 Oct 2007 17:33:21 +0000"  >Implemented with revision 590762.&lt;br/&gt;
</comment>
                </comments>
                    <attachments>
                    <attachment id="12368772" name="JCR-1200.patch.txt" size="4292" author="reschke" created="Wed, 31 Oct 2007 16:24:26 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 31 Oct 2007 14:48:47 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>142571</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>279677</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
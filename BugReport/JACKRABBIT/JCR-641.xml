<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:50:49 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-641/JCR-641.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-641] can&apos;t add lock token to session after 3 login/logout</title>
                <link>https://issues.apache.org/jira/browse/JCR-641</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>I login and lock a file and logout. Perfoms a new login and add the previous lock token to the current session because I want to unlock this file. This works fine. But if I do a new logout/login I can&amp;#39;t unlock the file (the file is locked). It is best understanded looking at the test case.</description>
                <environment>Linux Ubuntu Dapper</environment>
            <key id="12356217">JCR-641</key>
            <summary>can&apos;t add lock token to session after 3 login/logout</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="stefan@jira">Stefan Guggisberg</assignee>
                                <reporter username="monkiki">Paco Avila</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 Nov 2006 22:21:09 +0000</created>
                <updated>Tue, 30 Jan 2007 21:13:23 +0000</updated>
                    <resolved>Thu, 30 Nov 2006 14:45:09 +0000</resolved>
                            <version>0.9</version>
                <version>1.0</version>
                <version>1.0.1</version>
                <version>1.1</version>
                <version>1.1.1</version>
                                <fixVersion>1.2.1</fixVersion>
                                <component>locks</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12451454" author="monkiki" created="Mon, 20 Nov 2006 22:24:32 +0000"  >Perhaps the description is a bit confusing, but in our web application OpenKM the users logout and login several times and an user can&amp;#39;t unlock a previuos locked file.</comment>
                    <comment id="12451468" author="monkiki" created="Mon, 20 Nov 2006 22:51:36 +0000"  >This is a quick and dirty workaround:&lt;br/&gt;
&lt;br/&gt;
CLASS: LockManagerImpl&lt;br/&gt;
METHOD: public void lockTokenAdded(SessionImpl session, String lt)&lt;br/&gt;
&lt;br/&gt;
if (element != null) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;AbstractLockInfo info = (AbstractLockInfo) element.get();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (info != null) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (info.getLockHolder() == null || info.getLockHolder().getUserID().equals(session.getUserID())) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;info.setLockHolder(session);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} else {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;log.warn(&amp;quot;Adding lock token has no effect: &amp;quot;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;+ &amp;quot;lock already held by other session.&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}</comment>
                    <comment id="12451471" author="monkiki" created="Mon, 20 Nov 2006 22:57:00 +0000"  >Sample log output</comment>
                    <comment id="12454333" author="stefan@jira" created="Wed, 29 Nov 2006 14:52:46 +0000"  >pseudo code for reproducing the issue:&lt;br/&gt;
&lt;br/&gt;
- sessionA locks a node and retrieves the lock token&lt;br/&gt;
- sessionA logs out (or lock token is removed from sessionA)&lt;br/&gt;
&lt;br/&gt;
- lock token is transfered to sessionB&lt;br/&gt;
- sessionB logs out (or lock token is removed from sessionB)&lt;br/&gt;
&lt;br/&gt;
- lock token is transfered to sessionC&lt;br/&gt;
- sessionC tries to unlock the node =&amp;gt; LockException&lt;br/&gt;
</comment>
                    <comment id="12454337" author="stefan@jira" created="Wed, 29 Nov 2006 15:19:37 +0000"  >fixed in svn r480587&lt;br/&gt;
&lt;br/&gt;
paco, thanks for reporting this issue!</comment>
                    <comment id="12454381" author="monkiki" created="Wed, 29 Nov 2006 17:26:53 +0000"  >This is a ugly bug, can be fixed in the 1.1.1 release?</comment>
                    <comment id="12454390" author="jukkaz" created="Wed, 29 Nov 2006 18:00:40 +0000"  >&amp;gt; This is a ugly bug, can be fixed in the 1.1.1 release?&lt;br/&gt;
&lt;br/&gt;
Too late, the release has already been tagged. The fix will be in the 1.2 release.</comment>
                    <comment id="12454644" author="stefan@jira" created="Thu, 30 Nov 2006 14:43:08 +0000"  >reopening as i realized that this issue is actually a duplicate of KCR-441</comment>
                    <comment id="12454645" author="stefan@jira" created="Thu, 30 Nov 2006 14:45:03 +0000"  >resolving as duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-441&quot; title=&quot;Session logout doesn&amp;#39;t release locks acquired using addLockToken&quot;&gt;&lt;strike&gt;JCR-441&lt;/strike&gt;&lt;/a&gt;</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="12310000">
                <name>Duplicate</name>
                                <outwardlinks description="duplicates">
                            <issuelink>
            <issuekey id="12343460">JCR-441</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                    <attachment id="12345378" name="DummyLockToken.java" size="6398" author="monkiki" created="Mon, 20 Nov 2006 22:22:08 +0000" />
                    <attachment id="12345382" name="DummyLockToken.log" size="3604" author="monkiki" created="Mon, 20 Nov 2006 22:57:00 +0000" />
                    <attachment id="12345379" name="repository2.xml" size="5484" author="monkiki" created="Mon, 20 Nov 2006 22:22:24 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>3.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 29 Nov 2006 14:52:46 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>80347</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>189885</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
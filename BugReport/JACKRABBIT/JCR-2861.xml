<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:56:31 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-2861/JCR-2861.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-2861] Internal Timeout Handling in the TransactionContext is not XA Spec. conform</title>
                <link>https://issues.apache.org/jira/browse/JCR-2861</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>The problem here is that in a 2 phase transaction the xa spec does not  &lt;br/&gt;
permit a RB* return code in response to xa_commit().  The xa spec says  &lt;br/&gt;
the following about RB* return codes in the xa_commit() section:        &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;quot;The resource manager did not commit the work done on behalf of the     &lt;br/&gt;
transaction branch.  Upon return, the resource manager has rolled back  &lt;br/&gt;
the branch?s work and has released all held resources.  These values may&lt;br/&gt;
be returned only if TMONEPHASE is set in flags&amp;quot;                         &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
Essentially, the only two return codes from xa_commit that J2EE Containers can     &lt;br/&gt;
handle sensibly are XA_OK (normal case) and XA_RMFAIL.  RMFAIL will     &lt;br/&gt;
cause the containers to retry to commit the  transaction.  Any other return code will result in a heuristic          &lt;br/&gt;
transaction outcome (non-atomic).  &lt;br/&gt;
&lt;br/&gt;
In a xa environment the TMONEPHASE is not set on the flags and so XA_RBTIMEOUT is &lt;br/&gt;
not a permitted return code. A Container  transaction service cannot do anything to ensure an atomic     &lt;br/&gt;
outcome if an XAResource fails to honour its promise to be able to commit it made when it answer XA_OK in response to xa_prepare(). &lt;br/&gt;
&lt;br/&gt;
The internal timeout handling will rollback the Jackrabbit XAResource if the time exceeds between prepare and commit.&lt;br/&gt;
and in the commit Method will always throw a XA_RBTIMEOUT.&lt;br/&gt;
&lt;br/&gt;
We should not handle the timeout internal because this should make the container in a 2 Phase transaction.</description>
                <environment></environment>
            <key id="12495122">JCR-2861</key>
            <summary>Internal Timeout Handling in the TransactionContext is not XA Spec. conform</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="c_koell">Claus K&#246;ll</assignee>
                                <reporter username="c_koell">Claus K&#246;ll</reporter>
                        <labels>
                    </labels>
                <created>Mon, 10 Jan 2011 12:03:55 +0000</created>
                <updated>Wed, 16 Nov 2011 12:53:26 +0000</updated>
                    <resolved>Thu, 3 Feb 2011 12:38:40 +0000</resolved>
                            <version>2.2</version>
                                <fixVersion>2.2.10</fixVersion>
                <fixVersion>2.3</fixVersion>
                                <component>jackrabbit-core</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12986349" author="c_koell" created="Tue, 25 Jan 2011 11:49:24 +0000"  >The internal TimerTask will only be scheduled if we are in a one phase transaction.</comment>
                    <comment id="12986379" author="c_koell" created="Tue, 25 Jan 2011 13:26:33 +0000"  >I think we could delete the complete Rollback-Task because the timeout handling should make the TM not the RM.&lt;br/&gt;
I will create a new issue for that ...</comment>
                    <comment id="12990074" author="c_koell" created="Thu, 3 Feb 2011 12:38:40 +0000"  >Fixed in revision 1066794</comment>
                    <comment id="13151170" author="jukkaz" created="Wed, 16 Nov 2011 12:53:26 +0000"  >Merged to the 2.2 branch in revision 1202683.</comment>
                </comments>
                    <attachments>
                    <attachment id="12469279" name="JCR-2861.patch" size="4966" author="c_koell" created="Tue, 25 Jan 2011 13:22:36 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 16 Nov 2011 12:53:26 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>78148</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>189953</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
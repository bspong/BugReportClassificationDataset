<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:32:40 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-3107/JCR-3107.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-3107] Speed up hierarchy cache initialization</title>
                <link>https://issues.apache.org/jira/browse/JCR-3107</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>Initializing a workspace can take quite a long time if there is a big number of nodes and some search indexes involved. The reason is that the setup of the CachingIndexReader is processed using chunks of a certain size (actually 400K) in order to reduce the memory footprint. As soon as the number of documents exceeds this limit some operations (actually traversing complete indexes) are performed again and again.&lt;br/&gt;
&lt;br/&gt;
It seems that the current algorithm &amp;quot;initializeParents&amp;quot; in the CachingIndexReader class can&amp;#39;t be optimized without increasing the memory consumption. Therefore it should be a promising approach to persist the &amp;quot;state&amp;quot; of this class (actually it&amp;#39;s main member array and map) and reload it on startup.&lt;br/&gt;
&lt;br/&gt;
The &amp;quot;load&amp;quot; of the state can be done implicitly in the initializing phase of the cache. This is obvious. The correct point of time to call the &amp;quot;save&amp;quot; operation isn&amp;#39;t obvious at all. I tried the &amp;quot;doClose&amp;quot; method of the class and it seems sufficient.</description>
                <environment></environment>
            <key id="12526576">JCR-3107</key>
            <summary>Speed up hierarchy cache initialization</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="b&#246;">Martin B&#246;ttcher</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Oct 2011 09:26:56 +0100</created>
                <updated>Thu, 19 Jan 2012 14:31:07 +0000</updated>
                    <resolved>Thu, 13 Oct 2011 11:25:19 +0100</resolved>
                                            <fixVersion>2.2.11</fixVersion>
                <fixVersion>2.3.2</fixVersion>
                                <component>jackrabbit-core</component>
                <component>query</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13124888" author="b&#246;" created="Tue, 11 Oct 2011 10:46:33 +0100"  >proposed patch</comment>
                    <comment id="13124986" author="b&#246;" created="Tue, 11 Oct 2011 13:47:51 +0100"  >revoked due to results of discussion with Marcel</comment>
                    <comment id="13124999" author="b&#246;" created="Tue, 11 Oct 2011 14:02:40 +0100"  >new proposed patch</comment>
                    <comment id="13125004" author="b&#246;" created="Tue, 11 Oct 2011 14:07:42 +0100"  >Writing the array every time the &amp;quot;doClose&amp;quot;-method is invoked may lead to some runtime issues because the array can have a size of many megabytes. If the file is touched every time (even if it&amp;#39;s contents isn&amp;#39;t changed) a backup mechanism will need to handle this persistence file again and again.&lt;br/&gt;
&lt;br/&gt;
Therefore it seems to be a better idea to write the file only once as soon as the initializer finished.</comment>
                    <comment id="13126474" author="alex.parvulescu" created="Thu, 13 Oct 2011 11:25:19 +0100"  >good work, thanks!&lt;br/&gt;
applied the patch with some modifications&lt;br/&gt;
&lt;br/&gt;
fixed in revision 1182761&lt;br/&gt;
&lt;br/&gt;
(edit: changed to the revision number)</comment>
                    <comment id="13126541" author="alex.parvulescu" created="Thu, 13 Oct 2011 14:01:08 +0100"  >added some logs in revision 1182824</comment>
                </comments>
                    <attachments>
                    <attachment id="12498589" name="JCR-3107.patch" size="2890" author="b&#246;" created="Tue, 11 Oct 2011 14:02:40 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 13 Oct 2011 10:25:19 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>58992</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>250226</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
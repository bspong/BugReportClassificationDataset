<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:29:48 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-3117/JCR-3117.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-3117] Stats for the PersistenceManager</title>
                <link>https://issues.apache.org/jira/browse/JCR-3117</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>Statistics for the PersistenceManager impl that cover: &lt;br/&gt;
&amp;nbsp;- bundle cache access count, &lt;br/&gt;
&amp;nbsp;- bundle cache miss count, &lt;br/&gt;
&amp;nbsp;- bundle cache miss avg duration (this avg includes the penalty of having to load from the underlying storage / can be interpreted as avg read latency as there is no cache involved) &lt;br/&gt;
&amp;nbsp;- bundle writes per second&lt;br/&gt;
&lt;br/&gt;
What it doesn&amp;#39;t cover is :&lt;br/&gt;
&amp;nbsp;- number of bundles&lt;br/&gt;
&amp;nbsp;- size of workspace&lt;br/&gt;
as these are values that are expensive to compute on demand, and caching them would imply being able to store the values (which is not possible currently).</description>
                <environment></environment>
            <key id="12527460">JCR-3117</key>
            <summary>Stats for the PersistenceManager</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                    <parent id="12503117">JCR-2936</parent>
                        <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="alex.parvulescu">Alex Parvulescu</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Oct 2011 16:12:43 +0100</created>
                <updated>Tue, 8 Nov 2011 15:40:20 +0000</updated>
                    <resolved>Tue, 25 Oct 2011 16:03:34 +0100</resolved>
                                            <fixVersion>2.3.2</fixVersion>
                                <component>jackrabbit-core</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13128937" author="alex.parvulescu" created="Mon, 17 Oct 2011 16:20:33 +0100"  >attached proposed patch</comment>
                    <comment id="13130443" author="stefan@jira" created="Wed, 19 Oct 2011 08:57:46 +0100"  >patch looks good, thanks!</comment>
                    <comment id="13130609" author="alex.parvulescu" created="Wed, 19 Oct 2011 14:27:41 +0100"  >Fixed in revision 1186195.</comment>
                    <comment id="13131462" author="jukkaz" created="Thu, 20 Oct 2011 10:00:42 +0100"  >Wouldn&amp;#39;t it be easier to just use the AtomicLong counters from the TimeSeries mechanism? That way we wouldn&amp;#39;t have to add new interfaces and implementations for each piece of statistics we want to collect?</comment>
                    <comment id="13131476" author="alex.parvulescu" created="Thu, 20 Oct 2011 10:23:58 +0100"  >Hi Jukka,&lt;br/&gt;
&lt;br/&gt;
can you be a bit more specific? I&amp;#39;m not sure what you want to replace with the TimeSeries:&lt;br/&gt;
&lt;br/&gt;
&amp;gt; Statistics for the PersistenceManager impl that cover: &lt;br/&gt;
&amp;gt;  - bundle cache access count, &lt;br/&gt;
&amp;gt;  - bundle cache miss count, &lt;br/&gt;
&amp;gt;  - bundle cache miss avg duration (this avg includes the penalty of having to load from the underlying storage / can be interpreted as avg read latency as there is no cache involved) &lt;br/&gt;
&amp;gt;  - bundle writes per second &lt;br/&gt;
&lt;br/&gt;
Out of all the stats provided here, I&amp;#39;d say the &amp;#39;bundle writes per second&amp;#39; fall into the TimeSeries scope. And there, I don&amp;#39;t mind replacing the mechanism. &lt;br/&gt;
As for the rest: &lt;br/&gt;
&amp;nbsp;- the 2 counts are just incremental operations on AtomicLong, I don&amp;#39;t really see the added value in using TS; &lt;br/&gt;
&amp;nbsp;- the &amp;#39;cache miss avg duration&amp;#39; : AFAIK the TS impl does not do averages currently, if it will, I&amp;#39;m open for using it.&lt;br/&gt;
</comment>
                    <comment id="13131477" author="jukkaz" created="Thu, 20 Oct 2011 10:25:40 +0100"  >The proposed patch switches the PM stats to use the TimeSeries mechanism. This replaces 222 lines of code with just 63, while increasing the amount of collected information.</comment>
                    <comment id="13131482" author="jukkaz" created="Thu, 20 Oct 2011 10:34:44 +0100"  >&amp;gt; the 2 counts are just incremental operations on AtomicLong, I don&amp;#39;t really see the added value in using TS;&lt;br/&gt;
&lt;br/&gt;
There&amp;#39;s two main benefits: 1) we get a full time series of the collected values, and 2) we don&amp;#39;t need the extra interface or custom code for accessing this piece of information.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; the &amp;#39;cache miss avg duration&amp;#39; : AFAIK the TS impl does not do averages currently, if it will, I&amp;#39;m open for using it.&lt;br/&gt;
&lt;br/&gt;
The average duration is easily calculated by dividing total duration by count per second. It&amp;#39;s not currently supported by the TS implementation, but will be easy enough to add.</comment>
                    <comment id="13131485" author="alex.parvulescu" created="Thu, 20 Oct 2011 10:38:11 +0100"  >&amp;gt; This replaces 222 lines of code with just 63&lt;br/&gt;
the purpose of saving all these lines is lost on me.&lt;br/&gt;
&lt;br/&gt;
+1 on the patch</comment>
                    <comment id="13131487" author="alex.parvulescu" created="Thu, 20 Oct 2011 10:39:08 +0100"  >reopening to reconsider new patches</comment>
                    <comment id="13135130" author="jukkaz" created="Tue, 25 Oct 2011 16:03:34 +0100"  >I added also average time series in revision 1188678.</comment>
                </comments>
                    <attachments>
                    <attachment id="12499836" name="0001-JCR-3117-Stats-for-the-PersistenceManager.patch" size="22103" author="jukkaz" created="Thu, 20 Oct 2011 10:25:40 +0100" />
                    <attachment id="12499389" name="JCR-3117.patch" size="23600" author="alex.parvulescu" created="Mon, 17 Oct 2011 16:20:33 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 19 Oct 2011 07:57:46 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>88607</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>280334</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
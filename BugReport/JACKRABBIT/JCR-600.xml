<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:46:13 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-600/JCR-600.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-600] Repository does not release all resources on shutdown</title>
                <link>https://issues.apache.org/jira/browse/JCR-600</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>When Jackrabbit is shutdown some java.util.Timer threads are still running in the background even though no tasks are scheduled. This prevents the GC from collecting the classes when Jackrabbit is redeployed within a web application.</description>
                <environment></environment>
            <key id="12353822">JCR-600</key>
            <summary>Repository does not release all resources on shutdown</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mreutegg">Marcel Reutegger</assignee>
                                <reporter username="mreutegg">Marcel Reutegger</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Oct 2006 09:18:53 +0100</created>
                <updated>Tue, 12 Dec 2006 13:03:46 +0000</updated>
                    <resolved>Tue, 31 Oct 2006 08:37:47 +0000</resolved>
                            <version>1.0</version>
                <version>1.0.1</version>
                <version>1.1</version>
                                <fixVersion>1.1.1</fixVersion>
                                <component>jackrabbit-core</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12444263" author="mreutegg" created="Tue, 24 Oct 2006 10:29:16 +0100"  >Jackrabbit now uses a custom Timer class which wraps the java.util.Timer. When there are no tasks scheduled the wrapped java.util.Timer is canceled which effectively terminates the background thread.&lt;br/&gt;
&lt;br/&gt;
Fixed in revision: 467292</comment>
                    <comment id="12444898" author="iampivot" created="Thu, 26 Oct 2006 15:11:07 +0100"  >What classes are these changes in? I&amp;#39;d like to packport to 1.1 if possible.</comment>
                    <comment id="12444902" author="jukkaz" created="Thu, 26 Oct 2006 15:19:33 +0100"  >&amp;gt; What classes are these changes in? I&amp;#39;d like to packport to 1.1 if possible.&lt;br/&gt;
&lt;br/&gt;
See &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;revision=467292&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=467292&lt;/a&gt; for the changes. The link should also appear on the &amp;quot;All&amp;quot; and &amp;quot;Subversion Commits&amp;quot; tabs of this page in a short while as the SVN-Jira integration does it&amp;#39;s magic.</comment>
                    <comment id="12445366" author="iampivot" created="Sat, 28 Oct 2006 13:28:32 +0100"  >I tried backporting to 1.1, but it doesn&amp;#39;t seem to fix it. Are there other classes that keep on running?</comment>
                    <comment id="12445367" author="iampivot" created="Sat, 28 Oct 2006 13:30:50 +0100"  >There&amp;#39;s a problem attaching screenshots to this issue..</comment>
                    <comment id="12445368" author="iampivot" created="Sat, 28 Oct 2006 13:36:24 +0100"  >Loaded class count view of tomcat instance after multiple redeployments of webapp with modified jackrabbit core jar.</comment>
                    <comment id="12445369" author="iampivot" created="Sat, 28 Oct 2006 13:36:50 +0100"  >Ditto permgen view.</comment>
                    <comment id="12445829" author="mreutegg" created="Tue, 31 Oct 2006 08:33:21 +0000"  >You are right. My test didn&amp;#39;t involve a login. I simply re-deployed the jackrabbit-server.war.&lt;br/&gt;
&lt;br/&gt;
There is still a commit log thread local which holds a strong reference to a jackrabbit class, preventing the GC from collecting the WebappClassLoader.</comment>
                    <comment id="12445834" author="mreutegg" created="Tue, 31 Oct 2006 08:37:47 +0000"  >Second attempt ;)&lt;br/&gt;
&lt;br/&gt;
Fixed in revision: &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;revision=469412&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=469412&lt;/a&gt;</comment>
                    <comment id="12445875" author="iampivot" created="Tue, 31 Oct 2006 11:36:16 +0000"  >It still doesn&amp;#39;t work. Are there other classes that needs modification in jackrabbit 1.1? I&amp;#39;ve seen that there are threads used in other classes as well, eg RepositoryImpl, TransientFileFactory, ObservationDispatcher and others.</comment>
                    <comment id="12445904" author="mreutegg" created="Tue, 31 Oct 2006 14:30:43 +0000"  >What operations do you perform before you re-deploy the web application?&lt;br/&gt;
&lt;br/&gt;
It works for me when I do a login, read a couple of items and logout again.</comment>
                    <comment id="12453875" author="torgeir" created="Tue, 28 Nov 2006 10:57:11 +0000"  >I tried with both a 1.1 with the patches attached, and a fresh svn snapshot from Nov 28th 06, and I still see permgen growing without bounds. The code I use is simply&lt;br/&gt;
&lt;br/&gt;
public void contextInitialized(ServletContextEvent event) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// set up repository &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;try {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String rootDirectory = (String) ConfigManager.getEnvironmentEntry(&amp;quot;jackrabbit/directory&amp;quot;);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;String configFile = (String) ConfigManager.getEnvironmentEntry(&amp;quot;jackrabbit/configfile&amp;quot;);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (configFile.indexOf(&amp;quot;/WEB-INF/&amp;quot;) == 0) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;log.debug(&amp;quot;loading repository config from web application context root: &amp;quot; + configFile);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;URL url = event.getServletContext().getResource(configFile);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;InputStream repositoryXml = event.getServletContext().getResourceAsStream(configFile);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;RepositoryConfig config = RepositoryConfig.create(repositoryXml, rootDirectory);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;repository = new TransientRepository(config);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} else {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;repository = new TransientRepository(configFile, rootDirectory);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Session session = repository.login(new SystemCredentials());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;session.logout();&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} catch (Exception e) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;log.error(&amp;quot;unable to configure Jackrabbit repository; &amp;quot;, e);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
</comment>
                    <comment id="12454371" author="torgeir" created="Wed, 29 Nov 2006 16:49:45 +0000"  >I&amp;#39;ve done a bit more testing and it does in-fact seem to work properly now, so I guess this issue can be resolved as fixed.</comment>
                </comments>
                    <attachments>
                    <attachment id="12343831" name="Screenshot_1.png" size="63737" author="iampivot" created="Sat, 28 Oct 2006 13:36:24 +0100" />
                    <attachment id="12343832" name="Screenshot_2.png" size="79958" author="iampivot" created="Sat, 28 Oct 2006 13:36:50 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>2.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 26 Oct 2006 14:11:07 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>80424</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>252852</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:57:22 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-1325/JCR-1325.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-1325] Problems mapping custom collections</title>
                <link>https://issues.apache.org/jira/browse/JCR-1325</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>When using a custom list that extends from java.util.AbstractList, ManageableCollectionUtil.getManageableCollection raises a JcrMappingException because it does not consider the custom list to be a java.util.List. This is because it uses &amp;quot;if (object.getClass().equals(List.class))&amp;quot; instead of &amp;quot;if (object instanceof List)&amp;quot;. The same thing will probably happen when using a custom Collection, a custom ArrayList, etc. This is the stack trace:&lt;br/&gt;
&lt;br/&gt;
org.apache.jackrabbit.ocm.exception.JcrMappingException: Unsupported collection &lt;br/&gt;
type : *********** (MyCustomList class) &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.jackrabbit.ocm.manager.collectionconverter.ManageableColle &lt;br/&gt;
ctionUtil.getManageableCollection(ManageableCollectionUtil.java:153) &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.jackrabbit.ocm.manager.objectconverter.impl.ObjectConverte &lt;br/&gt;
rImpl.insertCollectionFields(ObjectConverterImpl.java:780) &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.jackrabbit.ocm.manager.objectconverter.impl.ObjectConverte &lt;br/&gt;
rImpl.insert(ObjectConverterImpl.java:221) &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.jackrabbit.ocm.manager.objectconverter.impl.ObjectConverte &lt;br/&gt;
rImpl.insert(ObjectConverterImpl.java:146) &lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.jackrabbit.ocm.manager.impl.ObjectContentManagerImpl.inser &lt;br/&gt;
t(ObjectContentManagerImpl.java:407) &lt;br/&gt;
&lt;br/&gt;
I have come up to this bug using a MyCustomList&amp;lt;MyClass&amp;gt;, with MyCustomList extending java.util.AbstractList&amp;lt;MyClass&amp;gt;.</description>
                <environment></environment>
            <key id="12386586">JCR-1325</key>
            <summary>Problems mapping custom collections</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="clombart">Christophe Lombart</assignee>
                                <reporter username="sgomez">Sebastian Gomez</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Jan 2008 09:03:04 +0000</created>
                <updated>Mon, 8 Dec 2008 11:07:59 +0000</updated>
                    <resolved>Mon, 21 Apr 2008 22:52:42 +0100</resolved>
                            <version>1.4</version>
                                <fixVersion>1.5</fixVersion>
                                <component>jackrabbit-ocm</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12563243" author="sgomez" created="Mon, 28 Jan 2008 18:47:42 +0000"  >Added patch that resolves the issue.</comment>
                    <comment id="12591078" author="clombart" created="Mon, 21 Apr 2008 22:52:42 +0100"  >Fixed. &lt;br/&gt;
I also reviewed the support for Collection &amp;amp; Map. The mapping definition can be simplified with parameterized classes. In this case the elementClassName setting is not necessary. There is a exemple in the unit tests (see the class org.apache.jackrabbit.ocm.testmodel.collection.Main). &lt;br/&gt;
&lt;br/&gt;
Major interfaces and classes are supported (Collection, List, ArrayList, Vector,Map, HashMap, ...) without creating extra code. &lt;br/&gt;
&lt;br/&gt;
In summary, there are3 different ways to define a collection or a Map : &lt;br/&gt;
&lt;br/&gt;
1. With a parameterized class, it is not necessary to specify the elementClassName&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;@Collection private List&amp;lt;Element&amp;gt; list;&lt;br/&gt;
&lt;br/&gt;
2. Without specifying the element type: in this case, this is mandatory to define the elementClassName&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;@Collection (elementClassName=MyContent.class)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;private List list;&lt;br/&gt;
&lt;br/&gt;
3. Create a descendant of ManageableCollection &amp;amp; ManageableMap for complex collections or maps. elementClassName is still mandatory if the descendant is not parameterized. &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                </comments>
                    <attachments>
                    <attachment id="12374204" name="ManageableCollectionUtil.java.patch" size="1726" author="sgomez" created="Mon, 28 Jan 2008 18:47:42 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 21 Apr 2008 21:52:42 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>78599</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>192373</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
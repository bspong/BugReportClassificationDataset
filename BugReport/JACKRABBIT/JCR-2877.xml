<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:50:59 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-2877/JCR-2877.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-2877] Extend the consistency check in BundleDbPersistenceManager&apos;s to fix child-parent relations</title>
                <link>https://issues.apache.org/jira/browse/JCR-2877</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>It could happen that a child node is not in the ChildNodeEntries of its parent node.&lt;br/&gt;
You will get something like (javax.jcr.ItemNotFoundException: failed to build path of node1: parentNode has no child entry for node1) if you try to retrieve the path from node1.&lt;br/&gt;
We should handle such cases and fix it on consistency check</description>
                <environment></environment>
            <key id="12497556">JCR-2877</key>
            <summary>Extend the consistency check in BundleDbPersistenceManager&apos;s to fix child-parent relations</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="c_koell">Claus K&#246;ll</assignee>
                                <reporter username="c_koell">Claus K&#246;ll</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Feb 2011 12:52:20 +0000</created>
                <updated>Tue, 8 Nov 2011 15:56:07 +0000</updated>
                    <resolved>Tue, 22 Feb 2011 10:14:42 +0000</resolved>
                            <version>2.2.2</version>
                                <fixVersion>2.3</fixVersion>
                                <component>jackrabbit-core</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12990083" author="schans" created="Thu, 3 Feb 2011 13:13:40 +0000"  >We have some code for this for the 1.5 branch. It should be portable to the trunk and 2.2 branch. Do you already have a patch yourself or should I try to make it work for the the trunk?</comment>
                    <comment id="12990085" author="c_koell" created="Thu, 3 Feb 2011 13:17:21 +0000"  >Feel free to attach the code, thanks</comment>
                    <comment id="12990090" author="stefan@jira" created="Thu, 3 Feb 2011 13:28:40 +0000"  >&amp;gt; It could happen that a child node is not in the ChildNodeEntries of its parent node. &lt;br/&gt;
&lt;br/&gt;
do you still experience such problems with 2.2? if yes, are they reproducible?&lt;br/&gt;
&lt;br/&gt;
i was under the impression that we had fixed all issues which could potentially &lt;br/&gt;
lead to repository corruption.</comment>
                    <comment id="12990092" author="c_koell" created="Thu, 3 Feb 2011 13:33:52 +0000"  >i don&amp;#39;t know if it still could happen under 2.2. &lt;br/&gt;
we are migrating from a 1.6.4 repository and we have inconsistencies in the workspace and i would like to fix that with&lt;br/&gt;
a consistency check</comment>
                    <comment id="12992402" author="c_koell" created="Wed, 9 Feb 2011 09:16:08 +0000"  >Is there a way to determine the name of the node. The child node must add itself to its parent node but normally only the parent knows the name of the child node ?</comment>
                    <comment id="12992407" author="stefan@jira" created="Wed, 9 Feb 2011 09:26:24 +0000"  >&amp;gt; Is there a way to determine the name of the node. The child node must add itself to its parent node but normally only the parent knows the name of the child node ?&lt;br/&gt;
&lt;br/&gt;
*only* the parent knows the names of its child nodes. that&amp;#39;s a core aspect of jackrabbit&amp;#39;s data model.&lt;br/&gt;
you would have to make up a new (unique) name. the child node should IMO be easily identifiable as a &lt;br/&gt;
resurrected orphaned child node.</comment>
                    <comment id="12992442" author="schans" created="Wed, 9 Feb 2011 11:29:46 +0000"  >We found two distinct cases:&lt;br/&gt;
- a parent referencing a child node that no longer exists&lt;br/&gt;
- a node of which the parent is missing (these can show up in searches)&lt;br/&gt;
&lt;br/&gt;
In the first case we just remove the reference to the child node. In the second case we delete the node and all of it&amp;#39;s children. This could potentially be a bit dangerous, but in our case we found that these nodes are usually leftovers from delete actions. Another option could be, but that requires a bit more work, follow the unix analogy of a lost+found folder. So instead of removing them just make them children of a  &amp;quot;special&amp;quot; node.&lt;br/&gt;
&lt;br/&gt;
I have to admit that we have mostly been using 1.5 and with recent 1.5 versions we see almost no data corruption anymore. There have also been some bugs in our custom extensions with virtual layers which caused some of these problems in the past.&lt;br/&gt;
&lt;br/&gt;
We always had great difficulty reproducing the data corruptions. Sometimes we found a way to reproduce one, but others times not at all. &lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12993368" author="c_koell" created="Fri, 11 Feb 2011 07:30:57 +0000"  >orphaned child node will be added again to its parent with a new unique name</comment>
                    <comment id="12997723" author="c_koell" created="Tue, 22 Feb 2011 10:14:42 +0000"  >resolved in rev. 1073280</comment>
                </comments>
                    <attachments>
                    <attachment id="12470842" name="JCR-2877.patch" size="2505" author="c_koell" created="Fri, 11 Feb 2011 07:30:57 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 3 Feb 2011 13:13:40 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>97799</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>250306</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
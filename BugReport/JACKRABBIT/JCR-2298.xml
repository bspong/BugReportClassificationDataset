<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 06:03:20 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-2298/JCR-2298.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-2298] NPE in EventStateCollection</title>
                <link>https://issues.apache.org/jira/browse/JCR-2298</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>When removing a Version with a versionlabel and restoring an other Version from the same containing history within 1 transaction, a NPE occured. When debugging I noticed the method createEventStates was entered with an UUID from a versionLabel. The ChangeLog.get(id) returned null.&lt;br/&gt;
&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.jackrabbit.core.observation.EventStateCollection.getNodeType(EventStateCollection.java:614)&lt;br/&gt;
	at org.apache.jackrabbit.core.observation.EventStateCollection.createEventStates(EventStateCollection.java:381)&lt;br/&gt;
	at org.apache.jackrabbit.core.state.SharedItemStateManager$Update.begin(SharedItemStateManager.java:697)&lt;br/&gt;
	at org.apache.jackrabbit.core.state.SharedItemStateManager.beginUpdate(SharedItemStateManager.java:1085)&lt;br/&gt;
	at org.apache.jackrabbit.core.state.XAItemStateManager.prepare(XAItemStateManager.java:163)&lt;br/&gt;
	at org.apache.jackrabbit.core.version.XAVersionManager.prepare(XAVersionManager.java:509)&lt;br/&gt;
	at org.apache.jackrabbit.core.TransactionContext.prepare(TransactionContext.java:154)&lt;br/&gt;
	at org.apache.jackrabbit.core.XASessionImpl.prepare(XASessionImpl.java:331)&lt;br/&gt;
	at org.springmodules.jcr.jackrabbit.support.JackRabbitUserTransaction.commit(JackRabbitUserTransaction.java:100)&lt;br/&gt;
	at org.springmodules.jcr.jackrabbit.LocalTransactionManager.doCommit(LocalTransactionManager.java:192)</description>
                <environment></environment>
            <key id="12435003">JCR-2298</key>
            <summary>NPE in EventStateCollection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="jukkaz">Jukka Zitting</assignee>
                                <reporter username="quipere">quipere</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Sep 2009 14:19:41 +0100</created>
                <updated>Fri, 23 Sep 2011 15:23:03 +0100</updated>
                    <resolved>Mon, 8 Nov 2010 22:39:39 +0000</resolved>
                            <version>1.6</version>
                                <fixVersion>2.2</fixVersion>
                                <component>jackrabbit-core</component>
                <component>transactions</component>
                <component>versioning</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12790194" author="jukkaz" created="Mon, 14 Dec 2009 15:05:41 +0000"  >This seems like a more generic problem, as we&amp;#39;ve seen this problem also in a normal save() call with Jackrabbit 1.4.x:&lt;br/&gt;
&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.jackrabbit.core.observation.EventStateCollection.getNodeType(EventStateCollection.java:476)&lt;br/&gt;
	at org.apache.jackrabbit.core.observation.EventStateCollection.createEventStates(EventStateCollection.java:179)&lt;br/&gt;
	at org.apache.jackrabbit.core.state.SharedItemStateManager$Update.begin(SharedItemStateManager.java:672)&lt;br/&gt;
	at org.apache.jackrabbit.core.state.SharedItemStateManager.beginUpdate(SharedItemStateManager.java:843)&lt;br/&gt;
	at org.apache.jackrabbit.core.state.SharedItemStateManager.update(SharedItemStateManager.java:873)&lt;br/&gt;
	at org.apache.jackrabbit.core.state.LocalItemStateManager.update(LocalItemStateManager.java:334)&lt;br/&gt;
	at org.apache.jackrabbit.core.state.XAItemStateManager.update(XAItemStateManager.java:337)&lt;br/&gt;
	at org.apache.jackrabbit.core.state.LocalItemStateManager.update(LocalItemStateManager.java:310)&lt;br/&gt;
	at org.apache.jackrabbit.core.state.SessionItemStateManager.update(SessionItemStateManager.java:317)&lt;br/&gt;
	at org.apache.jackrabbit.core.ItemImpl.save(ItemImpl.java:1251)&lt;br/&gt;
</comment>
                    <comment id="12790239" author="jukkaz" created="Mon, 14 Dec 2009 17:03:27 +0000"  >As a first step I added (r890401) a simple workaround that detects the case when the old parent of a moved node is no longer available and replaced the NPE with an error log message. Note that required REMOVE event is *not* fired in such cases,  so this is not a final solution to this problem. But at least the MOVED and ADDED events now get fired and no NPE is thrown.</comment>
                    <comment id="12929779" author="jukkaz" created="Mon, 8 Nov 2010 22:39:38 +0000"  >Resolving as fixed based on the above partial solution. If we need a more complete solution, we can do that in a separate followup issue.</comment>
                </comments>
                    <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 14 Dec 2009 15:05:41 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>59564</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>190963</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
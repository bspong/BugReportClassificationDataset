<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:41:50 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-1005/JCR-1005.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-1005] More Fine grained Permission Flags</title>
                <link>https://issues.apache.org/jira/browse/JCR-1005</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>It would be fine to have one more Permission Flag on node add.&lt;br/&gt;
At the moment there are 3 flags. We need to know if a node will be updated or created.&lt;br/&gt;
This is not possible with the current implementation because on node add the permission flag &lt;br/&gt;
AccessManager.WRITE will be used. This is a Problem in a  WebDav Scenario with Microsoft-Word because if i open a Node and &lt;br/&gt;
try to save it i need write permissions on the parent node. this is ok. If a user trys to save the file with a other name&lt;br/&gt;
he can because the same PermissionFlag will be used.&lt;br/&gt;
Maybe there is a other solution for this problem ?&lt;br/&gt;
BR,&lt;br/&gt;
claus</description>
                <environment></environment>
            <key id="12373046">JCR-1005</key>
            <summary>More Fine grained Permission Flags</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="-1">Unassigned</assignee>
                                <reporter username="c_koell">Claus K&#246;ll</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Jul 2007 09:31:02 +0100</created>
                <updated>Mon, 8 Dec 2008 11:09:32 +0000</updated>
                    <resolved>Wed, 27 Aug 2008 16:38:27 +0100</resolved>
                            <version>1.3</version>
                                <fixVersion>1.5</fixVersion>
                                <component>security</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12518479" author="c_koell" created="Wed, 8 Aug 2007 16:48:55 +0100"  >A patch that would help me.&lt;br/&gt;
Hope somebody will look at and comment it ...</comment>
                    <comment id="12518708" author="stefan@jira" created="Thu, 9 Aug 2007 14:08:15 +0100"  >first of all thanks  for the patch!&lt;br/&gt;
&lt;br/&gt;
i have the following concerns regarding the patch:&lt;br/&gt;
&lt;br/&gt;
- the permission constants READ, WRITE and REMOVE are bitmask flags,&lt;br/&gt;
&amp;nbsp;&amp;nbsp;i.e. any new constant would need to be a power of 2&lt;br/&gt;
- the current flags apply to the target, i.e. WRITE permission on the node to &lt;br/&gt;
&amp;nbsp;&amp;nbsp;be modified etc. the new constant ADD refers to the parent of the target&lt;br/&gt;
&amp;nbsp;&amp;nbsp;which seems to be inconsistent.&lt;br/&gt;
- the patch is incomplete. it doesn&amp;#39;t cover all locations that check permissions.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;check for usages of AccessManager.isGranted()&lt;br/&gt;
- i am afraid that the proposed change wouldn&amp;#39;t be backward compatible&lt;br/&gt;
&amp;nbsp;&amp;nbsp;with existing AccessManager implementations&lt;br/&gt;
&lt;br/&gt;
cheers&lt;br/&gt;
stefan</comment>
                    <comment id="12518721" author="c_koell" created="Thu, 9 Aug 2007 15:21:43 +0100"  >thanks for your hints stefan&lt;br/&gt;
ok i see my patch was too fast. sorry that it is not complete&lt;br/&gt;
&lt;br/&gt;
i also thought that there is maybe a problem with backward compatibility, but i have the problem as described&lt;br/&gt;
and maybe there is a other solution ?&lt;br/&gt;
&lt;br/&gt;
you say that the current flags apply to the target and not to the parent but in the SessionImpl Method checkPermission()&lt;br/&gt;
there is my problem. In my scenario the user trys to add a new node (File-&amp;gt;Save As) on a parent node and i should now&lt;br/&gt;
if he try to save the original file or if he try to save the file with a other name ....&lt;br/&gt;
&lt;br/&gt;
/**&lt;br/&gt;
&amp;nbsp;* &amp;quot;add_node&amp;quot; action:&lt;br/&gt;
&amp;nbsp;* requires WRITE permission on parent item&lt;br/&gt;
*/&lt;br/&gt;
if (set.contains(ADD_NODE_ACTION)) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;try {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;parentPath = targetPath.getAncestor(1);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;parentId = hierMgr.resolvePath(parentPath);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if (parentId == null) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// parent does not exist (i.e. / was specified), throw exception&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;throw new AccessControlException(ADD_NODE_ACTION);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;accessMgr.checkPermission(parentId, AccessManager.WRITE);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;} catch (AccessDeniedException re) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// otherwise the RepositoryException catch clause will&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// log a warn message, which is not appropriate in this case.&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;throw new AccessControlException(ADD_NODE_ACTION);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
hope for help&lt;br/&gt;
claus</comment>
                    <comment id="12519984" author="stefan@jira" created="Wed, 15 Aug 2007 15:50:24 +0100"  >&amp;gt; there is my problem. In my scenario the user trys to add a new node (File-&amp;gt;Save As) on a parent node and i should now&lt;br/&gt;
&amp;gt; if he try to save the original file or if he try to save the file with a other name ....&lt;br/&gt;
&lt;br/&gt;
if the user saves the original file the parent node shouldn&amp;#39;t be modified; OTOH if he saves the file with a new name the parent node will be modified.&lt;br/&gt;
</comment>
                    <comment id="12626164" author="anchela" created="Wed, 27 Aug 2008 16:38:27 +0100"  >i guess this issue has been addressed already some time ago with the overall security rework related to &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-1588&quot; title=&quot;JSR 283: Access Control&quot;&gt;&lt;strike&gt;JCR-1588&lt;/strike&gt;&lt;/a&gt;</comment>
                </comments>
                    <attachments>
                    <attachment id="12363414" name="acces.patch" size="4174" author="c_koell" created="Wed, 8 Aug 2007 16:48:54 +0100" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 9 Aug 2007 13:08:15 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>142480</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>190068</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
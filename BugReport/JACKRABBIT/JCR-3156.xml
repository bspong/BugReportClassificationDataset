<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 06:01:38 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-3156/JCR-3156.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-3156] Group#getMembers may list inherited members multiple times</title>
                <link>https://issues.apache.org/jira/browse/JCR-3156</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>i just happen to detect the following regression that seems to be introduces quite a while ago:&lt;br/&gt;
&lt;br/&gt;
Group#getMembers is defined to return all group members including those inherited by another group being member of that group.&lt;br/&gt;
&lt;br/&gt;
Example:&lt;br/&gt;
User t&lt;br/&gt;
Group a : t is declared member&lt;br/&gt;
Group b : t is declared member&lt;br/&gt;
Group c : a, b are declared members&lt;br/&gt;
&lt;br/&gt;
The expected result of Group.getMembers was: a, b and t.&lt;br/&gt;
&lt;br/&gt;
What is currently happening is that t is included twice in the returned iterator.&lt;br/&gt;
Quickly testing on jackrabbit 2.0 revealed that this used to work before...&lt;br/&gt;
&lt;br/&gt;
I didn&amp;#39;t carefully check when that bug has been introduced but the the refactoring of the membership&lt;br/&gt;
collections seems to be a possible culprit.&lt;br/&gt;
&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12532453">JCR-3156</key>
            <summary>Group#getMembers may list inherited members multiple times</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="mduerig">Michael D&#252;rig</assignee>
                                <reporter username="anchela">angela</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Nov 2011 11:29:48 +0000</created>
                <updated>Tue, 6 Dec 2011 14:47:11 +0000</updated>
                    <resolved>Wed, 23 Nov 2011 14:06:47 +0000</resolved>
                            <version>2.2</version>
                <version>2.3</version>
                                <fixVersion>2.3.4</fixVersion>
                                <component>jackrabbit-core</component>
                <component>security</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="13155817" author="anchela" created="Wed, 23 Nov 2011 11:32:52 +0000"  >test case illustrating the problem</comment>
                    <comment id="13155818" author="anchela" created="Wed, 23 Nov 2011 11:33:20 +0000"  >michi, does that ring a bell?</comment>
                    <comment id="13155821" author="mduerig" created="Wed, 23 Nov 2011 11:45:29 +0000"  >This was introduced as a side effect of &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-2726&quot; title=&quot;Make collecting group membership information lazy&quot;&gt;&lt;strike&gt;JCR-2726&lt;/strike&gt;&lt;/a&gt;</comment>
                    <comment id="13155831" author="mduerig" created="Wed, 23 Nov 2011 12:16:38 +0000"  >Group#getMembers() does not pose a uniqueness constraint on the returned iterator. So the current implementation is to the contract. Since uniqueness is desirable I think we should also tighten that contract. &lt;br/&gt;
&lt;br/&gt;
However, adding uniqueness will partially undo the gains from collecting group members lazily since the implementation would have to remember members in order to test for uniqueness. </comment>
                    <comment id="13155861" author="anchela" created="Wed, 23 Nov 2011 13:32:24 +0000"  >&amp;gt; Group#getMembers() does not pose a uniqueness constraint on the returned iterator.&lt;br/&gt;
&lt;br/&gt;
come on.... that&amp;#39;s the whole story about having the shortcut compared to Group.getDeclaredMembers and having to&lt;br/&gt;
fetch the members of member-groups of the membergroups of the member-groups. but if common sense is&lt;br/&gt;
not sufficient let&amp;#39;s add this explicitly to the API contract.&lt;br/&gt;
&lt;br/&gt;
&amp;gt; However, adding uniqueness will partially undo the gains from collecting group members lazily &lt;br/&gt;
&amp;gt; since the implementation would have to remember members in order to test for uniqueness. &lt;br/&gt;
&lt;br/&gt;
where exactly is the gain if every single API consumer has to maintain that list because the implementation&lt;br/&gt;
doesn&amp;#39;t do it? i don&amp;#39;t see the benefit and it would just lead to have that very same code being written&lt;br/&gt;
multiple times... just thinking of our own usages of Group.getMembers() i know at least 4 places where we&lt;br/&gt;
would need to add that filter. furthermore i think it is sufficient to remember the IDs of the members that &lt;br/&gt;
have already been served. </comment>
                    <comment id="13155884" author="mduerig" created="Wed, 23 Nov 2011 14:06:47 +0000"  >Fixed at revision 1205400</comment>
                </comments>
                    <attachments>
                    <attachment id="12504866" name="JCR-3156.patch" size="2087" author="anchela" created="Wed, 23 Nov 2011 11:32:51 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Wed, 23 Nov 2011 11:45:29 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>218187</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>250198</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:49:22 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-423/JCR-423.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-423] Node.restore() fails for existing non-versioned OPV=Version child nodes</title>
                <link>https://issues.apache.org/jira/browse/JCR-423</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>I have a node whose definition has properties and child nodes.  The&lt;br/&gt;
definitions of the nodetypes for the node and the child include&lt;br/&gt;
mix:versionable.  The properties definitions have onParentVersion=COPY and&lt;br/&gt;
the child nodes have onParentVersion=VERSION.  When I create a node with&lt;br/&gt;
child nodes and checkin and then restore the node, I get a&lt;br/&gt;
&amp;quot;....VersionException: Restore of root node not allowed&amp;quot;  This is&lt;br/&gt;
occurring on the restore of the child node.&lt;br/&gt;
&lt;br/&gt;
According to the spec:&lt;br/&gt;
&lt;br/&gt;
Child Node&lt;br/&gt;
On checkin of N, the node VN will get a subnode of type nt:versionedChild&lt;br/&gt;
with the same name as C. The single property of this node,&lt;br/&gt;
jcr:childVersionHistory is a REFERENCE to the version history of C (not to&lt;br/&gt;
C or any actual version of C). This also requires that C itself be&lt;br/&gt;
versionable (otherwise it would not have a version history).&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
On restore of VN, if the workspace currently has an already existing node&lt;br/&gt;
corresponding to C?s version history and the removeExisting flag of the&lt;br/&gt;
restore is set to true, then that instance of C becomes the child of the&lt;br/&gt;
restored N. If the workspace currently has an already existing node&lt;br/&gt;
corresponding to C?s version history and the removeExisting flag of the&lt;br/&gt;
restore is set to false then an ItemExistsException is thrown.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
I&amp;#39;m restoring the node using&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;node.restore(version, true);&lt;br/&gt;
&lt;br/&gt;
Is this expected behavior?</description>
                <environment></environment>
            <key id="12333017">JCR-423</key>
            <summary>Node.restore() fails for existing non-versioned OPV=Version child nodes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="tripod">Tobias Bocanegra</assignee>
                                <reporter username="tripod">Tobias Bocanegra</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 May 2006 22:06:50 +0100</created>
                <updated>Tue, 6 Nov 2007 15:12:51 +0000</updated>
                    <resolved>Tue, 9 May 2006 20:54:19 +0100</resolved>
                            <version>0.9</version>
                <version>1.0</version>
                                <fixVersion>1.0.1</fixVersion>
                                <component>versioning</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12377418" author="tripod" created="Tue, 2 May 2006 23:45:08 +0100"  >fixed in r398968</comment>
                    <comment id="12378507" author="tripod" created="Tue, 9 May 2006 04:07:33 +0100"  >the opv=copy issue is resolved, but another appeared:&lt;br/&gt;
&lt;br/&gt;
newly added opv=version child nodes are not removed when restoring an older version of the node, not containing that nodes.</comment>
                    <comment id="12378617" author="tripod" created="Tue, 9 May 2006 20:54:19 +0100"  >fixed (again).&lt;br/&gt;
&lt;br/&gt;
Committed revision 405417.</comment>
                    <comment id="12413410" author="jukkaz" created="Fri, 26 May 2006 17:31:09 +0100"  >Merged for 1.0.1 in revision 409609.</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12381440">JCR-1197</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Fri, 26 May 2006 16:31:09 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>80382</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>191214</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
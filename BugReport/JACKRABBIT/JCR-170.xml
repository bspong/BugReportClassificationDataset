<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:50:29 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-170/JCR-170.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-170] VirtualItemStates of node types definitions not accessible with uuid</title>
                <link>https://issues.apache.org/jira/browse/JCR-170</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>The VirtualNodeTypeStateProvider that maps node type definitions into the workspace under /jcr:system/jcr:nodeTypes does not implement the methods:&lt;br/&gt;
&lt;br/&gt;
- internalGetNodeState(NodeId id)&lt;br/&gt;
- internalHasNodeState(NodeId id)&lt;br/&gt;
&lt;br/&gt;
This has the effect that ItemStates that reflect node type definitions are not accessible directly with their uuid.</description>
                <environment>svn revision: 219171</environment>
            <key id="12312308">JCR-170</key>
            <summary>VirtualItemStates of node types definitions not accessible with uuid</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="tripod">Tobias Bocanegra</assignee>
                                <reporter username="mreutegg">Marcel Reutegger</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Jul 2005 20:06:25 +0100</created>
                <updated>Mon, 18 Jul 2005 21:11:58 +0100</updated>
                    <resolved>Mon, 18 Jul 2005 21:11:58 +0100</resolved>
                                            <fixVersion>1.0</fixVersion>
                                <component>nodetype</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12315973" author="tripod" created="Sun, 17 Jul 2005 02:05:05 +0100"  >all the virtually mapped nodestates are initialized on startup or on registration of new nodetypes. the mechanism is a bit obscure, but the createNodeTypeState() method calls the createNodeState() method of the AbstractVISProvider , which puts the newly created state into its cache. the cache is basically implemented with a soft-ref hashmap, so the items could disapear. to prevent this, they are also added as hard reference to the parent node state. imo, the internalGetNodeState() and internalHasNodeState() should never be called since the items should retain in the cache for ever.&lt;br/&gt;
as soon as the cache implementation in the AbstractVISProvider changes, we might reconsider this issue.</comment>
                    <comment id="12316024" author="mreutegg" created="Mon, 18 Jul 2005 18:35:25 +0100"  >I see. However the nodes are not cached on startup, but only when the root node of the virtual node type hierarchy is accessed for the first time.&lt;br/&gt;
&lt;br/&gt;
A quick dirty fix that worked for me was:&lt;br/&gt;
&lt;br/&gt;
Index: VirtualNodeTypeStateProvider.java&lt;br/&gt;
===================================================================&lt;br/&gt;
--- VirtualNodeTypeStateProvider.java	(revision 219171)&lt;br/&gt;
+++ VirtualNodeTypeStateProvider.java	(working copy)&lt;br/&gt;
@@ -58,6 +58,11 @@&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public VirtualNodeTypeStateProvider(NodeTypeRegistry ntReg, String rootNodeId, String parentId) {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;super(ntReg, new NodeId(rootNodeId));&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;this.parentId = parentId;&lt;br/&gt;
+        try {&lt;br/&gt;
+            getRootState();&lt;br/&gt;
+        } catch (ItemStateException e) {&lt;br/&gt;
+            // ignore&lt;br/&gt;
+        }&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br/&gt;
&amp;nbsp;&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;/**&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
But there is certainly a more elegant solution to this.</comment>
                    <comment id="12316029" author="tripod" created="Mon, 18 Jul 2005 21:11:58 +0100"  >fixed using marcels aproach.&lt;br/&gt;
&lt;br/&gt;
Author: tripod&lt;br/&gt;
Date: Mon Jul 18 04:09:39 2005&lt;br/&gt;
New Revision: 219466&lt;br/&gt;
&lt;br/&gt;
URL: &lt;a href=&quot;http://svn.apache.org/viewcvs?rev=219466&amp;view=rev&quot;&gt;http://svn.apache.org/viewcvs?rev=219466&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
[#&lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-170&quot; title=&quot;VirtualItemStates of node types definitions not accessible with uuid&quot;&gt;&lt;strike&gt;JCR-170&lt;/strike&gt;&lt;/a&gt;] VirtualItemStates of node types definitions not accessible with uuid&lt;br/&gt;
&lt;br/&gt;
Modified:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;incubator/jackrabbit/trunk/core/src/java/org/apache/jackrabbit/core/nodetype/virtual/VirtualNodeTypeStateProvider.java</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10032">
                <name>Blocker</name>
                                <outwardlinks description="blocks">
                            <issuelink>
            <issuekey id="12311969">JCR-160</issuekey>
        </issuelink>
                    </outwardlinks>
                                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sun, 17 Jul 2005 01:05:05 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>141984</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>253449</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
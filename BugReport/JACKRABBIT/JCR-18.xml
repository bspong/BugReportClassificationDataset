<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 06:02:20 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-18/JCR-18.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-18] Multithreading issue with versioning</title>
                <link>https://issues.apache.org/jira/browse/JCR-18</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>In a multithreading environment with two or more threads accessing the same version history, inconsistent state may be encountered. Concretely, the first thread is currently checking in the node to which the version history is attached while the second thread walks this same version history by means of a &amp;quot;self-built&amp;quot; iterator, which just accesses the successors of each version to get the &amp;quot;next&amp;quot; to visit.&lt;br/&gt;
&lt;br/&gt;
At a certain point the second point may encounter an ItemNotFoundException with a stack trace similar to this:&lt;br/&gt;
&lt;br/&gt;
javax.jcr.ItemNotFoundException: c9bd405b-dff4-46ef-845c-d98e073e473a&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.jackrabbit.core.ItemManager.createItemInstance(ItemManager.java:354)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.jackrabbit.core.ItemManager.getItem(ItemManager.java:230)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.jackrabbit.core.SessionImpl.getNodeByUUID(SessionImpl.java:494)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;at org.apache.jackrabbit.core.version.VersionImpl.getSuccessors(VersionImpl.java:86)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;....&lt;br/&gt;
&lt;br/&gt;
It seems that the first thread has already filled the successor of the version, while the node is not yet accessible by the createItemInstance method.&lt;br/&gt;
&lt;br/&gt;
This bug seems to not be enforcible, but it is easily reproducible.</description>
                <environment>Jackrabbit SVN Rev. 56918</environment>
            <key id="28325">JCR-18</key>
            <summary>Multithreading issue with versioning</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="tripod">Tobias Bocanegra</assignee>
                                <reporter username="fmeschbe">Felix Meschberger</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Nov 2004 21:27:34 +0000</created>
                <updated>Mon, 8 Oct 2007 11:47:19 +0100</updated>
                    <resolved>Tue, 26 Jun 2007 09:01:42 +0100</resolved>
                            <version>0.9</version>
                <version>1.0</version>
                <version>1.0.1</version>
                <version>1.1</version>
                <version>1.1.1</version>
                <version>1.2.1</version>
                <version>1.2.2</version>
                <version>1.2.3</version>
                <version>1.3</version>
                <version>1.3.1</version>
                                <fixVersion>1.3.3</fixVersion>
                                <component>versioning</component>
                        <due></due>
                    <votes>2</votes>
                        <watches>2</watches>
                                                    <comments>
                    <comment id="55352" author="tripod" created="Thu, 11 Nov 2004 14:44:31 +0000"  >i must admit that i took no care about multihtreading until now. but of course i will do it now.</comment>
                    <comment id="55575" author="tripod" created="Wed, 17 Nov 2004 10:02:01 +0000"  >fixed at revision 76106</comment>
                    <comment id="55681" author="fmeschbe" created="Fri, 19 Nov 2004 14:19:06 +0000"  >Sorry, to say this, but the issue is only partly solved. While it occurrs less frequently than before it still occurrs.&lt;br/&gt;
&lt;br/&gt;
Again, I get the same exception at the same place at a moment where another thread is currently checkin, which modifies the successors of while the referred-to node is not (yet?) accessible.&lt;br/&gt;
&lt;br/&gt;
Here is the stack of the other thread:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;Thread [--some undisclosed name--] (Suspended)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;BDbPersistenceManager.load(NodeReferences) line: 398&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;ReferenceManager.get(NodeId) line: 62&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;PropertyImpl(ItemImpl).checkReferences(Iterator, Iterator, ReferenceManager) line: 635&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;PropertyImpl(ItemImpl).save() line: 1132&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;NodeImpl.checkin() line: 2004&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;...</comment>
                    <comment id="55686" author="tripod" created="Fri, 19 Nov 2004 14:46:50 +0000"  >will investigage</comment>
                    <comment id="55687" author="fmeschbe" created="Fri, 19 Nov 2004 14:53:57 +0000"  >Sorry again: My previous remark on &amp;quot;less frequently&amp;quot; is completely wrong. It occurrs as often as before :-(</comment>
                    <comment id="12414003" author="jukkaz" created="Wed, 31 May 2006 16:36:21 +0100"  >Fixing issue &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-443&quot; title=&quot;Deadlock when concurrently committing and reading versioning states&quot;&gt;&lt;strike&gt;JCR-443&lt;/strike&gt;&lt;/a&gt; seems to have fixed a few other concurrent versioning problems. Is this issue also fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-443&quot; title=&quot;Deadlock when concurrently committing and reading versioning states&quot;&gt;&lt;strike&gt;JCR-443&lt;/strike&gt;&lt;/a&gt;?</comment>
                    <comment id="12508093" author="mreutegg" created="Tue, 26 Jun 2007 08:59:51 +0100"  >Added a test case for this issue:&lt;br/&gt;
&lt;br/&gt;
jackrabbit-core\src\test\java\org\apache\jackrabbit\core\ReadVersionsWhileModified.java  &lt;br/&gt;
&lt;br/&gt;
At revision: 550724</comment>
                    <comment id="12508094" author="mreutegg" created="Tue, 26 Jun 2007 09:01:42 +0100"  >The test runs without deadlock or errors. I will therefore set this issue to fixed.</comment>
                    <comment id="12531736" author="jukkaz" created="Tue, 2 Oct 2007 11:03:24 +0100"  >Merged to the 1.3 branch in revision 581178.</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                <outwardlinks description="relates to">
                            <issuelink>
            <issuekey id="12363218">JCR-754</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12311568">JCR-140</issuekey>
        </issuelink>
                    </outwardlinks>
                                                <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12364901">JCR-790</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12370904">JCR-962</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Thu, 11 Nov 2004 14:44:31 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>80408</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>191050</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
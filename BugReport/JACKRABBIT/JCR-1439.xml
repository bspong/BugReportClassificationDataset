<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:36:41 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-1439/JCR-1439.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-1439] MOVE method returns error 412 Precondition Failed</title>
                <link>https://issues.apache.org/jira/browse/JCR-1439</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>Hi, I was trying MacOS X 10.5 Finder&amp;#39;s WebDAV client to do testing on Jackrabbit 1.4 which is hosted on Tomcat 5.5.25 on a Windows XP SP2 computer on a LAN. I encounter an error while doing remote editing, I was able to open the text document, but the problem is I couldn&amp;#39;t save it.&lt;br/&gt;
&lt;br/&gt;
I tried to find some log on Tomcat but sadly Jackrabbit didn&amp;#39;t produces any log files regarding of my problem. So I used Ethereal 0.99.0 to check the packets from the Windows XP computer. The below trace is a summary from the exported text file of the packet analyzer where the problem occur:-&lt;br/&gt;
&lt;br/&gt;
line 11818:-&lt;br/&gt;
No.     Time        Source                Destination           Protocol Info&lt;br/&gt;
4352 27.629257   10.60.1.90            10.60.1.187           HTTP     MOVE /jackrabbit-webapp-1.4/repository/default/.TemporaryItems/folders.501/TemporaryItems/(A%20Document%20Being%20Saved%20By%20TextEdit)/Copy%20of%20Request_for_GAMS_User_Account.rtf HTTP/1.1&lt;br/&gt;
&lt;br/&gt;
Frame 4352 (592 bytes on wire, 592 bytes captured)&lt;br/&gt;
Ethernet II, Src: AppleCom_72:c3:5e (00:0d:93:72:c3:5e), Dst: 00:19:d1:a0:34:f7 (00:19:d1:a0:34:f7)&lt;br/&gt;
Internet Protocol, Src: 10.60.1.90 (10.60.1.90), Dst: 10.60.1.187 (10.60.1.187)&lt;br/&gt;
Transmission Control Protocol, Src Port: 64970 (64970), Dst Port: 8080 (8080), Seq: 69060, Ack: 90475, Len: 526&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Source port: 64970 (64970)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Destination port: 8080 (8080)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Sequence number: 69060    (relative sequence number)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Next sequence number: 69586    (relative sequence number)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Acknowledgement number: 90475    (relative ack number)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Header length: 32 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Flags: 0x0018 (PSH, ACK)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Window size: 524280 (scaled)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Checksum: 0xd4f9 [correct]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Options: (12 bytes)&lt;br/&gt;
Hypertext Transfer Protocol&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;MOVE /jackrabbit-webapp-1.4/repository/default/.TemporaryItems/folders.501/TemporaryItems/(A%20Document%20Being%20Saved%20By%20TextEdit)/Copy%20of%20Request_for_GAMS_User_Account.rtf HTTP/1.1\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Request Method: MOVE&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Request URI: /jackrabbit-webapp-1.4/repository/default/.TemporaryItems/folders.501/TemporaryItems/(A%20Document%20Being%20Saved%20By%20TextEdit)/Copy%20of%20Request_for_GAMS_User_Account.rtf&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Request Version: HTTP/1.1&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;User-Agent: WebDAVFS/1.5 (01508000) Darwin/9.1.0 (Power Macintosh)\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Accept: */*\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Destination: &lt;a href=&quot;http://10.60.1.187:8080/jackrabbit-webapp-1.4/repository/default/au/gov/arc/www/rtf/Copy%20of%20Request_for_GAMS_User_Account.rtf&quot;&gt;http://10.60.1.187:8080/jackrabbit-webapp-1.4/repository/default/au/gov/arc/www/rtf/Copy%20of%20Request_for_GAMS_User_Account.rtf&lt;/a&gt;\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Authorization: Basic YWRtaW46YWRtaW4=\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Credentials: admin:admin&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Content-Length: 0\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Connection: keep-alive\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Host: 10.60.1.187:8080\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\r\n&lt;br/&gt;
&lt;br/&gt;
line 11850 -&lt;br/&gt;
No.     Time        Source                Destination           Protocol Info&lt;br/&gt;
4353 27.630345   10.60.1.187           10.60.1.90            HTTP     HTTP/1.1 412 Precondition Failed (text/html)&lt;br/&gt;
&lt;br/&gt;
Frame 4353 (1191 bytes on wire, 1191 bytes captured)&lt;br/&gt;
Ethernet II, Src: 00:19:d1:a0:34:f7 (00:19:d1:a0:34:f7), Dst: AppleCom_72:c3:5e (00:0d:93:72:c3:5e)&lt;br/&gt;
Internet Protocol, Src: 10.60.1.187 (10.60.1.187), Dst: 10.60.1.90 (10.60.1.90)&lt;br/&gt;
Transmission Control Protocol, Src Port: 8080 (8080), Dst Port: 64970 (64970), Seq: 90475, Ack: 69586, Len: 1125&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Source port: 8080 (8080)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Destination port: 64970 (64970)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Sequence number: 90475    (relative sequence number)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Next sequence number: 91600    (relative sequence number)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Acknowledgement number: 69586    (relative ack number)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Header length: 32 bytes&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Flags: 0x0018 (PSH, ACK)&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Window size: 65535&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Checksum: 0x1c18 [incorrect, should be 0xa2f0]&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Options: (12 bytes)&lt;br/&gt;
Hypertext Transfer Protocol&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;HTTP/1.1 412 Precondition Failed\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Request Version: HTTP/1.1&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Response Code: 412&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Server: Apache-Coyote/1.1\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Content-Type: text/html;charset=utf-8\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Content-Length: 965\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Date: Fri, 29 Feb 2008 02:31:01 GMT\r\n&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\r\n&lt;br/&gt;
Line-based text data: text/html&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;Apache Tomcat/5.5.25 - Error report&amp;lt;/title&amp;gt;&amp;lt;style&amp;gt;&amp;lt;!--H1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} H2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#52&lt;br/&gt;
</description>
                <environment>Windows XP Service Pack 2, MacOS X 10.5 (Leopard), Java JDK 1.6.0_04, Apache Tomcat 5.5.25</environment>
            <key id="12389847">JCR-1439</key>
            <summary>MOVE method returns error 412 Precondition Failed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="anchela">angela</assignee>
                                <reporter username="philipcher">Philip Cher</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Feb 2008 07:44:31 +0000</created>
                <updated>Mon, 8 Dec 2008 11:08:00 +0000</updated>
                    <resolved>Wed, 5 Mar 2008 10:03:48 +0000</resolved>
                            <version>1.4</version>
                                <fixVersion>1.5</fixVersion>
                                <component>jackrabbit-webdav</component>
                        <due></due>
                    <votes>4</votes>
                        <watches>1</watches>
                                                    <comments>
                    <comment id="12573628" author="philipcher" created="Fri, 29 Feb 2008 07:48:07 +0000"  >This the exported text file from Ethereal</comment>
                    <comment id="12575081" author="jnolen" created="Tue, 4 Mar 2008 17:57:48 +0000"  >Just to chime in, we&amp;#39;re running into this problem at Atlassian as well. Would love some help with this one.&lt;br/&gt;
&lt;br/&gt;
-Jonathan @ Atlassian</comment>
                    <comment id="12575288" author="anchela" created="Wed, 5 Mar 2008 09:57:05 +0000"  >there are the following possibilities of a 412 being raised upon MOVE: &lt;br/&gt;
&lt;br/&gt;
- resource is locked and If-Header not present or not matching &lt;br/&gt;
- same for the destination resource &lt;br/&gt;
- attempt to move to an existing item but overwrite is not forced (header) &lt;br/&gt;
&lt;br/&gt;
from what i&amp;#39;ve seen in the dump.txt there was a lock on the move-source that was successfully removed after writing the content. so, i&amp;#39;d say the problem is rather not caused by a locking issue. &lt;br/&gt;
&lt;br/&gt;
however, i have the impression that the client tries to move the tmp-file to an existing destination without overwrite-header: &lt;br/&gt;
&lt;br/&gt;
in line 5933 (response to a PROPFIND): &lt;br/&gt;
&lt;br/&gt;
&amp;lt;D:href&amp;gt;&lt;a href=&quot;http://10.60.1.187:8080/jackrabbit-webapp-1.4/repository/default/au/gov/arc/www/rtf/Copy%20of%20Request_for_GAMS_User_Account.rtf&amp;lt;/D:href&quot;&gt;http://10.60.1.187:8080/jackrabbit-webapp-1.4/repository/default/au/gov/arc/www/rtf/Copy%20of%20Request_for_GAMS_User_Account.rtf&amp;amp;lt;/D:href&lt;/a&gt;&amp;gt; &lt;br/&gt;
&amp;lt;D:propstat&amp;gt;&amp;lt;D:prop&amp;gt; &amp;lt;D:resourcetype/&amp;gt; &amp;lt;D:getlastmodified&amp;gt;Fri, 29 Feb 2008 01:42:31 GMT&amp;lt;/D:getlastmodified&amp;gt;&amp;lt;D:getcontentlength&amp;gt;15721&amp;lt;/D:getcontentlength&amp;gt;&amp;lt;/D:prop&amp;gt;&amp;lt;D:status&amp;gt;HTTP/1.1 200 OK&amp;lt;/D:status&amp;gt;&amp;lt;/D:propstat&amp;gt; &lt;br/&gt;
&lt;br/&gt;
-&amp;gt; there is a resource a /repository/default/au/gov/arc/www/rtf/Copy%20of%20Request_for_GAMS_User_Account.rtf &lt;br/&gt;
&lt;br/&gt;
the MOVE only occurs in line 11835: &lt;br/&gt;
&lt;br/&gt;
Request Method: MOVE &lt;br/&gt;
Request URI: /jackrabbit-webapp-1.4/repository/default/.TemporaryItems/folders.501/TemporaryItems/(A%20Document%20Being%20Saved%20By%20TextEdit)/Copy%20of%20Request_for_GAMS_User_Account.rtf &lt;br/&gt;
[...] &lt;br/&gt;
Destination: &lt;a href=&quot;http://10.60.1.187:8080/jackrabbit-webapp-1.4/repository/default/au/gov/arc/www/rtf/Copy%20of%20Request_for_GAMS_User_Account.rtf&quot;&gt;http://10.60.1.187:8080/jackrabbit-webapp-1.4/repository/default/au/gov/arc/www/rtf/Copy%20of%20Request_for_GAMS_User_Account.rtf&lt;/a&gt; &lt;br/&gt;
&lt;br/&gt;
-&amp;gt; no Overwrite header as far as i saw. &lt;br/&gt;
&lt;br/&gt;
and now OverwriteHeader.java defines &amp;#39;doOverwrite&amp;#39; false if there is no Overwrite-Header at all. &lt;br/&gt;
however RFC 2518 requires &amp;quot;T&amp;quot; to be the default if the header is missing (quote: &amp;quot;If the overwrite header is not included in a COPY or MOVE request then the resource MUST treat the request as if it has an overwrite header of value &amp;#39;T&amp;#39;&amp;quot;). that&amp;#39;s a bug. &lt;br/&gt;
</comment>
                    <comment id="12575289" author="anchela" created="Wed, 5 Mar 2008 10:03:48 +0000"  >i modified OverwriteHeader.java and made &amp;#39;T&amp;#39; (do overwrite) the default in case the request does&lt;br/&gt;
not contain an Overwrite header field.&lt;br/&gt;
&lt;br/&gt;
the litmus tests passed but i didn&amp;#39;t create an extra test (move/copy without any overwrite header).&lt;br/&gt;
please reopen, if the problem still exists.</comment>
                    <comment id="12575290" author="anchela" created="Wed, 5 Mar 2008 10:04:24 +0000"  >edit component (jcr-webdav)</comment>
                </comments>
                    <attachments>
                    <attachment id="12376795" name="dump.txt" size="747570" author="philipcher" created="Fri, 29 Feb 2008 07:48:07 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Tue, 4 Mar 2008 17:57:48 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>78558</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>190147</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
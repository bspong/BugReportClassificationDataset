<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:31:23 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-221/JCR-221.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-221] NoSuchItemStateException if Node.checkin() is invoked within a transaction</title>
                <link>https://issues.apache.org/jira/browse/JCR-221</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>When you run a code that takes versionning outside transactions - everything goes ok. But when you run it inside transaction, it fails:&lt;br/&gt;
Here&amp;#39;s the stacktrace:&lt;br/&gt;
&lt;br/&gt;
15:41:14,434 ERROR (TransactionalItemStateManager.java:114) -&lt;br/&gt;
java.lang.Exception: Cannot commit transaction.&lt;br/&gt;
[...]&lt;br/&gt;
Caused by: org.apache.jackrabbit.core.state.TransactionException: Unable&lt;br/&gt;
to commit transaction.:&lt;br/&gt;
31f78b39-6422-4ec8-b41e-2571b6807b05/{&lt;a href=&quot;http://www.jcp.org/jcr/1.0&quot;&gt;http://www.jcp.org/jcr/1.0&lt;/a&gt;}isCheckedOut&lt;br/&gt;
[...]&lt;br/&gt;
Caused by: org.apache.jackrabbit.core.state.NoSuchItemStateException:&lt;br/&gt;
31f78b39-6422-4ec8-b41e-2571b6807b05/{&lt;a href=&quot;http://www.jcp.org/jcr/1.0&quot;&gt;http://www.jcp.org/jcr/1.0&lt;/a&gt;}isCheckedOut&lt;br/&gt;
[...]&lt;br/&gt;
&lt;br/&gt;
When you dont checkin the node transaction commits well, but the node is left checked out...</description>
                <environment>Jackrabbit and CRX on windows and linux.</environment>
            <key id="12317243">JCR-221</key>
            <summary>NoSuchItemStateException if Node.checkin() is invoked within a transaction</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="tripod">Tobias Bocanegra</assignee>
                                <reporter username="mcavity">Marcin Cenkier</reporter>
                        <labels>
                    </labels>
                <created>Sat, 24 Sep 2005 00:11:46 +0100</created>
                <updated>Fri, 13 Oct 2006 17:07:23 +0100</updated>
                    <resolved>Tue, 4 Oct 2005 02:34:46 +0100</resolved>
                                            <fixVersion>1.0</fixVersion>
                                <component>jackrabbit-core</component>
                <component>transactions</component>
                <component>versioning</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12331157" author="tripod" created="Mon, 3 Oct 2005 22:45:59 +0100"  >fixed.&lt;br/&gt;
&lt;br/&gt;
Author: tripod&lt;br/&gt;
Date: Mon Oct  3 05:45:08 2005&lt;br/&gt;
New Revision: 293324</comment>
                    <comment id="12331172" author="mcavity" created="Tue, 4 Oct 2005 00:53:42 +0100"  >The exception is not thrown, but transaction still doesn&amp;#39;t work. Checked out in transaction nodes remain checked out even so there is checkin() method called. So the repository is left in inconsistent state.</comment>
                    <comment id="12331176" author="tripod" created="Tue, 4 Oct 2005 01:32:00 +0100"  >yes, but this is another bug. see  &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-141&quot; title=&quot;Versioning does not make use of tx&quot;&gt;&lt;strike&gt;JCR-141&lt;/strike&gt;&lt;/a&gt;.&lt;br/&gt;
&lt;br/&gt;
the following test works for me:&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;public void testCheckin() throws Exception {&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// get user transaction object&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;UserTransaction utx = new UserTransactionImpl(superuser);&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// start transaction&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;utx.begin();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// add node and save&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Node n = testRootNode.addNode(nodeName1, testNodeType);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;n.addMixin(mixVersionable);&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;testRootNode.save();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;n.checkin();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;// commit&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;utx.commit();&lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;assertFalse(&amp;quot;Node must be checked-in&amp;quot;, n.isCheckedOut());&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}</comment>
                    <comment id="12331178" author="tripod" created="Tue, 4 Oct 2005 01:36:13 +0100"  >...ok refined the test. within the transaction, the node is still checked out....</comment>
                    <comment id="12331184" author="tripod" created="Tue, 4 Oct 2005 02:28:01 +0100"  >Node.isCheckedOut() returns true for a new item. due to the issue described in &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-237&quot; title=&quot;Item.isNew() does not work correctly within a transaction&quot;&gt;&lt;strike&gt;JCR-237&lt;/strike&gt;&lt;/a&gt;, this is a problem within transactions.</comment>
                    <comment id="12331187" author="tripod" created="Tue, 4 Oct 2005 02:34:46 +0100"  >prevously mentioned tests succeed after &lt;a href=&quot;https://issues.apache.org/jira/browse/JCR-237&quot; title=&quot;Item.isNew() does not work correctly within a transaction&quot;&gt;&lt;strike&gt;JCR-237&lt;/strike&gt;&lt;/a&gt; was fxied.</comment>
                </comments>
                <issuelinks>
                        <issuelinktype id="10032">
                <name>Blocker</name>
                                                <inwardlinks description="is blocked by">
                            <issuelink>
            <issuekey id="12317540">JCR-237</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                        <issuelinktype id="10030">
                <name>Reference</name>
                                                <inwardlinks description="is related to">
                            <issuelink>
            <issuekey id="12311569">JCR-141</issuekey>
        </issuelink>
                    </inwardlinks>
                            </issuelinktype>
                    </issuelinks>
                <attachments>
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>0.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Mon, 3 Oct 2005 21:45:59 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>142029</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>189719</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
<!-- 
RSS generated by JIRA (5.2.8#851-sha1:3262fdc28b4bc8b23784e13eadc26a22399f5d88) at Sat Jul 27 05:55:16 UTC 2013

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/JCR-864/JCR-864.xml?field=key&field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>5.2.8</version>
        <build-number>851</build-number>
        <build-date>26-02-2013</build-date>
    </build-info>

<item>
            <title>[JCR-864] Bug in UtilDateTypeConverterImpl</title>
                <link>https://issues.apache.org/jira/browse/JCR-864</link>
                <project id="10591" key="JCR">Jackrabbit Content Repository</project>
                        <description>In this converter following line is used:&lt;br/&gt;
return this.getValueFactory().createValue(((java.util.Date) propValue).getTime());&lt;br/&gt;
but propValue must be converted to java.util.Calendar, not into long! ValueFactory than converts to LongValue not DateValue as expected.&lt;br/&gt;
&lt;br/&gt;
Following code works OK:&lt;br/&gt;
final long timeInMilis = ((java.util.Date) propValue).getTime();&lt;br/&gt;
final Calendar calendar = Calendar.getInstance();&lt;br/&gt;
calendar.setTimeInMillis(timeInMilis);&lt;br/&gt;
return this.getValueFactory().createValue( calendar );&lt;br/&gt;
&lt;br/&gt;
but I dont know better Date-&amp;gt; Calendar conversion.&lt;br/&gt;
</description>
                <environment></environment>
            <key id="12325491">JCR-864</key>
            <summary>Bug in UtilDateTypeConverterImpl</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                    <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png">Closed</status>
                    <resolution id="1">Fixed</resolution>
                                <assignee username="clombart">Christophe Lombart</assignee>
                                <reporter username="markoc50">Martin Ko&#269;&#237;</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Nov 2005 05:32:02 +0000</created>
                <updated>Tue, 15 Jan 2008 23:26:38 +0000</updated>
                    <resolved>Wed, 6 Jun 2007 22:28:05 +0100</resolved>
                                            <fixVersion>1.4</fixVersion>
                                <component>jackrabbit-ocm</component>
                        <due></due>
                    <votes>0</votes>
                        <watches>0</watches>
                                                    <comments>
                    <comment id="12357503" author="clombart" created="Sun, 13 Nov 2005 06:04:02 +0000"  >I don&amp;#39;t see a bug here. The unit tests work fine. Futhermore, if I apply your patch, one unit test fails.&lt;br/&gt;
Following the JDK doc, a Date can be converted into a long which represents the numbers of milliseconds since the standard base time known as &amp;quot;the epoch&amp;quot;, namely January 1, 1970, 00:00:00.&lt;br/&gt;
Searching on Date and Calendar is not very friendly with lucene, that&amp;#39;s why calendar &amp;amp; date are converted into long values. &lt;br/&gt;
</comment>
                    <comment id="12357587" author="markoc50" created="Mon, 14 Nov 2005 22:39:27 +0000"  >I think with this solution following is not possible:&lt;br/&gt;
&lt;br/&gt;
Custom node type with property of type Date:&lt;br/&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;propertyDefinition name=&amp;quot;jcr:lastModified&amp;quot; requiredType=&amp;quot;Date&amp;quot; autoCreated=&amp;quot;false&amp;quot; mandatory=&amp;quot;true&amp;quot; onParentVersion=&amp;quot;IGNORE&amp;quot; protected=&amp;quot;false&amp;quot; multiple=&amp;quot;false&amp;quot;/&amp;gt;&lt;br/&gt;
&lt;br/&gt;
jcrmapping with that property:&lt;br/&gt;
		&amp;lt;field-descriptor fieldName=&amp;quot;lastModified&amp;quot; jcrName=&amp;quot;jcr:lastModified&amp;quot; /&amp;gt;&lt;br/&gt;
&lt;br/&gt;
Domain object with that property:&lt;br/&gt;
protected Date lastModified;&lt;br/&gt;
&lt;br/&gt;
Jackrabbit throws exception because UtilDateTypeConverterImpl returns LongValue object but property is declared as Date. &lt;br/&gt;
This can be fixed with changing requiredType=&amp;quot;Date&amp;quot; to requiredType=&amp;quot;Long&amp;quot; but I want use Date type with JCR. Jcrmapping can support saving/converting Date properties as Longs as optional feature.&lt;br/&gt;
</comment>
                    <comment id="12357627" author="clombart" created="Tue, 15 Nov 2005 06:00:45 +0000"  >I&amp;#39;m ok to change if  we find a nice solution for searching correctly on date. Lucene has a bad support for searching on date. &lt;br/&gt;
&lt;br/&gt;
FYI, I would like to specify in the mapping file which atomic converter to use like this : &lt;br/&gt;
&lt;br/&gt;
&amp;lt;field-descriptor fieldName=&amp;quot;lastModified&amp;quot; jcrName=&amp;quot;jcr:lastModified&amp;quot;  atomicConverterClass =&amp;quot;com.blable.myDate2LongConverter&amp;quot;/&amp;gt;&lt;br/&gt;
&lt;br/&gt;
Of course, it will be a optional feature. If the attribute &amp;quot;atomicConverterClass&amp;quot; is not specify, the current code will be used. &lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
</comment>
                    <comment id="12502116" author="clombart" created="Wed, 6 Jun 2007 22:28:05 +0100"  >Done - Now the date attributes are not converted if the UtilDateConverteImpl is used. &lt;br/&gt;
XPath queries seem to work with date.</comment>
                </comments>
                    <attachments>
                    <attachment id="12320572" name="UtilDateTypeConverterImpl.patch" size="1120" author="markoc50" created="Thu, 10 Nov 2005 05:33:55 +0000" />
                </attachments>
            <subtasks>
        </subtasks>
                <customfields>
                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                <customfieldname>Attachment count</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>1.0</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                <customfieldname>Date of First Response</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>Sun, 13 Nov 2005 06:04:02 +0000</customfieldvalue>

                </customfieldvalues>
            </customfield>
                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Global Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>78743</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                            <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                <customfieldname>Rank</customfieldname>
                <customfieldvalues>
                    <customfieldvalue>252783</customfieldvalue>
                </customfieldvalues>
            </customfield>
                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                <customfieldname>Time in Status</customfieldname>
                <customfieldvalues>
                    
                </customfieldvalues>
            </customfield>
                            </customfields>
    </item>
</channel>
</rss>
An HTTP 204 NO CONTENT response results in dropped connection
After receiving a 204 NO CONTENT response HttpClient always closes the connection. This did not happen in earlier versions and appears to have been caused by a recent fix to bug 34262.Ian I reran the tests and once again reviewed the patch committed as a fix for bug 34262. I found no logical flaws in the code. HttpClient will close the connection ONLY if the server erroneously sends content body with 204 response which is a gross violation of the HTTP spec thus rendering the underlying connection unreliable OlegCreated an attachment id 15864 New unit test for a 204 response and the relevant fix Oleg As you say the 204 response does not have a content body. This means that it does not have either a content-length or a transfer-encoding header. I could not see a unit test that covers this situation. After adding a test I found that it failed and that a one line fix was required in HttpMethodBase. See the attached file for the new test and the fix. IanCreated an attachment id 15866 Patch a slightly different take Then I would rather have it this way. Please review and let me know if you agree OlegOleg That s fine. Thanks Ian Folks please review and let me know if it is okay with you to have the patch checked in. OlegWorks for me. MikePatch committed. Oleg

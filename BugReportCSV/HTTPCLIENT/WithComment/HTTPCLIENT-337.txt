Move Content-Type to the RequestEntity
The content type is really a property of the RequestEntity. It should be moved there.Charset property would also make sense IMO as charset is an attribute of the Content-Type property.Agreed. I was implicitly including that in the content type. MikeContent-Type is a property of every MIME part as well as of the overall HTTP message. Where do you want to move the Content-Type property from From EntityEnclosingMethod to RequestEntity. This move is purely conceptual. It makes perfect sense to me to have RequestEntity define its own content type instead of having to provide a request entity and its content type separately OlegMaybe I am blind but I can not spot any Content-Type property handling in EntityEnclosingMethod. It is all handled through a header no Anyway. Good to have it in RequestEntity.It s currently all done via headers except for HttpMethodBase.getRequestCharSet . MikeCreated an attachment id 11480 Take 1 Here s a first take on this one. The only things I see missing at this point are tests. Please take a look and let me know what you think. MikeMike It looks good to me. I would only make StringRequestEntity a little more intelligent with regards to charset attribute of the content type. For instance new StringRequestEntity stuff text plain charset UTF-8 should be smart enough to extract the charset attribute from the content type. Likewise new StringRequestEntity stuff text plain UTF-8 should be able to add the charset attribute to the content type. Do not worry about missing test cases at this point. I suspect the rest of the 3.0 development will be all about improving HttpClient s test coverage OlegCreated an attachment id 11511 Patch take 2 I tweaked StringRequestEntity String String String constructor a little to make it parse out the charset attribute out of the content type if not charset parameter explicitly specified OlegHi Oleg This looks good to me... I have only one other item to add. I think we also wanted to add the charset to the content-type if it was missing. I have a version of StringRequestEntity at home that does this which I will attach tonight. Other than this change I think the patch is ready to go. Any objections if I apply tonight MikeNone from me. OlegPatch applied after a few bug fixes. Mike

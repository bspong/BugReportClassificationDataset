Request is retried if preemptive authentication fails
Hello I m using premptive authentification from an Axis client using BASIC Http authentification. When the user isn t authenticated authorized by server in my case credentials are expired httpclient runs a Chalenge that produces a second request to server with same credentials. when using preemptive mode chalenge should be skipped if authentication scheme hasn t changed Nicolas Could you please attach a wire context log of the HTTP session http jakarta.apache.org commons httpclient logging.html OlegCreated an attachment id 16177 logs for duplicate request preemptive authentication is activated line 11 http.authentication.preemptive true first request is send line 52 server responds HTTP 1.1 401 line 120 and requires basic authentication line 138 WWW-Authenticate Basic realm Contact AuthChallengeProcessor runs challenge line 159 and retries authentication line 162 second request line 193 uses same credentials and gets same 401 line 257 I ve made some changed to processWWWAuthChallenge to include after line 690 boolean usePreemptive method.getParams .isParameterTrue HttpClientParams.PREEMPTIVE AUTHENTICATION boolean useBasic AuthPolicy.BASIC.equalsIgnoreCase authscheme.getSchemeName if usePreemptive useBasic     return false Using this no challenge is processed.Now I understand what the problem is The request is retried instead of failing after the first time.Created an attachment id 16259 Patch take 1 Folks Please review and let me know what you think OlegDid anyone have time to review this one This is a fairly big change for a release candidate. Please test and review OlegI haven t had a chance to test this but it looks good to me. The only other thing I can think of testing would be the combination of failed preemptive authentication and a custom CredentialsProvider. MikePatch committed Oleg

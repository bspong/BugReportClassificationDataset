entity returns the same stream for getContent 
BasicHttpEntity and GzipDecompressingEntity will return the same stream when getContent is called multiple times. That is not allowed by the HttpEntity interface. They should rather throw an IllegalStateException. Some tests and EntityUtils rely on getContent to return the same stream for multiple calls. patch follows   RolandCreated an attachment id 17593 patch take 1 This patch should apply without problems. I originally had a class comment added to BasicHttpEntity but then the patch would fail to apply. Created an attachment id 17594 patch take 2 This one also takes care of a difference between JVMs when charset names with illegal characters like whitespace are used in EncodingUtils. It includes a new test case which had previously failed on IBM JDK 1.4.2. import java.nio.charset.IllegalCharsetNameException Roland we cannot make use of Java 1.4 specific exceptions. The idea was to keep HttpCore Java 1.3 compatible. I ll happily apply the first take if that s okay with you Olegyakk - I thought only the API was supposed to be 1.3 compatible. Ok let s stick with take 1. But the EncodingUtils should then really be changed to use the default charset as the fallback for any RuntimeException. cheers   Roland In reply to comment 4 yakk - I thought only the API was supposed to be 1.3 compatible. With all NIO code moved to a module of its own there is no compelling reason for the use of Java 1.4 specific functionality at all. Ok let s stick with take 1. But the EncodingUtils should then really be changed to use the default charset as the fallback for any RuntimeException. If that can be made without indiscriminately discarding runtime exceptions fine by me. Otherwise I respectfully disagree. Patch take 1 checked in. Many thanks Roland Oleg

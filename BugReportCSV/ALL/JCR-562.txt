 OR in XPath query badly interpreted
executing query a 1 and b 2 or c 3 leads to creating wrong query tree. The builded tree looks like for query a 1 and b 2 and c 3 see attachement . using brackets resolves the problem but without brackets output query is different from input query. When AND and OR are switched so the OR is in first palce - a 1 or b 2 and c 3 everything is ok.The attached patch contains fix and following test case     public void testLogicalExpression throws Exception Node foo testRootNode.addNode foo foo.setProperty a 1 foo.setProperty b 2 foo.setProperty c 3 Node bar testRootNode.addNode bar bar.setProperty a 0 bar.setProperty b 2 bar.setProperty c 0 Node bla testRootNode.addNode bla bla.setProperty a 1 bla.setProperty b 0 bla.setProperty c 3 testRootNode.save String sql SELECT FROM nt unstructured WHERE a 1 and b 2 or c 3 Query q superuser.getWorkspace .getQueryManager .createQuery sql Query.SQL QueryResult result q.execute checkResult result new Node foo bla String xpath a 1 and b 2 or c 3 q superuser.getWorkspace .getQueryManager .createQuery xpath Query.XPATH result q.execute checkResult result new Node foo bla Applied patch as proposed in revision 464466 Thank you for reporting this issue.

Deprecate Spatial Contrib
The spatial contrib is blighted by bugs. The latest series found by Grant and discussed here shows that we need to re-think the cartesian tier implementation. Given the need to create a spatial module containing code taken from both lucene and Solr it makes sense to deprecate the spatial contrib and start from scratch in the new module. chris wanna come up with a patch against trunk that deprecates things and I go and port it to 3.x - once we are done we can nuke it from trunk On it. Attached patch for deprecating the contrib. Each class is deprecated and a message is left in the package.html. Attaching a patch that includes the creation of a new spatial module. Definitely needs someone to look at the build.xml Robert but I think it works. Chris I think we should not add an empty modules sub though. I plan to commit the deprecation part to 3.x and nuke spatial from 4.0 entirely. Would you want to move forward and open an issue to fill the module with some solr spatial logic Objections anybody I just noticed that Solr depends upon some methods in DistanceUtils. We ll need to move that into the module before removing the contrib from 4x. I am in favor of nuking spatial contrib FYI I m the author of SOLR-2155 . Solr 3.1 will be released soon so I suggest that committers here act now while there s time. The nuking will occur in trunk so its unaffected by the Solr 3.1 release. However some of Solr s spatial code depends on the contrib so its too late to make the deprecations in 3.1. Please don t remove remove any lucene spatial capabilities until there is a suitable replacement. Its absurd to tell users they should have to use Solr to use spatial this makes no sense. Thats a fair point and there is every intention to do that. But its also dangerous to continue to offer code with known and probably many unknown bugs. I d like to come to an agreement here and finish this off as to make a clear statement about spatial in Lucene 4. It seems we have a few options in front of us now Deprecate in 3x nuke fully in trunk Deprecate in 3x and in trunk moving the code to the sandbox Deprecate in 3x and in trunk and leave the code where it is Do nothing Robert s concern that removing the contrib entirely without providing an alternative seems very reasonable. But as I said in February I m very wary of continuing to release code which has so many problems. As such I favour deprecating in 3x and in trunk and sandboxing the code wit big warnings that it ll go when we have a better solution. Any opinions Robert David Deprecate in 3x absolutely. We know it s broken and we need to send a message to folks who don t know any better. I hope we can at least get consensus on this part. I don t see any point in this bad code moving forward into Lucene 4 whether there is a replacement or not. Deprecate in 3x and in trunk moving the code to the sandbox 1 and then decide what to do one something better gets up-to-speed This contrib module was eliminated from trunk as part of LUCENE-3795. So what to do about 3x Add a Deprecated annotation to all classes in the contrib And add a CHANGES.txt entry 1 I m about to commit a bunch of deprecations and the following edit to the overview.html javadoc h2 DEPRECATED h2 p The Lucene 3.x spatial contrib module is deprecated as of Solr 3.6. In Solr 4 there is a new spatial module that should be used instead. br For further information see a href https issues.apache.org jira browse LUCENE-2599 LUCENE-2599 a . br The old documentation follows below p I think thats confusing. It should say Lucene 3.6 Lucene 4. Your current wording makes people think that they have to use Solr to do spatial queries and thats not true correct Marking as fixed. The javadoc changes.txt were revision 1305595. Woops Robert you are right. I will fix this right away.

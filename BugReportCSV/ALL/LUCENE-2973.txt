Source distribution packaging targets should make a tarball from svn export 
Instead of picking and choosing which stuff to include from a local working copy Lucene s dist-src package-tgz-src target and Solr s package-src target should simply perform svn export with the same revision and URL as the local working copy. Patch implementing the idea. svn info is used to collect the revision and URL of the working copy. Drops .zip source packaging for both Lucene and Solr - only .tar.gz files are produced. Solr s package-src target includes everything in the top-level checkout. Lucene s dist-src package-tgz-src target includes everything in the top-level checkout except solr . Renamed the directory in which svn export operates from build checkout to build svn-export . Forgot to mention the patch is against trunk. This version of the patch copies the LICENSE.txt and NOTICE.txt files into the root dir of both the Lucene and Solr source packages. Solr s package-src target includes everything in the top-level checkout. Lucene s dist-src package-tgz-src target includes everything in the top-level checkout except solr We shouldn t do this. lucene should just include lucene and in no event should we be releasing dev-tools. Its not just philosophical issue either in a lucene-only release none of the stuff in dev-tools will actually even work anyway because it contains reference to solr. instead the build must not depend upon dev-tools its optional stuff. 1 this will be much easier and less error prone to maintain. This version of the patch has two changes The build svn-export directory is now deleted before telling svn export to export to that directory - previously it was complaining about the dir being in the way. dev-tools is excluded from both the Lucene and the Solr source packages. Lucene source distribution changed to export only the lucene top-level dir. NOTICE.txt and LICENSE.txt don t need copying anymore. I think this is ready to go - I ll commit later today if there are no objections. In this version of the patch I restored inclusion of dev-tools in the Solr source package. The decision about whether to include dev-tools is orthogonal to using svn export this patch maintains the status quo for Solr. dev-tools is not included in the Lucene source package this maintains the status quo for Lucene. Added some comments and introduced a variable for the source package filename instead of spelling it out everywhere. I will commit shortly. One more change in this patch Solr s sign-artifacts target no longer attempts to sign the .zip version of the source package. Committed trunk revision 1083213 branch 3x revision 1083235 lucene solr 3 1 revision 1083237 The subversion export command has a native-eol parameter native-eol ARG use a different EOL marker than the standard system marker for files with the svn eol-style property set to native . ARG may be one of LF CR CRLF Solr s package-src and Lucene s dist-src targets should be made to use this parameter with the LF arg so that the source packages can be consistently produced regardless of platform. The subversion export command has a native-eol parameter .... Solr s package-src and Lucene s dist-src targets should be made to use this parameter with the LF arg so that the source packages can be consistently produced regardless of platform. Committed r1083945 trunk r1083946 branch 3x r1083947 lucene solr 3 1 Ant s exec task can take arguments in two forms as a line to be parsed split by the shell arg line ... or as a pre-parsed list with one arg value ... for each cmdline argument . The svn-export-source target should be rewritten to use the pre-parsed form to avoid splitting problems e.g. spaces in paths with the arg line ... form. The svn-export-source target should be rewritten to use the pre-parsed form to avoid splitting problems e.g. spaces in paths with the arg line ... form. Committed r1084307 trunk r1084309 branch 3x I ll leave this issue open to also be committed on the lucene solr 3 1 branch before a 3.1.1 release if there is one . The svn-export-source targets were not using the svn.exe property but they should to allow for use of svn executables not on the PATH. Committed r1084322 trunk r1084324 branch 3x This change should also be added to the lucene solr 3 1 branch before a 3.1.1 release if there is one . Merged also to 3.1.0 Bulk close for 3.1

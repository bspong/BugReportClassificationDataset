Create org.apache.jackrabbit.core.id
I d like to create a separate package for the identifier interfaces and classes in jackrabbit-core. Currently all the identifiers are in org.apache.jackrabbit.core which makes almost all the other packages have dependencies to o.a.j.core and causes trouble for various package-level code quality and dependency analysis tools. For now the package would contain the ItemId NodeId and PropertyId classes. 1 But don t forget the NodeReferencesId.Any objections to this Otherwise I ll assume lazy consensus in a few days. This breaks all existing persistence managers implementations. Are we really willing to accept this just to make jackrabbit look better in code quality tools Yes I m having second thoughts about this as well now that I looked at it again in more detail. I ll come up with a proposed patch but let s delay this until we need to change the PM interface for some other reason.Why does it break persistence managers implementations The various Ids are part of the method signatures of the persistence manager interface.So the package name would change. The persistence managers would have to be recompiled. As far as I see that is an acceptable change for 1.5 not for 1.4.x of course .Just my Û.02 from the perspective of an OSGi user and modularization lover Having all these classes mixed with internal implementation code prevents proper separation of API and implementation and in fact prevents proper OSGi separation. For example it would be almost impossible to make the API externally visible and not at the same time make the implementation visible ... IMHO this is not a matter of making jackrabbit look better in code quality tools it is a matter of good programming style oh yeah another one from pandorra s box supporting separation of concern.Side note IMHO for code to look good in code quality tools is or at least should be equivalent to good programming style. If not then there s something wrong with the tools. - As for why I think moving the Ids to a separate package is especially important for code quality tools as long as they are in o.a.j.core many tools have trouble identifying circular dependencies and other design issues beyond the obvious o.a.j.core.foo - o.a.j.core dependencies caused by the Id classes. Creating o.a.j.core.id will not solve those issues but will at least make them more visible and thus easier to solve.Done in revision 792437. Targeting for Jackrabbit 2.0.

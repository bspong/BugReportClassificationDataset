Wrong exeption returned from Repository.login Credentials String 
According to specification calling Repository.login Credentials String with a non-existent wokspaceName should return NoSuchWorkspaceException. In fact it returns RepositoryException.Are you sure about this I just tested with the following code snippet and received the correct exception.     Repository repository new TransientRepository     try         repository.login foo      catch NoSuchWorkspaceException e         System.out.println No such workspace      Note that NoSuchWorkspaceException extends RepositoryException so you d get the same result if you used RepositoryException in the catch statement above. Resolving as Cannot Reproduce.Here s my code try   m session repository.login credentials foo catch NoSuchWorkspaceException e   System.out.println No such workspace catch RepositoryException e   System.out.println Repository exception And here s my console output compare the first line with the last one 11 46 53 090 INFO jcr local javax.jcr.NoSuchWorkspaceException foo 11 46 53 090 INFO jcr local at org.apache.jackrabbit.core.RepositoryImpl.getWorkspaceInfo RepositoryImpl.java 736 11 46 53 090 INFO jcr local at org.apache.jackrabbit.core.RepositoryImpl.login RepositoryImpl.java 1227 11 46 53 090 INFO jcr local at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.openSession JCAManagedConnectionFactory.java 140 11 46 53 090 INFO jcr local at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedConnection JCAManagedConnectionFactory.java 163 11 46 53 090 INFO jcr local at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedConnection JCAManagedConnectionFactory.java 155 11 46 53 090 INFO jcr local at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.createConnectionEventListener InternalManagedConnectionPool.java 565 11 46 53 090 INFO jcr local at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.getConnection InternalManagedConnectionPool.java 250 11 46 53 090 INFO jcr local at org.jboss.resource.connectionmanager.JBossManagedConnectionPool BasePool.getConnection JBossManagedConnectionPool.java 491 11 46 53 200 INFO jcr local at org.jboss.resource.connectionmanager.BaseConnectionManager2.getManagedConnection BaseConnectionManager2.java 341 11 46 53 200 INFO jcr local at org.jboss.resource.connectionmanager.TxConnectionManager.getManagedConnection TxConnectionManager.java 301 11 46 53 200 INFO jcr local at org.jboss.resource.connectionmanager.BaseConnectionManager2.allocateConnection BaseConnectionManager2.java 396 11 46 53 200 INFO jcr local at org.jboss.resource.connectionmanager.BaseConnectionManager2 ConnectionManagerProxy.allocateConnection BaseConnectionManager2.java 842 11 46 53 200 INFO jcr local at org.apache.jackrabbit.jca.JCARepositoryHandle.login JCARepositoryHandle.java 98 11 46 53 200 INFO jcr local at org.apache.jackrabbit.jca.JCARepositoryHandle.login JCARepositoryHandle.java 89 11 46 53 200 INFO jcr local at com.v4x.jcr.JcrConnectionBean.connect JcrConnectionBean.java 70 11 46 53 200 INFO jcr local at com.v4x.jcr.JcrConnectionBean.getSession JcrConnectionBean.java 86 11 46 53 200 INFO jcr local at sun.reflect.NativeMethodAccessorImpl.invoke0 Native Method 11 46 53 200 INFO jcr local at sun.reflect.NativeMethodAccessorImpl.invoke Unknown Source 11 46 53 200 INFO jcr local at sun.reflect.DelegatingMethodAccessorImpl.invoke Unknown Source 11 46 53 200 INFO jcr local at java.lang.reflect.Method.invoke Unknown Source 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 112 11 46 53 200 INFO jcr local at org.jboss.ejb3.interceptor.InvocationContextImpl.proceed InvocationContextImpl.java 166 11 46 53 200 INFO jcr local at org.jboss.ejb3.interceptor.EJB3InterceptorsInterceptor.invoke EJB3InterceptorsInterceptor.java 63 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.entity.ExtendedPersistenceContextPropagationInterceptor.invoke ExtendedPersistenceContextPropagationInterceptor.java 57 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.entity.TransactionScopedEntityManagerInterceptor.invoke TransactionScopedEntityManagerInterceptor.java 54 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.AllowedOperationsInterceptor.invoke AllowedOperationsInterceptor.java 46 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.tx.BMTInterceptor.handleStateful BMTInterceptor.java 106 11 46 53 200 INFO jcr local at org.jboss.ejb3.tx.BMTInterceptor.invoke BMTInterceptor.java 132 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.aspects.tx.TxPropagationInterceptor.invoke TxPropagationInterceptor.java 76 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.stateful.StatefulInstanceInterceptor.invoke StatefulInstanceInterceptor.java 83 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.aspects.security.AuthenticationInterceptor.invoke AuthenticationInterceptor.java 77 11 46 53 200 INFO jcr local at org.jboss.ejb3.security.Ejb3AuthenticationInterceptor.invoke Ejb3AuthenticationInterceptor.java 102 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.ENCPropagationInterceptor.invoke ENCPropagationInterceptor.java 47 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.asynchronous.AsynchronousInterceptor.invoke AsynchronousInterceptor.java 106 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.stateful.StatefulContainer.localInvoke StatefulContainer.java 203 11 46 53 200 INFO jcr local at org.jboss.ejb3.stateful.StatefulLocalProxy.invoke StatefulLocalProxy.java 98 11 46 53 200 INFO jcr local at Proxy121.getSession Unknown Source 11 46 53 200 INFO jcr local at com.v4x.mediaCenter.types.MediaItemBean.addToStorage MediaItemBean.java 84 11 46 53 200 INFO jcr local at com.v4x.mediaCenter.webServices.VideoItemWSBean.addVideoItem VideoItemWSBean.java 52 11 46 53 200 INFO jcr local at sun.reflect.NativeMethodAccessorImpl.invoke0 Native Method 11 46 53 200 INFO jcr local at sun.reflect.NativeMethodAccessorImpl.invoke Unknown Source 11 46 53 200 INFO jcr local at sun.reflect.DelegatingMethodAccessorImpl.invoke Unknown Source 11 46 53 200 INFO jcr local at java.lang.reflect.Method.invoke Unknown Source 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 112 11 46 53 200 INFO jcr local at org.jboss.ejb3.interceptor.InvocationContextImpl.proceed InvocationContextImpl.java 166 11 46 53 200 INFO jcr local at org.jboss.ejb3.interceptor.EJB3InterceptorsInterceptor.invoke EJB3InterceptorsInterceptor.java 63 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.entity.TransactionScopedEntityManagerInterceptor.invoke TransactionScopedEntityManagerInterceptor.java 54 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.AllowedOperationsInterceptor.invoke AllowedOperationsInterceptor.java 46 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.aspects.tx.TxPolicy.invokeInOurTx TxPolicy.java 79 11 46 53 200 INFO jcr local at org.jboss.aspects.tx.TxInterceptor Required.invoke TxInterceptor.java 191 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.aspects.tx.TxPropagationInterceptor.invoke TxPropagationInterceptor.java 76 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.ejb3.stateless.StatelessInstanceInterceptor.invoke StatelessInstanceInterceptor.java 62 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 200 INFO jcr local at org.jboss.aspects.security.AuthenticationInterceptor.invoke AuthenticationInterceptor.java 77 11 46 53 200 INFO jcr local at org.jboss.ejb3.security.Ejb3AuthenticationInterceptor.invoke Ejb3AuthenticationInterceptor.java 102 11 46 53 200 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 246 INFO jcr local at org.jboss.ejb3.ENCPropagationInterceptor.invoke ENCPropagationInterceptor.java 47 11 46 53 246 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 246 INFO jcr local at org.jboss.ejb3.asynchronous.AsynchronousInterceptor.invoke AsynchronousInterceptor.java 106 11 46 53 246 INFO jcr local at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 11 46 53 246 INFO jcr local at org.jboss.ejb3.stateless.StatelessContainer.localInvoke StatelessContainer.java 211 11 46 53 246 INFO jcr local at org.jboss.ejb3.stateless.StatelessContainer.localInvoke StatelessContainer.java 173 11 46 53 246 INFO jcr local at org.jboss.ws.integration.jboss.ServiceEndpointInvokerEJB3.invokeServiceEndpoint ServiceEndpointInvokerEJB3.java 131 11 46 53 246 INFO jcr local at org.jboss.ws.server.AbstractServiceEndpointInvoker.invoke AbstractServiceEndpointInvoker.java 151 11 46 53 246 INFO jcr local at org.jboss.ws.server.ServiceEndpoint.handleRequest ServiceEndpoint.java 195 11 46 53 246 INFO jcr local at org.jboss.ws.server.ServiceEndpointManager.processSOAPRequest ServiceEndpointManager.java 373 11 46 53 246 INFO jcr local at org.jboss.ws.server.StandardEndpointServlet.doPost StandardEndpointServlet.java 116 11 46 53 246 INFO jcr local at javax.servlet.http.HttpServlet.service HttpServlet.java 717 11 46 53 246 INFO jcr local at org.jboss.ws.server.StandardEndpointServlet.service StandardEndpointServlet.java 77 11 46 53 246 INFO jcr local at javax.servlet.http.HttpServlet.service HttpServlet.java 810 11 46 53 246 INFO jcr local at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter ApplicationFilterChain.java 252 11 46 53 246 INFO jcr local at org.apache.catalina.core.ApplicationFilterChain.doFilter ApplicationFilterChain.java 173 11 46 53 246 INFO jcr local at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter ReplyHeaderFilter.java 96 11 46 53 246 INFO jcr local at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter ApplicationFilterChain.java 202 11 46 53 246 INFO jcr local at org.apache.catalina.core.ApplicationFilterChain.doFilter ApplicationFilterChain.java 173 11 46 53 246 INFO jcr local at org.apache.catalina.core.StandardWrapperValve.invoke StandardWrapperValve.java 213 11 46 53 246 INFO jcr local at org.apache.catalina.core.StandardContextValve.invoke StandardContextValve.java 178 11 46 53 246 INFO jcr local at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke SecurityAssociationValve.java 175 11 46 53 246 INFO jcr local at org.jboss.web.tomcat.security.JaccContextValve.invoke JaccContextValve.java 74 11 46 53 246 INFO jcr local at org.apache.catalina.core.StandardHostValve.invoke StandardHostValve.java 126 11 46 53 246 INFO jcr local at org.apache.catalina.valves.ErrorReportValve.invoke ErrorReportValve.java 105 11 46 53 246 INFO jcr local at org.jboss.web.tomcat.tc5.jca.CachedConnectionValve.invoke CachedConnectionValve.java 156 11 46 53 246 INFO jcr local at org.apache.catalina.core.StandardEngineValve.invoke StandardEngineValve.java 107 11 46 53 246 INFO jcr local at org.apache.catalina.connector.CoyoteAdapter.service CoyoteAdapter.java 148 11 46 53 246 INFO jcr local at org.apache.coyote.http11.Http11Processor.process Http11Processor.java 869 11 46 53 246 INFO jcr local at org.apache.coyote.http11.Http11BaseProtocol Http11ConnectionHandler.processConnection Http11BaseProtocol.java 664 11 46 53 246 INFO jcr local at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket PoolTcpEndpoint.java 527 11 46 53 246 INFO jcr local at org.apache.tomcat.util.net.MasterSlaveWorkerThread.run MasterSlaveWorkerThread.java 112 11 46 53 246 INFO jcr local at java.lang.Thread.run Unknown Source 11 46 53 246 WARN JBossManagedConnectionPool Throwable while attempting to get a new connection null javax.resource.ResourceException Failed to create session foo at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.openSession JCAManagedConnectionFactory.java 145 at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedConnection JCAManagedConnectionFactory.java 163 at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedConnection JCAManagedConnectionFactory.java 155 at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.createConnectionEventListener InternalManagedConnectionPool.java 565 at org.jboss.resource.connectionmanager.InternalManagedConnectionPool.getConnection InternalManagedConnectionPool.java 250 at org.jboss.resource.connectionmanager.JBossManagedConnectionPool BasePool.getConnection JBossManagedConnectionPool.java 491 at org.jboss.resource.connectionmanager.BaseConnectionManager2.getManagedConnection BaseConnectionManager2.java 341 at org.jboss.resource.connectionmanager.TxConnectionManager.getManagedConnection TxConnectionManager.java 301 at org.jboss.resource.connectionmanager.BaseConnectionManager2.allocateConnection BaseConnectionManager2.java 396 at org.jboss.resource.connectionmanager.BaseConnectionManager2 ConnectionManagerProxy.allocateConnection BaseConnectionManager2.java 842 at org.apache.jackrabbit.jca.JCARepositoryHandle.login JCARepositoryHandle.java 98 at org.apache.jackrabbit.jca.JCARepositoryHandle.login JCARepositoryHandle.java 89 at com.v4x.jcr.JcrConnectionBean.connect JcrConnectionBean.java 70 at com.v4x.jcr.JcrConnectionBean.getSession JcrConnectionBean.java 86 at sun.reflect.NativeMethodAccessorImpl.invoke0 Native Method at sun.reflect.NativeMethodAccessorImpl.invoke Unknown Source at sun.reflect.DelegatingMethodAccessorImpl.invoke Unknown Source at java.lang.reflect.Method.invoke Unknown Source at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 112 at org.jboss.ejb3.interceptor.InvocationContextImpl.proceed InvocationContextImpl.java 166 at org.jboss.ejb3.interceptor.EJB3InterceptorsInterceptor.invoke EJB3InterceptorsInterceptor.java 63 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.entity.ExtendedPersistenceContextPropagationInterceptor.invoke ExtendedPersistenceContextPropagationInterceptor.java 57 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.entity.TransactionScopedEntityManagerInterceptor.invoke TransactionScopedEntityManagerInterceptor.java 54 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.AllowedOperationsInterceptor.invoke AllowedOperationsInterceptor.java 46 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.tx.BMTInterceptor.handleStateful BMTInterceptor.java 106 at org.jboss.ejb3.tx.BMTInterceptor.invoke BMTInterceptor.java 132 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.aspects.tx.TxPropagationInterceptor.invoke TxPropagationInterceptor.java 76 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.stateful.StatefulInstanceInterceptor.invoke StatefulInstanceInterceptor.java 83 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.aspects.security.AuthenticationInterceptor.invoke AuthenticationInterceptor.java 77 at org.jboss.ejb3.security.Ejb3AuthenticationInterceptor.invoke Ejb3AuthenticationInterceptor.java 102 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.ENCPropagationInterceptor.invoke ENCPropagationInterceptor.java 47 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.asynchronous.AsynchronousInterceptor.invoke AsynchronousInterceptor.java 106 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.stateful.StatefulContainer.localInvoke StatefulContainer.java 203 at org.jboss.ejb3.stateful.StatefulLocalProxy.invoke StatefulLocalProxy.java 98 at Proxy121.getSession Unknown Source at com.v4x.mediaCenter.types.MediaItemBean.addToStorage MediaItemBean.java 84 at com.v4x.mediaCenter.webServices.VideoItemWSBean.addVideoItem VideoItemWSBean.java 52 at sun.reflect.NativeMethodAccessorImpl.invoke0 Native Method at sun.reflect.NativeMethodAccessorImpl.invoke Unknown Source at sun.reflect.DelegatingMethodAccessorImpl.invoke Unknown Source at java.lang.reflect.Method.invoke Unknown Source at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 112 at org.jboss.ejb3.interceptor.InvocationContextImpl.proceed InvocationContextImpl.java 166 at org.jboss.ejb3.interceptor.EJB3InterceptorsInterceptor.invoke EJB3InterceptorsInterceptor.java 63 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.entity.TransactionScopedEntityManagerInterceptor.invoke TransactionScopedEntityManagerInterceptor.java 54 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.AllowedOperationsInterceptor.invoke AllowedOperationsInterceptor.java 46 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.aspects.tx.TxPolicy.invokeInOurTx TxPolicy.java 79 at org.jboss.aspects.tx.TxInterceptor Required.invoke TxInterceptor.java 191 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.aspects.tx.TxPropagationInterceptor.invoke TxPropagationInterceptor.java 76 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.stateless.StatelessInstanceInterceptor.invoke StatelessInstanceInterceptor.java 62 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.aspects.security.AuthenticationInterceptor.invoke AuthenticationInterceptor.java 77 at org.jboss.ejb3.security.Ejb3AuthenticationInterceptor.invoke Ejb3AuthenticationInterceptor.java 102 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.ENCPropagationInterceptor.invoke ENCPropagationInterceptor.java 47 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.asynchronous.AsynchronousInterceptor.invoke AsynchronousInterceptor.java 106 at org.jboss.aop.joinpoint.MethodInvocation.invokeNext MethodInvocation.java 101 at org.jboss.ejb3.stateless.StatelessContainer.localInvoke StatelessContainer.java 211 at org.jboss.ejb3.stateless.StatelessContainer.localInvoke StatelessContainer.java 173 at org.jboss.ws.integration.jboss.ServiceEndpointInvokerEJB3.invokeServiceEndpoint ServiceEndpointInvokerEJB3.java 131 at org.jboss.ws.server.AbstractServiceEndpointInvoker.invoke AbstractServiceEndpointInvoker.java 151 at org.jboss.ws.server.ServiceEndpoint.handleRequest ServiceEndpoint.java 195 at org.jboss.ws.server.ServiceEndpointManager.processSOAPRequest ServiceEndpointManager.java 373 at org.jboss.ws.server.StandardEndpointServlet.doPost StandardEndpointServlet.java 116 at javax.servlet.http.HttpServlet.service HttpServlet.java 717 at org.jboss.ws.server.StandardEndpointServlet.service StandardEndpointServlet.java 77 at javax.servlet.http.HttpServlet.service HttpServlet.java 810 at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter ApplicationFilterChain.java 252 at org.apache.catalina.core.ApplicationFilterChain.doFilter ApplicationFilterChain.java 173 at org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter ReplyHeaderFilter.java 96 at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter ApplicationFilterChain.java 202 at org.apache.catalina.core.ApplicationFilterChain.doFilter ApplicationFilterChain.java 173 at org.apache.catalina.core.StandardWrapperValve.invoke StandardWrapperValve.java 213 at org.apache.catalina.core.StandardContextValve.invoke StandardContextValve.java 178 at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke SecurityAssociationValve.java 175 at org.jboss.web.tomcat.security.JaccContextValve.invoke JaccContextValve.java 74 at org.apache.catalina.core.StandardHostValve.invoke StandardHostValve.java 126 at org.apache.catalina.valves.ErrorReportValve.invoke ErrorReportValve.java 105 at org.jboss.web.tomcat.tc5.jca.CachedConnectionValve.invoke CachedConnectionValve.java 156 at org.apache.catalina.core.StandardEngineValve.invoke StandardEngineValve.java 107 at org.apache.catalina.connector.CoyoteAdapter.service CoyoteAdapter.java 148 at org.apache.coyote.http11.Http11Processor.process Http11Processor.java 869 at org.apache.coyote.http11.Http11BaseProtocol Http11ConnectionHandler.processConnection Http11BaseProtocol.java 664 at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket PoolTcpEndpoint.java 527 at org.apache.tomcat.util.net.MasterSlaveWorkerThread.run MasterSlaveWorkerThread.java 112 at java.lang.Thread.run Unknown Source 11 46 53 278 INFO STDOUT Repository exception I forgot to mention my repository runs as JCA and I get a reference through JNDI lookup InitialContext ctx new InitialContext Repository repository Repository ctx.lookup java jcr local cannot reproduce using local jackrabbit instance must be a JCA issue changing component accordinglyHere s the problem and the suggested fix The source of the problem is in JCAManagedConnectionFactory openSession            Create a new session.           private XASession openSession JCAConnectionRequestInfo cri             throws ResourceException         createRepository         Credentials creds cri.getCredentials         String workspace cri.getWorkspace         try             XASession session XASession getRepository .login creds workspace             log Created session session             return session          catch RepositoryException e             log Failed to create session e             throw new ResourceException                      Failed to create session e.getMessage               All login exceptions which are instanceOf RepositoryException are catched and rethrown as ResourceException. That s fine because we are being called by an AS application server which doesn t know about repositories. However just for these situations JCARepositoryHandle login checks for the exception s cause which is missing. Therefore the correct catch clause should be as following          catch RepositoryException e             log Failed to create session e             throw new ResourceException                      Failed to create session e.getMessage e added second argument          Fixed as suggested in revision 507864. Thanks For the record This issue was actually caused by revision 418448 where I committed a simplified version of the fix suggested in issue JCR-413. The suggested fix used the J2EE 1.3 method setLinkedException to keep the original exception but I didn t realize why the underlying exception is required and just dropped the call in favor of a string copy of the exception message. The fix to this issue reintroduced the problem in JCR-413 and was now fixed properly in revision 510468. The reintroduced issue was recorded as JCR-761 since JCR-413 had already been closed in Jackrabbit 1.1.

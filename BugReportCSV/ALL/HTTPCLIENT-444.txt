Preemptive authentication causes NTLM auth scheme to fail
The NTLM authentication scheme does not work when the preemptive authentication is enabled. Reported by Dave Seidel dave at mindreef.com Created an attachment id 14603 Patch take 1 Possible fix. Dave could you please take it for a spin and let me know the results OlegThis patch is working fine for me solved the problem.Folks please review. If I hear no objections I ll commit the patch in a week or so OlegI am unable to test this lacking a Windows server. Any chance we can get a basic test case for this that at least reproduces the bug Odi If you know how to simulate NTLM server using an ASLv2 compatible java library I ll be happy to learn OlegNot exactly Oleg I rather thought of a replay attack Capture the protocol traffic of a successful authentication session and replay the server side with our test server class. Then verify the client response. Is this possible at all Or is NTLM safe to replay attacks IM H O replay attack based unit tests are of marginal benefit while quite being laborous to implement. I would very much rather see more efforts spent on providing better test case coverage for Digest auth scheme which is an open standard unlike NTLM. OlegCreated an attachment id 14628 Test patch I ll give this a try at work tomorrow and see if I can reproduce the problem. In general it seems good to me. We definitely don t want to spend too much time trying to exactly emulate a Win2k3 server but that doesn t seem to be necessary in this case. The attached test case should work. MikeGood job Michael Tested both patches. Looks very good.Patch test cases committed. Oleg

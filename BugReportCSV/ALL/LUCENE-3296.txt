Enable passing a config into PKIndexSplitter
I need to be able to pass the IndexWriterConfig into the IW used by PKIndexSplitter. Patch all tests pass. looks good.. do you have to use Version.LUCENE CURRENT in the ctors or can you pass in a version. using Version.LUCENE CURRENT is discouraged for several reasons. That was in there previously. Lets change it. This patch uses LUCENE 40. All tests pass. Simon The Version.LUCENE CURRENT is not important here for easier porting the version should be LUCENE CURRENT and it was before Jason s patch . Else we will have to always upgrade it with every new release. The same applies to the IndexUpdater class in core it also uses LUCENE CURRENT when you not pass in anything as the version is completely useless for simple merge operations - like here . I would take this issue but with LUCENE CURRENT. btw. The LUCENE CURRENT was inserted by myself in the orginal code Uwe the first patch 1 is implemented with CURRENT. 1. https issues.apache.org jira secure attachment 12485805 LUCENE-3296.patch here is a new patch. I added a second IWC since we can not reuse IWC instances across IW due to SetOnce restrictions. I also moved out the VERSION CURRENT and made it a ctor argument. We should not randomly use the VERSION CURRENT but rather be consistent when we use version. Simon The Version.LUCENE CURRENT is not important here for easier porting the version should be LUCENE CURRENT and it was before Jason s patch . Else we will have to always upgrade it with every new release. The same applies to the IndexUpdater class in core it also uses LUCENE CURRENT when you not pass in anything as the version is completely useless for simple merge operations - like here . not entirely true we use the index splitter in 3.x and if you upgrade from 3.1 to 3.2 you get a new mergepolicy by default which doesn t merge in order. I think its a problem that this version is not in 3.x yet so let fix it properly and backport. Simon not entirely true we use the index splitter in 3.x and if you upgrade from 3.1 to 3.2 you get a new mergepolicy by default which doesn t merge in order. I think its a problem that this version is not in 3.x yet so let fix it properly and backport. PKIndexSplitter is new in 3.3 so you would never used it with older versions... We should not randomly use the VERSION CURRENT but rather be consistent when we use version. I agree but when you backport to 3.4 you have to keep backwards compatibility so only deprecate the ctor there. IndexUpgrader only uses LUCENE CURRENT when you invoke from command line in all other cases its required arg so we are consistent here. We should also look at the other IndexSplitters in this package this patch includes added version to MultipassIndexSplitter ctor. I am going to commit this and backport to 3.x Committed to trunk and backported to 3.x. I marked parts in 3.x as deprecated.

WriteLineDocTask should write gzip bzip2 txt according to the extension of specified output file name
Since the readers behave this way it would be nice and handy if also this line writer would. Patch for auto-detecting output compression mode of result line file getInputStream moved from ContentSource to a new class StreamUtils under util. It is now named inputStream File . outputStream method added to StreamUtils. Before applying this patch svn mv modules benchmark src test org apache lucene benchmark byTask feeds ContentSourceTest.java modules benchmark src test org apache lucene benchmark byTask utils StreamUtilsTest.java I kept for now the force-bzip logic in WriteLineDocTask but I would like to remove it - it is strange and in any case LineDocSource would only auto-detect bzip input format if WriteLineDocTask was able to auto-detect bzip output format. Removing it will also simplify StreamUtils. Any opinions on removing this force-bzip option Patch looks good In StreamUtils you have b .bz b Ð it should be b .bz2 b Any opinions on removing this force-bzip option 1 you mean the bzip.compression property in WLDT right . I think that it s reasonable to request the user to specify an output file with .bz2 extension if he wants bzip compression. I don t see how it will simplify StreamUtils though but I trust you perhaps you meant it will simplify WLDT Thanks for reviewing Shai In StreamUtils you have b .bz b Ð it should be b .bz2 b Good catch Fixed. 1 you mean the bzip.compression property in WLDT right . Yes. I think that it s reasonable to request the user to specify an output file with .bz2 extension if he wants bzip compression. Great I removed it. I don t see how it will simplify StreamUtils though but I trust you perhaps you meant it will simplify WLDT It allowed to keep just one of the two variations of StreamUtils.outputStream . WLDT and the tests became simpler as well. Attaching updated patch. again first apply that svn mv... Looks good to me. Committed r084929 - trunk r1084941 - 3x Thanks Shai Bulk closing for 3.2

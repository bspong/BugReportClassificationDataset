SimpleDateFormat used in a non thread safe manner
As Mike pointed out in http www.mail-archive.com java-dev lucene.apache.org msg10831.html SimpleDateFormat is not thread safe and hence DocMakers need to maintain it in a ThreadLocal. Attached patch fixing DateFormat for parallel doc making . Also fixing addDoc logging in this scenario. LUCENE-848 s DirDocMaker use of SimpledateFormat should be modified to use ThreadLocal similar to Docmaker changes in LUCENE-940 Committed the fix thanks Mike for tracking this New test case TestPerfTasksLogic.testParallelDocMaker is using Reuters collection which is not found in this test run. Need to check why. Should have better tested the whole setup not just the particular Test sorry fore that. with LUCENE-945 resolved this one can be resolved as well now the parabuild test pass .

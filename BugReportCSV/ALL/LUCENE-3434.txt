Make ShingleAnalyzerWrapper and PerFieldAnalyzerWrapper immutable
Both ShingleAnalyzerWrapper and PerFieldAnalyzerWrapper have setters which change some state which impacts their analysis stack. If these are going to become reusable then the state must be immutable as changing it will have no effect. Process will be similar to QueryAutoStopWordAnalyzer I will remove in trunk and deprecate in 3x. Patches for trunk and 3x. I think you can remove the suppresswarnings and use Collections.emptyMap instead of Collections.EMPTY MAP Trunk Committed revision 1170942. with Robert s change 3x Committed revision 1170939. Bulk close after release of 3.5 As of Lucene 3.4.0 the default Analyzer of PerFieldAnalyzerWrapper is not loaded when searching documents only with fields in the exception list. I m a little confused about what you mean Simon. Are you able to expand on that a little What used to happen and what now happens 

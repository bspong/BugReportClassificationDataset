implement PERSIST events for the EventJournal
See http www.day.com specs jcr 2.0 12 Observation.html 12.6.3 20Event 20Bundling 20in 20Journaled 20Observation we ll probably have to add a PERSIST event at the end of o.a.jackrabbit.core.observation.EventStateCollection createEventStates Wouldn t be EventJournalImpl the obvious place It iterates through EventBundles and could add PERSIST each time the end of a bundle was reached.. Wouldn t be EventJournalImpl the obvious place It iterates through EventBundles and could add PERSIST each time the end of a bundle was reached.. yes perhaps. i am not familiar with the details of EventJournalImpl and what the criteria of event bundling are. anyway EventStateCollection createEventStates is probably the wrong place since PERSIST events should only appear in the event journal.Patch work-in-progress. Note that the introduction of PERSIST events may cause trouble for existing EventJournal consumers due to some method on Event now potentially returning null.Proposed patch including fixes for spi-commons and spi2jcrAdded http java.net jira browse JSR 333-44 on how to filter PERSIST events. final patch. final as we apparently have zero test coverage which I ll try to take care of next. 1 for the patch JCR-3172.diff 

REMOVE access is not checked when moving a node
When a node cannot be removed because AccessManager does not allow this it still can be moved using Session.move .Attaching a test which is a Maven project . AccessManager denies removal of any item. Test contains two methods one for removal of node passes another for move of node fails .When moving a node using Session.move the moved node doesn t get marked as removed as it would be upon Node.remove . Since the permissions are checked based on the state modifications upon save only the check for REMOVE permission is omitted. However The same test being execute with a Workspace.move String String would fail as the BatchedItemOperations explicitely check for both REMOVE permission on the target node and ADD NODE permission on the destination parent. For consistency between Session.move and Workspace.move i would opt for adding the corresponding permission check to Session.move .

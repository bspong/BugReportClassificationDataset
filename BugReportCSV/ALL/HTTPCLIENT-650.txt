Wire log is incomplete if HttpParser detects an error
If HttpParser detects an error in any of the headers it throws a ProtocolException Although the failing header is included in the Exception detail the headers leading up to the failure are not logged which makes it hard to debug and is quite confusing as the PE does not appear to be related to the data that has been received . This is because the wire-logging is done in the caller HttpMethodDirector which only logs the header if the parse succeeds. Perhaps the Wire logging should be done at the point where the HttpParser reads the line.Sebastian thanks a lot for figuring this out. The situation is indeed even a bit worse because what is logged is not the actual input from the wire but what is returned by the parser. That s after stripping ignorable whitespace and concatenating continuation lines. Attached patch moves wire logging for headers but not for the status line from HttpMethodBase to HttpParser.readLine ... . Somebody please review this carefully . I know it compiles but I don t have the environment set up to test whether it actually logs as expected... cheers   Roland Looks good to me Olegpatch committed

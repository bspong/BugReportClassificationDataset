Remove FieldMaskingSpanQuery or fix its scoring 
In Lucene 4.0 we added new scoring mechanisms but FieldMaskingSpanQuery is a serious problem Because it lies about the fields of its terms this sometimes results in totally bogus statistics cases where a single terms totalTermFreq exceeds sumTotalTermFreq for the entire field since its lying about it . Such lying could result in NaN Inf Negative scores exceptions divide by zero and other problems because the statistics are impossibly bogus. I d really like to commit these asserts but this query is in the way. As a temporary measure we can Ignore its tests. Patch enabling the assertions and disabling FieldMaskingSpanQuery s query tests unless the sim for the masked field is TFIDFSimilarity. I also changed the javadoc p Note as link getField returns the masked field scoring will be - done using the norms of the field name supplied. This may lead to unexpected - scoring behaviour. p done using the Similarity and collection statistics of the field name supplied but with the term statistics of the real field. This may lead to exceptions poor performance and unexpected scoring behaviour. p I think because this query doesn t really work except with certain scoring models we should at least move it to contrib if we aren t going to fix its scoring or remove it.

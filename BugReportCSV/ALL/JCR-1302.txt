ArrayHits does not end properly when skipTo doesn t find document
If skipTo target does not find a document that that has a higher value than the target it falls out of the loop and calls next possibly returning a previously found document. The patch makes sure that -1 is returned in this case otherwise confusing results might occur. Index src main java org apache jackrabbit core query lucene hits ArrayHits.java src main java org apache jackrabbit core query lucene hits ArrayHits.java revision 608900 src main java org apache jackrabbit core query lucene hits ArrayHits.java working copy -87 9 87 9              int nextDocValue hits i              if nextDocValue target                  index i - break return next                         - return next return -1         I guess we didn t have this before JCR-1041 so the fix doesn t need to be applied to the 1.3 branch. But it would be good to have this in 1.4.Suggested fix and a test case committed by Christoph in revisions 610717 and 610719. Merged to the 1.4 branch in revision 610770.Thanks a lot Owen for tracking this down and providing a patch 

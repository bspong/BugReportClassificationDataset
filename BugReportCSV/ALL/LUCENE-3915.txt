Add Japanese filter to replace term attribute with readings
Koji and Robert are working on LUCENE-3888 that allows spell-checkers to do their similarity matching using a different word than its surface form. This approach is very useful for languages such as Japanese where the surface form and the form we d like to use for similarity matching is very different. For Japanese it s useful to use readings for this Ð probably with some normalization. Find attached a draft patch that replaces term attributes with readings. I saw in Ohtani-san s Twitter feed that Koji had checked this functionality into lucene-gosen and I m providing a similar patch here hoping to support the Japanese spell-checking work. This patch can also convert katakana readings to romaji and it might make sense to use a romaji representation to do the spell-checking. We probably also need to deal with misspellings turning into several tokens and that we need to recompose them using their readings before we do matching. Just some thoughts... looks good we should also do a little optimization to the romanization method... we can make instead of String f String kana and then it making its own stringbuilder then toStringing that it can be f Appendable sb Charsequence kana and we just pass termAtt.setEmpty as the sb . updated patch with this optimization. Thanks Robert. I m thinking it could be useful to expand this filter with an option that controls how the reading is actually being used. I see two primary cases for this Use the reading as the term attribute Use the reading as a synonym The latter option can be useful for certain applications where we d like to be able to search by reading and get kanji matches. Expanding further on this scenario we would then probably want to support readings in several scripts Romaji Hepburn Hiragana Katakana This filter should be optional and available as tool to support these applications Ð and of course the on-going Japanese spell-check work. Thoughts The latter option can be useful for certain applications where we d like to be able to search by reading and get kanji matches. These apps can just copy their text to another field with a different analysis chain particularly with this filter as-is and search on both or whatever to get this behavior. This is just as efficient as adding a bunch of code to do the same thing but keeps all of our analysis much simpler. Thanks Robert. Understood. I ll run tests and commit this shortly. Committed revision 1305046 on trunk. Backporting to branch 3x. Committed revision 1305051 and 1305052 to branch 3x. Thanks Robert and Koji 

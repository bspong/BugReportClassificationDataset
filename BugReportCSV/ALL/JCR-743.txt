XA Transaction Recovery
If i add a node to the repository i get a XAException because i run into a Timeout ... I see the Warn Message Transaction rolled back because timeout expired. The default Timeout is set to 5 sec and i dont know how to set it to a higher value The Problem is if i restart my server websphere has a RecoveryManager and he try to recover this Transaction and then i get a NullpointerException in JCAManagedConnectionFactory. createManagedConnection beacuse the given ConnectionRequestInfo is null. So i dont know why the RecoveryManager tries to recover the Transaction The only solution for me is to delete the Tran-Log Files wich keep Websphere to recvoer XA Trasnactions. I have tested more with this behaviour. For more information my environment in detail Websphere 5.1.1 and Jackrabbit as J2C Resource Adapter My Workspace configuration      PersistenceManager class org.apache.jackrabbit.core.state.db.JNDIDatabasePersistenceManager         param name dataSourceLocation value jdbc JCR         param name schema value oracle         param name schemaObjectPrefix value wsp.name         param name externalBLOBs value false      PersistenceManager The DataSource jdbc JCR is a oracle.jdbc.pool.OracleConnectionPoolDataSource. I have also tested a oracle.jdbc.xa.client.OracleXADataSource but then i get a Exception on commit see JCR-744 I have a SessionBean where i make some calls to to Jackrabbit within a Transaction. I made a clean start. starting my Server and Jackrabbit to a a empty repository . If i add a node to the repository within transaction there are no problems. Now i stop the server and restart it and i get always the Nullpointer Exception. First i thought that is only if a make a Rollback but that is not so. I try to find out why Websphere try to recover the transaction ... WebSphere 5.1.1 tries to recover the connection s associated XAResource on startup regardless whether it was committed or rolled back. In order to be interoperable an anonymous recoverable-only connection is returned when this situation is detected. Fixed in revision 510465.

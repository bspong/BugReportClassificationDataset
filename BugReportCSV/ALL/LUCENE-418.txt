 PATCH Contribution A QueryParser which passes wildcard and prefix queries to analyzer
Lucenes built-in QueryParser class does not analyze prefix nor wildcard queries. Attached is a subclass which passes these queries to the analyzer as well. Created an attachment id 15886 MyQueryParser.java Attached java class. Thanks The following issues need to be fixed if this should become part of Lucene s core -it doesn t work yet for fuzzy and range queries -it needs test cases a real life test case that shows how this solves your original problem would be nice -a better name is needed maybe AnalyzingQueryParser . But I m not sure anyway whether it really should be a subclass or if it should be integrated into QueryParser. -the we should never get here should probably throw a runtime exception for easier debugging If you d like to work on these issues that would be nice. Created an attachment id 15903 AnalyzingQueryParser.java Renamed class added methods getRangeQuery and getFuzzyQuery and made a few fixes to getWildcardQuery. Created an attachment id 15907 TestAnalyzingQueryParser.java A query parser which utilises an analyzer is usable when you have multi-lingual content in one context for example a web portal application. Analyzing is not recommended when using a stemmer since a stemmer usually truncates terms. For multi-lingual content I have used a custom analyzer which normalises umlauts and diacritics to their closest ascii equivalent see attachment below . Doing tests with StandardAnalyzer would not make much sense so this test case requires the custom analyzer as well. Created an attachment id 15908 ASCIIAnalyzer.java Required by TestAnalyzingQueryParser. Created an attachment id 15909 ASCIIFilter.java Used by ASCIIAnalyzer. Created an attachment id 15910 TestASCIIAnalyzer.java Test case for ASCIIAnalyzer. Created an attachment id 15923 cleanup version Thanks here s a cleaned up version works only with Lucene in SVN . Created an attachment id 15924 cleanup version Cleaned up version that doesn t require ASCIIAnalyzer. I cleaned up your files a bit -re-indent according to Lucene standard -make it work with Lucene from SVN -removed deprecated methods -some spam protection for your email address Remaining issue -hasWildcardSuffix is never read If you make further changes please use either my files or provide patches against your version. Created an attachment id 15925 last cleanup Oh nice Thank you for taking the time looking at the code I wasn t sure with the deprecated methods and included them just in case. I ve removed the two lines with unused variable hasWildcardSuffix boolean it s function was replaced with countTokens int . Created an attachment id 15929 cleanup Some javadoc fixes. This has now been commited not to core but to contrib miscellaneous. If you have further improvements please either open a new bug report or re-open this one and attach a patch against the version now in SVN. Thanks again for your contribution 

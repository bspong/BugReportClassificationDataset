cache module should populate Via header to capture upstream and downstream protocols
Because the cache module is currently implemented as a decorator that behaves like a transparent caching proxy we need it to correctly populate the Via header so that we can preserve the record of which protocol versions were used upstream and downstream from the caching module. This is a MUST per the RFC http www.w3.org Protocols rfc2616 rfc2616-sec14.html sec14.45I ve uploaded a patch that fixes this issue including unit tests. One area for discussion is how to populate the comment section of the Via header if we want to include one . Currently the implementation follows the format of the User-Agent set by DefaultHttpClient so Via 1.1 localhost Apache-HttpClient 4.1-alpha3-SNAPSHOT cache This patch is contributed with the permission of my employer.Patch checked in. Many thanks Jon Oleg

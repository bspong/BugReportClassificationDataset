Item retrieval inefficient after refresh
When RepositoryService getItemInfos returns a sufficiently large batch for a path then the second invocation of getItem below is significantly slower than the first. String path ... Item i session.getItem path i.refresh false same for refresh true session.getItem path In my test setup RepositoryService getItemInfos returns 3946 elements. The first invocation takes approx. 800ms the second 3000ms.The slow down is caused by merging changes of item states from the server with the local ones on the client. The main contribution seems to come from diffing the property states. This patch disables diffing of property states. Items contained in a batch from the server are set to Status MODIFIED without establishing whether they differ form their cached values. I was able to successfully run all tests with the patch applied. However I m not sure whether this patch has further more subtle consequences which I m not aware of.fixed typo in summaryForget the patch. It doesn t work - test failuresThe fix to JCR-2498 should also fix this issue

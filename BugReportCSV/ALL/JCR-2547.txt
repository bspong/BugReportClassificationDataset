Setting a property which has been transiently removed fails with a PathNotFoundException
The following tests currently all fail with a PathNotFoundException org.apache.jackrabbit.jcr2spi.AddPropertyTest testReplacingProperty org.apache.jackrabbit.jcr2spi.AddPropertyTest testReplacingProperty2 org.apache.jackrabbit.jcr2spi.AddPropertyTest testAddingProperty org.apache.jackrabbit.jcr2spi.AddPropertyTest testAddingProperty2 The reason seems to be that the client sends an invalid request of the following form to the server - testroot node1 prop1 - testroot node1 prop1 testroot node1 prop1 value3 The server then responds with 409 Conflict AFAIU the reason for the invalid request is that property addition followed by property removal is not properly handled. That is the two operations do not properly cancel out.the issue was cause by some automatic cleanup that only respected multiple calls to setProperty but didn t take any removal into account. for simplicity i decided to remove the clean-up for regular setProperty setValue calls and only leave it for addMixin removeMixin and setPrimaryType.

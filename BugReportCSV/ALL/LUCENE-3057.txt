LuceneTestCase newFSDirectoryImpl misses to set LockFactory if ctor call throws exception
selckin reported on IRC that if you run ant test -Dtestcase TestLockFactory -Dtestmethod testNativeFSLockFactoryPrefix -Dtests.directory FSDirectory the test fails. Since FSDirectory is an abstract class it can not be instantiated so our code falls back to FSDirector.open. yet we miss to set the given lockFactory though. here is a patch Patch looks great Simon thanks for catching this selckin Maybe you can rip out the random number generator in your machine and donate it to Apache Committed revision 1098367. Maybe you can rip out the random number generator in your machine and donate it to Apache 1 thanks for running tests that is of great value should we backport to 3.x too should we backport to 3.x too oh right this stuff is in 3.x too - I will backport tomorrow Hi Simon I think you meant to set the lockfactory in the finally block currently if there is no exception instantiated the requested directory impl via the ctor e.g. NIOFSDirectory then the lockfactory parameter is never set. Hi Simon I think you meant to set the lockfactory in the finally block thanks robert for catching this I removed the return statement in revision 1098375. Backported to 3.x in revision 1098505

TestIndexFileDeleter checkIndex fail
found on 3.x ant test-tag -Dtestcase TestIndexFileDeleter -Dtestmethod testDeleteLeftoverFiles -Dtests.seed 7631088157098800527 4270221915205524915 junit-backwards-sequential junit Testsuite org.apache.lucene.index.TestIndexFileDeleter junit Tests run 1 Failures 0 Errors 1 Time elapsed 0.243 sec junit junit Standard Output junit CheckIndex failed junit Segments file segments 2 numSegments 5 version 3.4 format FORMAT 3 1 Lucene 3.1 junit 1 of 5 name 0 docCount 10 junit compound true junit hasProx true junit numFiles 2 junit size MB 0 001 junit diagnostics os Linux os.version 2.6.38-10-generic source flush lucene.version 3.4-SNAPSHOT os.arch amd64 java.version 1.6.0 24 java.vendor Sun Microsystems Inc. junit has deletions delFileName 0 1.del junit test open reader.........OK 1 deleted docs junit test fields..............OK 2 fields junit test field norms.........OK 2 fields junit test terms freq prox...OK 11 terms 20 terms docs pairs 18 tokens junit test stored fields.......OK 9 total field count avg 1 fields per doc junit test term vectors........OK 1 total vector count avg 0 111 term freq vector fields per doc junit junit 2 of 5 name 1 docCount 10 junit compound true junit hasProx true junit numFiles 1 junit size MB 0 junit diagnostics os Linux os.version 2.6.38-10-generic source flush lucene.version 3.4-SNAPSHOT os.arch amd64 java.version 1.6.0 24 java.vendor Sun Microsystems Inc. junit no deletions junit test open reader.........OK junit test fields..............OK 2 fields junit test field norms.........OK 2 fields junit test terms freq prox...OK 11 terms 20 terms docs pairs 20 tokens junit test stored fields.......OK 10 total field count avg 1 fields per doc junit test term vectors........OK 0 total vector count avg 0 term freq vector fields per doc junit junit 3 of 5 name 2 docCount 10 junit compound true junit hasProx true junit numFiles 2 junit size MB 0 junit diagnostics os Linux os.version 2.6.38-10-generic source flush lucene.version 3.4-SNAPSHOT os.arch amd64 java.version 1.6.0 24 java.vendor Sun Microsystems Inc. junit no deletions junit test open reader.........FAILED junit WARNING fixIndex would remove reference to this segment full exception junit java.io.IOException No sub-file with id .tvx found files .tii .fnm .tis .frq .fdt .nrm .prx .fdx junit at org.apache.lucene.index.CompoundFileReader.openInput CompoundFileReader.java 155 junit at org.apache.lucene.index.TermVectorsReader. init TermVectorsReader.java 79 junit at org.apache.lucene.index.SegmentCoreReaders.openDocStores SegmentCoreReaders.java 253 junit at org.apache.lucene.index.SegmentReader.get SegmentReader.java 117 junit at org.apache.lucene.index.SegmentReader.get SegmentReader.java 93 junit at org.apache.lucene.index.CheckIndex.checkIndex CheckIndex.java 524 junit at org.apache.lucene.index.CheckIndex.checkIndex CheckIndex.java 306 junit at org.apache.lucene.util. TestUtil.checkIndex TestUtil.java 146 junit at org.apache.lucene.store.MockDirectoryWrapper.close MockDirectoryWrapper.java 481 junit at org.apache.lucene.index.TestIndexFileDeleter.testDeleteLeftoverFiles TestIndexFileDeleter.java 165 junit at sun.reflect.NativeMethodAccessorImpl.invoke0 Native Method junit at sun.reflect.NativeMethodAccessorImpl.invoke NativeMethodAccessorImpl.java 39 junit at sun.reflect.DelegatingMethodAccessorImpl.invoke DelegatingMethodAccessorImpl.java 25 junit at java.lang.reflect.Method.invoke Method.java 597 junit at org.junit.runners.model.FrameworkMethod 1.runReflectiveCall FrameworkMethod.java 44 junit at org.junit.internal.runners.model.ReflectiveCallable.run ReflectiveCallable.java 15 junit at org.junit.runners.model.FrameworkMethod.invokeExplosively FrameworkMethod.java 41 junit at org.junit.internal.runners.statements.InvokeMethod.evaluate InvokeMethod.java 20 junit at org.junit.rules.TestWatchman 1.evaluate TestWatchman.java 48 junit at org.junit.internal.runners.statements.RunBefores.evaluate RunBefores.java 28 junit at org.junit.internal.runners.statements.RunAfters.evaluate RunAfters.java 31 junit at org.junit.runners.BlockJUnit4ClassRunner.runChild BlockJUnit4ClassRunner.java 76 junit at org.apache.lucene.util.LuceneTestCase LuceneTestCaseRunner.runChild LuceneTestCase.java 1277 junit at org.apache.lucene.util.LuceneTestCase LuceneTestCaseRunner.runChild LuceneTestCase.java 1195 junit at org.junit.runners.ParentRunner 3.run ParentRunner.java 193 junit at org.junit.runners.ParentRunner 1.schedule ParentRunner.java 52 junit at org.junit.runners.ParentRunner.runChildren ParentRunner.java 191 junit at org.junit.runners.ParentRunner.access 000 ParentRunner.java 42 junit at org.junit.runners.ParentRunner 2.evaluate ParentRunner.java 184 junit at org.junit.internal.runners.statements.RunBefores.evaluate RunBefores.java 28 junit at org.junit.internal.runners.statements.RunAfters.evaluate RunAfters.java 31 junit at org.junit.runners.ParentRunner.run ParentRunner.java 236 junit at junit.framework.JUnit4TestAdapter.run JUnit4TestAdapter.java 39 junit at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run JUnitTestRunner.java 420 junit at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch JUnitTestRunner.java 911 junit at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main JUnitTestRunner.java 768 junit junit 4 of 5 name 3 docCount 10 junit compound false junit hasProx true junit numFiles 8 junit size MB 0 junit diagnostics os Linux os.version 2.6.38-10-generic source flush lucene.version 3.4-SNAPSHOT os.arch amd64 java.version 1.6.0 24 java.vendor Sun Microsystems Inc. junit no deletions junit test open reader.........OK junit test fields..............OK 2 fields junit test field norms.........OK 2 fields junit test terms freq prox...OK 11 terms 20 terms docs pairs 20 tokens junit test stored fields.......OK 10 total field count avg 1 fields per doc junit test term vectors........OK 0 total vector count avg 0 term freq vector fields per doc junit junit 5 of 5 name 4 docCount 5 junit compound false junit hasProx true junit numFiles 8 junit size MB 0 junit diagnostics os Linux os.version 2.6.38-10-generic source flush lucene.version 3.4-SNAPSHOT os.arch amd64 java.version 1.6.0 24 java.vendor Sun Microsystems Inc. junit no deletions junit test open reader.........OK junit test fields..............OK 2 fields junit test field norms.........OK 2 fields junit test terms freq prox...OK 6 terms 10 terms docs pairs 10 tokens junit test stored fields.......OK 5 total field count avg 1 fields per doc junit test term vectors........OK 0 total vector count avg 0 term freq vector fields per doc junit junit WARNING 1 broken segments containing 10 documents detected junit junit junit Standard Error junit NOTE reproduce with ant test -Dtestcase TestIndexFileDeleter -Dtestmethod testDeleteLeftoverFiles -Dtests.seed 7631088157098800527 4270221915205524915 junit NOTE test params are locale no NO NY timezone America Ensenada junit NOTE all tests run in this JVM junit TestIndexFileDeleter junit NOTE Linux 2.6.38-10-generic amd64 Sun Microsystems Inc. 1.6.0 24 64-bit cpus 8 threads 1 free 236439224 total 252248064 junit junit Testcase testDeleteLeftoverFiles org.apache.lucene.index.TestIndexFileDeleter Caused an ERROR junit CheckIndex failed junit java.lang.RuntimeException CheckIndex failed junit at org.apache.lucene.util. TestUtil.checkIndex TestUtil.java 150 junit at org.apache.lucene.store.MockDirectoryWrapper.close MockDirectoryWrapper.java 481 junit at org.apache.lucene.index.TestIndexFileDeleter.testDeleteLeftoverFiles TestIndexFileDeleter.java 165 junit at org.apache.lucene.util.LuceneTestCase LuceneTestCaseRunner.runChild LuceneTestCase.java 1277 junit at org.apache.lucene.util.LuceneTestCase LuceneTestCaseRunner.runChild LuceneTestCase.java 1195 junit junit junit Test org.apache.lucene.index.TestIndexFileDeleter FAILED BUILD FAILED

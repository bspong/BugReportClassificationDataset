It should be possible to create a non-transient Repository inside the JCARepositoryManager
With JCR-2555 jukka changed the code to create a Repository with the RepositoryFactory mechanism. It should be possible to create a non-transient Repository I would prefer that if we use the old parameters homeDir and configFile to create the repository not transient create repo via RepositoryConfig.create WDOT 1 looks good to meCommitted revision 1205295.I checked the patch and seems like configInputStream is not being closed. Am I right Thanks for hint i opened a new issue JCR-3176There is another problem with this patch. If config is null it will call the method in line 108             config RepositoryConfig.create configFile homeDir It will result in an NPE Null Pointer Exception on org.apache.jackrabbit.core.config.RepositoryConfig line 276         URI uri new File file .toURI Following stack trace is provided Caused by java.lang.NullPointerException at java.io.File. init File.java 222 at org.apache.jackrabbit.core.config.RepositoryConfig.create RepositoryConfig.java 276 at org.apache.jackrabbit.jca.JCARepositoryManager.createNonTransientRepository JCARepositoryManager.java 108 at org.apache.jackrabbit.jca.JCARepositoryManager.createRepository JCARepositoryManager.java 77 at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.getRepository JCAManagedConnectionFactory.java 205 at org.apache.jackrabbit.jca.JCAManagedConnection.openSession JCAManagedConnection.java 100 at org.apache.jackrabbit.jca.JCAManagedConnection. init JCAManagedConnection.java 85 at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedConnection JCAManagedConnectionFactory.java 174 at org.apache.jackrabbit.jca.JCAManagedConnectionFactory.createManagedConnection JCAManagedConnectionFactory.java 166 at com.sun.enterprise.resource.allocator.ConnectorAllocator.createResource ConnectorAllocator.java 160 at com.sun.enterprise.resource.pool.ConnectionPool.createSingleResource ConnectionPool.java 907 ... 77 more 

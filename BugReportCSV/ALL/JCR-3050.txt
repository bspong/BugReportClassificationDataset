NullPointerException on removing a node acquired from search result
with a code snipped like the following i get a NullPointerException in ItemState Session s repo.login sc workspace QueryManager qm s.getWorkspace .getQueryManager Query q qm.createQuery SELECT FROM nt unstructured Query.JCR SQL2 QueryResult r q.execute NodeIterator i r.getNodes Node n i.nextNode n.remove breaks here with NullPointerException Exception in thread main java.lang.NullPointerException         at org.apache.jackrabbit.jcr2spi.state.ItemState.getParent ItemState.java 210         at org.apache.jackrabbit.jcr2spi.operation.Remove.create Remove.java 98         at org.apache.jackrabbit.jcr2spi.ItemImpl.remove ItemImpl.java 306 The NPE happens because you re trying to delete the root node. Try running the same query and printing the path of the nodes you get I ve fixed the NPE but your scenario is still not going to work as you cannot delete the root node. You ll get a ConstraintViolationException Cannot remove root node. Fixed in revision 1240198.oh ok. guess with the right exception i will understand what i do wrong - actually the root node is reported as something else than nt unstructured so it was not so obvious to me. thanks for the cleanuphi you are welcome by the way you re not supposed to close the issue just leave it as resolved and when it ships it will turn into closed . see more here http jackrabbit.apache.org issue-tracker.html backported to 2.4 in rev 1346866.

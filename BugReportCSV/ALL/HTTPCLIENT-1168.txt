HTTPClient doesn t send authentication header in threaded environment
Using HTTPClient with multiple threads and basic authentication seems to create a race condition. The request headers sometimes don t contain the authorization entry which results in a 401 although the username and password credentials are correctly set .Simple test to demonstrate the issue.Lennart The race condition is caused by HttpContext instance being shared for all threads of execution. While theoretically HttpContext can be shared by multiple execution threads authentication state clearly cannot. I ll see if I can fix this issue by synchronizing access to AuthState instances or by updating the documentation. OlegAuthState instances are inherently thread unsafe as they maintain conversation state that can span across multiple HTTP exchanges. I opted for just documenting the recommended way of using HttpContext in multithreaded applications one HttpContext instance per thread of execution . Oleg

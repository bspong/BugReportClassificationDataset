Range queries fail on large repositories
As discussed on the user mailing list queries on large repositories with date constraints like field constant treat the constraint as always true returning results that should not be returned.This bug was introduced with the new fn upper-case and fn lower-case functions. The boundary was not checked correctly anymore. The optimization was a bit too agressive Fixed in trunk and 1.2 branch 496435Great work seems to work now I m curious how the seemingly small problem could only have manifested itself in large repositories. There exist two implementations of a range query 1 the lucene range query and 2 a jackrabbit variant. The default lucene range query has a limitation regarding the number of terms in the range. Per default this limit is set to 1000 terms. In a large repository with many distinct date values a date range can contain thousands of terms. This is where the jackrabbit variant of the range query comes into play which doesn t have this limitation. We actually have a test case that covers this issue but it is disabled because it involves creating 2000 nodes. I think the overhead is not that big and that we should enable the test.

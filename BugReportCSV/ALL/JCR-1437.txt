add framework for performance tests
Add a test suite for running various kinds of performance tests.Proposed start containing the test suite and a single test relating to big collections.I think that some of the concurrency tests we have should be moved here because they re mostly about performance. I also think that this is a great idea and that finally we ll get a consistent and common way to compare different approaches to do things.I very much welcome that we create performance tests but they shouldn t be located in jackrabbit-jcr-tests.Angela hat the same concern. Jukka on the other hand was in favor. I don t see a problem as long as it s clear what is testing functionality .api and what is testing performance .performance OK I ll rephrase my previous comment I very much welcome that we create performance tests but they must not be located in jackrabbit-jcr-tests. -1 for including this in jackrabbit-jcr-tests See also http markmail.org message 64q4kfdifu7qoly5I really don t care except for making progress here and re-using jackrabbit-jcr-tests would have been less work. So how about a jackrabbit-perf-tests depending on the existing test for setup config etc yes i think i would prefer to create a new jackrabbit-performance-tests module. performance testing is a different story than testing JCR functionality isn t it So how about a jackrabbit-perf-tests depending on the existing test for setup config etc Please do so. From my point of view there shouldn t be any setup config stuff in the jackrabbit-performance-tests. Setting up tests is done in jackrabbit-core which means we just have to add a new test dependency to jackrabbit-core to include the performance tests and a probably a test class similar to org.apache.jackrabbit.core.integration.JCRAPITest.Proposed patch with code moved into new sub-project please review. The patch looks a bit strange some files are contained twice and svn executable properties are set.Yep I not’ced that maybe a TortoiseSVN hickup. Any comments WRT actual content Looks OK to me. Some minor comments 1 How about a name like jackrabbit-benchmark or jackrabbit-jcr-benchmark That would indicate a bit larger scope for the component. The package name would be org.apache.jackrabbit.benchmark. 2 It would be nice if we could move the while loop into an abstract base class or even to the test framework. 3 How about a more structured performance report instead of just logging the numbers I d like to automate the generation of some kind of a trend graph. We can take care of 2 and 3 also later on.Also instead of the TestAll class it might be more useful to have something like a PerformanceSuite class that can be instantiated and added to the test suites of downstream components like jackrabbit-core. 1 How about a name like jackrabbit-benchmark or jackrabbit-jcr-benchmark That would indicate a bit larger scope for the component. The package name would be org.apache.jackrabbit.benchmark. Yep. I ll make it jackrabbit-jcr-benchmark . 2 It would be nice if we could move the while loop into an abstract base class or even to the test framework. 3 How about a more structured performance report instead of just logging the numbers I d like to automate the generation of some kind of a trend graph. I would prefer to delay stuff like that until we have more test cases and we see patterns emerging. Also instead of the TestAll class it might be more useful to have something like a PerformanceSuite class that can be instantiated and added to the test suites of downstream components like jackrabbit-core. Yes I ll do that.New proposed patch changing the project name package name and adding a TestSuite class.Hi. I would use jackrabbit-benchmark for the package name since it s not JCR API related. RegardsThe patch looks OK though I would remove the TestAll class and add the tests directly to the BenchmarkSuite.Esteban as a matter of fact they are JCR related thus the name. Marcel I was following the pattern in jackrabbit-jcr-tests anything wrong with that 1 Feel free to commit it it s easier to tweak the details in svn. Esteban The idea is to keep these tests free of Jackrabbit-specific functionality so that we could run the benchmark on various different JCR implementations. Marcel Agreed. BTW why is the explicit concurrent concurrent dependency needed The TestAll pattern is legacy from the time when jackrabbit-jcr-tests was a part of src test in jackrabbit-core.I was under the impression that we would be testing performance scalability etc. not compliance. Am I wrong OK. The dependence to concurrent isn t needed copied pasted too much . I m removing TestAll. Commit coming soon. ÊChecked in with revision 633876. Leaving issue open for fine-tuning. i guess we can resolve this issue. add framework is completed isn t it Indeed.

ChainedFilter does not work well in the event of filters in ANDNOT
First ANDNOT operation takes place against a completely false bitset and will always return zero results. It would have in this way to be ... if logic AND if logic AND logic ANDNOT result BitSet chain i .bits reader .clone i else result new BitSet reader.maxDoc for i chain.length i doChain result reader logic chain i return result ... Thanks Antonio Could you attach a patch and click Grant license to ASF for inclusion in ASF works If you can a test case for this would be great too I correct myself. Task that would have in this way to be if logic AND result BitSet chain i .bits reader .clone i else if logic ANDNOT result BitSet chain i .bits reader .clone result.flip 0 reader.maxDoc i else result new BitSet reader.maxDoc for i chain.length i doChain result reader logic chain i return result In this way it is avoided that the first ANDNOT operation takes place against a completely false bitset and will always return zero results. This is a valid issue and the proposed fix is correct. An updated patch with two test cases demonstrating the bug. Committed Thanks Antonio 

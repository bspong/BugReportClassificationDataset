Compatibility issue if admin impersonates admin session
in revision 1076596 in made some improvements in ImpersonationImpl removing the shortcut for AdminPrincipal which from my point of view is problematic. however this introduced the following compatibility issue detected by tom while - according to my tests - a user is allowed to impersonate itself jcr isn t totally clear about this but states that Session.impersonate is used to ... impersonate another ... this was possible for the admin-user due to the shortcut mentioned above. in order not to break existing code relying on that special case i would suggest to change the code accordingly. do you mean ensure that a admin can impersonate to an admin session as a shortcut to spawn a new session so basically SimpleCredentials myCreds new SimpleCredentials session.getUserId new char 0 Session newSession session.impersonate myCreds should work.

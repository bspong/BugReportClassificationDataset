non-contiguous LogMergePolicy should be careful to not select merges already running
Now that LogMP can do non-contiguous merges the fact that it disregards which segments are already being merged is more problematic since it could result in it returning conflicting merges and thus failing to run multiple merges concurrently. Patch. LogMP now skips any segments that are currently being merged when requireContiguous is false . I think we should simply change the API for MergePolicy. Instead of SegmentInfos it should accept a Set SegmentInfo with SIs eligible for merging eg completely written not elected for another merge . IW.getMergingSegments is a damn cheat and Expert notice is not an excuse Why should each and every MP do the set substraction when IW can do it for them once and for all Ok I m wrong. We need both a list of all SIs and eligible SIs for calculations. But that should be handled through API change not a new public method on IW. Earwin that sounds great changing current API instead of new IW method I think Can you open a new issue Thanks. Bulk closing for 3.2

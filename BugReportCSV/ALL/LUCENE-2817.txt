SimpleText has a bulk enum buffer reuse bug
testBulkPostingsBufferReuse fails with SimpleText codec. junit-sequential junit Testsuite org.apache.lucene.index.TestCodecs junit Tests run 1 Failures 1 Errors 0 Time elapsed 0.492 sec junit junit Standard Error junit NOTE reproduce with ant test -Dtestcase TestCodecs -Dtestmethod testBulkPostingsBufferReuse -Dtests.seed 8878914233730236058 -5578535381307601353 junit NOTE test params are codec RandomCodecProvider field SimpleText locale mk timezone America Indiana Tell City junit NOTE all tests run in this JVM junit TestCodecs junit junit Testcase testBulkPostingsBufferReuse org.apache.lucene.index.TestCodecs FAILED junit expected org.apache.lucene.index.codecs.simpletext.SimpleTextFieldsReader SimpleTextBulkPostingsEnum 1a42792 but was org.apache.lucene.index.codecs.simpletext.SimpleTextFieldsReader SimpleTextBulkPostingsEnum 2200d5 junit junit.framework.AssertionFailedError expected org.apache.lucene.index.codecs.simpletext.SimpleTextFieldsReader SimpleTextBulkPostingsEnum 1a42792 but was org.apache.lucene.index.codecs.simpletext.SimpleTextFieldsReader SimpleTextBulkPostingsEnum 2200d5 junit at org.apache.lucene.util.LuceneTestCase LuceneTestCaseRunner.runChild LuceneTestCase.java 1043 junit at org.apache.lucene.util.LuceneTestCase LuceneTestCaseRunner.runChild LuceneTestCase.java 981 junit at org.apache.lucene.index.TestCodecs.testBulkPostingsBufferReuse TestCodecs.java 671 junit junit junit Test org.apache.lucene.index.TestCodecs FAILED Duh silliness. I just added this test to assert BulkPostingsEnum buffer reuse but SimpleText never re-uses. I ll add an Assume. Fixed. In fact SimpleText does try to reuse and in fact it was buggy I fixed it.

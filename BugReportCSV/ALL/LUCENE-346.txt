 PATCH disable coord for generated BooleanQueries
Here s a patch that disables Similiarty.coord in the scoring of most automatically generated boolean queries. The coord score factor is appropriate when clauses are independently specified by a user but is usually not appropriate when clauses are generated automatically e.g. by a fuzzy wildcard or range query. Matches on such automatically generated queries are currently penalized for not matching all terms. Created an attachment id 14232 patch to disable coord scoring in most generated boolean queries Note that this does not yet fix MultiFieldQueryParser. That should probably be modified to generate something like for the query t1 t2 over fields f1 and f2 a query like f1 t1 f2 t1 f1 t2 f2 t2 in this case the innner queries should have coord disabled while the outer query should not. I think the best approach for MultiFieldQueryParser is to re-implement it as a subclass of QueryParser which overrides query creation methods. But that s a separate patch... f1 t1 f2 t1 f1 t2 f2 t2 Ð that s what MFQP in SVN does already unless you use the deprecated calls. Or am I missing something Created an attachment id 14236 new version of patch You re right. I guess I was looking at the deprecated parse method. Sorry. I ve updated the patch to include MFQP. Should we commit something like this The BooleanScorer2 can be simplified heavily when there is no coordination needed. Basically all makeCountingSumScorer.. methods could be renamed to makeSumScorer.. and the private Coordinator class is unnecessary in that case. I ll start working on a non coordinating version perhaps as a superclass of BooleanScorer2. Meanwhile the flat coord method in Similarity will do fine. Regards Paul Elschot Seems this has been applied so I m closing this bug report.

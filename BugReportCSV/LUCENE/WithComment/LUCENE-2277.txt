QueryNodeImpl throws ConcurrentModificationException on add List 
on adding a List of children to a QueryNodeImplemention a ConcurrentModificationException is thrown. This is due to the fact that QueryNodeImpl instead of iteration over the supplied list iterates over its internal clauses List. Patch Index QueryNodeImpl.java Ñ QueryNodeImpl.java revision 911642 QueryNodeImpl.java working copy -74 7 74 7 .getLocalizedMessage QueryParserMessages.NODE ACTION NOT SUPPORTED for QueryNode child getChildren for QueryNode child children add child iterates over the supplied List of QueryNodes. attached is Frank s patch with a testcase that fails with ConcurrentModificationException as he describes and passes with the patch. will commit soon. Committed revision 919869. Thanks Frank Robert should the changes text rather say something about the argument that was completely ignored. This was simply a bug due to ignoring the argument but calling a similar named method. Could be a bit picky but I thought I should mention it. Simon Simon you could also say the bug was adding a List to itself... either way it was wrong. I liked the way Frank describes it because if someone else hit this bug then they will recognize the exception message in CHANGES. reopening for possible 2.9.4 3.0.3 backport. Committed 3.0.x revision 1028758 Committed 2.9.x revision 1028759

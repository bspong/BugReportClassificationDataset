improve BaseTokenStreamTestCase random string generation
Most analysis tests use mocktokenizer which splits on whitespace but its rare that we generate a string with many tokens . So I think we should try to generate more realistic test strings. one bug is that this generates overly short words since the maxWordLength we pass in is really a max... but we would want that to be the exact number of elements. I ll improve this. attached is a patch. also fixes off-by-one length bugs in all the testUtil string generation methods too Looks great I committed this. I have one more minor improvement to make the randomRealistic more realistic . Ill put up a patch. Long term for another day another issue I think we should actually refactor this stuff with LineDocs so that LineDocs can return synthetic linedocs too that way non-analysis tests can use this too. trivial patch forces us to pass minLength as well to randomRealistic so in that case we get whole words in the same unicode block good for stemmers also sometimes uses randomRegexpIshString so we get lots of punctuation good for tokenizers filters etc I think this is much better if you want to see what the test strings look like now have a look at ant test -Dtestcase TestMockAnalyzer -Dtestmethod testRandomStrings -Dtests.verbose true

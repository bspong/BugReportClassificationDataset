Document.fields only returns stored fields
Document.fields only returns stored fields not those which are indexed but not stored. This is confusing as there s a isStored Method which doesn t make much sense then. Actually fields returns all fields only just after Document.add new Field ... even the ones which are not stored. Sounds confusing I ll attach a small program that demonstrates this. This should either be fixed so that all fields are always returned or it should be documented. Created an attachment id 10948 small demo that show the bug irritating behavior I guess this must be a documentation bug since it has been raised a few times but I don t know how to make it any more clear. The only fields that are stored are stored fields. Before a document has been indexed it has not been stored so that all fields are present. When it is retrieved from an index it has been stored and only stored fields are present. That s the whole point of the stored attribute to enable control over which fields are stored and which are dropped after indexing. I ll attach a documentation patch and reopen the bug report. Created an attachment id 10994 doc mention the issues with store some markup for null I ve amended the javadoc. Some of your proposed changes were incorrect un-stored fields are always available before a document is indexed and never available from a document retrieved from an index. Rather than adding a comment to each Document method that accesses Field data saying that only stored fields are available in documents retrieved from hits I added a single emphatic comment to this effect at the top. I also added notes to all of the methods which return a document from an index saying that only stored fields are returned. I hope this is satisfactory.

CharArraySet.contains char text int off int len does not work
I try to use the CharArraySet for a filter I am writing. I heavily use char-arrays in my code to speed up things. I stumbled upon a bug in CharArraySet while doing that. The method public boolean contains char text int off int len seems not to work. When I do if set.contains buffer offset length ... my code fails. But when I do if set.contains new String buffer offset length ... everything works as expected. Both variants should behave the same. I attach a small piece of code to show the problem. A simple piece of code that shows the problem. Indeed it s really a bug Ð thank you for finding this reporting it Thomas We were ignoring the offset when computing the hash code internally. Lucene always passes 0 for this offset only used in StopFilter currently so it wasn t hitting any existing Lucene test cases. I turned your example into a test case in the attached patch. I will commit shortly. Thanks for the quick response. I can confirm that the patch fixes the problem. Super thanks Thomas I just committed this. I ll port this one to 2.3.1 as well. Backported to 2.3

DocumentsWriter.abort fails to clear docStoreOffset
I hit this in working on LUCENE-1044. If you disk full event during flush then DocumentsWriter will abort clear all buffered docs . Then if you then add another doc or two and then close your writer and this time succeed in flushing say because it s only a couple buffered docs so the resulting segment is smaller you can flush a corrupt segment that incorrectly has a non-zero docStoreOffset . I modified the TestConcurrentMergeScheduler test to show this bug. I ll attach a patch shortly. Attached patch. All tests pass. I created more unit tests in TestIndexWriter to test hitting a single IOException at different points and then NOT hitting anymore exceptions and verifying we can close open a reader successfully. The fix itself is trivial and low risk. I think this is serious enough to re-spin 2.3. I will commit shortly to trunk port to 2.3 branch. Committed to trunk 2.3. Michael can you roll a new 2.3 RC Thanks 

MultiFieldQueryParser ignores slop parameter
MultiFieldQueryParser.getFieldQuery String String int calls super.getFieldQuery String String thus obliterating any slop parameter present in the query. It should probably be changed to call super.getFieldQuery String String int except doing only that will result in a recursive loop which is a side-effect of what may be a deeper problem in MultiFieldQueryParser Ð getFieldQuery String String int is documented as delegating to getFieldQuery String String yet what it actually does is the exact opposite. This also causes problems for subclasses which need to override getFieldQuery String String to provide different behaviour. Attaching one possible fix. It s more verbose than I wish it could be but I couldn t think of a reliable way to make it delegate as it would require casting the result to BooleanQuery to get the clauses our and a subclass may return something else entirely. Trejkaz thanks for the patch. Attached a slightly compacted fix refactoring slop-applying to a separate method . Also added a test that fails without this fix. All tests pass if there are no comments I will commit this in a day or two. Committed thanks Trejkaz 

Benchmark alg line - AddDoc 4000 4 - causes an infinite loop
Background in http www.mail-archive.com java-dev lucene.apache.org msg10831.html The line AddDoc 4000 4 causes an infinite loop because the parallel sequence would mask the exhaustion from the outer sequential sequence. To fix this the DocMaker exhaustion check should be modified to rely on the doc maker instance only and to be reset when the inputs are being reset. Doron are you working on this one I think we want to release 2.3 pretty soon and this one is marked with 2.3 fix version. Attached a test demonstrating the bug and a fix for it. I will commit it in a few days unless there are any concerns. Previous fix did not cover the case of a ResetInput task after exhaustion. Updated patch is fixing this case as well. Two notes on current patch Two ResetSystem Tasks now subclass ResetInputsTask. Unlike initially intended fix is mainly in TaskSequence not relying on DocMakers so that it can easily be extended to work with other makers . fixed.

Back-compat break with non-ascii field names
If a field name contains non-ascii characters in a 2.3.x index then on upgrade to 2.4.x unexpected problems are hit. It s possible to hit a read past EOF IOException it s also possible to not hit an exception but get an incorrect field name. This was caused by LUCENE-510 because the FieldInfos .fnm file is not properly versioned. Spinoff from http www.nabble.com Read-past-EOF-td23276171.html Attached patch. I plan to commit in a day or two and back-port to 2.4.x branch. I updated the back compat test to show the failure and also separately added 2.4 cases to the back-compat test. Committed to trunk 2.4 branch. Hi Mike a little bit too late but there is a small flow-error in handling of the IOException in FieldInfos ctor catch IOException ioe if format FORMAT PRE ... The problem If the IOException occurs and the Format is not FORMAT PRE the Exception should be re-thrown. And here a suggestion byNumber new ArrayList byName new HashMap I would simply clear the two collections... Great catches Uwe I ll fold them in Ð thanks 

Spatial checks for a string in an int double map
private Map Integer Double distances if precise null double xLat getPrecision lat precise double xLng getPrecision lng precise String k new Double xLat .toString new Double xLng .toString Double d distances.get k if d null return d.doubleValue Something is off here eh This is from DistanceHandler by the way. well I give up on this one - apparently distances holds docIds to distance - not sure why the heck there is an attempt here to use it in this manner. Not confident in changing it to anything either - the distance test class asserts nothing and just does System outs. And I don t know how the heck distances acts as a cache - no code inserts anything into it. It looks like it can just be used as a user override for pre chosen docs They fill it and pass it Some of this spatial code is kind of hairy - and the tests javadoc are very sparse. Many methods constructors are not called anywhere tests or not . Some are just called from random main methods. And whats this class Spatial does not live up to the standard of quality that Lucene generally delivers - contrib or not. public class PolyShape private static double lat 38.969398 private static double lng -77.386398 private static int miles 1000 param args public static void main String args CartesianPolyFilterBuilder cpf new CartesianPolyFilterBuilder localTier cpf.getBoxShape lat lng miles Okay - a little insight finally - it looks like the lookup should actually be on what is called elsewhere distanceLookupCache - a weakhashmap mapping string to double. Thats on the DistanceFilter though and I don t see how its usable here yet ... I guess I ll fix this one

WriteLineDocTask incorrectly normalizes fields
WriteLineDocTask normalizes the body title and date fields by replacing any t with a space. However if any one of them contains newlines LineDocMaker will fail since the first line read will include some of the text however the second line which it now expects to be a new document will include other parts of the text. I don t know how we didn t hit it so far. Maybe the wikipedia text doesn t have such lines however when I ran over the TREC collection I hit a lot of those. I will attach a patch shortly. Patch includes Fix WriteLineDocTask to replace t r n with a space for body title and date. Add test to WriteLineDocTaskTest CHANGES All benchmark tests pass. Looks good Shai can we pre-compile the regex up front java.util.regex.Matcher so we don t have to compile it three times on every written line Using a Matcher as a static final member pre-compiled. Completed CHANGES Added a note to WriteLineDocTask about this task not being thread-safe. It never was since it writes to the output file in a non-synchronized way. Now with the addition of a static Matcher member it s even less thread-safe. All benchmark tests pass. Looks good I ll commit shortly. Thanks Shai 

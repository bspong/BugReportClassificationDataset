Upgrade to commons-compress 1.2
Commons Compress bug COMPRESS-127 was fixed in 1.2 so the workaround in benchmark s StreamUtils is no longer required. Compress is also used in solr. Replace with new jar in both benchmark and solr and get rid of that workaround. Attached simple patch with the fix. After applying the patch need to also download commons-compress-1.2.jar and place it in under module benchmark lib and under solr contrib extraction lib. Currently several solr tests fails for me with this patch probably not related to replacing the compress jar as when running alone -Dtestcase they pass. Which tests are they hmmm this is strange. These are the tests that failed with compress-1.2 for ant clean test under solr org.apache.solr.handler.TestReplicationHandler junit Tests run 1 Failures 1 Errors 0 Time elapsed 39.968 sec org.apache.solr.handler.component.DebugComponentTest junit Tests run 2 Failures 1 Errors 0 Time elapsed 1.219 sec org.apache.solr.handler.component.TermVectorComponentTest junit Tests run 4 Failures 1 Errors 0 Time elapsed 1 sec org.apache.solr.request.JSONWriterTest junit Tests run 2 Failures 1 Errors 0 Time elapsed 0.75 sec org.apache.solr.response.TestCSVResponseWriter junit Tests run 1 Failures 0 Errors 0 Time elapsed 0.719 sec org.apache.solr.schema.BadIndexSchemaTest junit Tests run 5 Failures 1 Errors 0 Time elapsed 1.187 sec org.apache.solr.search.TestQueryUtils junit Tests run 1 Failures 1 Errors 0 Time elapsed 1.14 sec org.apache.solr.search.similarities.TestBM25SimilarityFactory junit Tests run 2 Failures 1 Errors 0 Time elapsed 0.187 sec org.apache.solr.servlet.DirectSolrConnectionTest junit Tests run 2 Failures 1 Errors 0 Time elapsed 0.344 sec org.apache.solr.update.processor.SignatureUpdateProcessorFactoryTest junit Tests run 4 Failures 1 Errors 0 Time elapsed 3.984 sec I replaced 1.1 and they all passed. However replaced to compress-1.2 and now they all passed. I now see that I am on r1174072 I ll update and try again Maybe do a clean compile on the lucene sources too Thanks Chris almost sure I did a clean will try again. Still it fails - this time running clean test from trunk all lucene tests pass some of solr tests failed org.apache.solr.handler.TestReplicationHandler junit Tests run 1 Failures 1 Errors 0 Time elapsed 43.703 sec org.apache.solr.handler.component.DebugComponentTest junit Tests run 2 Failures 1 Errors 0 Time elapsed 1 sec org.apache.solr.handler.component.TermVectorComponentTest junit Tests run 4 Failures 1 Errors 0 Time elapsed 1.375 sec org.apache.solr.request.JSONWriterTest junit Tests run 2 Failures 1 Errors 0 Time elapsed 1.078 sec org.apache.solr.schema.BadIndexSchemaTest junit Tests run 5 Failures 1 Errors 0 Time elapsed 1.266 sec org.apache.solr.schema.RequiredFieldsTest junit Tests run 3 Failures 1 Errors 0 Time elapsed 1.422 sec org.apache.solr.search.QueryParsingTest junit Tests run 2 Failures 1 Errors 0 Time elapsed 0.641 sec org.apache.solr.search.SpatialFilterTest junit Tests run 3 Failures 1 Errors 0 Time elapsed 1.438 sec org.apache.solr.search.TestQueryTypes junit Tests run 1 Failures 1 Errors 0 Time elapsed 0.953 sec org.apache.solr.servlet.CacheHeaderTest junit Tests run 5 Failures 1 Errors 0 Time elapsed 0.984 sec org.apache.solr.spelling.SpellCheckCollatorTest junit Tests run 4 Failures 1 Errors 0 Time elapsed 1.281 sec org.apache.solr.update.DocumentBuilderTest junit Tests run 4 Failures 1 Errors 0 Time elapsed 0.734 sec org.apache.solr.util.SolrPluginUtilsTest junit Tests run 7 Failures 1 Errors 0 Time elapsed 0.766 sec Running alone TestReplicationHandler for example passes. Same for DebugComponentTest. I am not sure what is happenning here. Attaching the test output in case someone wants take a look. I know whats happening a test failed happens often with solr tests but some assertions in the base solr test classes then cause every test following to fail. this happened to me too i ll commit a fix. ok great thanks Robert so this has nothing to do with the comprees jar update. I ll commit shortly. Fixed 1175475 - trunk 1175528 - 3x Bulk close after release of 3.5

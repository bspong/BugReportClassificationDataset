Terms dict should block-encode terms
With PrefixCodedTermsReader Writer we now encode each term standalone ie its bytes metadata details for postings frq prox file pointers etc. But this is costly when something wants to visit many terms but pull metadata for only few eg respelling certain MTQs . This is particularly costly for sep codec because it has more metadata to store per term. So instead I think we should block-encode all terms between indexed term so that the metadata is stored column stride instead. This makes it faster to enum just terms. Patch. I think it s basically working but there are still a bunch of nocommits. New patch Ð cleaned up all the nocommits and cutover to common prefix for all terms in the block. New patch specializes read in ByteArrayDataInput poached from LUCENE-2824 . 1 to commit the last specialization made all the difference on my benchmarks. I think this will pave the way for us to fix Sep codec in the branch... WOW nice mike do you have benchmark numbers here by any chance After all those improvements - FST TermState BlockCoded TermDict etc. I wonder if we reached the 10k in the 3.0 vs. 4.0 united 2.0 benchmark... I did run the benchmark Ð but lost the output I compared standard on trunk vs standard w block terms dict. There were solid gains especially for the MTQs that visit many terms but few docs like the respelling case .

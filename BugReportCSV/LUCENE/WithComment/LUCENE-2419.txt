Improve parallel tests
As mentioned on the dev mailing list here http www.lucidimagination.com search document 93432a677917b9bd lucenejunitresultformatter sometimes fails to lock It would be useful to not create a lockfactory for each test suite As they are run sequentially in the same separate JVM . Additionally we create a lot of JVMs 26 for each batch because we have to run one for each letter. Instead we use a technique here to divide up the tests with a custom selector http blog.code-cop.org 2009 09 parallel-junit.html I emailed the blog author and received permission to use this code This gives a nice boost to the speed of overall tests especially Solr tests as many start with an S but this is no longer a problem. attached is a patch all tests pass. Additionally i fixed the problem that backwards tests did not respect the threadsPerProcessor variable. I plan to commit soon. While there might be some issue with the NativeFSLockFactory I cannot reproduce it and hopefully this will create less test locks in the meantime... besides it speeds up tests. feel free to reopen if you have problems. Committed revision 939111. backported to 3.x rev 941677 Bulk close for 3.1

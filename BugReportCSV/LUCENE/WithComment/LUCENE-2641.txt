BaseTestRangeFilter can be extremely slow
The tests that extend BaseTestRangeFilter can sometimes be very slow TestFieldCacheRangeFilter TestMultiTermConstantScore TestTermRangeFilter for example TestFieldCacheRangeFilter just ran for 10 minutes on my computer before I killed it but i noticed these tests frequently run for over a minute. I think at the least we should change these to junit4 so the index is built once in beforeClass here s an initial patch. i tried to fix some worst-case problems with similar tests as well but some still have problems... here s an updated patch that speeds up the worst of the tests. additionally we found 2 bugs in preflex codec that caused tests to be very slow under preflex. sorry wrong patch. I accidentally uploaded the old one again last time Committed revision 996357 996360 3x . we can always look out for more tests like this and handle them on a case by case basis In general if it creates a huge index we should ensure reasonable maxBufferedDocs etc and if it has a ton of methods that don t modify the index we should consider creating the index in BeforeClass But i think the crazy defaults in newIndexWriterConfig are reasonable given most tests only use a tiny amount of documents. Bulk close for 3.1

creating empty field empty term leads to invalid index
Spinoff from LUCENE-3526. if you create new Field you get IllegalArgumentException from Field s ctor name and value cannot both be empty But there are tons of other ways to index an empty term for the empty field for example initially make it garbage then .setValue or via tokenstream . If you do this and you have assertions enabled you will trip an assert the assert is fixed in trunk in LUCENE-3526 But If you don t have assertions enabled you will create a corrupt index test terms freq prox...ERROR term docFreq 1 num docs seen 0 num docs deleted 0 attached is a test committed to trunk . I also fixed the assert and removed the bogus check in Field s ctor. But the checkIndex fails as it does before if you index this term with assertions disabled . So next step is to figure out a fix... attached is a patch... its basically just a backport of LUCENE-3526 to fix the problem. Thanks Mike your fix from 3183 was correct all along... we should have just gone with it originally... Bulk close after release of 3.5

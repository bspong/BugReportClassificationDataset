FieldCache keeps hard references to readers doesn t prevent multiple threads from creating same instance
typo in original used reader instead of key Cool This should solve at least part of my problem. Trying this now along with finalizer removal patch that is already installed here . Will report back results. Thanks This patch together with LUCENE-750 already committed solved our problem completely. It sped up simultaneous multi-threaded searches with a new ParallelReader against a 1 million item investigation that has a unique id sort field i.e. 1 million entry FIeldCache must be created by a factor of 15x. Thanks Yonik 1 to commit this. patch committed. Chuck and whoever else got burned by this - really big apology for letting that typo slip into my patch Unfortunately because I was constrained to use a release version of Lucene I ended up implementing a different solution in our production system and obviously I didn t pick up the mistake I d made in the patch. Since I was the one who first whined about this leak I m just following up to report that this change indeed eliminated the leak.

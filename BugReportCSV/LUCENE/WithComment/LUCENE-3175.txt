speed up core tests
Our core tests have gotten slower and slower if you don t have a really fast computer its probably frustrating. I think we should 1. still have random parameters but make the obscene settings like SimpleText rarer... we can always make them happen more on NIGHTLY 2. tests that make a lot of documents can conditionalize on NIGHTLY so that they are still doing a reasonable test on ordinary runs e.g. numdocs NIGHTLY 10000 1000 multiplier 3. refactor some of the slow huge classes with lots of tests like TestIW TestIR at least pull out really slow methods like TestIR.testDiskFull into its own class. this gives better parallelization. Patch looks good here s some timings on my macbook... still some bad apples i didn t notice on my faster computer at all but its better using ant test-core -Dtests.seed 0 0 trunk BUILD SUCCESSFUL Total time 12 minutes 40 seconds patch BUILD SUCCESSFUL Total time 7 minutes 37 seconds updated patch I did some more reorganization removed some places where we checkindex ed twice in a row sped up some of the really slow tests with beforeClass etc. on my mac this one is now under 6 minutes... I want to keep the issue open as there are still some really really slow tests to fix. Committed revision 1132517. i shaved another minute off on my mac with this patch. Attached the output of ant test-core on my 2.53 GHZ Core 2 Duo MacBook Pro the core tests are still like 6 to 8 min which is very long though. Not that I am complaining about Roberts hard work thanks for that it made it way better than it used to be. but I think there are still some test we can improve thanks for running this Simon i think its important we consider normal hardware to a lot of developers your computer is actually a fast computer I ll review this log and see if we can improve the situation more for some of the very long ones. here is a patch that speeds up some test that use large num of iterations threads. Especially the num of threads helps a lot on a system with not that many CPUs 1 1 thanks Simon. 1 thanks Simon. committed to trunk I am down to 4 min 36 seconds for ant test-core without compiling - here is my output. great speedup already Down from what time pre-patch pre-patch and roberts latest commits was 6 min 34 I think this is ok... core tests are about 1 3 what they were Bulk close after release of 3.5

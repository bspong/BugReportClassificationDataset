use AtomicInteger Boolean to track IR.refCount and IW.closed
Less costly than synchronized methods we have now... Did I miss you exploiting atomicity of IW flags For what I see you could declare them volatile with same result and less characters typed. You re right AtomicBoolean is overkill... Hmm I think even volatile is overkill Ð ensureOpen is only on a best effort basis it makes no guarantee that it will be immediate . So I ll revert the changes to IndexWriter and remove the synchronized from ensureOpen. New patch. ensureOpen is only on a best effort basis it makes no guarantee that it will be immediate Ehm. If you re okay with the possible case of ensureOpen -guarded code to fail in grotesque ways because IW was in fact closed but your best effort failed - why not drop ensureOpen completely It no longer ensures anything what is its purporse ensureOpen is to help catch coding mistakes not to act in a completely deterministic way. It should be as light weight as possible so correct programs aren t penalized.

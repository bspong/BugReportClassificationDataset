Redesign SPI observation
With the current SPI observation design it may happen that events are lost while the filter for an event listener is changed. See - http www.nabble.com SPI-observation 3A-EventFilter-lifecycle-tf4732281.html - http people.apache.org mreutegg spi-event problem.png My proposal is to introduce a Subscription interface. See attached patch and http people.apache.org mreutegg spi-event proposal.pngMoved methods related to subscriptions to the RepositoryService. This is in line with the already existing functionality which is all located on the service interface. Subscription becomes a marker interface and allows an implementation to hold proprietary information about the current state of the subscription e.g. an svn implementation may hold the revision number of the last change reported as events . Unless someone objects I will adapt all modules in jackrabbit accordingly and commit the changes later today.Committed the patch and adapted jcr2spi and spi2jcr modules. svn revision 592356Modules in sandbox that depend on the SPI are now also updated.

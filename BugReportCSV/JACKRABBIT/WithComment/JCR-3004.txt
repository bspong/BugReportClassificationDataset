Check if a DAV-Request has a Label in the header before checking if it s version-controlled
When looking at our MySQL logs I realized that jackrabbit on each DAV Request calls the VERSION table every time I get a new node which is not cached yet even if I only do a simple getNode. As a versioning table can get pretty large this may have a performance impact. I found out that DavResourceFactoryImpl checks if a node is versioned to decide if we have to check for the Label header to later check out another version for the GET request. I re-ordered those checks now so that it first checks if there s an http Label-header and only then checks if the node is versioned. The check for a Label header should be much faster than checking a DB if it s versioned and scale much better too The patch against trunk tests still runthanks for the patchGuten Tag Ich bin bis am 23. Juli 2011 abwesend und werde meine Emails nicht lesen. Bitte senden Sie in dringenden Fällen eine E-Mail an contact liip.ch. Besten Dank für Ihr Verständnis. Christian Stocker Hi I m off until 23 July and do not read my emails. In urgent cases please send an email to contact liip.ch Best Wishes Christian Stocker Liip AG Feldstrasse 133 CH-8004 Zurich Tel 41 43 500 39 81 Mobile 41 76 561 88 60 www.liip.ch blog.liip.ch GnuPG 0x0748D5FE I would recommend to drop support for the Label header. See http www.webdav.org deltav protocol rfc3253-issues-list.htm gt 8.3 LABEL HEADER ... The Label header has poorly defined semantics when used with Depth header and is inconsistent with HTTP variant processing. ... Replace the Label header with a DAV labeled-version report. and draft in http www.webdav.org deltav protocol draft-ietf-webdav-versioning-xx.7.htm 

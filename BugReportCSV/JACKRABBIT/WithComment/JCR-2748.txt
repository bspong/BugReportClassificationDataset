provide a relatively simple way to disable anonymous access to the security workspace
As discussed in this thread http sling.markmail.org thread st52jejjuxykfxtj the security workspace is by default configured with an AccessControlProvider which provides a fixed access control policy i.e. o.a.j.core.security.user.UserAccessControlProvider . In order to prevent anonymous access to security-related nodes requires the use of an alternate AccessControlProvider. The attached patch provides a simpler mechanism. By adding param name anonymousAccessToSecurityWorkspace value false to the configuration of the DefaultSecurityManager anonymous access to the security workspace is forbidden. patchi would rather add a configuration option to this specific access control provider similar to the other providers . the patch adding the config option to the security manager seems wrong to me. the current default ac-provider setup in case of missing configuration just reflects the state of jackrabbit 1.6 where users were stored in a separate dedicated workspace and i didn t change it for backwards compatibility reasons. in the mean time i changed the user management in a way that users having access to a given workspace can be stored in that workspace which makes things a lot easier see JCR-2313 . i would rather add a configuration option to this specific access control provider similar to the other providers . the patch adding the config option to the security manager seems wrong to me. IIUC this requires manual configuration of the security workspace. Isn t that a bit onerous - 15-20 lines of XML vs. one In other words I think this should be configured in the Security section of repository.xml not Workspace as it is a property of the security subsystem. IIUC this requires manual configuration of the security workspace. Isn t that a bit onerous - 15-20 lines of XML vs. one if the default setup get s changed in jackrabbit you will need to have a manual ac provider configuration of your security workspace anyway. as i said before i just didn t do that for 2.0 because we changed the way we at day want to store users in a rather late stage and i didn t want to cause troubles for all those using the old style jr 1.6 setup. furthermore i don t want to spoil the repository level security configuration for something that i consider end of life code. having an configuration option for the UserAccessControlProvider should be configured where it belongs to. and adding a repository level option for the inital ac-setup seems wrong to me... this would be yet another workaround for something that will be addressed by JCR-2331. In other words I think this should ... fair enough... but it doesn t make me change my opinion updated patch which restricts the change to only be within UserAccessControlProvider.applied patch2 with minor modification the default value of the anonymousAccess if not present with the configuration should be true some existing tests therefore failed with the unmodified patch2 thanks Angela

ConcurrentModificationException in QueryStatImpl
Running with qurystats enabled the Query execute can throw ConcurrentModificationException caused by the iterator which backing collection is changed from another thread see logQuery method         Iterator QueryStatDtoImpl iterator popularQueries.iterator         while iterator.hasNext QueryStatDtoImpl qsdi iterator.next             if qsdi.equals qs                 qs.setOccurrenceCount qsdi.getOccurrenceCount 1                 iterator.remove                 break                               popularQueries.offer qs I wasn t able to see the ConcurrentModificationException but I saw another one on getPopularQueries ArrayIndexOutOfBoundsException. I added some synchronization code to the 2 methods. Fixed in rev 1240053. Merged to the 2.4 branch in revision 1240068.

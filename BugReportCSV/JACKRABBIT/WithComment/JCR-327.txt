Mixins as supertypes do not appear to be queryable
When creating custom nodetypes that contain mixins as the supertype nodes of the custom type do not appear to be queryable when using statements of the form element mixin . Attached are a relatively simple JUnit test and compact type definition that seem to illustrate the problem.There is indeed a bug in the query builder that creates the lucene query tree from the JCR query statement. Fixed in svn revision 380766. Thank you for reporting this issue. Could you please check if this fix works for you and give a quick feedback I did only check it with existing predefined node types but it should also works for any custom defined node types.Hi Marcel The fix does indeed work for custom types where the mixin is explicitly in the hierarchy. However I ve run into an issue now where type queries do not seem to locate mixins with other mixins as supertypes when querying for the supertype mixin. More concretely using the type definitions attached if I add nt TestMixin to a node then the node responds true to isNodeType for nt TestMixin and mix versionable. Querying directly for nt TestMixin using the element function also works. However querying for mix versionable does not seem to work.You are right. I ll look into it asap.Ok second attempt The query builder now also searches for mixins that are derived from the node type in element test. I ve also added a test cases that searches referenceable nodes o.a.j.core.MixinTest . The test adds nodes that are made referenceable in three ways - implicitly referenceable node type definition has mix referenceable as supertype - explicitly referenceable mix referenceable is set on node instance - explicitly referenceable using mixin derived from mix referenceable svn revision 381292

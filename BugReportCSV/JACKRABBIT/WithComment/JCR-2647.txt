Reduce temporary memory usage of hierarchy cache initialization
Initializing the hierarchy cache temporarily uses memory which is linear to the size of the index segment. This process should be split into multiple phases to limit the memory usage to a fixed amount. The temporary memory usage for an index segment current is about 170 bytes per node.Attached patch limits the memory used while initializing the hierarchy cache to 64MB. Initializing the hierarchy cache of an index segment with two million nodes is now three times slower but uses five times less memory.Applied patch in revision 958577

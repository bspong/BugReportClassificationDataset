QueryResult s RowIterator.getSize returned the wrong size of the results after I implemented my own AccessManager
The background is I have implemented my own AccessManager. After executing a query and get back the RowIterator from the result if I call rowiterator.getSize it will return the size of all nodes matching my query without honoring the access control . But if I iterate through the result I find lots of duplicates in the results and if I filter out those duplicate the final result is quite off the original number from RowIteartor.getSize BTW I also disabled Doc Order sorting. ÊCan you please provide a test case that shows this behaviour Thank you.Big news I have the same weird issue. I am trying to make a minimal test case. The duplicate nodes are nodes which the quering session have no permissions and the returned node is a duplicate of the last returned node where the session can read. It is a bit confusing to explain and my english is poor. If the query is done by a super user session the returned nodes are the good nodes. If the query is performed by a limited user session the number of returned nodes are the same amazing but the forbidden nodes are not returned of course and these nodes are filled with the other readed nodes.Forbidden nodes are not tracked correctly in the result set. Fixed in trunk 509944 Xiaohua and Paco thank you for reporting this bug and the description how to reproduce the issue. Jukka if possible this fix should also go into the next patch release.Tagged for the 1.2.3 release.

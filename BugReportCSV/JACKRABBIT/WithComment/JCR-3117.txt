Stats for the PersistenceManager
Statistics for the PersistenceManager impl that cover Ê- bundle cache access count Ê- bundle cache miss count Ê- bundle cache miss avg duration this avg includes the penalty of having to load from the underlying storage can be interpreted as avg read latency as there is no cache involved Ê- bundle writes per second What it doesn t cover is Ê- number of bundles Ê- size of workspace as these are values that are expensive to compute on demand and caching them would imply being able to store the values which is not possible currently .attached proposed patchpatch looks good thanks Fixed in revision 1186195.Wouldn t it be easier to just use the AtomicLong counters from the TimeSeries mechanism That way we wouldn t have to add new interfaces and implementations for each piece of statistics we want to collect Hi Jukka can you be a bit more specific I m not sure what you want to replace with the TimeSeries Statistics for the PersistenceManager impl that cover - bundle cache access count - bundle cache miss count - bundle cache miss avg duration this avg includes the penalty of having to load from the underlying storage can be interpreted as avg read latency as there is no cache involved - bundle writes per second Out of all the stats provided here I d say the bundle writes per second fall into the TimeSeries scope. And there I don t mind replacing the mechanism. As for the rest Ê- the 2 counts are just incremental operations on AtomicLong I don t really see the added value in using TS Ê- the cache miss avg duration AFAIK the TS impl does not do averages currently if it will I m open for using it. The proposed patch switches the PM stats to use the TimeSeries mechanism. This replaces 222 lines of code with just 63 while increasing the amount of collected information. the 2 counts are just incremental operations on AtomicLong I don t really see the added value in using TS There s two main benefits 1 we get a full time series of the collected values and 2 we don t need the extra interface or custom code for accessing this piece of information. the cache miss avg duration AFAIK the TS impl does not do averages currently if it will I m open for using it. The average duration is easily calculated by dividing total duration by count per second. It s not currently supported by the TS implementation but will be easy enough to add. This replaces 222 lines of code with just 63 the purpose of saving all these lines is lost on me. 1 on the patchreopening to reconsider new patchesI added also average time series in revision 1188678.

Trouble undeploying jackrabbit-webapp from Tomcat
When testing jackrabbit-webapp for the 1.4 release I again came across this issue that I ve occasionally seen also before but never qualified enough for a bug report. The Jackrabbit webapp would deploy without problems but when I undeploy the webapp Tomcat fails to remove the Derby jar in WEB-INF lib I have unpackWARs enabled . This causes problems especially when I have autoDeploy enabled as Tomcat then deploys the skeleton webapp right after undeployment and the only way to really get rid of the webapp is to shutdown Tomcat and to manually remove the webapp on the file system. I suspect that this problem is related to Derby jar being somehow referenced even after the webapp is undeployed causing Windows to prevent the jar file from being removed. Unless someone has some bright idea on how to resolve this I ll consider this a known issue in Jackrabbit 1.4.This forum entry notes that apparently upgrading from Tomcat 6.0.16 to 6.0.18 solves the problem. I m hitting the same issue with Tomcat 6.0.16. Can anyone else verify and contradict this Will report back once I upgrade.FYI. I upgraded to Tomcat 6.0.18. Didn t help.OK thanks for the info. I still don t know how to solve this issue. We should probably ask the Derby people as I think they ve encountered this issue already before.In revision 1055116 I added a DerbyShutdown listener that attempts to automatically release all remaining Derby resources when the Jackrabbit webapp gets stopped or undeployed. That clears many of the warnings logged by Tomcat and gives us a clean undeploy at least on Tomcat 7.Merged to the 2.2 branch in revision 1055129.

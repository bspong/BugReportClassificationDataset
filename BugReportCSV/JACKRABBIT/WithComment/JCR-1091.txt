more lenient behavior of Node addMixin if mixin is already present
Change implementation of addMixin so that it doesn t fail when the mixin is already present. See also jackrabbit core change http svn.apache.org viewvc view rev revision 570149 JSR-283 issue https jsr-283.dev.java.net issues show bug.cgi id 353 this affects both the TCK and JCR2SPI so I didn t specify a component Proposal for next steps JCR2SPI mirror the change in jackrabbit-core. TCK unless JSR170 is changed do not rely on the lenient behaviour instead add a convenience method that checks whether adding a mixin type is needed and use that throughout. As in public boolean needsMixin Node n String mixin   return n.getSession .getWorkspace .getNodeTypeManager .getNodeType n.getNodeType .isNodeType mixin Enhanced TCK as proposed in revision 570180. See the attached patch JCR-1091.patch for my take on the required changes in jcr2spi.Hmm the patch causes some test failures. I ll work it out.what is the status of this issue can we close it is there something left to be done I never got around to resolving the test failures. I m not sure if they still occur with this patch.Implemented the jcr2spi change in revision 705961. My previous patch modified the canAddMixin method that was used by addMixin to validate the request to add the mixin. However since the TCK uses the same canAddMixin method to find new mixins i.e. ones that are not already included in a node to add to a node the tests would always fail. The committed resolution adds the succeed if the mixin is already set test directly in the addMixin method.

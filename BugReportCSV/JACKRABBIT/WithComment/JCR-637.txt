Multiple namespace definitions in CND prevent definition of node type without child nodes
The BNF in http jackrabbit.apache.org api-1 org apache jackrabbit core nodetype compact CompactNodeTypeDefReader.html defines ... cnd ns mapping node type def ... so multiple namespace definitions should not affect the node type definitions. However the following CND definition will fail namespace http www.mynamespace.co.uk namespace 39 nt http www.jcp.org jcr nt 1.0 39 namespace document nt file    - namespace name string mandatory namespace http www.mynamespace.co.uk namespace 39 nt http www.jcp.org jcr nt 1.0 39 namespace document2 nt file    - namespace name string mandatory Remove the second set of namespace definitions and all s well namespace http www.mynamespace.co.uk namespace 39 nt http www.jcp.org jcr nt 1.0 39 namespace document nt file    - namespace name string mandatory namespace document2 nt file    - namespace name string mandatorythe problem only occurs if a namespace declaration follows a property definition without value constraint s e.g. ...   - foo prop string mandatory bar http www.acme.org bar 39 ... the token in this example is ambiguos since it denotes both a list value constraints and a namespace declaration. the problem therefore are not intermixed namespace declarations and node type defintions per se. the problem is the ambiguity of the token. probably the easiest fix would be to change the BNF and the parser so that namespace declarations can only occur at the top of a .cnd file. probably the easiest fix would be to change the BNF and the parser so that namespace declarations can only occur at the top of a .cnd file. 1attached patch for suggested changeapplied patch svn r475669 - adapted EBNF and parser all ns declarations must precede first node type definiton

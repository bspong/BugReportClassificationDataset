jcr mapping layer does not expose node move and node copy via PersistenceManager.java
The PersistenceManagerImpl.java in jcr-apping layer does not implement move and copy methods for a node.Recommended fix for this issue Kindly review . Add following methods in PersistenceManager.java  public void move String srcPath String destPath throws PersistenceException       public void copy String srcPath String destPath throws PersistenceException Add following methods in PersistenceManagerImpl.java import javax.jcr.Workspace   added by ruchi     public void move String srcPath String destPath         Workspace workspace session.getWorkspace         try             workspace.move srcPath destPath          catch javax.jcr.nodetype.ConstraintViolationException cve             throw new PersistenceException                      Cannot move the node from srcPath to destPath . Violation of a nodetype or attempt to move under a property detected cve                       catch javax.jcr.version.VersionException ve             throw new VersionException                      Cannot move the node from srcPath to destPath . Parent node of source or destination is versionable and checked in ve                       catch javax.jcr.AccessDeniedException ade             throw new PersistenceException                      Cannot move the node from srcPath to destPath . Session does not have access permissions ade                       catch javax.jcr.PathNotFoundException pnf             throw new PersistenceException                      Cannot move the node from srcPath to destPath . Node at source or destination does not exist pnf                       catch javax.jcr.ItemExistsException ie             throw new PersistenceException                      Cannot move the node from srcPath to destPath . It might already exist at destination path. ie                       catch javax.jcr.lock.LockException le             throw new PersistenceException                      Cannot move the node from srcPath to destPath . Violation of a lock detected le                       catch javax.jcr.RepositoryException re             throw new org.apache.portals.graffito.jcr.exception.RepositoryException                      Cannot move the node from srcPath to destPath . re                    added by ruchi      public void copy String srcPath String destPath         Workspace workspace session.getWorkspace         try             workspace.copy srcPath destPath          catch javax.jcr.nodetype.ConstraintViolationException cve             throw new PersistenceException                      Cannot copy the node from srcPath to destPath . Violation of a nodetype or attempt to copy under property detected cve                       catch javax.jcr.version.VersionException ve             throw new VersionException                      Cannot copy the node from srcPath to destPath . Parent node of source or destination is versionable and checked in ve                       catch javax.jcr.AccessDeniedException ade             throw new PersistenceException                      Cannot copy the node from srcPath to destPath . Session does not have access permissions ade                       catch javax.jcr.PathNotFoundException pnf             throw new PersistenceException                      Cannot copy the node from srcPath to destPath . Node at source or destination does not exist pnf                       catch javax.jcr.ItemExistsException ie             throw new PersistenceException                      Cannot copy the node from srcPath to destPath . It might already exist at destination path. ie                       catch javax.jcr.lock.LockException le             throw new PersistenceException                      Cannot copy the node from srcPath to destPath . Violation of a lock detected le                       catch javax.jcr.RepositoryException re             throw new org.apache.portals.graffito.jcr.exception.RepositoryException                      Cannot copy the node from srcPath to destPath . re               Could you provide some unit tests Thanks Patch apply. Thanks It should be nice if you can provide unit test for new features. Let me know if you have time for doing it. Patch Apply . Does that mean I checkin the code . Do I have permissions to do so I will try to come up with unit test although I have tested it in my use case.Ok. I see it checked in in the latest trunk code . For the unit test can u wait for a while I am stuck with deliverables. Or if you get a chance please go ahead with it.the unit tests are working now.

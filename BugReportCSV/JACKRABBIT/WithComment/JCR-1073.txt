Add getTotalSize to QueryResults
As discussed in http www.nabble.com Total-size-of-a-query-result-and-setLimit 28 29-tf4280909.html a12185543 a getTotalSize method should be added to QueryResults.A first shot how this might look like. I stumbled over QueryResultImpl which is apparently no longer used. Instead LazyQueryResultImpl is used. Can we discard QueryResultImpl and rename LazyQueryResultImpl to QueryResultImpl We could then just implemented getTotalSize on QueryResultImpl without the need for a further interface or abstract base class for both QueryResult implementations. 1 for the patch. I m still using the class QueryResultImpl in a different project. But I m ok with renaming LazyQueryResultImpl to QueryResultImpl. We just have to rename QueryResultImpl as well e.g. to SimpleQueryResultImpl.WDYT about removing QueryResultImpl from jackrabbit and you just add it to your particular project Is that an option Seems to be a quite customized installation anyway.That s actually the better option but we then have to open up the package private jackrabbit classes the QueryResultImpl currently uses - RowIteratorImpl - DocOrderNodeIteratorImpl - NodeIteratorImpl Is that OK with you I m afraid if we open up jackrabbit here we might run into more issues like this one where people start using classes that are not intended to be extended or used outside of Jackrabbit. Another hacky solution would be to place to place the class in the org.apache.jackrabbit.core.query.lucene in your project as well. I think java doesn t mind if the file is in another jar file. If you dislike this solution I think we should spend some more time thinking about which parts should be usable from outside to implement a custom QueryHandler for instance I guess you are using a customized QueryHandler in your project aren t you Unfortunately I m a bit low on time currently to concentrate on such a work I guess you are using a customized QueryHandler in your project aren t you yes we are. I ve now decoupled our code from the respective Jackrabbit classes. Feel free to remove QueryResultImpl and rename LazyQueryResultImpl.Committed patch in revision 572889. I ll open a new ticket for renaming LazyQueryResultImpl to QueryResultImpl as this might affect other users as well.

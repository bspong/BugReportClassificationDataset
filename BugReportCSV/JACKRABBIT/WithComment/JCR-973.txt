XML import using MacOS X WebDAV client does not work
when trying to import a xml file via a webdav mount this does not work. this is mainly because the client first tries to create a 0-sized file which fails with the xml importer. after the file is created it will lock it and put the xml body. a second problem might be the dot-underscore files mac tries to create.Note that command-line copies as opposed to via the Finder GUI behave differently   cp somefile.xml Volumes default somewhere-in-the-jcr-tree works for me. I haven t precisely checked the differences at the protocol level but it s useful as a workaround for Finder addicts - i changed the following - the xmlhandler does only accept content that have a length 0. this causes it to ignore the 1st empty put and let the default handler create the file. - for the subsequent put with the content the xml import would fail since the jcr content is already created as nt resource. therefor the improved handler will replace the node if it is not compatible with the desired content node type. now does the xml import with mac client work. the dot-underscore files log an error since the xml handler cannot cope with binary data but are nevertheless created later by the default handler.Committed revision 548395.the fix adding check for ImportContext.getContentLength introduced a minor inconsistency that didn t have an effect before The ImportContextImpl retrieves the content length from an InputContext which is passed with one constructor but missing with the second one. Any usage of the latter constructor has the effect that the XmlHandler will be able to import. In order to fix this the ImportContextImpl should try to retrieve the content length even if no InputContext is present.fmodified http svn.apache.org repos asf jackrabbit trunk jackrabbit-jcr-server src main java org apache jackrabbit server io ImportContextImpl.java rev. 549796 Merged to the 1.3 branch in revision 552540.

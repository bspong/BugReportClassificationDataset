PROPPATCH in simple webdav server failing with 403 Forbidden error
i ve configured the import-collection chain called via MKCOL to add nodes with the node type dav collection which is defined as such NodeTypeName   dav collection SuperTypes   nt folder IsMixin   false HasOrderableChildNodes   false PrimaryItemName   null PropertyDef   Name   RequiredType UNDEFINED   DefaultValues null   AutoCreate false   Mandatory false   OnParentVersion COPY   Protected false   Multiple false PropertyDef   Name   RequiredType UNDEFINED   DefaultValues null   AutoCreate false   Mandatory false   OnParentVersion COPY   Protected false   Multiple true the idea is that i should be able to set arbitrary webdav properties single- or multi-value on a webdav collection. when i use cadaver to mkcol a collection creating a jcr node of type dav collection and then try to propset an arbitrary property on that collection which as i understand it would set a jcr property of the same name on the dav collection node i get a 403 Forbidden error dav home mkcol hi Creating hi succeeded. dav home propset hi hi hi Setting property on hi failed 403 Forbidden it s not clear to me if i m using cadaver incorrectly misunderstanding the PROPPATCH implementation or both it turns out that i was in fact using cadaver correctly. cadaver s default namespace is DAV which of course is not registered in the repository. so the webdav server was throwing a NamespaceException when trying to formulate the jcr name for DAV hi . cadaver didn t report the response description to me until i figured out how to turn on http-level debugging. the correct way to set the property is to set the cadaver namespace to be one that is registered in the repository then create the property in that namespace dav home set namespace http osafoundation.org jcr dav 1.0 dav home propset hi myprop abc123 dav home propget hi myprop Value of myprop is abc123 this begs the question since webdav servers are required by rfc 2518 to store the values of dead properties shouldn t jcr-server attempt to register unknown namespaces rather than returning 403 Forbidden er the first sentence of the previous comment should read it turns out that i was in fact not using cadaver correctly . shouldn t jcr-server attempt to register unknown namespaces rather than returning 403 Forbidden it probably should.fixed. if the namespace of a dav-property has not been registered before an attempt is made to register it. please note that this still may fail due to a non-unique prefix or due to another error e.g. missing access rights i that situation PROPPATCH will fail.

Optimize usage of norms
There is a very significant potential for optimizing the size of the search index. We have seen a case where there were multiple segments with about the same number of nodes roughly 10 million but the size on disk was very different. One segment was 19 GB while all others where around 3 GB. The major difference was the number of fields indexed. The large segment had significantly more fields which resulted in a large norms file. We should go through our implementation and see where norms are really necessary and disable tracking of norms wherever possible.attaching proposed patch. Based on the indexing config we know if a field has its boost changed or not so if a field has no boost setting we can safely disable norms.I ve had some issues with a test IndexingRuleTest testBoost it failed a few times. The sort seemed to not be stable the field that had no initial boost so no norms kept moving from the first position to the last messing with the test result. Now it seems ok. Fixed in revision 1308833.the patch was insufficient I missed some norm creation codetweaked LazyTextExtractorField so it doesn t add norms unless it s needed. fixed in revision 1308833 and 1325820.

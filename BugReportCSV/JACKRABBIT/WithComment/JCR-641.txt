can t add lock token to session after 3 login logout
I login and lock a file and logout. Perfoms a new login and add the previous lock token to the current session because I want to unlock this file. This works fine. But if I do a new logout login I can t unlock the file the file is locked . It is best understanded looking at the test case.Perhaps the description is a bit confusing but in our web application OpenKM the users logout and login several times and an user can t unlock a previuos locked file.This is a quick and dirty workaround CLASS LockManagerImpl METHOD public void lockTokenAdded SessionImpl session String lt if element null                 AbstractLockInfo info AbstractLockInfo element.get                 if info null                     if info.getLockHolder null info.getLockHolder .getUserID .equals session.getUserID                         info.setLockHolder session                      else                         log.warn Adding lock token has no effect                                  lock already held by other session.                                                    Sample log outputpseudo code for reproducing the issue - sessionA locks a node and retrieves the lock token - sessionA logs out or lock token is removed from sessionA - lock token is transfered to sessionB - sessionB logs out or lock token is removed from sessionB - lock token is transfered to sessionC - sessionC tries to unlock the node LockException fixed in svn r480587 paco thanks for reporting this issue This is a ugly bug can be fixed in the 1.1.1 release This is a ugly bug can be fixed in the 1.1.1 release Too late the release has already been tagged. The fix will be in the 1.2 release.reopening as i realized that this issue is actually a duplicate of KCR-441resolving as duplicate of JCR-441

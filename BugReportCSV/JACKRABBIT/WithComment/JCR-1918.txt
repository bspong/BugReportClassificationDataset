DbDataStore keeps ResultSets open
The DbDataStore does not always close the ResultSet which can lead to memory leaks and or large memory usage. It seems that this already has been fixed in trunk and 1.5.Instead of committing this patch is backport JCR-1825 DBDataStore doesn t support concurrent reads . Another difference to the 1.4.x branch is JCR-1864 Database Data Store clean up the code . How important is 1.4.6 for you why don t you upgrade to 1.5 The code in 1.5 and trunk has clearly improved and looks much better. The idea of this patch instead of backporting the other patches is that it fixes the specific problem without doing any refactoring minimizing the risk of introducing new behavior or bugs. We will be upgrading to 1.5 within the next month but I could still be useful to people who are stuck to 1.4 when a new maintenance release is done of the core. For some background I ran into this bug when importing some 15GB of data for a customer. Without the patch I ran into OOMs using 1GB of memory within 40 minutes. With the patch the import script was running fine for almost 2 days straight getting all the data in. The setup was running on linux 64bit with java 6 64bit in Tomcat 6 with mysql configured as a datasource.Scheduling for jackrabbit-core 1.4.8.The patch doesn t close the first result sets in the method DbDataStore.addRecord. I will create a new patch and test it.I m sorry - it does close the result set. I will test the patch and commit it.The patch is incorrect if copyWhenReading is disabled. I will fix it.Committed in r736286 1.4 branch Thx Thomas 

Item.isSame may return true for 2 nodes from different workspaces.
the code in ItemImpl.isSame only compares the item id but not the source workspace. spec Two Item objects represent the same repository item if all the following are true 1 Both objects were acquired through Session objects that were created by the same Repository object. 2 Both objects were acquired through Session objects bound to the same repository workspace. 3 The objects are either both Node objects or both Property objects. 4 If they are Node objects they have the same correspondence identifier see 3.10.2 Multiple Workspaces and Corresponding Nodes . 5 If they are Property objects they have identical names and their parent nodes have the same correspondence identifiers. spec however point 2 and 4 are a bit contradicting but 2 is stronger. so i assume the workspace must be taken into account then comparing the items. see also discussion on jcr283 https jsr-283.dev.java.net issues show bug.cgi id 146for the sake of correctness the quote in tobi s previous comment was extracted from a draft version of the next maintenance release of the spec jcr 1.0.1 which has yet to be finalized. here s what the current spec has to say about Item isSame Item quote jcr 1 0 Returns true if this Item object the Java object instance represents the same actual repository item as the object otherItem.This method does not compare the states of the two items. For example if two Item objects representing the same actual repository item have been retrieved through two different sessions and one has been modified then this method will still return true when comparing these two objects. Note that if two Item objects representing the same repository item are retrieved through the same session they will always reflect the same state see 7.1.3 Reflecting Item State so comparing state is not an issue.A RepositoryException is thrown if an error occurs. quote jcr 1 0 the current spec is obviously unclear about whether the workspace name has to be taken into account or not. as soon as jcr 1.0.1 has been finalized or we ve reached consensus within the expert group about this topic i ll fix the the implementation in jackrabbit. fixed in svn r429293

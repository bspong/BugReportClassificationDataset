When using QueryImpl.setLimit and QueryImpl.setOffset then NodeIterator.getSize reports wrong size
When using QueryImpl.setLimit and QueryImpl.setOffset then NodeIterator.getSize reports wrong size. Returned size seems to be allways the same as the limit.This is expected behaviour as the iterator has exactly that size. To get the total number of result entries use org.apache.jackrabbit.core.query.lucene.QueryResultImpl.getTotalSize . Please ask on the mailing list before creating issues.I think you didn t understand me completely. If I have 45 nodes offset is 40 and limit is 20 ie I am on the last page then NodeIterator.getSize should report 5 and not 20. final Query query session.getWorkspace .getQueryManager .createQuery queryString Query.XPATH QueryImpl query .setLimit limit QueryImpl query .setOffset offset NodeIterator ni queryResult.getNodes System.out.println ni.getSize will print 20 and not 5 as expected int i for i 0 ni.hasNext i   ni.nextNode System.out.println i will print 5 Now I must use workaround final long totalSize QueryResultImpl queryResult .getTotalSize final long size Math.min ni.getSize totalSize - offset If I am wrong again then I apologize in advance - Thanks a lot for clarifying Fixed in rev. 613221Merged to the 1.4 branch in revision 618589.

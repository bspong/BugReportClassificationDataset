DatabaseFileSystem mysql.ddl works for mysql5 but not mysql 4.1.20
Perhaps a new column primary key could get added to the table called uid which is actually an md5checksum of FSENTRY PATH and FSENTRY NAME.hi stephen thanks for reporting this issue. this issue has been reported a while ago on the dev-list. you can find the discussion incl. solutions here http www.mail-archive.com dev jackrabbit.apache.org msg00969.html i m resolving this issue as Won t Fix since it s IMO rather a db configuration issue. cheers stefanI am sorry but IMO this does not seem like a reasonable solution. Mysql fixed this bug not config as of 5.0.19 - http bugs.mysql.com bug.php id 13835 To support older databases mysql4.ddl should get created with create table schemaObjectPrefix FSENTRY FSENTRY PATH text not null FSENTRY NAME varchar 255 not null FSENTRY DATA longblob null FSENTRY LASTMOD bigint not null FSENTRY LENGTH bigint not null charset latin1 This allows the developer to choose the right schema in his her application without having to download the code create a patch then do it all over again after the next release. mysql4.dll and mysql.ddl should have create unique index JCR FSENTRY IDX on JCR FSENTRY FSENTRY PATH 745 FSENTRY NAME Mysql fixed this bug not config as of 5.0.19 - http bugs.mysql.com bug.php id 13835 this mysql bug is IMO unrelated to the current issue because it refers to fulltext indices which are not used in jackrabbit. fulltext indices don t have a size limit hence the mysql bug but regular indices do. mysql4.dll and mysql.ddl should have create unique index JCR FSENTRY IDX on JCR FSENTRY FSENTRY PATH 745 FSENTRY NAME that s not a good idea since the max key limit is storage engine mysql version dependant. quote src http dev.mysql.com doc refman 4.1 en create-index.html Prefix lengths are storage engine-dependent for example a prefix can be up to 1000 bytes long for MyISAM tables 767 bytes for InnoDB tables . Before MySQL 4.1.2 the limit is 255 bytes for all tables. Note that prefix limits are measured in bytes whereas the prefix length in CREATE INDEX statements is interpreted as number of characters for non-binary data types CHAR VARCHAR TEXT . Take this into account when specifying a prefix length for a column that uses a multi-byte character set. quote the current create unique index stmt in mysql.ddl is IMO a good compromise that will work with most mysql servers out there. added character set latin1 to create table statement fixed in svn r566639Merged to the 1.3 branch in revision 577850.

Annotation based implementation of jackrabbit ocm
we have created an annotation based implementation of jackrabbit-ocm that can be used instead of the digester onePatch needed for jackrabbit-ocmPatch needed for jackrabbit-ocm-nodemanagement.there s still the problem that jcr-nodemanagement has not been deployed and the reference to jackrabbit-ocm in its pom is still 1.0-SNAPSHOT instead of 1.4-SNAPSHOTupdated patch with correct versions in pomAnd here it is the important part If you run the unit test you ll see it fails we haven t figured out how to deal with collections yet maybe somebody can figure out what s going on thereThe class AnnotatedObjectMapper doesn t register the class descriptor which certainly causes this kind of issue. classDescriptorsRequiringRegistration is empty in the constructor. I m going to continue my investigation tomorrowOOps maybe it is a normal behavior after a second run. Need more time to investigate.Patch applied - thanks The collection issue is still there. I created a more simple unit test because I also detected some issues with namespaces. I continue to work on it. I added support for the bean descriptor. I dropped the AnnotationObjectContentManagerImpl because we can use the ObjectContentManagerImpl. Only the mapper is different for the annotation support. I also modified the annotation attribute names. In order to avoid confusion it is important to use the same name as the xml file descriptors. Please make suggestions if you think that the names are not correct. the collection annotation has to be modify should be done this week . I added more unit tests map objects into nt unstructured . I will add more unit test for mapping on specific node types. I will continue to work on this issue. I think we can add the following improvements Create an abstract mapper impl because both Mapper classes have a lot of code in common AnnotedObjectMapper DigesterMapperImpl . The Mapper classes should not have the responsibility to create the jcr node types. This can be done outside the mapper and it should be an optional operation. There are certainly some use cases where node type creation is not necessary. I m just wondering how can we use the same unit tests for both approach xml file annotations . Can we drop the annotation SuperType. This is defined in the annotation Node jcrSuperTypes Add license headers Please add your comments and feedback. the annotation support is done.

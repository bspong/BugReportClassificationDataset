Re-index fails on corrupt bundle
The re-indexing process should be more resilient log an error and simply continue with the next node. It doesn t seem useful to refuse repository startup in this case.In the case of a corrupt bundle the ItemStateManager getItemState can throw an ItemStateException that stops the repository from starting. My proposal is to have MultiIndex.createInitialIndex catch the ItemStateException and have it logged via the OnWorkspaceInconsistency handler. The error wouldn t be a blocker anymore and if anybody is looking at the workspace consystency logs will see its message as well. The simplest way to do this is to wrap log.error into a public method OnWorkspaceInconsistency logError and use it from the MultiIndex.Is this not be handled with JCR-2651 greetsHi Claus I don t understand what you are saying Is that a question or a suggestion It is not currently handled by JCR-2651 because it addresses only NoSuchItemStateException. In this issue I m dealing with is an ItemStateException generated by a corrupt bundle.ahh sorry for my typo .. ok i see you are handling with ItemStateException... so i think it will be good as you have proposed to catch it and handle it with OnWorkspaceInconsistency logError wrap log.error into a public method OnWorkspaceInconsistency logError sounds good to me.fixed in revision 1304323.backported to 2.4 in revision 1304466.

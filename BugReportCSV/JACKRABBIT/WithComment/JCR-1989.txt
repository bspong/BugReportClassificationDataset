AppendRecord writes single bytes to disk
The AppendRecord initially buffers writes in memory and starts to write it to a temp file as soon as it occupies more than 64k heap. After switching to the temp file data is written unbuffered.Proposed patch. 1 Simple and effective. On a related note the DeferredFileOutputStream from Commons IO does pretty much the same thing as the custom memory buffering we have in the AppendRecord class. There s no need to change the code now but leveraging the DeferredFileOutputStream might be a good idea if we ever find other issues with the current code or want to refactor things.Thanks for the review. Committed the patch in revision 745849

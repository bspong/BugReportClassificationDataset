Adding DerbyDataStore to handle proper close of the embedded database
When using embedded Derby in conjunction with DbDataStore the Derby database is never shutdown as it requires special code to be executed creating a Connection with shutdown true We may provide a DerbyDataStore extending standard DbDataStore for handling that.Attached is a patch that extends DbDataStore with a DerbyDataStore overriding the close method Note that this relies on the JCR-2127 for the close method being actually calledCommitted in revision 783383 trunk . Test case fixed in revision 783386 trunk . Thanks a lot for the patch A few remarks 1 Originally I wanted to use the same class DbDataStore for all databases to simplify configuration and maybe implementation . But in this case it makes sense to use a different class. 2 super.close is called twice in your patch. I added a remark need to call it again because we just opened a connection and super.close closes it. Could the improvement be backported to the upcoming 1.6.0 Along with the fix contained in the JCR-2127 We may want to include it in 1.6.0I don t know if there will be a Jackrabbit 1.6.0...Merged to the 1.x branch in revision 791791.

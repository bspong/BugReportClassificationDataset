Removal of first version throws javax.jcr.ReferentialIntegrityException
A ReferentialIntegrityException occurs when I delete the first version succeeding the root version. Deleting other versions works fine. Here is the stack javax.jcr.ReferentialIntegrityException Unable to remove version. At least once referenced.         at org.apache.jackrabbit.core.version.InternalVersionHistoryImpl.removeVersion InternalVersionHistoryImpl.java 379         at org.apache.jackrabbit.core.version.InternalVersionManagerBase.internalRemoveVersion InternalVersionManagerBase.java 684         at org.apache.jackrabbit.core.version.InternalVersionManagerImpl 5.run InternalVersionManagerImpl.java 495         at org.apache.jackrabbit.core.version.InternalVersionManagerImpl DynamicESCFactory.doSourced InternalVersionManagerImpl.java 760         at org.apache.jackrabbit.core.version.InternalVersionManagerImpl.removeVersion InternalVersionManagerImpl.java 493         at org.apache.jackrabbit.core.version.InternalXAVersionManager.removeVersion InternalXAVersionManager.java 264         at org.apache.jackrabbit.core.version.VersionHistoryImpl.removeVersion VersionHistoryImpl.java 253 The code is simple VersionHistory vh session.getWorkspace .getVersionManager .getVersionHistory path vh.removeVersion version where version is the first version succeeding the root version Are you sure that version is not referenced by a versionable node I am not certain. But the only action which is performed on the node is versionManager.checkout path Version ver versionManager.checkin path versionManager.addVersionLabel ver.getName ... true And other versions than the first which are created the same way can be deleted. How could I resolve delete such references can you create a test case that covers your issue see examples in  jackrabbit trunk jackrabbit-core src test java org apache jackrabbit core version RemoveVersionTest.javaWhen I run your test case against 2.0.0 I get the ReferentialIntegrityException when I move the removal of the actual node after the removal of the versions. In the trunk version both versions work fine.works in trunk thus closing as fixed.
